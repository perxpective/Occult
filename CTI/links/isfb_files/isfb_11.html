<!DOCTYPE html><!-- Last Published: Thu Dec 21 2023 10:32:03 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="www.cleafy.com" data-wf-page="609e4249b3778b39524cad9a" data-wf-site="6020129a813fe0c8f1e8053e" lang="en"><head><meta charset="utf-8"/><title>Digital banking fraud: how the Gozi malware works</title><meta content="Read the Technical Analysis of the Gozi malware family, and discover how is used on digital banking fraud." name="description"/><meta content="Digital banking fraud: how the Gozi malware works" property="og:title"/><meta content="Read the Technical Analysis of the Gozi malware family, and discover how is used on digital banking fraud." property="og:description"/><meta content="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172c10ee5fec0fe5dac76ba_Linkedin-1%20LABS-01.png" property="og:image"/><meta content="Digital banking fraud: how the Gozi malware works" property="twitter:title"/><meta content="Read the Technical Analysis of the Gozi malware family, and discover how is used on digital banking fraud." property="twitter:description"/><meta content="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172c10ee5fec0fe5dac76ba_Linkedin-1%20LABS-01.png" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="NzF6vhWzbA9bechcdWjl5dTv5OEoTjcIlJbQ-Tvu_kk" name="google-site-verification"/><link href="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/css/cleafy.58725456d.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com" rel="preconnect"/><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Inconsolata:400,700","Roboto Mono:regular"]  }});</script><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/603d13d936ee41fe7a568f18_Crypto%20-%2032.png" rel="shortcut icon" type="image/x-icon"/><link href="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/603d13dd8d1bea09eb7266d5_Crypto%20-%20256.png" rel="apple-touch-icon"/><link href="https://www.cleafy.com/cleafy-labs/digital-banking-fraud-how-the-gozi-malware-work" rel="canonical"/><meta name="google-site-verification" content="NzF6vhWzbA9bechcdWjl5dTv5OEoTjcIlJbQ-Tvu_kk">
<link rel="preconnect" href="https://assets-global.website-files.com/"/>
<link rel="preconnect" href="https://cdn.iubenda.com"/>
<link rel="preconnect" href="https://www.googletagmanager.com"/>



<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WF5KQ9M');</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WF5KQ9M"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



<style>
/* HubSpot*/
fieldset.form-columns-1 .hs-input  {
  width:100%;
  } 
  
  .hs-dependent-field{
  margin-top:20px;
  margin-bottom:20px;
  }
  
form.hs-form fieldset.form-columns-1 .hs-input {
  width: 100%;
}


  .grecaptcha-logo{
  margin-top: 32px;
 }
  
  .rc-anchor-invisible{
  margin-top:16px;}
  
  label{
  font-weight: 300;
  margin-bottom:8px;
  }  
  
  input[type="file"]{
    display: inline-block;
    border-radius: 0.8em;
    -webkit-transition: color 200ms ease, background-color 200ms ease;
    transition: color 200ms ease, background-color 200ms ease;
    font-size: 14px;
    font-weight: 500;
  	border: 1px;
    border-color: 
    text-decoration: none
  }
  
  .hs-dependent-field{
    margin-top: 8px;
    margin-bottom: 8px;
  }
  
  label[for="file"] {
  background-color: white;
  }
  
  
.hs-input:not([type=file]) {
    background-color: white;}

.hs-richtext{
  	font-size:10px;
  }
  
  .inputs-list{
  margin-top:4px;
  margin-bottom: 8px;
  }
  
  input{
  margin-bottom:16px;
  }
  
  textarea{
  margin-bottom:16px;
  }
  
.hs-input {
	/* 	-webkit-appearance: none; */
    display: inline-block;
    width: 100%;
  	padding: 9px 10px;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    font-size: 16px;
    font-weight: normal;
    line-height: 22px;
    color: #33475b;
    border: 1px solid #FFFFFF;
    box-sizing: border-box;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    -ms-border-radius: 3px;
    border-radius: 3px;
}
  
  
input[type=submit] {
    -webkit-appearance: none;
	position: static;
 	width: 100%;
    right: 1em;
    display: block;
    margin-top: 2em;
    padding: 1em 1.67em;
    border-radius: 0.8em;
    background-color: #009fa8;
    -webkit-transition: color 200ms ease, background-color 200ms ease;
    transition: color 200ms ease, background-color 200ms ease;
    color: #ceffca;
    font-size: 1em;
    font-weight: 500;
    text-decoration: none;
  border: 0px;
}  
  .inputs-list{
  list-style-type: none;
  padding: 0;
  margin: 0;
}
  .hs-form-booleancheckbox{
    font-size: 10px;
    font-weight: 300;
  }

  /* Custom Input */
ul.inputs-list.multi-container li.hs-form-checkbox {
  margin: 16px 0;
}
ul.inputs-list.multi-container li.hs-form-checkbox label {
  position: relative;
}
ul.inputs-list.multi-container li.hs-form-checkbox label span {
display: inline-block;
  margin-left: 40px; /* Width of the new radio select and any additional spacing on the left */
  margin-right: 16px; /* Additional spacing on the right */
}
/* Hide the original checkbox */
ul.inputs-list.multi-container li.hs-form-checkbox label input {
  height: 24px;
  left: 0;
  opacity: 0;
  position: absolute;
  top: 0;
  width: 24px;
}
/* Add new checkbox */
ul.inputs-list.multi-container li.hs-form-checkbox label span::before {
  border: 2px solid;
  content: "";
  height: 24px;
  left: 0;
  position: absolute;
  top: 0;
  width: 24px;
  border-radius: 4px;
}
/* Style new checked item */
ul.inputs-list.multi-container li.hs-form-checkbox label span::after {
  content: "";
  border: 4px solid;
  border-left: 0;
  border-top: 0;
  height: 16px;
  left: 8px;
  opacity: 0;
  position: absolute;
  top: 2px;
  transform: rotate(45deg);
  transition: opacity 0.2s ease-in-out;
  width: 8px;
}
/* Show when checked */
ul.inputs-list.multi-container li.hs-form-checkbox label input:checked + span::after {
  opacity: 1;
}
/* Style when focused */
ul.inputs-list.multi-container li.hs-form-checkbox label input:focus + span::after {
  outline: 3px solid transparent; /* For Windows high contrast mode. */
}
  
  
  
@media only screen and (max-width: 600px) {

  input[type=text] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
    input[type=email] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
    textarea {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  height: 120px;    
}
  
  
input[type=submit] {
    -webkit-appearance: none;
	position: static;
    right: 1em;
    width:100%;
    margin-top: 2em;
    padding: 1em 1.67em;
    border-radius: 0.8em;
    background-color: #009fa8;
    -webkit-transition: color 200ms ease, background-color 200ms ease;
    transition: color 200ms ease, background-color 200ms ease;
    color: #ceffca;
    font-size: 1.2em;
    font-weight: 500;
    text-decoration: none;
  border: 0px;
}
</style><style>
.w-embed{
	width:90%;
  margin:auto;
  }
</style>
   <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "Digital banking fraud: how the Gozi malware works",
      "description": "Read the Technical Analysis of the Gozi malware family, and discover how is used on digital banking fraud.",
      "image": "https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172c10ee5fec0fe5dac76ba_Linkedin-1%20LABS-01.png",
      "datePublished": "",
      "author": [{
          "@type": "Person",
          "name": "Federico Valentini",
          "url": "www.cleafy.com/autori/digital-banking-fraud-how-the-gozi-malware-work",
          "jobTitle": "Head of Threat Intelligence and Incident Response",
          "image": "https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b5b9c1376519044dbc9e1_FedeV_final.jpg",
          "sameAs": "https://www.linkedin.com/in/federico-valentini-862003a6/"
        },{
          "@type": "Person",
          "name": "Francesco Iubatti",
          "url": "www.cleafy.com/autori/francesco-iubatti",
          "jobTitle": "Mobile Malware Analyst &amp; Threat Intelligence Analyst",
          "image": "https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b9b336021964770793763_Francesco_Iubatti.png",
          "sameAs": "https://www.linkedin.com/in/francesco-iubatti/"
        }],
      "publisher": {
        "@type": "Organization",
        "name": "Cleafy",
        "url": "https://www.cleafy.com/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/62875f1223056743282d00f8_logo-extended-blue.jpg"
        }
      }
    }
    </script></head><body class="clabs"><div class="announcer w-dyn-list"><div class="emptytohide w-dyn-empty"><div>No items found.</div></div></div><main class="navbar labs"><a href="/" class="logo w-inline-block"><img src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/6031121f73c6a32184bd3db3_Cleafy-white-logo.svg" loading="lazy" alt=""/></a><ul role="list" class="navlist"><li id="w-node-f10984d6-bfd8-6a9d-4748-4f4600c5c571-00c5c56d" class="navitemlist"><a href="/why-cleafy" class="li link labs">Why Cleafy</a></li><li id="w-node-f10984d6-bfd8-6a9d-4748-4f4600c5c574-00c5c56d" class="navitemlist"><a href="/anti-fraud-solution" class="li link labs">Solution</a></li><li id="w-node-f95f33e8-d1a5-4bd0-4960-775ab0e6f9e3-00c5c56d" class="navitemlist"><a href="/threat-intelligence" class="li link labs">Intelligence</a></li><li id="w-node-f10984d6-bfd8-6a9d-4748-4f4600c5c577-00c5c56d" class="navitemlist company nopaddingmobile"><div class="web"><a href="#" class="li labs w-inline-block"><div>Resources</div><div class="fonticon left2">g</div></a><div class="hovermenulist resources"><a href="/resources/documents" class="lihover">Documents</a><div class="divider tiny"></div><a href="/resources/insights" class="lihover">Insights</a><div class="divider tiny"></div><a href="/labs" class="lihover">Cleafy Labs</a><div class="divider tiny"></div><div class="lihover comingsoon">Events</div><div class="divider tiny hide"></div><div class="lihover comingsoon">Webinar</div></div></div><div data-hover="false" data-delay="0" class="mobileli w-dropdown"><div class="li company noborderbottom labs w-dropdown-toggle"><div class="accordionicon w-icon-dropdown-toggle"></div><div>Resources</div></div><nav class="dropdown-list w-dropdown-list"><div class="hovermenulist"><a href="/resources/documents" class="lihover labs">Documents</a><a href="/labs" class="lihover labs">Cleafy Labs</a><div class="divider tiny"></div><div class="lihover comingsoon labs">Events</div><div class="divider tiny"></div><div class="lihover comingsoon labs">Webinar</div></div></nav></div></li><li id="w-node-f10984d6-bfd8-6a9d-4748-4f4600c5c58e-00c5c56d" class="navitemlist company nopaddingmobile"><div class="web"><a href="#" class="li labs w-inline-block"><div>Company</div><div class="fonticon left2">g</div></a><div class="hovermenulist"><a href="/about-us" class="lihover">About us</a><div class="divider tiny"></div><a href="/careers" class="lihover">Careers</a><div class="divider tiny"></div><a href="/partners" class="lihover">Partners</a></div></div><div data-hover="false" data-delay="0" class="mobileli w-dropdown"><div class="li company noborderbottom labs w-dropdown-toggle"><div class="accordionicon w-icon-dropdown-toggle"></div><div>Company</div></div><nav class="dropdown-list w-dropdown-list"><div class="hovermenulist"><a href="/about-us" class="lihover labs">About us</a><div class="divider tiny"></div><a href="/careers" class="lihover labs">Careers</a><div class="divider tiny"></div><a href="/partners" class="lihover labs">Partners</a></div></nav></div></li><li class="li mobile"><a href="/get-in-touch" class="button nav">Get in touch</a></li></ul><a href="/get-in-touch" class="button nav web">Get in touch</a><div data-is-ix2-target="1" class="menuburger" data-w-id="f10984d6-bfd8-6a9d-4748-4f4600c5c5aa" data-animation-type="lottie" data-src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/61001195712379681c733bde_lf30_editor_vybrwrxp.json" data-loop="0" data-direction="1" data-autoplay="0" data-renderer="svg" data-default-duration="2" data-duration="2" data-ix2-initial-state="0"></div></main><div class="globalcustomcss w-embed"><style>
/* JQuery */
@media only screen and (min-width: 1440px) {
     body {font-size: 14.4px;}
}
/* Global CSS */
.navbar {
	backdrop-filter: blur(0.7em);
  -webkit-backdrop-filter: blur(0.7em);
}

.overlayHubSpot{
	backdrop-filter: blur(1em);
  -webkit-backdrop-filter: blur(1em);
}
</style></div><section class="intro clab"><div class="wrapper"><div class="w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="tagitem w-dyn-item"><div class="ctag"><div>Gozi</div></div></div><div role="listitem" class="tagitem w-dyn-item"><div class="ctag"><div>Windows</div></div></div><div role="listitem" class="tagitem w-dyn-item"><div class="ctag"><div>Fraud</div></div></div><div role="listitem" class="tagitem w-dyn-item"><div class="ctag"><div>Malware</div></div></div></div></div><h1 class="clabtitle">Digital banking fraud: how the Gozi malware works</h1><div class="infoarticle"><div class="cdatablock detail w-clearfix"><h6 class="mono whitetext datalab">Published:</h6><h6 class="mono whitetext datalab nor">25/10/21</h6></div><a href="/labs" class="w-inline-block"><img src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/60b5585b6689a33061c9c75d_C_Labs_Octanium.svg" loading="lazy" alt="" class="logo labs detail"/></a></div></div></section><div style="-webkit-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="overlayhubspot w-clearfix"><div class="overlay"></div><div style="-webkit-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(100%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)" class="formcontainer editorial"><div class="headform">Download the PDF version</div><div class="form w-embed w-script"><!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
	portalId: "3993512",
	formId: "51329453-cd82-46d1-a80f-87611891dfee"
});
</script></div></div></div><section class="section paddingbig visible"><div class="wrapper"><div class="downloadbannerbigger insight bigger clabs w-condition-invisible"><div class="infobannerblock"><h3>Download your PDF  guide to TeaBot</h3><p>Get your free copy to your inbox now</p></div><a href="#" class="button downloadpdf bigger">Download PDF Version</a></div></div><div class="wrapper clabs w-clearfix"><div class="_45 full blog"><section id="1" class="bigmarginbottom"><h3 class="titlesectionclab">Introduction</h3><div class="blog w-richtext"><p>Also known as RM3, ISFB, Ursnif, Dreambot, CRM, and Snifula, Gozi can be considered as a group of malware families which are based on the same malicious codebase. Historically, it has been known as one of the most widely spread and longest-standing Banking Trojans with more than 14 years of activity. Its unique modular architecture facilitates multiple <strong>Threat Actors</strong> (TAs) in carrying on with their own malicious purposes, which in most cases are included in the following categories: </p><ul role="list"><li>Banking fraud</li><li>eCommerce fraud</li><li>POS devices compromise</li><li>Ransomware </li></ul><p>Since its source-code was leaked in 2015, tracking all the different variants appears to be knotty and time consuming due to its fragmentation and the several distinct names used by security firms and researchers. The main functionalities of Gozi families, and derivatives, include:</p><ul role="list"><li>Acting as info-stealer by collecting system activities and data (including network and browser data)</li><li>Recording keystrokes (keylogging)</li><li>Recording videos or making screenshots</li><li>Performing MitB attacks on the targeted websites (e.g., Formgrabbing, Web-injects)</li><li>Redirect browser navigation to malicious websites</li><li>Enabling hVNC (hidden-VNC) and SOCKS proxy </li></ul><p>Focusing on the <strong>Banking fraud</strong> category, during the last 2 years we were able to analyze in-depth a specific TA (or a group of affiliates) which distributes Gozi infections on EU territory to corporate banks and their customers. </p><p>During our analysis, we were able to extract multiple TTPs on how this specific TA leverages Gozi to execute unauthorized transactions to a well-organized network of bank mule accounts controlled by the same group.</p><p><strong>OUR FINDINGS</strong></p><p><strong>More than 50 different banks and financial institutions</strong> appear to be targeted by this group, which includes both retail and corporate environments in Europe. </p><p>Through Gozi, the TA delivers a specific Web-inject family, which we dubbed as RATBANK (also known as ‘delsrc’), which is used to discriminate interesting bots and to perform <strong>Account Takeover (ATO)</strong> <strong>fraud</strong> only on valid ones. </p><p>The TA behind this pattern has a deep knowledge of how those targeted corporate banking environments work, which steps are needed to authorize a bank transfer, and how different 2FA (two factor authentication) mechanisms can be bypassed, by identifying specific weaknesses in their implementation.</p><p>During Q4 2020, the same group started distributing another Android malware (Alien) to expand their attack surface also on mobile devices.</p><p>The TA has access to native-speaking operators who perform vishing attacks in the attempt to elicit victims during the execution of an ATO scenario and to try to isolate all the communication between victims and their banks with Social Engineering tricks.</p><p>The TA has access to a significant and well-structured set of money mule accounts, in multiple SEPA (Single Euro Payment Area) and NON-SEPA countries, which are typically discriminated against by the amount of the unauthorized transaction. </p><p>In the last 2 years, we identified <strong>more than 100 bank accounts</strong> controlled by this group, with the largest amount being <strong>1,5M Euro, handled in a single bank transfer </strong>during a targeted Account Takeover fraud.</p></div></section><section id="2" class="bigmarginbottom"><h3 class="titlesectionclab">Gozi malspam distribution: a recent example</h3><div class="blog w-richtext"><p>Gozi has a very stable malspam distribution routine as many different campaigns have been used to spread this malware. In recent malspam campaigns, the well-known actor TA551 has been caught multiple times pushing Gozi infection to European citizen as follows:</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172b6cdc701525193198918_Figure%201.png" loading="lazy" alt="Figure 1 – TA551/Shathak pushing Gozi in Europe (April 2020) "/></div><figcaption>Figure 1 <em>–</em> TA551/Shathak [<a href="https://twitter.com/malware_traffic/status/1385241028924518410">1</a>] pushing Gozi in Europe (April 2020) </figcaption></figure><p><strong>TA551 (also known as Shathak)</strong> is a sophisticated threat actor behind an email-based malware distribution campaign that often targets end-users on a global scale.Historically, TA551 has pushed different payloads belonging to multiple malware families such as Gozi/Ursnif, IcedID, and Trickbot.</p><p>Even though TA551 often targets English-speaking victims, it has been caught targeting German, Italian and Japanese users as well by using geofencing techniques that make payloads not accessible to users in all regions and better protected against malware analysts and researchers. </p><p>The following list shows multiple maldocs that, last April, spread Gozi infection from a specific <strong>TA551/Shathak</strong> campaign focused on both German and Italian lures:</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172b79c099f5545efde093a_Figure%202.png" loading="lazy" alt="Figure 2 - Gozi maldocs pushed by TA551/Shathak"/></div><figcaption>Figure 2 - Gozi maldocs pushed[<a href="https://www.malware-traffic-analysis.net/2021/04/22/index.html">2</a>] by TA551/Shathak<br/></figcaption></figure><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172b899bff7d51771ed14b0_Figure%203.png" loading="lazy" alt="Figure 3 - TA551/Shathak German and Italian maldoc template"/></div><figcaption>Figure 3 - TA551/Shathak German and Italian maldoc template</figcaption></figure><p>From a high-level perspective, atypical Gozi infection is characterized by the following steps:</p><ol start="" role="list"><li>The user opens the Word document attached to the received email and enables a malicious macro which triggers the download of a dynamic link library (<em>.dll</em>) from a remote server.</li><li>The downloaded <em>.dll </em>will be executed via <em>RegSvr32.exe</em> and unpack the core Gozi loader into memory, which is designed to manage all the interactions with the infected machine (e.g download/launch additional modules, update configuration, etc.).</li><li>Gozi uses Internet Explorer (IE) COM objects to communicate with its C2server; it creates a running instance through the<em> CoCreateInstance() </em>API.</li></ol><p>The previous steps can be better visualized with the following “process graph view” which has been extracted from a recent Gozi malspam campaign: </p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172b980985ab983252e986f_Figure%204.png" loading="lazy" alt="Figure 4 - Gozi process tree view"/></div><figcaption>Figure 4 - Gozi process tree view[<a href="https://app.any.run/tasks/5c628008-9f2c-49d1-8a94-aa878e46076f/">3</a>] <br/></figcaption></figure><p>[1] Source: <a href="https://twitter.com/malware_traffic/status/1385241028924518410">https://twitter.com/malware_traffic/status/1385241028924518410</a></p><p>[2] Source: <a href="https://www.malware-traffic-analysis.net/2021/04/22/index.html">https://www.malware-traffic-analysis.net/2021/04/22/index.html</a></p><p>[3] Source: <a href="https://app.any.run/tasks/5c628008-9f2c-49d1-8a94-aa878e46076f/">https://app.any.run/tasks/5c628008-9f2c-49d1-8a94-aa878e46076f/</a></p></div></section><section id="3" class="bigmarginbottom"><h3 class="titlesectionclab">Exploring the “Gozi fraud core toolkit”</h3><div class="blog w-richtext"><p>After a new victim has been successfully infected, the TA will deliver a specific configuration through the core Gozi loader, to instruct the bot on where to retrieve additional modules (also referred to as “second stages”), which typically includes:</p><ul role="list"><li>Web-inject kit(s) for the targeted applications</li><li>hVNC module</li><li>SOCKS module</li></ul><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172bb9398f15200b5b87191_Figure%205.png" loading="lazy" alt="Figure 5 - Fraud-related additional modules (hVNC, Web-injects) from Gozi configuration"/></div><figcaption>Figure 5 - Fraud-related additional modules (hVNC, Web-injects) from Gozi configuration</figcaption></figure><p><strong>Web-injects</strong> are typically part of a MitB attack with the goal of modifying the content of a legitimate web page in real-time by performing API hooking. They are considered as an extension of the formgrabbing technique since they can intercept and manage web responses, altering the content before it is displayed on the browser (bypassing TLS protocol).  </p><p><strong>hVNC</strong> stands for <strong>Hidden VNC</strong> and means that the malware controls a machine without the victim’s knowledge. Instead of controlling a victim’s desktop, an attacker can open a hidden instance in the shape of a virtual desktop and control it invisibly behind the scenes, even as the unwitting victim continues using his or her computer.</p><p><strong>SOCKS</strong> module enables TA to remotely connect to the infected bot, routing all the internet data through the same IP address as the victim, bypassing anti-fraud countermeasures such as network heuristics, etc.</p><p>We refer to those three modules as the <strong>“Gozi fraud core toolkit”</strong> since those are the modules used by high-skilled fraud operators for conducting banking fraud nowadays which typically happens only on the most valuable bots. This is an interesting pattern that we observed especially over the last year: from the initial malspam campaign to the actual banking fraud attempt, it can take weeks or even months, and <em>during this period operators enrich their botnet automatically via RATBANK</em>, exfiltrating in the background useful information, such as:</p><ul role="list"><li>Valid credentials </li><li>Personal information and phone numbers(for further vishing attacks, if required)</li><li>Account balances</li><li>Recent bank transfers</li><li>2FA mechanism in use (e.g., SMS based, token based, QR codes)</li></ul><p><strong>RATBANK</strong> appears to be the main Web-inject kit used by this TA, which works as aRitB (<strong>RAT in the Browser</strong>), injecting a malware code into the browser memory by using MitB (Man in the Browser) techniques. In this way the victim’s browser becomes a middle man component for all monitored web sessions. These specific attacks are very hard to detect since the compromised user continues to act undisturbed in a normal-looking web session on his own device and with his own IP address, known to (and therefore not suspected by) the targeted bank.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172bce4aa85932b56e8aad3_Figure%206.png" loading="lazy" alt=""/></div><figcaption>Figure 6 - RATBANK injected during the login process into a targeted website</figcaption></figure><p>During our analysis, we were also able to intercept “less-common” configurations where we noticed the usage of another Web-inject kit in addition to RATBANK, also known as <strong>tables</strong>, and well described in the following <a href="https://www.botconf.eu/wp-content/uploads/2018/12/2018-J-Wyke-Tracking-actors-through-their-webinjects-.pdf">research</a> published by FireEye in 2018.</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/6172bd4365ec852f1db21697_Figure%207.png" loading="lazy" alt=""/></div><figcaption>Figure7 - Two different Web-inject kits found on recent Gozi campaigns</figcaption></figure><p>An example of a related sample that has been caught delivering this specific configuration has been provided in <strong>Appendix 1: IOCs</strong>.</p><p>Once extracted, we identified more than 50 different financial institutions targeted by this specific configuration, including both retail and corporate banking environments, as shown in the following table:</p><div class="w-embed"><table style="border-color: 0000;">
	<tbody>
		<tr>
			<td width="84">
				<p><strong>Country</strong></p>
			</td>
			<td width="142">
				<p><strong>Number of targets</strong></p>
			</td>
			<td width="189">
				<p><strong>Webinjects kit (family)</strong></p>
			</td>
			<td width="265">
				<p><strong>Additional modules</strong></p>
			</td>
		</tr>
		<tr>
			<td width="84">
				<p>Italy</p>
			</td>
			<td width="142">
				<p>39</p>
			</td>
			<td width="189">
				<p>RATBANK (delsrc)</p>
			</td>
			<td width="265">
				<p>SOCKS-5, hVNC</p>
			</td>
		</tr>
		<tr>
			<td width="84">
				<p>Germany</p>
			</td>
			<td width="142">
				<p>12</p>
			</td>
			<td width="189">
				<p>tables&nbsp;&nbsp;</p>
			</td>
			<td width="265">
				<p>NA</p>
			</td>
		</tr>
	</tbody>
</table></div><h5>Appendix1: IOCs</h5><p>‍</p><p>2ef16b02901c1bdd819ddf1aa96f3994 (Gozi maldoc)</p><p>0b26191e482cf7c321efeb8d2569caac (Gozi loader)</p><p>x-energy[.org/components/com_finder/img32.rar(hVNC 32 bit)</p><p>x-energy[.org/components/com_finder/img64.rar(hVNC 64 bit)</p><p>ecertificateboly[.us (RATBANK C2)</p></div></section><section id="4" class="bigmarginbottom w-condition-invisible"><h3 class="titlesectionclab w-dyn-bind-empty"></h3><div class="blog w-dyn-bind-empty w-richtext"></div></section><section id="5" class="bigmarginbottom w-condition-invisible"><h3 class="titlesectionclab w-dyn-bind-empty"></h3><div class="blog w-dyn-bind-empty w-richtext"></div></section><section id="6" class="bigmarginbottom w-condition-invisible"><h3 class="titlesectionclab w-dyn-bind-empty"></h3><div class="blog w-dyn-bind-empty w-richtext"></div></section><section id="7" class="bigmarginbottom w-condition-invisible"><h3 class="titlesectionclab w-dyn-bind-empty"></h3><div class="blog w-dyn-bind-empty w-richtext"></div></section><section id="8" class="bigmarginbottom w-condition-invisible"><h3 class="titlesectionclab w-dyn-bind-empty"></h3><div class="blog w-dyn-bind-empty w-richtext"></div></section><div class="author-block"><div class="divider full bigmarginbottom"></div><h4>Meet the authors</h4><div class="grid2 _90 auto"><a id="w-node-_21caf8a6-ccd2-7b9e-08b3-bf8e4aeca09c-524cad9a" href="/authors/federico-valentini" class="authorblock w-inline-block"><div class="portraitpic"><img alt="" loading="lazy" src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b5b9c1376519044dbc9e1_FedeV_final.jpg" sizes="64px" srcset="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b5b9c1376519044dbc9e1_FedeV_final-p-500.jpeg 500w, https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b5b9c1376519044dbc9e1_FedeV_final-p-800.jpeg 800w, https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b5b9c1376519044dbc9e1_FedeV_final.jpg 1067w" class="objectfit"/></div><div class="grow"><div class="authorname">Federico Valentini</div><div>Head of Threat Intelligence and Incident Response</div></div></a><a href="/authors/francesco-iubatti" class="authorblock w-inline-block"><div class="portraitpic"><img alt="" loading="lazy" src="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b9b336021964770793763_Francesco_Iubatti.png" sizes="64px" srcset="https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b9b336021964770793763_Francesco_Iubatti-p-500.png 500w, https://assets-global.website-files.com/60201cc2b6249b0358f70f8a/628b9b336021964770793763_Francesco_Iubatti.png 733w" class="objectfit"/></div><div class="grow"><div class="authorname">Francesco Iubatti</div><div>Mobile Malware Analyst &amp; Threat Intelligence Analyst</div></div></a></div></div></div><div class="sidebar"><div class="anchorlist"><h6 class="whitetext">Article Content</h6><a href="#1" class="anchorlink">Introduction</a><a href="#2" class="anchorlink">Gozi malspam distribution: a recent example</a><a href="#3" class="anchorlink">Exploring the “Gozi fraud core toolkit”</a><a href="#4" class="anchorlink w-condition-invisible w-dyn-bind-empty"></a><a href="#5" class="anchorlink w-condition-invisible w-dyn-bind-empty"></a><a href="#6" class="anchorlink w-dyn-bind-empty"></a><a href="#7" class="anchorlink w-dyn-bind-empty"></a><a href="#8" class="anchorlink w-dyn-bind-empty"></a></div><h6 class="whitetext">Share with your community</h6><div class="sharethis w-embed w-script"><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60ba4de6ccd96e1e"></script>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox"></div></div><div style="opacity:0;display:none;-webkit-transform:translate3d(10%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(10%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(10%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(10%, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)" class="downloadbanner"><h5 class="cryptotext">Get the PDF version by subscribing to Cleafy LABS bulletins</h5><p class="white">Get your free copy to your inbox now</p><a href="#" class="button downloadpdf">Download PDF Version</a></div></div></div></section><footer class="footer labs"><div class="whiteblockfooter labs"></div><div class="wrapper"><div class="footercontent w-clearfix"><div class="infofooter"><a href="/" class="logo footer w-inline-block"><img src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/6031121f73c6a32184bd3db3_Cleafy-white-logo.svg" loading="lazy" alt=""/></a><div class="infotext white">© 2021 Cleafy S.p.A.<br/>Via Simone Schiaffino, <a href="#" class="whitetext">11 20158 Milano</a>, Italy<br/><a href="#"><span class="whitetext">VAT 02340370226</span></a></div><div><a href="https://twitter.com/cleafy" target="_blank" class="linkopacity w-inline-block"><img src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/60454c31c6c6152e2ac784b0_tw.svg" loading="lazy" alt="" class="iconsocial"/></a><a href="https://www.linkedin.com/company/cleafy/" target="_blank" class="linkopacity w-inline-block"><img src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/60454c31995a8c56d5ff9d9c_in.svg" loading="lazy" alt="" class="iconsocial marginright"/></a></div></div><div class="footerlist"><ul role="list" class="footerlistflex"><li class="listitemfooter"><div class="infotext empty">-</div><a href="/why-cleafy" class="linkfooter">Why Cleafy</a></li><li class="listitemfooter"><div class="infotext empty">-</div><a href="/anti-fraud-solution" class="linkfooter">Solution</a></li><li class="listitemfooter"><div class="infotext empty">-</div><a href="/threat-intelligence" class="linkfooter">Intelligence</a></li><li class="listitemfooter"><div class="infotext">Resources</div><a href="/resources/documents" class="linkfooter">Documents</a><a href="/labs" class="linkfooter">Cleafy Labs</a><div class="linkfooter inactive">Events</div><div class="linkfooter inactive">Webinars</div></li><li class="listitemfooter"><div class="infotext">Company</div><a href="/about-us" class="linkfooter">About us</a><a href="/careers" class="linkfooter">Careers</a><a href="/partners" class="linkfooter">Partners</a></li></ul></div></div><div class="footerend w-clearfix"><div class="left"><a href="https://www.iubenda.com/privacy-policy/31282315" target="_blank" class="linkfooter small">Privacy Policy</a><a href="https://www.iubenda.com/privacy-policy/31282315/cookie-policy" target="_blank" class="linkfooter small">Cookie Policy</a><a href="/security-disclosure-policy" class="linkfooter small">Security Disclosure Policy</a><a href="/legal" class="linkfooter small">Legal</a></div><div class="right"><a href="http://iunocreative.com" target="_blank" class="linkfooter small iuno">Design by IUNO</a></div></div><div class="footerend iubenda"><div class="iubenda w-embed"><a href="#" class="iubenda-advertising-preferences-link" style="color: white; font-size: 0.8em; text-transform: uppercase;">Update your advertising tracking preferences</a></div></div></div></footer><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6020129a813fe0c8f1e8053e" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://assets-global.website-files.com/6020129a813fe0c8f1e8053e/js/cleafy.d65982e9f.js" type="text/javascript"></script></body></html>