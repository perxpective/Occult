<!DOCTYPE html>
<html dir="ltr" lang="ja" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://mal-eats.net/xmlrpc.php">

<title>日本を狙う新たな攻撃キャンペーン Campo の全体像 - Mal-Eats</title>

		<!-- All in One SEO 4.5.3.1 - aioseo.com -->
		<meta name="description" content="最終更新日:2021年5月11日 2021年3月頃より、campo/Openfieldと呼ばれる" />
		<meta name="robots" content="max-image-preview:large" />
		<link rel="canonical" href="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/" />
		<meta name="generator" content="All in One SEO (AIOSEO) 4.5.3.1" />
		<meta property="og:locale" content="ja_JP" />
		<meta property="og:site_name" content="Mal-Eats - BLUE TEAM INTELLIGENCE BLOG" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="日本を狙う新たな攻撃キャンペーン Campo の全体像 - Mal-Eats" />
		<meta property="og:description" content="最終更新日:2021年5月11日 2021年3月頃より、campo/Openfieldと呼ばれる" />
		<meta property="og:url" content="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/" />
		<meta property="article:published_time" content="2021-05-10T03:21:28+00:00" />
		<meta property="article:modified_time" content="2023-05-14T05:33:36+00:00" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content="日本を狙う新たな攻撃キャンペーン Campo の全体像 - Mal-Eats" />
		<meta name="twitter:description" content="2021年3月頃より、campo/Openfieldと呼ばれるインフラを利用した日本への攻撃が複数回確認されています。この攻撃キャンペーンは、感染組織によっては後続のマルウェアが配信される可能性があり、その中には最終的にランサムウェアが使用されるケースが海外で観測されています。" />
		<meta name="twitter:image" content="https://mal-eats.net/wp-content/uploads/2021/05/image1.png" />
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"BlogPosting","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#blogposting","name":"\u65e5\u672c\u3092\u72d9\u3046\u65b0\u305f\u306a\u653b\u6483\u30ad\u30e3\u30f3\u30da\u30fc\u30f3 Campo \u306e\u5168\u4f53\u50cf - Mal-Eats","headline":"\u65e5\u672c\u3092\u72d9\u3046\u65b0\u305f\u306a\u653b\u6483\u30ad\u30e3\u30f3\u30da\u30fc\u30f3 Campo \u306e\u5168\u4f53\u50cf","author":{"@id":"https:\/\/mal-eats.net\/author\/maleats_user\/#author"},"publisher":{"@id":"https:\/\/mal-eats.net\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/i0.wp.com\/mal-eats.net\/wp-content\/uploads\/2021\/05\/image1.png?fit=1831%2C677&ssl=1","width":1831,"height":677},"datePublished":"2021-05-10T12:21:28+09:00","dateModified":"2023-05-14T14:33:36+09:00","inLanguage":"ja","mainEntityOfPage":{"@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#webpage"},"isPartOf":{"@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#webpage"},"articleSection":"Campaign"},{"@type":"BreadcrumbList","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/mal-eats.net\/#listItem","position":1,"name":"\u5bb6","item":"https:\/\/mal-eats.net\/","nextItem":"https:\/\/mal-eats.net\/2021\/#listItem"},{"@type":"ListItem","@id":"https:\/\/mal-eats.net\/2021\/#listItem","position":2,"name":"2021","item":"https:\/\/mal-eats.net\/2021\/","nextItem":"https:\/\/mal-eats.net\/2021\/05\/#listItem","previousItem":"https:\/\/mal-eats.net\/#listItem"},{"@type":"ListItem","@id":"https:\/\/mal-eats.net\/2021\/05\/#listItem","position":3,"name":"May","item":"https:\/\/mal-eats.net\/2021\/05\/","nextItem":"https:\/\/mal-eats.net\/2021\/05\/10\/#listItem","previousItem":"https:\/\/mal-eats.net\/2021\/#listItem"},{"@type":"ListItem","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/#listItem","position":4,"name":"10","item":"https:\/\/mal-eats.net\/2021\/05\/10\/","nextItem":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#listItem","previousItem":"https:\/\/mal-eats.net\/2021\/05\/#listItem"},{"@type":"ListItem","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#listItem","position":5,"name":"\u65e5\u672c\u3092\u72d9\u3046\u65b0\u305f\u306a\u653b\u6483\u30ad\u30e3\u30f3\u30da\u30fc\u30f3 Campo \u306e\u5168\u4f53\u50cf","previousItem":"https:\/\/mal-eats.net\/2021\/05\/10\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/mal-eats.net\/#organization","name":"Mal-Eats","url":"https:\/\/mal-eats.net\/"},{"@type":"Person","@id":"https:\/\/mal-eats.net\/author\/maleats_user\/#author","url":"https:\/\/mal-eats.net\/author\/maleats_user\/","name":"@mal_eats","image":{"@type":"ImageObject","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/7689b4d6c282b327d9cc1ca98070bc35?s=96&d=mm&r=g","width":96,"height":96,"caption":"@mal_eats"}},{"@type":"WebPage","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#webpage","url":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/","name":"\u65e5\u672c\u3092\u72d9\u3046\u65b0\u305f\u306a\u653b\u6483\u30ad\u30e3\u30f3\u30da\u30fc\u30f3 Campo \u306e\u5168\u4f53\u50cf - Mal-Eats","description":"\u6700\u7d42\u66f4\u65b0\u65e5:2021\u5e745\u670811\u65e5 2021\u5e743\u6708\u9803\u3088\u308a\u3001campo\/Openfield\u3068\u547c\u3070\u308c\u308b","inLanguage":"ja","isPartOf":{"@id":"https:\/\/mal-eats.net\/#website"},"breadcrumb":{"@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#breadcrumblist"},"author":{"@id":"https:\/\/mal-eats.net\/author\/maleats_user\/#author"},"creator":{"@id":"https:\/\/mal-eats.net\/author\/maleats_user\/#author"},"image":{"@type":"ImageObject","url":"https:\/\/i0.wp.com\/mal-eats.net\/wp-content\/uploads\/2021\/05\/image1.png?fit=1831%2C677&ssl=1","@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#mainImage","width":1831,"height":677},"primaryImageOfPage":{"@id":"https:\/\/mal-eats.net\/2021\/05\/10\/campo_new_attack_campaign_targeting_japan\/#mainImage"},"datePublished":"2021-05-10T12:21:28+09:00","dateModified":"2023-05-14T14:33:36+09:00"},{"@type":"WebSite","@id":"https:\/\/mal-eats.net\/#website","url":"https:\/\/mal-eats.net\/","name":"Mal-Eats","description":"BLUE TEAM INTELLIGENCE BLOG","inLanguage":"ja","publisher":{"@id":"https:\/\/mal-eats.net\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//i0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Mal-Eats &raquo; フィード" href="https://mal-eats.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="Mal-Eats &raquo; コメントフィード" href="https://mal-eats.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Mal-Eats &raquo; 日本を狙う新たな攻撃キャンペーン Campo の全体像 のコメントのフィード" href="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/feed/" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/mal-eats.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.2.3"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!s("\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!s("\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!s("\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='bootstrap-css' href='https://mal-eats.net/wp-content/themes/astrid/css/bootstrap/bootstrap.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css' href='https://mal-eats.net/wp-includes/css/dist/block-library/style.min.css?ver=6.2.3' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://mal-eats.net/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.17' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://mal-eats.net/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=6.2.3' type='text/css' media='all' />
<link rel='stylesheet' id='classic-theme-styles-css' href='https://mal-eats.net/wp-includes/css/classic-themes.min.css?ver=6.2.3' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bogo-css' href='https://mal-eats.net/wp-content/plugins/bogo/includes/css/style.css?ver=3.5.3' type='text/css' media='all' />
<link rel='stylesheet' id='toc-screen-css' href='https://mal-eats.net/wp-content/plugins/table-of-contents-plus/screen.min.css?ver=2309' type='text/css' media='all' />
<link rel='stylesheet' id='astrid-style-css' href='https://mal-eats.net/wp-content/themes/astrid/style.css?ver=6.2.3' type='text/css' media='all' />
<style id='astrid-style-inline-css' type='text/css'>
.site-header {position: fixed;}
.woocommerce .woocommerce-message:before,.woocommerce #payment #place_order,.woocommerce-page #payment #place_order,.woocommerce .cart .button, .woocommerce .cart input.button,.woocommerce-cart .wc-proceed-to-checkout a.checkout-button,.woocommerce #review_form #respond .form-submit input,.woocommerce a.button,.woocommerce div.product form.cart .button,.woocommerce .star-rating,.page-header .page-title .fa,.site-footer a:hover,.footer-info a:hover,.footer-widgets a:hover,.testimonial-title a:hover,.employee-title a:hover,.fact .fa,.service-title a:hover,.widget-area .widget a:hover,.entry-meta a:hover,.entry-footer a:hover,.entry-title a:hover,.comment-navigation a:hover,.posts-navigation a:hover,.post-navigation a:hover,.main-navigation a:hover,.main-navigation li.focus > a,a,a:hover,button,.button,input[type="button"],input[type="reset"],input[type="submit"] { color:#20abd6}
.social-menu-widget a,.woocommerce span.onsale,.woocommerce #payment #place_order:hover, .woocommerce-page #payment #place_order:hover,.woocommerce .cart .button:hover, .woocommerce .cart input.button:hover,.woocommerce-cart .wc-proceed-to-checkout a.checkout-button:hover,.woocommerce #review_form #respond .form-submit input:hover,.woocommerce div.product form.cart .button:hover,.woocommerce a.button:hover,.preloader-inner ul li,.progress-animate,button:hover,.button:hover,input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover { background-color:#20abd6}
.woocommerce .woocommerce-message,.woocommerce #payment #place_order,.woocommerce-page #payment #place_order,.woocommerce .cart .button, .woocommerce .cart input.button,.woocommerce-cart .wc-proceed-to-checkout a.checkout-button,.woocommerce #review_form #respond .form-submit input,.woocommerce a.button,.woocommerce div.product form.cart .button,.main-navigation li a::after,.main-navigation li a::before,button,.button,input[type="button"],input[type="reset"],input[type="submit"] { border-color:#20abd6}
.site-title a,.site-title a:hover { color:#ffffff}
.site-description { color:#BDBDBD}
.site-header,.site-header.header-scrolled { background-color:rgba(32,37,41,0.9)}
@media only screen and (max-width: 1024px) { .site-header.has-header,.site-header.has-video,.site-header.has-single,.site-header.has-shortcode { background-color:rgba(32,37,41,0.9)} }
body, .widget-area .widget, .widget-area .widget a { color:#1f2121}
.footer-widgets, .site-footer, .footer-info { background-color:#202529}
body {font-family: Helvetica, Arial, "Hiragino Kaku Gothic ProN", "メイリオ", Meiryo, "Yu Gothic", YuGothic, sans-serif;}
h1, h2, h3, h4, h5, h6, .fact .fact-number, .fact .fact-name, .site-title {font-family: Helvetica, Arial, "Hiragino Kaku Gothic ProN", "メイリオ", Meiryo, "Yu Gothic", YuGothic, sans-serif;}
.site-title { font-size:36px; }
.site-description { font-size:14px; }
h1 { font-size:36px; }
h2 { font-size:30px; }
h3 { font-size:24px; }
h4 { font-size:16px; }
h5 { font-size:14px; }
h6 { font-size:12px; }
body { font-size:16px; }

</style>
<link rel='stylesheet' id='astrid-body-fonts-css' href='//fonts.googleapis.com/css?family=Open+Sans%3A300%2C300italic%2C600%2C600italic&#038;ver=6.2.3' type='text/css' media='all' />
<link rel='stylesheet' id='astrid-headings-fonts-css' href='//fonts.googleapis.com/css?family=Josefin+Sans%3A300italic%2C300&#038;ver=6.2.3' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://mal-eats.net/wp-content/themes/astrid/fonts/font-awesome.min.css?ver=6.2.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='https://mal-eats.net/wp-content/plugins/jetpack/css/jetpack.css?ver=12.8.1' type='text/css' media='all' />
<script type='text/javascript' src='https://mal-eats.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.4' id='jquery-core-js'></script>
<script type='text/javascript' src='https://mal-eats.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.0' id='jquery-migrate-js'></script>
<link rel="https://api.w.org/" href="https://mal-eats.net/wp-json/" /><link rel="alternate" type="application/json" href="https://mal-eats.net/wp-json/wp/v2/posts/328" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mal-eats.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://mal-eats.net/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 6.2.3" />
<link rel='shortlink' href='https://mal-eats.net/?p=328' />
<link rel="alternate" type="application/json+oembed" href="https://mal-eats.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmal-eats.net%2F2021%2F05%2F10%2Fcampo_new_attack_campaign_targeting_japan%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://mal-eats.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmal-eats.net%2F2021%2F05%2F10%2Fcampo_new_attack_campaign_targeting_japan%2F&#038;format=xml" />
<link rel="alternate" hreflang="en-US" href="https://mal-eats.net/en/2021/05/11/campo_new_attack_campaign_targeting_japan/" />
<link rel="alternate" hreflang="ja" href="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/" />
	<style>img#wpstats{display:none}</style>
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #ffffff; }
</style>
	<meta name="twitter:partner" content="tfwp"><link rel="icon" href="https://i0.wp.com/mal-eats.net/wp-content/uploads/2020/11/cropped-image-8.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/mal-eats.net/wp-content/uploads/2020/11/cropped-image-8.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/mal-eats.net/wp-content/uploads/2020/11/cropped-image-8.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/mal-eats.net/wp-content/uploads/2020/11/cropped-image-8.png?fit=270%2C270&#038;ssl=1" />

<meta name="twitter:card" content="summary"><meta name="twitter:title" content="日本を狙う新たな攻撃キャンペーン Campo の全体像"><meta name="twitter:description" content="最終更新日:2021年5月11日 &nbsp; 2021年3月頃より、campo/Openfieldと呼ばれるインフラを利用した日本への攻撃が複数回確認されています。この攻撃キャンペーンは、感染組織によっては後続のマルウェアが配信される可能性があり、その中には最終的にランサムウェアが使用されるケースが海外で観測されています。 我々は、現在この攻撃キャンペーンを継続調査しており、認識している限り、少&hellip;"><meta name="twitter:image" content="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?fit=1831%2C677&amp;ssl=1">
		<style type="text/css" id="wp-custom-css">
			.container {
	width: 900px;
	font-size: 15px;
}
.site-content > .container {
	border-left: 0px solid #F2F2F3;
	border-right: 0px solid #F2F2F3;
	border-bottom: 0px solid #F2F2F3;
}
.hentry {
	border: 0px solid #F2F2F3;
	padding: 30px 60px;
}
.widget-area {
	width: 100%;
}
.entry-content h1 {
	font-weight: bold;
}
.entry-content h2 {
	margin-top: 80px;
	font-weight: bold;
	border-bottom: #DCDCDC 1px solid;
  padding-bottom: 10px;
}
h2 * {
	font-size: 25px;
}
h3 {
	margin-top: 50px;
	font-weight: bold;
	font-size: 22px;
}
h4 {
	margin-top: 40px;
	font-weight: bold;
	font-size: 18px;
	/*text-decoration: underline;*/
}
figcaption {
	text-align:center;
}
figure {
	text-align:center;
}
img {
	text-align:center;
}
table {
  width: 100%;
  border-collapse: collapse;
  border-spacing: 0;
}
table th,table td{
  padding: 10px 0;
}
table tr:nth-child(even){
  background-color: #f8f8f8;
}
table tr:first-child{
	font-weight:bold;
}
table td {
	word-break : break-all;
}
.example-val {
	font-size: 13px;
	padding: 0 10px;
	margin-top: -10px;
	margin-bottom: 10px;
	color: #5b5b5b;
}
.single-thumb {
	text-align:center;
}
.site-title {
	font-family: 'Open Sans', sans-serif;
}
.site-description {
	font-family: 'Open Sans', sans-serif;
}
.header-text {
  font-size: 61px;
	font-family: 'Open Sans', sans-serif;
}
@media screen and (max-width: 480px) {
 	.header-text {
		margin-top:-5px;
		font-size: 8px !important;
	}
	.container {
		width: initial;
	}
 	* {
		line-height: 1.5;
	}
	p, li, td, figcaption {
		font-size: 14px;		
	}
	ul, ol {
		padding-left: 20px;
	}
	h1 {
		font-size: 30px;
	}
	.entry-content h2 {
		margin-top: 60px;
		margin-bottom: 20px;
	}
	.entry-content h2 * {
		font-size: 20px;
		font-weight: bold;
	}
	.entry-content h2 + h3 {
		margin-top: 30px;
	}
	.entry-content h3 {
		margin-top: 50px;
		margin-bottom: 10px;
		font-size: 19px !important;
		font-weight: bold !important;
	}
	.entry-content h4 {
		margin-top: 35px;
		font-size: 15px;
	}
	.hentry {
		padding: 15px;
	}
}
@media screen and (max-width: 767px) {
 	.header-text {
	 font-size: 14px;
 	}
	.container {
		width: initial;
	}
}
@media screen and (max-width: 992px) {
 	.header-text {
		font-size: 20px;
 	}
	.container {
		width: initial;
	}
}
@media screen and (max-width: 1200px){
 	.header-text {
		font-size: 20px;
 	}
}
@media screen and (min-width: 1200px){
	.header-text {
	 	font-size: 20px;
 	}

}

.site-copyright {
	font-size:9px;
}		</style>
		</head>

<body class="post-template-default single single-post postid-328 single-format-standard custom-background ja fullwidth-single">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0.49803921568627" /><feFuncG type="table" tableValues="0 0.49803921568627" /><feFuncB type="table" tableValues="0 0.49803921568627" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 0.27843137254902" /><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0" /><feFuncG type="table" tableValues="0 0.64705882352941" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.78039215686275 1" /><feFuncG type="table" tableValues="0 0.94901960784314" /><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.44705882352941 0.4" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.098039215686275 1" /><feFuncG type="table" tableValues="0 0.66274509803922" /><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg>
<div class="preloader">
<div class="preloader-inner">
	<ul><li></li><li></li><li></li><li></li><li></li><li></li></ul>
</div>
</div>

<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">コンテンツへスキップ</a>

	<header id="masthead" class="site-header " role="banner">
		<div class="container">
			<div class="site-branding col-md-4 col-sm-6 col-xs-12">
				<p class="site-title"><a href="https://mal-eats.net/" rel="home">Mal-Eats</a></p><p class="site-description">BLUE TEAM INTELLIGENCE BLOG</p>			</div>
			<div class="btn-menu col-md-8 col-sm-6 col-xs-12"><i class="fa fa-navicon"></i></div>
			<nav id="mainnav" class="main-navigation col-md-8 col-sm-6 col-xs-12" role="navigation">
				<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-2"><a href="https://mal-eats.net/profile/">Profile</a></li>
</ul></div>
			</nav><!-- #site-navigation -->
		</div>
	</header><!-- #masthead -->

			<div class="header-clone"></div>
		

				
	
	<div id="content" class="site-content">
		<div class="container">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-328" class="post-328 post type-post status-publish format-standard has-post-thumbnail hentry category-campaign ja clearfix">


	<header class="entry-header">
		<h1 class="entry-title">日本を狙う新たな攻撃キャンペーン Campo の全体像</h1>		<div class="entry-meta">
			<span class="posted-on"><i class="fa fa-calendar"></i><a href="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/" rel="bookmark"><time class="entry-date published" datetime="2021-05-10T12:21:28+09:00">2021年5月10日</time><time class="updated" datetime="2023-05-14T14:33:36+09:00">2023年5月14日</time></a></span><span class="byline"> <i class="fa fa-user"></i><span class="author vcard"><a class="url fn n" href="https://mal-eats.net/author/maleats_user/">@mal_eats</a></span></span><span class="cat-links"><i class="fa fa-folder-o"></i><a href="https://mal-eats.net/category/campaign/" rel="category tag">Campaign</a></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->	

					<div class="single-thumb">
			<a href="https://mal-eats.net/2021/05/10/campo_new_attack_campaign_targeting_japan/" title="日本を狙う新たな攻撃キャンペーン Campo の全体像"><img width="700" height="259" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?fit=700%2C259&amp;ssl=1" class="attachment-astrid-large-thumb size-astrid-large-thumb wp-post-image" alt="" decoding="async" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?w=1831&amp;ssl=1 1831w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=300%2C111&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=1024%2C379&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=768%2C284&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=1536%2C568&amp;ssl=1 1536w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=700%2C259&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=520%2C192&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=360%2C133&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=250%2C92&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=100%2C37&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?w=1280&amp;ssl=1 1280w" sizes="(max-width: 700px) 100vw, 700px" /></a>
		</div>	
			
		<div class="entry-content">
		<div style="text-align: right;">最終更新日:2021年5月11日</div>
<p>&nbsp;</p>
<p>2021年3月頃より、campo/Openfieldと呼ばれるインフラを利用した日本への攻撃が複数回確認されています。この攻撃キャンペーンは、感染組織によっては後続のマルウェアが配信される可能性があり、その中には最終的にランサムウェアが使用されるケースが海外で観測されています。</p>
<p>我々は、現在この攻撃キャンペーンを継続調査しており、認識している限り、少なくとも2020年10月頃には観測され始めています。今後も攻撃者による継続的な活動は予測され、最悪の場合、ランサムウェアによる暗号化をはじめとした様々な被害に発展してしまう可能性があることを危惧しています。そこで、このような脅威に備えて、現時点で判明している日本向けキャンペーンの特徴とマルウェアの実行痕跡の確認方法等について本稿で共有します。</p>
<p>&nbsp;</p>
<div id="toc_container" class="toc_light_blue no_bullets"><p class="toc_title">目次</p><ul class="toc_list"><li><a href="#i"><span class="toc_number toc_depth_1">1</span> 更新履歴</a></li><li><a href="#i-2"><span class="toc_number toc_depth_1">2</span> 日本向けのキャンペーンの報告状況</a></li><li><a href="#i-3"><span class="toc_number toc_depth_1">3</span> 攻撃の全体像</a></li><li><a href="#i-4"><span class="toc_number toc_depth_1">4</span> メールの特徴</a></li><li><a href="#i-5"><span class="toc_number toc_depth_1">5</span> リンク先のサーバの特徴</a></li><li><a href="#i-6"><span class="toc_number toc_depth_1">6</span> 文書ファイルの特徴</a></li><li><a href="#campo_loader"><span class="toc_number toc_depth_1">7</span> Campo Loader マルウェアの特徴</a></li><li><a href="#openfield"><span class="toc_number toc_depth_1">8</span> Openfieldの特徴</a></li><li><a href="#dfdownloader"><span class="toc_number toc_depth_1">9</span> DFDownloader マルウェアの特徴</a></li><li><a href="#i-7"><span class="toc_number toc_depth_1">10</span> その後のペイロードの考察</a></li><li><a href="#i-8"><span class="toc_number toc_depth_1">11</span> 他のキャンペーンとの関連性</a></li><li><a href="#i-9"><span class="toc_number toc_depth_1">12</span> 実行痕跡の確認方法</a></li><li><a href="#i-10"><span class="toc_number toc_depth_1">13</span> 感染の判断が難しい場合・専門企業による調査が必要な場合</a></li><li><a href="#i-11"><span class="toc_number toc_depth_1">14</span> 謝辞</a></li><li><a href="#ioc510"><span class="toc_number toc_depth_1">15</span> IoC（5月10日時点）</a></li></ul></div>
<h2><span id="i"><b>更新履歴</b></span></h2>
<p>本稿の更新による変更点は次の通りです。</p>
<table>
<tbody>
<tr>
<td style="min-width: 160px;">日付</td>
<td>内容</td>
</tr>
<tr>
<td>2021年5月10日</td>
<td>本稿を公開しました。</td>
</tr>
<tr>
<td>2021年5月11日</td>
<td>一部誤字を修正しました。</td>
</tr>
</tbody>
</table>
<h2><span id="i-2"><b>日本向けのキャンペーンの報告状況</b></span></h2>
<p>日本におけるメールの報告は、SNS上で行われています。以下に報告を時系列順に示します。<br />
2020年10月14日<br />
<a href="https://twitter.com/bomccss/status/1316163808319041536">https://twitter.com/bomccss/status/1316163808319041536</a><br />
2021年3月10日<br />
<a href="https://twitter.com/bomccss/status/1369612781209591813">https://twitter.com/bomccss/status/1369612781209591813</a><br />
2021年3月24日<br />
<a href="https://twitter.com/bomccss/status/1374526482890944515">https://twitter.com/bomccss/status/1374526482890944515</a><br />
2021年3月31日<br />
<a href="https://twitter.com/bomccss/status/1377280535710494729">https://twitter.com/bomccss/status/1377280535710494729</a><br />
2021年4月6日<br />
<a href="https://twitter.com/bomccss/status/1379240664362143744">https://twitter.com/bomccss/status/1379240664362143744</a><br />
2021年4月7日<br />
<a href="https://twitter.com/bomccss/status/1379602541495738371">https://twitter.com/bomccss/status/1379602541495738371</a><br />
2021年4月8日<br />
<a href="https://twitter.com/bomccss/status/1379970130642235392">https://twitter.com/bomccss/status/1379970130642235392</a><br />
2021年4月9日<br />
<a href="https://twitter.com/bomccss/status/1380327966765314050">https://twitter.com/bomccss/status/1380327966765314050</a></p>
<h2><span id="i-3"><b>攻撃の全体像</b></span></h2>
<p>攻撃の全体像は、図1の通りです。攻撃は日本語メールの接到から始まります。メール本文にはURLリンクとパスワードが記載されており、ユーザがURLリンクにアクセスするとパスワード付きZIPファイルをダウンロードすることができます。このZIPファイルを展開し、文書ファイルを開いてコンテンツを有効にすると、Campo Loaderと呼ばれるダウンローダがドロップ・実行され、通信が発生します。そして、別のダウンローダであるDFDownloaderに感染し、サーバと通信することで追加のペイロードをダウンロード・実行できる状態となります。</p>
<figure id="attachment_329" aria-describedby="caption-attachment-329" style="width: 1831px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-329 size-full" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=640%2C237&#038;ssl=1" alt="" width="640" height="237" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?w=1831&amp;ssl=1 1831w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=300%2C111&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=1024%2C379&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=768%2C284&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=1536%2C568&amp;ssl=1 1536w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=700%2C259&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=520%2C192&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=360%2C133&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=250%2C92&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?resize=100%2C37&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image1.png?w=1280&amp;ssl=1 1280w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-329" class="wp-caption-text">図1 攻撃の全体像</figcaption></figure>
<p>なお、URLリンクの通信先とCampo Loaderの通信先は「BlackTDS」と呼ばれるアンチボットサービスを利用している可能性が高く、通信時にリサーチャの調査活動が妨害され正規サイトへリダイレクトされることがあります。このサービスの動作の詳細は後述します。</p>
<p>今回の日本向け攻撃キャンペーンで使用されているDFDownloaderは、追加のマルウェアをダウンロードして実行する機能があるものの、現時点で我々は後続のペイロードの観測に至っていません。DFDownloaderに関しては、海外の文献においても報告されていない状況です。このため、DFDownloaderを経由して最終的に感染するマルウェアは不明です。</p>
<p>その一方で、海外ではCampo Loaderから下記のマルウェアに感染する類似事例が報告されています。</p>
<ul>
<li>Trickbot</li>
<li>Ursnif</li>
<li>BazarLoader→CobaltStrike, AnchorDNS</li>
<li>Phobos Ransomware</li>
</ul>
<p>また、同攻撃者グループによると思われる日本での過去事例では、Zloaderに感染させようとする事例も確認されています。<br />
これらの内容に関しては、我々の考察を含め、本稿の最後に記載しています。</p>
<p>&nbsp;</p>
<h2><span id="i-4"><b>メールの特徴</b></span></h2>
<p>メールの例を下図に示します。日本向けの攻撃キャンペーンでは、図2の通りメール本文に日本語が使用されており、実在する企業の担当者を騙り、請求書の形式でリンク先のパスワード付きZIPファイルのダウンロードに誘導します。</p>
<p>送信元は多数の企業を騙っており、正規の企業メールアドレスとは異なります。メール本文に記載されているリンク先ファイルのパスワードは、現在観測している限り、すべて同一であることを確認しています。さらに、メールヘッダの情報から攻撃者はオープンソースのWebメールである「Roundcube Webmail」を使用して配信していると推定しています。</p>
<figure id="attachment_330" aria-describedby="caption-attachment-330" style="width: 1089px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-330 size-full" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=640%2C316&#038;ssl=1" alt="" width="640" height="316" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?w=1089&amp;ssl=1 1089w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=300%2C148&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=1024%2C505&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=768%2C379&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=700%2C345&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=520%2C256&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=360%2C178&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=250%2C123&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image2.png?resize=100%2C49&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-330" class="wp-caption-text">図2 日本向け攻撃メールの例</figcaption></figure>
<p>&nbsp;</p>
<h2><span id="i-5"><b>リンク先のサーバの特徴</b></span></h2>
<p>リンク先サーバへのアクセスは、HTTPSで行われることが確認されています。また、接続先ドメイン名に紐づいているIPアドレスが共通であることが多いという特徴があります。</p>
<p>調査の結果、このサーバは「BlackTDS」と呼ばれるアンチボットサービスを利用している可能性があることがわかりました。このサービスは、公式サイトによると”トラフィックのクリーニングとボットの保護に最適なソリューション”（図3）とされていますが、実際はDrive-by as a serviceとして攻撃者が悪用しているとProofpoint社によって報告されています[1]。</p>
<figure id="attachment_331" aria-describedby="caption-attachment-331" style="width: 942px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-331" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=640%2C364&#038;ssl=1" alt="" width="640" height="364" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?w=942&amp;ssl=1 942w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=300%2C171&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=768%2C437&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=700%2C398&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=520%2C296&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=360%2C205&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=250%2C142&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image3.png?resize=100%2C57&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-331" class="wp-caption-text">図3 BlackTDS</figcaption></figure>
<ul>
<li>[1]「Drive-by as a service: BlackTDS」, Proofpoint, 2018/3/13<br />
<a href="https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds">https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds<br />
</a></li>
</ul>
<p>今回の日本向けキャンペーンでは、このサービスが提供すると言われている以下のフィルタリングが利用されている可能性があります。</p>
<ul>
<li>IPv6に完全対応したIPアドレスによるフィルタリング</li>
<li>ISPによるフィルタリング</li>
<li>リファラーによるフィルタリング</li>
<li>ハードウェアIDによるフィルタリング、</li>
<li>44万以上のIPアンチウイルス、モデレーター、検索エンジン、チェッカーボットが登録されているアンチボットデータベースによるフィルタリング</li>
</ul>
<p>そのため、BlackTDSによりセキュリティリサーチャやサンドボックスによるファイルの取得が難しく調査の難易度が高くなってしまいます。</p>
<p>&nbsp;</p>
<h2><span id="i-6"><b>文書ファイルの特徴</b></span></h2>
<p>主に日本向けのキャンペーンでは、メールのリンク先からダウンロードされたパスワード付きZIPファイルを展開し文書ファイルを開くと、図4のように日本語が使用された画像が表示されます。</p>
<figure id="attachment_332" aria-describedby="caption-attachment-332" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-332 size-large" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=640%2C483&#038;ssl=1" alt="" width="640" height="483" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=1024%2C773&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=300%2C227&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=768%2C580&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=700%2C529&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=520%2C393&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=360%2C272&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=250%2C189&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?resize=100%2C76&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image4.png?w=1323&amp;ssl=1 1323w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-332" class="wp-caption-text">図4 日本向けの攻撃で確認された文書ファイルの例</figcaption></figure>
<p>表示される画像は、他の攻撃においても共通のものが使用されることもあるため、見た目だけで本攻撃に関連するものであるかを判断することは困難な場合があります。また、画像が変更される場合もあるため、図4のデザインに限らない点にご注意ください。</p>
<p>以降では、動作の概要と、執筆時点（2021年4月）における最新の文書ファイルの動作について解説します。</p>
<p>&nbsp;</p>
<h3><b>動作の概要</b></h3>
<p>Office製品がデフォルト設定の場合、ユーザが文書ファイルを開いて「コンテンツの有効化」をクリックすると、Excel 4.0 マクロ（以降、マクロと記載）が実行され、文書ファイルに埋め込まれている文字列がファイルとしてドロップされます。</p>
<p>一連の攻撃で確認している文書ファイルでは、マクロが設定されているシートが非表示状態となっており、シート内にはマクロを実行するために必要な文字列が細分化されて記述されています。</p>
<p>また、文書ファイルのブックに「Auto_Open」が設定されていることで、文書ファイルを開くと悪意あるマクロが自動的に実行されます。自動的に実行されるマクロの一部を図5、6に示します。</p>
<figure id="attachment_333" aria-describedby="caption-attachment-333" style="width: 903px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-333" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=640%2C220&#038;ssl=1" alt="" width="640" height="220" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?w=903&amp;ssl=1 903w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=300%2C103&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=768%2C265&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=700%2C241&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=520%2C179&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=360%2C124&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=250%2C86&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image5.png?resize=100%2C34&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-333" class="wp-caption-text">図5 2021年4月9日に観測した文書ファイルから実行される一部のマクロ関数</figcaption></figure>
<figure id="attachment_334" aria-describedby="caption-attachment-334" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-334" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=640%2C132&#038;ssl=1" alt="" width="640" height="132" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=1024%2C211&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=300%2C62&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=768%2C159&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=700%2C145&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=520%2C107&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=360%2C74&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=250%2C52&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?resize=100%2C21&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image6.png?w=1167&amp;ssl=1 1167w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-334" class="wp-caption-text">図6 2021年4月9日に観測した文書ファイルから実行される一部のマクロ関数</figcaption></figure>
<p>SAVE.AS関数で保存された文字列はcertutil.exeを用いてデコードされ、別のファイル名で保存されます。その後、CALL関数などでrundll32.exeを用いて、デコードされたCampo Loaderが実行されます（図7）。</p>
<figure id="attachment_335" aria-describedby="caption-attachment-335" style="width: 690px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-335 " src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=640%2C76&#038;ssl=1" alt="" width="640" height="76" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?w=808&amp;ssl=1 808w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=300%2C36&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=768%2C91&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=700%2C83&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=520%2C62&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=360%2C43&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=250%2C30&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image7.png?resize=100%2C12&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-335" class="wp-caption-text">図7 2021年4月9日に観測した文書ファイルから実行されるマクロ関数</figcaption></figure>
<p>これら一連の挙動は、マクロに加えWindowsに標準で搭載されているモジュール群（DLL）の関数を直接呼び出すことで実装されています。</p>
<p>&nbsp;</p>
<h3><b>4月9日の攻撃で使用された文書ファイル</b></h3>
<p>以下に4月9日の攻撃で確認された文書ファイルからCampo Loaderが実行されるまでのフローを示します（図8、9）。</p>
<figure id="attachment_336" aria-describedby="caption-attachment-336" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-336" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=640%2C229&#038;ssl=1" alt="" width="640" height="229" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=1024%2C366&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=300%2C107&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=768%2C274&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=700%2C250&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=520%2C186&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=360%2C129&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=250%2C89&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?resize=100%2C36&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?w=1347&amp;ssl=1 1347w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image8.png?w=1280&amp;ssl=1 1280w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-336" class="wp-caption-text">図8 文書ファイルを開いた際のフロー</figcaption></figure>
<figure id="attachment_337" aria-describedby="caption-attachment-337" style="width: 664px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-337" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=640%2C204&#038;ssl=1" alt="" width="640" height="204" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?w=664&amp;ssl=1 664w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=300%2C96&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=520%2C166&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=360%2C115&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=250%2C80&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image9.png?resize=100%2C32&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-337" class="wp-caption-text">図9 文書ファイルを開いた際のプロセスツリー</figcaption></figure>
<p>動作の流れは以下の通りです。</p>
<ol>
<li aria-level="1">文書ファイルを開きコンテンツが有効化されると、悪意あるマクロが動作します。</li>
<li aria-level="1">文書ファイルのシート内に埋め込まれている文字列がC:\Users\Public\14118.doyとして保存されます（※1）。</li>
<li aria-level="1">文書ファイルのシート内に埋め込まれている文字列がC:\Users\Public\14118.xlsbとして保存されます（※2）。</li>
<li aria-level="1">cmd.exe経由でcertutil.exeが呼び出され、%PUBLIC%\14118.doyの中身がBASE64デコードされて、結果が%PUBLIC%\14118.biyとして保存されます。</li>
<li aria-level="1">ここで偽の入力フォームが表示されます（図10）。</li>
<li aria-level="1">rundll32.exeでCampo Loader（%PUBLIC%\14118.biy）が実行されます。このとき、引数としてDF1が指定されておりDF1関数が呼び出されます。</li>
</ol>
<p>※1 ファイル名（例えば、14118.doy）に含まれている数値は、疑似乱数を生成する関数で9999 ~ 19999まで値が生成されますが、実際には攻撃者が保存した際の数値がそのまま保存されており、固定値になっています。<br />
※2 当該ファイルは作成されるだけで、実際には攻撃を成立させるためには不要なファイルであると考えられます。</p>
<figure id="attachment_338" aria-describedby="caption-attachment-338" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-338" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=640%2C478&#038;ssl=1" alt="" width="640" height="478" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=1024%2C765&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=300%2C224&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=768%2C573&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=700%2C523&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=520%2C388&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=360%2C269&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=250%2C187&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?resize=100%2C75&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image10.png?w=1318&amp;ssl=1 1318w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-338" class="wp-caption-text">図10 偽の入力フォーム</figcaption></figure>
<p>&nbsp;</p>
<h2><span id="campo_loader"><b>Campo Loader マルウェアの特徴</b></span></h2>
<p>Campo Loader（別名：NLoader）は、文書ファイルからドロップされた後に実行されるマルウェアです。このマルウェアの役割はダウンローダであり、HTTP通信を行って追加のペイロードを取得・実行する機能を有しています。通信時に「/campo/」を含むパスにアクセスすることから、Orange Cyberdefense社が「Campo Loader」という名称を使用し[2]、SNS上で定着しました。<br />
Campo Loaderは、3月上旬に変更が加えられ、HTTP通信の特徴が変化しました。本稿では執筆時点（2021年4月）で最新のものを解説します。</p>
<ul>
<li>[2] 「In the eye of our CyberSOC: Campo Loader, analysis and detection perspectives」, Orange Cyberdefense, 2021/03/23<br />
<a href="https://orangecyberdefense.com/global/blog/cybersoc/in-the-eye-of-our-cybersoc-campo-loader-analysis-and-detection-perspectives/">https://orangecyberdefense.com/global/blog/cybersoc/in-the-eye-of-our-cybersoc-campo-loader-analysis-and-detection-perspectives/</a></li>
</ul>
<p>Campo Loaderが実行されると、まずはディレクトリを作成します。下図に示す通り、作成するディレクトリ名はハードコーディングされています。</p>
<figure id="attachment_339" aria-describedby="caption-attachment-339" style="width: 930px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-339" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=640%2C201&#038;ssl=1" alt="" width="640" height="201" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?w=930&amp;ssl=1 930w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=300%2C94&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=768%2C241&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=700%2C220&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=520%2C163&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=360%2C113&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=250%2C78&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image11.png?resize=100%2C31&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-339" class="wp-caption-text">図11 ディレクトリの作成</figcaption></figure>
<p>続いて、POSTメソッドで文字列”ping”をサーバへ送信します（図12）。このときに通信するサーバを以降では「Openfieldサーバ」と呼びます。</p>
<figure id="attachment_340" aria-describedby="caption-attachment-340" style="width: 920px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-340" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=640%2C102&#038;ssl=1" alt="" width="640" height="102" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?w=920&amp;ssl=1 920w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=520%2C83&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image12.png?resize=100%2C16&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-340" class="wp-caption-text">図12 Campo Loaderが発生させるリクエストの例</figcaption></figure>
<p>この段階の通信では、OpenfieldサーバはレスポンスとしてURLを返します（詳細は後述）。このため、Campo Loaderはレスポンスが「h」で始まるかをチェックし、「h」で始まらない場合はプロセスを終了します（図13）。</p>
<figure id="attachment_341" aria-describedby="caption-attachment-341" style="width: 848px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-341" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=640%2C255&#038;ssl=1" alt="" width="640" height="255" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?w=848&amp;ssl=1 848w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=300%2C120&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=768%2C306&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=700%2C279&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=520%2C207&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=360%2C143&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=250%2C100&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image13.png?resize=100%2C40&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-341" class="wp-caption-text">図13 ‘h’のチェック</figcaption></figure>
<p>「h」である場合は、そのURLに対して、POSTメソッドで2回目の”ping”メッセージを送信します。これにより、追加のペイロードがダウンロードされ、ファイルとして保存されます。保存されるファイルの名前に関してもハードコーディングされています（図14）。</p>
<figure id="attachment_342" aria-describedby="caption-attachment-342" style="width: 619px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-342" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=619%2C77&#038;ssl=1" alt="" width="619" height="77" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?w=619&amp;ssl=1 619w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=300%2C37&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=520%2C65&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=360%2C45&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=250%2C31&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image14.png?resize=100%2C12&amp;ssl=1 100w" sizes="(max-width: 619px) 100vw, 619px" data-recalc-dims="1" /><figcaption id="caption-attachment-342" class="wp-caption-text">図14 ハードコーディングされている保存ファイル名の例</figcaption></figure>
<p>その後、rundll32.exeを使用して、ダウンロードしたDLLファイルの関数を呼び出します。呼び出す関数名は通常「DF」関数です（※）。この呼び出し引数もハードコーディングされています。</p>
<p>なお、Campo Loaderにはexeファイルをダウンロードして実行するタイプも存在します。日本における過去の事例では、Campo LoaderがUrsnifやZloaderなどのマルウェアを直接実行したことがあります。ただし、最近の日本向けのキャンペーンではDLL版が多く、後述のDFDownloaderへのダウンロード・実行に移行している傾向にあります。</p>
<p>※ Campo Loaderはエクスポート関数として「DF」や「DF1」などの関数名が使用されていますが、後述のマルウェアであるDFDownloaderも同名の「DF」が関数名として使用されているため、この部分でCampo LoaderとDFDownloaderを混同しないようご注意ください。</p>
<p>&nbsp;</p>
<h2><span id="openfield"><b>Openfieldの特徴</b></span></h2>
<p>Openfieldサーバは、Campo Loaderが取得するペイロードがホストされたサーバです。ペイロード取得時の通信先URLとして「/campo/」を含む特徴があります。ここでは、レスポンスの内容とサーバの調査結果について解説します。</p>
<h3><b>サーバのレスポンス</b></h3>
<p>POSTメソッドを用いてHTTPボディに “ping “を指定し「/campo/」配下に接続すると、URLが返却されます（下図）。過去事例として、リダイレクトを示すレスポンスが行われるケースも確認していますが、最近のものはレスポンスにURLが含む形式が一般的です。</p>
<figure id="attachment_343" aria-describedby="caption-attachment-343" style="width: 869px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-343 " src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=640%2C230&#038;ssl=1" alt="" width="640" height="230" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?w=891&amp;ssl=1 891w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=300%2C108&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=768%2C276&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=700%2C251&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=520%2C187&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=360%2C129&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=250%2C90&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image15.png?resize=100%2C36&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-343" class="wp-caption-text">図15 レスポンスの例1</figcaption></figure>
<figure id="attachment_344" aria-describedby="caption-attachment-344" style="width: 858px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-344 size-full" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=640%2C268&#038;ssl=1" alt="" width="640" height="268" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?w=858&amp;ssl=1 858w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=300%2C126&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=768%2C321&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=700%2C293&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=520%2C218&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=360%2C151&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=250%2C105&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image16.png?resize=100%2C42&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-344" class="wp-caption-text">図16 レスポンスの例2</figcaption></figure>
<p>なお、Openfieldサーバに関しても「5 リンク先のサーバの特徴」と同様にBlackTDSを用いたアンチボットが設定されている可能性があります。このため、BlackTDSサービスによってリサーチャの調査活動が妨害され、YahooやGNU等の正規のサイトへリダイレクトが行われる可能性があります。</p>
<p>レスポンスとしてCampo Loaderに通知するURLは、以下の2種類のケースがあります。</p>
<ul>
<li>同サーバの別ディレクトリ（/uploads/files/配下など）を示すURL</li>
<li>他のOpenfieldサーバのURL</li>
</ul>
<p>なお、過去の日本向けのキャンペーンや海外向けのキャンペーンでは、侵害済みの正規サーバにマルウェアを配置したと考えられる事例も確認しています。</p>
<p>&nbsp;</p>
<h3><b>IPアドレスとドメイン名の特徴</b></h3>
<p>通信先のURLには、IPアドレスとドメイン名が使用されたことがありますが、最近はドメイン名を使用する傾向があります。ドメイン名は、Namecheap社のサービスで登録されており、「単語＋数字＋xyzドメイン」という規則性があります。また、ドメイン名に紐づくIPアドレスのレンジは、176.111.174.0/24であることも調査より判明しています（表1）。</p>
<p style="text-align: center;">表1 Openfieldに使用されたドメイン名とIPアドレスの例</p>
<table>
<tbody>
<tr>
<td><b>対象</b></td>
<td><b>ドメイン名</b></td>
<td><b>IPアドレス</b></td>
</tr>
<tr>
<td>海外</td>
<td>bfdnews[.]xyz</td>
<td>176.111.174[.]72</td>
</tr>
<tr>
<td>海外</td>
<td>groupeu[.]xyz</td>
<td>176.111.174[.]72</td>
</tr>
<tr>
<td>海外</td>
<td>allcafe[.]xyz</td>
<td>176.111.174[.]72</td>
</tr>
<tr>
<td>海外</td>
<td>gainme[.]xyz</td>
<td>176.111.174[.]53</td>
</tr>
<tr>
<td>日本</td>
<td>ship4[.]xyz</td>
<td>176.111.174[.]53</td>
</tr>
<tr>
<td>日本</td>
<td>gopigs[.]xyz</td>
<td>176.111.174[.]53</td>
</tr>
<tr>
<td>海外</td>
<td>beauty1[.]xyz</td>
<td>176.111.174[.]53</td>
</tr>
<tr>
<td>海外</td>
<td>about2[.]xyz</td>
<td>176.111.174[.]57</td>
</tr>
<tr>
<td>日本</td>
<td>board3[.]xyz</td>
<td>176.111.174[.]57</td>
</tr>
<tr>
<td>日本</td>
<td>cake3[.]xyz</td>
<td>176.111.174[.]58</td>
</tr>
<tr>
<td>日本</td>
<td>dance4[.]xyz</td>
<td>176.111.174[.]61</td>
</tr>
<tr>
<td>海外</td>
<td>hall4[.]xyz</td>
<td>176.111.174[.]62</td>
</tr>
<tr>
<td>海外</td>
<td>keep2[.]xyz</td>
<td>176.111.174[.]62</td>
</tr>
<tr>
<td>海外</td>
<td>lie3[.]xyz</td>
<td>176.111.174[.]59</td>
</tr>
<tr>
<td>海外</td>
<td>out2[.]xyz</td>
<td>176.111.174[.]60</td>
</tr>
<tr>
<td>海外</td>
<td>noise1[.]xyz</td>
<td>176.111.174[.]60</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3><b>Openfieldサーバの由来と機能</b></h3>
<p>「Openfield」は、このサーバを識別するために、海外のセキュリティリサーチャチームCryptolaemus Team（@Cryptolaemus1）が名付けた名称です。</p>
<div class="twitter-tweet">
<blockquote class="twitter-tweet" data-lang="ja">
<p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/Trickbot?src=hash&amp;ref_src=twsrc%5Etfw">#Trickbot</a> gtag mon88 <a href="https://t.co/D3U5S10zJQ">https://t.co/D3U5S10zJQ</a><br />This /campo/x/x actor is some sort of distro as a service group that loves to do these 1 or 2 letter subdirectories like that. We have started to call them <a href="https://twitter.com/hashtag/openfield?src=hash&amp;ref_src=twsrc%5Etfw">#openfield</a> or <a href="https://twitter.com/hashtag/campoloader?src=hash&amp;ref_src=twsrc%5Etfw">#campoloader</a> because they always have the same structure.</p>
<p>&mdash; Cryptolaemus (@Cryptolaemus1) <a href="https://twitter.com/Cryptolaemus1/status/1365494339883958272?ref_src=twsrc%5Etfw">2021年2月27日</a></p></blockquote>
</div>
<p>&nbsp;</p>
<p>Webサーバのディレクトリリスティング機能が有効になっており、コンテンツの一覧を見ることができる状態（一般的に”open directory”と呼ばれる）であったことが由来と考えられます。我々の調査でも、Openfieldサーバのコンテンツの一覧を見られる状態であったことを確認しています。ただし、この設定は現在は修正されています。</p>
<figure id="attachment_345" aria-describedby="caption-attachment-345" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-345" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=640%2C308&#038;ssl=1" alt="" width="640" height="308" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=1024%2C492&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=300%2C144&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=768%2C369&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=700%2C336&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=520%2C250&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=360%2C173&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=250%2C120&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?resize=100%2C48&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image17.png?w=1111&amp;ssl=1 1111w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-345" class="wp-caption-text">図17 Openfieldサーバ（当時）のディレクトリリスト</figcaption></figure>
<p>また、Openfieldサーバには、ログインパネルも存在しています。図17（左）に示す通り、ディレクトリに「smtp」「mails」といった名称が使用されていることから、Openfieldサーバはメールの送信に関連した機能を持つ可能性があります。</p>
<figure id="attachment_346" aria-describedby="caption-attachment-346" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-346" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=640%2C317&#038;ssl=1" alt="" width="640" height="317" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=1024%2C507&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=300%2C149&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=768%2C380&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=700%2C347&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=520%2C258&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=360%2C178&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=250%2C124&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?resize=100%2C50&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image18.png?w=1153&amp;ssl=1 1153w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-346" class="wp-caption-text">図18 Openfieldサーバのログインパネル</figcaption></figure>
<p>&nbsp;</p>
<h2><span id="dfdownloader"><b>DFDownloader マルウェアの特徴</b></span></h2>
<p>DFDownloaderは、Campo Loaderによってダウンロード・実行される、2段階目のマルウェアです。このマルウェアはダウンローダであり、次の段階のマルウェアをダウンロードして実行する役割を担っています。ダウンロード・実行のほかにも永続化や自身を更新する機能などを備えており、Campo Loaderよりも機能が豊富です。また、DFDownloaderには、バージョン情報が埋め込まれており、頻繁にバージョンアップが行われていることから、今後も継続して使用されるものと予想されます。以降では、DFDownloaderの動作について解説します。</p>
<p>後述しますが、海外の事例ではDFDownloaderを使用しないケースも確認されています。</p>
<p>&nbsp;</p>
<h3><b>アンチサンドボックス機能</b></h3>
<p>DFDownloaderには、アンチサンドボックス機能があります。DFDownloaderは最初にシステムのメモリ総量をチェックし、4GiBに満たない場合はプロセスを終了します。また、sleep関数が複数存在しており、これら妨害機能によって、サンドボックス環境での実行で正確な結果を得られない可能性があります。</p>
<figure id="attachment_347" aria-describedby="caption-attachment-347" style="width: 765px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-347" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=640%2C421&#038;ssl=1" alt="" width="640" height="421" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?w=765&amp;ssl=1 765w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=300%2C197&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=700%2C460&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=520%2C342&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=360%2C237&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=250%2C164&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image19.png?resize=100%2C66&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-347" class="wp-caption-text">図19 メモリチェック</figcaption></figure>
<p>&nbsp;</p>
<h3><b>文字列の暗号化</b></h3>
<p>下図の通り、DFDownloaderは使用する文字列をXORで暗号化した状態で保持しています。この文字列には、通信先情報や使用する関数の情報などが含まれています。また、これらの文字列を復号するXORのルーチンは、サーバからのレスポンスを復号する際にも使用されます。</p>
<figure id="attachment_348" aria-describedby="caption-attachment-348" style="width: 733px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-348" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=640%2C478&#038;ssl=1" alt="" width="640" height="478" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?w=733&amp;ssl=1 733w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=300%2C224&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=700%2C523&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=520%2C389&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=360%2C269&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=250%2C187&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image20.png?resize=100%2C75&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-348" class="wp-caption-text">図20 XOR文字列の例</figcaption></figure>
<p>&nbsp;</p>
<h3><b>通信の流れ</b></h3>
<p>DFDownloaderによる通信の流れは下図の通りです。通信先として、通常は4種類のドメイン名を保持しています。DFDownloaderがサーバと通信する際に使用するデータフォーマットは4種類存在します。</p>
<figure id="attachment_349" aria-describedby="caption-attachment-349" style="width: 1000px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-349" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=640%2C352&#038;ssl=1" alt="" width="640" height="352" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?w=1000&amp;ssl=1 1000w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=300%2C165&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=768%2C422&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=700%2C385&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=520%2C286&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=360%2C198&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=250%2C138&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image21.png?resize=100%2C55&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-349" class="wp-caption-text">図21 DFDownloaderの通信の流れ</figcaption></figure>
<p>&nbsp;</p>
<h4>①SYS識別子の通信</h4>
<p>DFDownloaderは最初に感染したホストで収集した情報をPOSTメソッドで送信します（下図）。このとき送信される情報はBase64でエンコードされており、識別子などを含んでいることがわかります。</p>
<figure id="attachment_350" aria-describedby="caption-attachment-350" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-350 size-large" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=640%2C102&#038;ssl=1" alt="" width="640" height="102" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=1024%2C163&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=520%2C83&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image22.png?w=1174&amp;ssl=1 1174w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-350" class="wp-caption-text">図22 最初の通信例（SYS識別子）</figcaption></figure>
<p>サーバへ送信される情報の詳細は下表の通りです。これらのリクエストに対し、サーバは通常、HTTPステータスコード「200 OK」のレスポンスを返します。</p>
<p style="text-align: center;">表2 送信データの詳細</p>
<table>
<tbody>
<tr>
<td>値の例</td>
<td>意味</td>
</tr>
<tr>
<td>SYS</td>
<td>識別子</td>
</tr>
<tr>
<td>10</td>
<td>OSのメジャーバージョン番号</td>
</tr>
<tr>
<td>17763</td>
<td>OSのビルド番号</td>
</tr>
<tr>
<td>DESKTOP-AABSVH71760622929</td>
<td>コンピュータ名とボリュームシリアル番号から生成した値</td>
</tr>
<tr>
<td>test</td>
<td>ユーザ名</td>
</tr>
<tr>
<td>64</td>
<td>OSのビット数</td>
</tr>
<tr>
<td>1.28r</td>
<td>DFDownloaderのバージョン</td>
</tr>
<tr>
<td>0</td>
<td>0 または 1</td>
</tr>
<tr>
<td>7545391</td>
<td>不明</td>
</tr>
</tbody>
</table>
<h4></h4>
<p>&nbsp;</p>
<h4>②BIN識別子の通信</h4>
<p>2番目にBIN識別子を使用した通信が発生します（下図）。</p>
<figure id="attachment_351" aria-describedby="caption-attachment-351" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-351" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=640%2C101&#038;ssl=1" alt="" width="640" height="101" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=1024%2C162&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=520%2C82&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image23.png?w=1173&amp;ssl=1 1173w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-351" class="wp-caption-text">図23 2番目の通信例（BIN識別子）</figcaption></figure>
<p>ここで、サーバからレスポンスがあった場合、DFDownloaderはレスポンスをXORで復号し、先頭バイトが「MZ」（PEファイルのマジックナンバー）で始まるかチェックします。PEファイルである場合、受信したデータをファイルとして保存します。</p>
<p>その後、作成したファイルのパスを使用して、レジストリに値を登録します（下図）。このレジストリへの登録によって、ユーザが端末にログオンした際にDFDownloaderが実行されるようになります（感染の永続化）。</p>
<figure id="attachment_352" aria-describedby="caption-attachment-352" style="width: 960px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-352" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=640%2C362&#038;ssl=1" alt="" width="640" height="362" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?w=960&amp;ssl=1 960w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=300%2C170&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=768%2C434&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=700%2C396&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=520%2C294&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=360%2C204&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=250%2C141&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image24.png?resize=100%2C57&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-352" class="wp-caption-text">図24 レジストリに登録される値の例</figcaption></figure>
<p>&nbsp;</p>
<p>なお、我々は当該通信によってDFDownloaderの更新が行われる動作を確認しました。更新が行われる際は、新しくファイルを保存し、レジストリの値を書き換え、古いファイルとディレクトリを削除します。</p>
<p>&nbsp;</p>
<h4>③PNG識別子の通信</h4>
<p>3番目にPNG識別子を使用した通信が発生します。</p>
<figure id="attachment_353" aria-describedby="caption-attachment-353" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-353" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=640%2C101&#038;ssl=1" alt="" width="640" height="101" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=1024%2C162&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=520%2C82&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image25.png?w=1174&amp;ssl=1 1174w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-353" class="wp-caption-text">図25 3番目の通信例（PNG識別子）</figcaption></figure>
<p>この通信でサーバから受け取った値に応じて、以降の処理が下表の通り分岐します。分岐処理には実装途中と考えられる部分があり、今後のバージョンアップによって機能が追加されると予想されます。</p>
<p style="text-align: center;">表3 コマンド</p>
<table>
<tbody>
<tr>
<td>値</td>
<td>説明</td>
</tr>
<tr>
<td>0x31</td>
<td>後続の通信で取得するファイル（DLLまたはEXE）を保存して実行する。DLLの場合は関数名を指定することができる。</td>
</tr>
<tr>
<td>0x32</td>
<td>後続の通信で取得するファイル（DLL）を保存して実行する。この場合、実行後にDFDownloaderのプロセスは終了する。</td>
</tr>
<tr>
<td>0x33</td>
<td>未実装。</td>
</tr>
<tr>
<td>0x34</td>
<td>未実装。</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h4>④BN識別子の通信</h4>
<p>最後にBN識別子を使用した通信が発生します（下図）。この通信では、③PNG識別子を使用した通信でサーバから返ってきた値に合わせて、それぞれの分岐で実行するペイロードをサーバから取得します。前述の通り、取得するペイロードはDLLファイルまたはEXEファイルです。</p>
<figure id="attachment_354" aria-describedby="caption-attachment-354" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-354" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=640%2C102&#038;ssl=1" alt="" width="640" height="102" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=1024%2C163&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=520%2C83&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image26.png?w=1174&amp;ssl=1 1174w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-354" class="wp-caption-text">図26 4番目の通信例（BN識別子）</figcaption></figure>
<p>そして、CreateProcessA関数を使用して新しいプロセスを生成します。EXEファイルの場合はそのまま実行し、DLLファイルの場合はrundll32.exeを使用します。</p>
<p>なお、ループ処理があるため、サーバから期待されるレスポンスがない場合でも、③と④の通信が何度も発生します。ただし、通信の間隔は一定ではありません。</p>
<p>&nbsp;</p>
<h2><span id="i-7"><b>その後のペイロードの考察</b></span></h2>
<p>執筆時点（2021年4月）では、後続のペイロードを確認できていません。しかし、海外では類似事例が報告されており、日本においても今後これらの事例のように感染が進行する可能性があると考えます。また、以前から同攻撃者グループによると考えられる攻撃キャンペーンも確認されており、その内容からも狙いの傾向を推測することが可能です。そこで、ここでは海外事例と過去事例をもとに、最終的に感染すると考えられるマルウェアを考察します。</p>
<p>これまでの類似事例から、その後感染する可能性のあるマルウェアは次の図の通りです。Campo Loaderから、下図の青枠に示すマルウェアに感染する事例があり、DFDownloaderからも同様に感染が進行する可能性があります。</p>
<figure id="attachment_473" aria-describedby="caption-attachment-473" style="width: 1253px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-473 size-full" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=640%2C258&#038;ssl=1" alt="" width="640" height="258" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?w=1253&amp;ssl=1 1253w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=300%2C121&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=1024%2C414&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=768%2C310&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=700%2C283&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=520%2C210&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=360%2C145&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=250%2C101&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image27_.png?resize=100%2C40&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-473" class="wp-caption-text">図27 感染フローの考察</figcaption></figure>
<p>このように情報窃取やリモートアクセス、ランサムウェアなど様々な被害が想定されます。あくまで推測であり、上記以外のマルウェアに感染することもあり得る点にご注意ください。</p>
<p>&nbsp;</p>
<h3><b>日本における類似事例</b></h3>
<p>日本においては、以前にOpenfieldサーバやCampo Loaderを利用してUrsnifやZloaderへの感染を狙う事例[3]が確認されています。この事例では、メールに添付された悪性の文書ファイルからドロップされたCampo Loaderが、UrsnifやZloaderをダウンロードして実行するという流れでした。そのため、DFDownloaderからUrsnifやZloaderに感染する可能性も考えられます。</p>
<ul>
<li>[3] 「2020/10/14(火) 添付ファイル付不審メール「【お振込口座変更のご連絡】」（ZLoader）の調査」, bomb_blog, 2020/10/28<br />
<a href="https://bomccss.hatenablog.jp/entry/2020/10/28/125630">https://bomccss.hatenablog.jp/entry/2020/10/28/125630</a></li>
</ul>
<p>&nbsp;</p>
<h3><b>海外における類似事例</b></h3>
<p>海外においても、OpenfieldサーバとCampo Loaderを使用する事例が複数報告されています。これらの事例も、Campo Loaderが他のマルウェアをダウンロードして実行するケースです。</p>
<p>海外の活発なキャンペーンのひとつに「BazarCall」と呼ばれる攻撃キャンペーンがあります。このキャンペーンでは、ユーザがメールに記載の連絡先に電話することで文書ファイルのリンク先に誘導され、実行することで感染に至ります[4]。</p>
<p>このキャンペーンでもCampo Loaderが使用されており、本攻撃キャンペーンと同様に文書ファイルからドロップされたCampo Loaderが実行されOpenfieldサーバへアクセスし、BazarLoaderをダウンロードして実行します（図28）。</p>
<figure id="attachment_356" aria-describedby="caption-attachment-356" style="width: 866px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-356" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=640%2C234&#038;ssl=1" alt="" width="640" height="234" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?w=866&amp;ssl=1 866w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=300%2C110&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=768%2C281&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=700%2C256&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=520%2C190&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=360%2C132&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=250%2C92&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image28.png?resize=100%2C37&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-356" class="wp-caption-text">図28 BazarCall キャンペーンにおけるのBazarLoaderを取得する通信の例<br />（出典：https://www.malware-traffic-analysis.net/2021/04/16/index2.html）</figcaption></figure>
<ul>
<li>[4] 「BazarCall malware uses malicious call centers to infect victims」, Bleeping Computer, 2021/3/31<br />
<a href="https://www.bleepingcomputer.com/news/security/bazarcall-malware-uses-malicious-call-centers-to-infect-victims/">https://www.bleepingcomputer.com/news/security/bazarcall-malware-uses-malicious-call-centers-to-infect-victims/</a></li>
</ul>
<p>また、他の事例として、古いタイプのCampo LoaderからTrickbotやPhobos Ransomwareに感染した事例の報告があります。2020年9月～10月頃の事例ですが、現在も活動を続けるマルウェアですので注意が必要です。</p>
<ul>
<li>[5]「Deep Analysis – The EKING Variant of Phobos Ransomware」, Fortinet, 2020/10/13<br />
<a href="https://www.fortinet.com/blog/threat-research/deep-analysis-the-eking-variant-of-phobos-ransomware">https://www.fortinet.com/blog/threat-research/deep-analysis-the-eking-variant-of-phobos-ransomware</a></li>
<li>[6] 「TRICKBOT AND EMOTET DELIVERY THROUGH WORD MACRO」, Morphisec, 2020/9/16<br />
<a href="https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro">https://blog.morphisec.com/trickbot-emotet-delivery-through-word-macro</a></li>
</ul>
<p>&nbsp;</p>
<h2><span id="i-8"><b>他のキャンペーンとの関連性</b></span></h2>
<p>調査の過程で判明した他のキャンペーンとの関連性について解説します。</p>
<h3><b>BazarCallとの関連性</b></h3>
<p>4月9日の日本向けの攻撃に使用された文書ファイルを開いた際に表示される偽の入力フォームが、4月15日にSophos社が公開したレポート[7]にて言及されている偽の入力フォームとほぼ一致しています（図29、図30）。</p>
<ul>
<li>[7]「BazarLoader deploys a pair of novel spam vectors」, Sophos, 2021/04/15<br />
<a href="https://news.sophos.com/en-us/2021/04/15/bazarloader/">https://news.sophos.com/en-us/2021/04/15/bazarloader/</a></li>
</ul>
<figure id="attachment_357" aria-describedby="caption-attachment-357" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-357 size-large" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=640%2C478&#038;ssl=1" alt="" width="640" height="478" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=1024%2C765&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=300%2C224&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=768%2C573&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=700%2C523&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=520%2C388&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=360%2C269&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=250%2C187&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?resize=100%2C75&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image29.png?w=1318&amp;ssl=1 1318w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-357" class="wp-caption-text">図29 4月9日の日本向け攻撃キャンペーンで表示される偽の入力フォーム</figcaption></figure>
<figure id="attachment_358" aria-describedby="caption-attachment-358" style="width: 663px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="wp-image-358 " src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=640%2C511&#038;ssl=1" alt="" width="640" height="511" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?w=856&amp;ssl=1 856w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=300%2C239&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=768%2C613&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=700%2C559&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=520%2C415&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=360%2C287&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=250%2C199&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image30.png?resize=100%2C80&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-358" class="wp-caption-text">図30 Sophos社のレポートで言及されている偽の入力フォーム<br />（出典 : https://news.sophos.com/en-us/2021/04/15/bazarloader/）</figcaption></figure>
<p>また、同様に日本向けの一連の攻撃で使用された文書ファイルの挙動についてもほぼ一致しています（図31、図32）。</p>
<figure id="attachment_359" aria-describedby="caption-attachment-359" style="width: 664px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-359" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=640%2C204&#038;ssl=1" alt="" width="640" height="204" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?w=664&amp;ssl=1 664w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=300%2C96&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=520%2C166&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=360%2C115&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=250%2C80&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image31.png?resize=100%2C32&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-359" class="wp-caption-text">図31 4月9日の日本向け攻撃キャンペーンで使用された文書ファイルのプロセスツリー</figcaption></figure>
<figure id="attachment_360" aria-describedby="caption-attachment-360" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-360" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=640%2C124&#038;ssl=1" alt="" width="640" height="124" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=1024%2C199&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=300%2C58&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=768%2C149&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=700%2C136&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=520%2C101&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=360%2C70&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=250%2C48&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?resize=100%2C19&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image32.png?w=1031&amp;ssl=1 1031w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-360" class="wp-caption-text">図32 Sophos社のレポートで言及されているプロセスツリー<br />（出典 : https://news.sophos.com/en-us/2021/04/15/bazarloader/）</figcaption></figure>
<p>&nbsp;</p>
<h3><b>パッカーの類似性</b></h3>
<p>Campo LoaderとDFDownloaderに使用されているパッカーには複数のバリエーションがありますが、一部のパッカーがTrickbotやBazarLoaderで使用されていたものと類似しています。</p>
<p>下図は、Campo LoaderとDFDownloader（1.28r）で使用されているパッカーのコードの一部です。このパッカーは、CryptoAPIを使用してマルウェア本体を暗号化しており、CryptImportKey関数によるRSA2キーのインポートと、CryptEncryptを使用してRC4暗号でデータを処理する動きが特徴的です。</p>
<figure id="attachment_361" aria-describedby="caption-attachment-361" style="width: 716px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-361" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=640%2C450&#038;ssl=1" alt="" width="640" height="450" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?w=716&amp;ssl=1 716w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=300%2C211&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=700%2C492&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=520%2C365&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=360%2C253&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=250%2C176&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image33.png?resize=100%2C70&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-361" class="wp-caption-text">図33 Campo Loaderのパッカーの例</figcaption></figure>
<figure id="attachment_362" aria-describedby="caption-attachment-362" style="width: 700px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-362" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=640%2C429&#038;ssl=1" alt="" width="640" height="429" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?w=700&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=300%2C201&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=520%2C348&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=360%2C241&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=250%2C168&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image34.png?resize=100%2C67&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-362" class="wp-caption-text">図34 DFDownloaderのパッカーの例</figcaption></figure>
<p>これらのコードは、Cybereason社のブログ[8]で紹介されているBazarLoaderのパッカーやVIPRE Labsのブログ[9]で紹介されているTrickbotが使用しているパッカーにも同様の特徴が見られます。このような類似点からも、TrickbotとBazarLoaderが本攻撃キャンペーンに関連する可能性があることがわかります。</p>
<ul>
<li>[8] 「A Bazar of Tricks: Following Team9’s Development Cycles」, Cybereason, 2020/7/16<br />
<a href="&quot;https://www.cybereason.com/blog/a-bazar-of-tricks-following-team9s-development-cycles">https://www.cybereason.com/blog/a-bazar-of-tricks-following-team9s-development-cycles</a></li>
<li>[9] 「Trickbot’s Tricks」, VIPRE Labs, 2018/12/5<br />
<a href="https://labs.vipre.com/trickbots-tricks/">https://labs.vipre.com/trickbots-tricks/</a></li>
</ul>
<p>&nbsp;</p>
<h2><span id="i-9"><b>実行痕跡の確認方法</b></span></h2>
<p>実行痕跡の確認方法を以下に示します。</p>
<h3><b>端末の自動起動設定の確認</b></h3>
<h4>レジストリ</h4>
<ul>
<li>DFDownloaderは、永続化のためにレジストリにDLLファイルを登録します。</li>
<li>ユーザが端末にログオンした際にDFDownloaderが実行されるようになります。</li>
</ul>
<p style="text-align: center;">表4 レジストリに登録される値の例</p>
<table>
<tbody>
<tr>
<td>項目</td>
<td>値</td>
</tr>
<tr>
<td>レジストリキー</td>
<td>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</td>
</tr>
<tr>
<td>値</td>
<td>Shell</td>
</tr>
<tr>
<td>データ型</td>
<td>REG_SZ</td>
</tr>
<tr>
<td>データ</td>
<td>（例）explorer.exe, regsvr32.exe C:\ProgramData\nmvhg\nmvhg.dll</td>
</tr>
</tbody>
</table>
<figure id="attachment_363" aria-describedby="caption-attachment-363" style="width: 960px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-363" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=640%2C362&#038;ssl=1" alt="" width="640" height="362" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?w=960&amp;ssl=1 960w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=300%2C170&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=768%2C434&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=700%2C396&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=520%2C294&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=360%2C204&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=250%2C141&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image35.png?resize=100%2C57&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-363" class="wp-caption-text">図35 レジストリに登録される値の例</figcaption></figure>
<p>&nbsp;</p>
<h3><b>ネットワークトラフィックやプロキシログの確認</b></h3>
<p>感染時のネットワークトラフィックやプロキシログが残っている場合は、次に示す通信が記録されていないかをご確認ください。</p>
<h4>Campo Loaderの通信</h4>
<ul>
<li>POSTメソッドを使用します。このときHTTPヘッダにはUser-Agentがありません。</li>
<li>通信先のドメイン名は、xyzドメインを使用する傾向があります。</li>
<li>URLは正規表現で「\/campo\/([a-z0-9]{1,2})\/([a-z0-9]{1,3})」と表現できます。</li>
</ul>
<figure id="attachment_364" aria-describedby="caption-attachment-364" style="width: 891px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-364" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=640%2C230&#038;ssl=1" alt="" width="640" height="230" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?w=891&amp;ssl=1 891w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=300%2C108&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=768%2C276&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=700%2C251&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=520%2C187&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=360%2C129&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=250%2C90&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image36.png?resize=100%2C36&amp;ssl=1 100w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-364" class="wp-caption-text">図36 Campo Loaderの通信例</figcaption></figure>
<h4>DFDownloaderの通信</h4>
<ul>
<li>POSTメソッドを使用します。このときHTTPヘッダにはUser-Agentがありません。</li>
<li>通信先のドメイン名は、xyzドメインを使用する傾向があります。</li>
<li>リクエストのContent-Lengthは、40～100バイト程度です。</li>
<li>サーバレスポンスは、XORで暗号化されています。XORキーは感染した端末ごとに異なる値です。<br />
例：「DESKTOP-AABSVH71760622929」</li>
</ul>
<figure id="attachment_365" aria-describedby="caption-attachment-365" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-365" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=640%2C102&#038;ssl=1" alt="" width="640" height="102" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=1024%2C163&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=520%2C83&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image37.png?w=1174&amp;ssl=1 1174w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-365" class="wp-caption-text">図37 DFDownloaderの通信例1</figcaption></figure>
<figure id="attachment_366" aria-describedby="caption-attachment-366" style="width: 640px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-large wp-image-366" src="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=640%2C101&#038;ssl=1" alt="" width="640" height="101" srcset="https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=1024%2C162&amp;ssl=1 1024w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=300%2C48&amp;ssl=1 300w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=768%2C122&amp;ssl=1 768w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=700%2C111&amp;ssl=1 700w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=520%2C82&amp;ssl=1 520w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=360%2C57&amp;ssl=1 360w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=250%2C40&amp;ssl=1 250w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?resize=100%2C16&amp;ssl=1 100w, https://i0.wp.com/mal-eats.net/wp-content/uploads/2021/05/image38.png?w=1174&amp;ssl=1 1174w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1" /><figcaption id="caption-attachment-366" class="wp-caption-text">図38 DFDownloaderの通信例2</figcaption></figure>
<p>&nbsp;</p>
<h3><b>生成ファイルの確認</b></h3>
<p>以下に示すようなファイルが生成されていないかをご確認ください。<br />
ファイルの名前や保存先などは攻撃者が容易に変更できる部分であるため、未掲載のものが存在する可能性がある点にご注意ください。</p>
<h4>文書ファイル</h4>
<ul>
<li>保存先のフォルダパスは一貫して「C:\Users\Public\」が使用されており、攻撃キャンペーンによってファイル名が変化します。</li>
<li>文書ファイルの生成ファイルの例は下表の通りです。</li>
</ul>
<p style="text-align: center;">表5 文書ファイルによる生成ファイル例</p>
<table>
<tbody>
<tr>
<td>ファイル</td>
<td>説明</td>
</tr>
<tr>
<td>C:\Users\Public\14118.doy</td>
<td>文書ファイルがドロップしたファイル。</p>
<p>2021年4月9日の日本向けキャンペーンで使用。</td>
</tr>
<tr>
<td>C:\Users\Public\14118.xlsb</td>
<td>文書ファイルがドロップしたファイル。</p>
<p>2021年4月9日の日本向けキャンペーンで使用。</td>
</tr>
<tr>
<td>C:\Users\Public\14118.biy</td>
<td>「C:\Users\Public\14118.doy」の中身をBase64デコードして生成されたファイル（Campo Loader）。</p>
<p>2021年4月9日の日本向けキャンペーンで使用。</td>
</tr>
</tbody>
</table>
<h4>Campo Loader</h4>
<ul>
<li>保存先のパス、ファイル名は、文書ファイルからドロップされるCampo Loaderにハードコーディングされています。</li>
<li>「C:\ProgramData\」配下を使用する傾向にあります。</li>
<li>Campo Loaderの生成ファイルは下表の通りです。</li>
</ul>
<p style="text-align: center;">表6 Campo Loaderによる生成ファイル例</p>
<table>
<tbody>
<tr>
<td>ファイル</td>
<td>説明</td>
</tr>
<tr>
<td>C:\ProgramData\jyqwkf\jyqwkf.dll</td>
<td>Campo LoaderがダウンロードしたDLLファイル。2021年4月9日の日本向けキャンペーンで使用。</td>
</tr>
<tr>
<td>C:\ProgramData\yosgu\yosgu.dll</td>
<td>Campo LoaderがダウンロードしたDLLファイル。2021年4月8日、2日の日本向けキャンペーンで使用。</td>
</tr>
</tbody>
</table>
<h4>DFDownloader</h4>
<ul>
<li>DFDownloaderの保存先のパス、ファイル名は、ランダムに生成されます。</li>
<li>「C:\ProgramData\」配下を使用する傾向にあります。</li>
<li>通信の状況によっては、フォルダとファイルを削除することもあります。</li>
<li>DFDownloaderの生成ファイルは下表の通りです。</li>
</ul>
<p style="text-align: center;">表7 DFDownloaderによる生成ファイル例</p>
<table>
<tbody>
<tr>
<td>ファイル</td>
<td>説明</td>
</tr>
<tr>
<td>C:\ProgramData\＜ランダム＞\＜ランダム＞.dll</p>
<div class="example-val">例：「C:\ProgramData\nmvhg\nmvhg.dll」</div>
</td>
<td>DFDownloaderがダウンロードしたDLLファイル。</td>
</tr>
<tr>
<td>C:\ProgramData\＜ランダム＞\＜ランダム＞.exe</p>
<div class="example-val">例：「C:\ProgramData\nmvhg\nmvhg.exe」</div>
</td>
<td>DFDownloaderがダウンロードしたEXEファイル。</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2><span id="i-10"><b>感染の判断が難しい場合・専門企業による調査が必要な場合</b></span></h2>
<p>下記リンクにて、セキュリティインシデント発生時に緊急対応を請け負ってくれる企業の一覧があります。初期相談が無料の企業もあります。</p>
<ul>
<li>JNSA　サイバーインシデント緊急対応企業一覧<br />
<a href="https://www.jnsa.org/emergency_response/">https://www.jnsa.org/emergency_response/</a></li>
</ul>
<p>&nbsp;</p>
<h2><span id="i-11"><b>謝辞</b></span></h2>
<p>本稿の執筆にあたり、下記のセキュリティリサーチャ（順不同）による情報共有を活用させていただきました。お礼を申し上げます。</p>
<ul>
<li>Cryptolaemus Team (@Cryptolaemus1)</li>
<li>ExecuteMalware (@executemalware)</li>
<li>bom (@bomccss)</li>
<li>わが (@waga_tw)</li>
<li>moto_sato (@58_158_177_102)</li>
<li>Malware Traffic Analysis<br />
<a href="https://www.malware-traffic-analysis.net/">https://www.malware-traffic-analysis.net/</a></li>
</ul>
<p>&nbsp;</p>
<h2><span id="ioc510"><b>IoC（5月10日時点）</b></span></h2>
<h3>文書ファイルのハッシュ</h3>
<p>7d1ff39fc6daab153ad6477554415336578256257aa81fd796a48b89c7a8b2e8</p>
<h3>Campo Loaderのハッシュ</h3>
<p>b8212f866c5cdf1a823031e24fe10444aab103d8fb55a25821e1c7c7366e580f</p>
<h3>DFDownloaderのハッシュ</h3>
<p>8589e2d840c3ed5adbdc160724bdb3c2e703adeec1ec1e29983960c9c00c4469</p>
<h3>Campo Loaderの通信先</h3>
<p>Openfieldサーバは、Campo Loader以外のマルウェアでも使用されるため、下記にはBazarCall等で使用される通信先が含まれる可能性があります。<br />
また、他のOpenfieldのURL情報は、<a href="https://urlhaus.abuse.ch/browse/tag/openfield/">URLhaus</a>にも登録されています。</p>
<p>hxxp://nightsalmon[.]xyz/campo/b/b<br />
hxxp://foreverbold[.]xyz/campo/b/b<br />
hxxp://superstartart[.]xyz/campo/b/b<br />
hxxp://steeltits[.]xyz/campo/z/z<br />
hxxp://steeltits[.]xyz/campo/LHq/cD<br />
hxxp://139.162.150[.]121/campo/b/j<br />
hxxp://185.14.31[.]147/campo/j1/j2<br />
hxxp://ship4[.]xyz/campo/i/i<br />
hxxp://gopigs[.]xyz/campo/k/k<br />
hxxp://board3[.]xyz/campo/h/h2<br />
hxxp://cake3[.]xyz/campo/c4/c4<br />
hxxp://dance4[.]xyz/campo/c5/c5<br />
hxxp://cake3[.]xyz/uploads/files/120.dll<br />
hxxp://chance5[.]xyz/uploads/files/1.dll<br />
hxxp://dance4[.]xyz/uploads/files/120-cr.dll</p>
<h3>DFDownloaderの通信先</h3>
<p>showstoreonline[.]com<br />
moviesmenia[.]com<br />
avydabiz[.]com<br />
kingdomcoffee[.]com<br />
domaindnsresolver[.]xyz<br />
domainutility[.]xyz<br />
domainservicing[.]xyz<br />
domainsupply[.]xyz</p>
	</div>
	
			
		<footer class="entry-footer">
			</footer><!-- .entry-footer -->
	</article><!-- #post-## -->

	<nav class="navigation post-navigation" aria-label="投稿">
		<h2 class="screen-reader-text">投稿ナビゲーション</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://mal-eats.net/2020/11/12/analysis_of_the-_icedid_campaign_for_japan/" rel="prev">IcedIDの感染につながる日本向けキャンペーンの分析</a></div><div class="nav-next"><a href="https://mal-eats.net/2023/06/01/the_deceptive_software_trap_spreading_on_youtube/" rel="next">YouTubeで拡散される不正ソフトウェアの罠</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


		</div>
	</div><!-- #content -->

	<div class="footer-wrapper">
				
						<div class="footer-info">
			<div class="container">
				<div class="footer-branding"><h2 class="site-title-footer"><a href="https://mal-eats.net/" rel="home">Mal-Eats</a></h1></div>				<div class="footer-contact"></div>			</div>
		</div>
		
		<footer id="colophon" class="site-footer" role="contentinfo">	
			<div class="site-info container">
				<nav id="footernav" class="footer-navigation" role="navigation">
					<div id="footer-menu" class="menu"><ul>
<li class="page_item page-item-2"><a href="https://mal-eats.net/profile/">Profile</a></li>
</ul></div>
				</nav><!-- #site-navigation -->
				<div class="site-copyright">
					<a href="https://ja.wordpress.org/">Powered by WordPress</a><span class="sep"> | </span>テーマ: <a href="http://athemes.com/theme/astrid" rel="nofollow">Astrid</a> by aThemes.				</div>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div>

</div><!-- #page -->

<script type='text/javascript' src='https://mal-eats.net/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-image-cdn/dist/image-cdn.js?minify=false&#038;ver=132249e245926ae3e188' id='jetpack-photon-js'></script>
<script type='text/javascript' id='toc-front-js-extra'>
/* <![CDATA[ */
var tocplus = {"smooth_scroll":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://mal-eats.net/wp-content/plugins/table-of-contents-plus/front.min.js?ver=2309' id='toc-front-js'></script>
<script type='text/javascript' src='https://mal-eats.net/wp-content/themes/astrid/js/main.js?ver=6.2.3' id='astrid-main-js'></script>
<script type='text/javascript' src='https://mal-eats.net/wp-content/themes/astrid/js/scripts.min.js?ver=20210510' id='astrid-scripts-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://mal-eats.net/wp-content/themes/astrid/js/html5shiv.js?ver=6.2.3' id='astrid-html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='wp_slimstat-js-extra'>
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/mal-eats.net\/wp-admin\/admin-ajax.php","baseurl":"\/","dnt":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czoxOiIzIjtzOjEwOiJjb250ZW50X2lkIjtpOjMyODtzOjY6ImF1dGhvciI7czoxMjoibWFsZWF0c191c2VyIjt9.8ea834784995ee1913a007a47576fdab"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.8.8.1/wp-slimstat.min.js' id='wp_slimstat-js'></script>
<script defer type='text/javascript' src='https://stats.wp.com/e-202401.js' id='jetpack-stats-js'></script>
<script type='text/javascript' id='jetpack-stats-js-after'>
_stq = window._stq || [];
_stq.push([ "view", {v:'ext',blog:'185356617',post:'328',tz:'9',srv:'mal-eats.net',j:'1:12.8.1'} ]);
_stq.push([ "clickTrackerInit", "185356617", "328" ]);
</script>
<script type='text/javascript' id='twitter-wjs-js-extra'>
/* <![CDATA[ */
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
/* ]]> */
</script>
<script type="text/javascript" id="twitter-wjs" async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</body>
</html>

<!-- Dynamic page generated in 0.478 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2024-01-01 20:59:40 -->

<!-- super cache -->