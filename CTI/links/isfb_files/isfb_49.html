<!doctype html>
<html dir="ltr" lang="en-GB" prefix="og: https://ogp.me/ns#">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Analysing ISFB – The First Loader | 0ffset Training Solutions</title>

		<!-- All in One SEO 4.5.3.1 - aioseo.com -->
		<meta name="description" content="I&#039;m finally getting round to writing this post - for the past few months I have been analysing different versions of ISFB/Ursnif/Gozi to gain a deeper understanding in the functionality of this specific malware. In this post, I will be detailing how to unpack and then analyse the first stage loader executable, and then use" />
		<meta name="robots" content="max-image-preview:large" />
		<link rel="canonical" href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" />
		<meta name="generator" content="All in One SEO (AIOSEO) 4.5.3.1" />
		<meta property="og:locale" content="en_GB" />
		<meta property="og:site_name" content="0ffset Training Solutions | Practical and Affordable Cyber Security Training" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="Analysing ISFB – The First Loader | 0ffset Training Solutions" />
		<meta property="og:description" content="I&#039;m finally getting round to writing this post - for the past few months I have been analysing different versions of ISFB/Ursnif/Gozi to gain a deeper understanding in the functionality of this specific malware. In this post, I will be detailing how to unpack and then analyse the first stage loader executable, and then use" />
		<meta property="og:url" content="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" />
		<meta property="og:image" content="https://0ffset.net/wp-content/uploads/2021/05/z2a_logo.png" />
		<meta property="og:image:secure_url" content="https://0ffset.net/wp-content/uploads/2021/05/z2a_logo.png" />
		<meta property="article:published_time" content="2019-03-13T18:25:37+00:00" />
		<meta property="article:modified_time" content="2021-07-01T08:41:23+00:00" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@0verfl0w_" />
		<meta name="twitter:title" content="Analysing ISFB – The First Loader | 0ffset Training Solutions" />
		<meta name="twitter:description" content="I&#039;m finally getting round to writing this post - for the past few months I have been analysing different versions of ISFB/Ursnif/Gozi to gain a deeper understanding in the functionality of this specific malware. In this post, I will be detailing how to unpack and then analyse the first stage loader executable, and then use" />
		<meta name="twitter:creator" content="@0verfl0w_" />
		<meta name="twitter:image" content="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo.png" />
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"BlogPosting","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#blogposting","name":"Analysing ISFB \u2013 The First Loader | 0ffset Training Solutions","headline":"Analysing ISFB &#8211; The First Loader","author":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"publisher":{"@id":"https:\/\/www.0ffset.net\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/bss_psuedo.png","width":853,"height":470},"datePublished":"2019-03-13T18:25:37+00:00","dateModified":"2021-07-01T09:41:23+01:00","inLanguage":"en-GB","commentCount":2,"mainEntityOfPage":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#webpage"},"isPartOf":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#webpage"},"articleSection":"Malware Analysis"},{"@type":"BreadcrumbList","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.0ffset.net\/#listItem","position":1,"name":"Home","item":"https:\/\/www.0ffset.net\/","nextItem":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#listItem","position":2,"name":"Analysing ISFB - The First Loader","previousItem":"https:\/\/www.0ffset.net\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/www.0ffset.net\/#organization","name":"0ffset Training Solutions LTD.","url":"https:\/\/www.0ffset.net\/","logo":{"@type":"ImageObject","url":"https:\/\/0ffset.net\/wp-content\/uploads\/2021\/05\/cropped-z2a_logo.png","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#organizationLogo"},"image":{"@id":"https:\/\/www.0ffset.net\/#organizationLogo"},"sameAs":["https:\/\/twitter.com\/0verfl0w_","https:\/\/www.youtube.com\/channel\/UCy21puSd9R3C5Xn46YI32_g","https:\/\/www.linkedin.com\/company\/0ffset"]},{"@type":"Person","@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author","url":"https:\/\/www.0ffset.net\/author\/dan489400\/","name":"0verfl0w_","image":{"@type":"ImageObject","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/4646d0a6fcf15f17545b9a8708b8c3b4?s=96&d=mm&r=g","width":96,"height":96,"caption":"0verfl0w_"}},{"@type":"WebPage","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#webpage","url":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/","name":"Analysing ISFB \u2013 The First Loader | 0ffset Training Solutions","description":"I'm finally getting round to writing this post - for the past few months I have been analysing different versions of ISFB\/Ursnif\/Gozi to gain a deeper understanding in the functionality of this specific malware. In this post, I will be detailing how to unpack and then analyse the first stage loader executable, and then use","inLanguage":"en-GB","isPartOf":{"@id":"https:\/\/www.0ffset.net\/#website"},"breadcrumb":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#breadcrumblist"},"author":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"creator":{"@id":"https:\/\/www.0ffset.net\/author\/dan489400\/#author"},"image":{"@type":"ImageObject","url":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/bss_psuedo.png","@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#mainImage","width":853,"height":470},"primaryImageOfPage":{"@id":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/#mainImage"},"datePublished":"2019-03-13T18:25:37+00:00","dateModified":"2021-07-01T09:41:23+01:00"},{"@type":"WebSite","@id":"https:\/\/www.0ffset.net\/#website","url":"https:\/\/www.0ffset.net\/","name":"0ffset Training Solutions","description":"Practical and Affordable Cyber Security Training","inLanguage":"en-GB","publisher":{"@id":"https:\/\/www.0ffset.net\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<script src='//cdn.cookie-script.com/s/f7880085be5f53685c89aa7e1abba794.js' id='cookie_script-js'></script><link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Feed" href="https://www.0ffset.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Comments Feed" href="https://www.0ffset.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="0ffset Training Solutions &raquo; Analysing ISFB &#8211; The First Loader Comments Feed" href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.0ffset.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.4.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://www.0ffset.net/wp-includes/css/dist/block-library/style.min.css?ver=6.4.2' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.8.5' type='text/css' media='all' />
<link rel='stylesheet' id='woocommerce-layout-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce-layout.css?ver=8.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='woocommerce-smallscreen-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce-smallscreen.css?ver=8.4.0' type='text/css' media='only screen and (max-width: 768px)' />
<link rel='stylesheet' id='woocommerce-general-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/woocommerce.css?ver=8.4.0' type='text/css' media='all' />
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel='stylesheet' id='engitech-fonts-css' href='https://fonts.googleapis.com/css?family=Montserrat%3A100%2C100i%2C200%2C200i%2C300%2C300i%2C400%2C400i%2C500%2C500i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CNunito+Sans%3A200%2C200i%2C300%2C300i%2C400%2C400i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/bootstrap.css?ver=4.0' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-awesome-font-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/font-awesome.min.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-flaticon-font-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/flaticon.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='slick-slider-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/slick.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='slick-theme-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/slick-theme.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='magnific-popup-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/magnific-popup.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-style-css' href='https://www.0ffset.net/wp-content/themes/engitech/style.css?ver=1.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='simple-likes-public-css-css' href='https://www.0ffset.net/wp-content/themes/engitech/inc/backend/css/simple-likes-public.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-preload-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/royal-preload.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-woocommerce-style-css' href='https://www.0ffset.net/wp-content/themes/engitech/css/woocommerce.css?ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/eicons/css/elementor-icons.min.css?ver=5.25.0' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-frontend-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/css/frontend.min.css?ver=3.18.3' type='text/css' media='all' />
<link rel='stylesheet' id='swiper-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/swiper/css/swiper.min.css?ver=5.3.6' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-12-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-12.css?ver=1703230940' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-pro-css' href='https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/css/frontend.min.css?ver=3.18.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-7991-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-7991.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='engitech-child-style-css' href='https://www.0ffset.net/wp-content/themes/ChildTheme/style.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='eael-general-css' href='https://www.0ffset.net/wp-content/plugins/essential-addons-for-elementor-lite/assets/front-end/css/view/general.min.css?ver=5.9.3' type='text/css' media='all' />
<link rel='stylesheet' id='google-fonts-1-css' href='https://fonts.googleapis.com/css?family=Roboto%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CRoboto+Slab%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CPoppins%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7COpen+Sans%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic%7CFjalla+One%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;display=auto&#038;ver=6.4.2' type='text/css' media='all' />
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/wp-polyfill-inert.min.js?ver=3.1.2" id="wp-polyfill-inert-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.14.0" id="regenerator-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/hooks.min.js?ver=c6aec9a8d4e5a5d543a1" id="wp-hooks-js"></script>
<script type="text/javascript" src="https://stats.wp.com/w.js?ver=202401" id="woo-tracks-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/jquery-blockui/jquery.blockUI.min.js?ver=2.7.0-wc.8.4.0" id="jquery-blockui-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="wc-add-to-cart-js-extra">
/* <![CDATA[ */
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%","i18n_view_cart":"View basket","cart_url":"https:\/\/www.0ffset.net\/cart\/","is_cart":"","cart_redirect_after_add":"no"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/add-to-cart.min.js?ver=8.4.0" id="wc-add-to-cart-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/js-cookie/js.cookie.min.js?ver=2.1.4-wc.8.4.0" id="js-cookie-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="woocommerce-js-extra">
/* <![CDATA[ */
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?wc-ajax=%%endpoint%%"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/woocommerce.min.js?ver=8.4.0" id="woocommerce-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="simple-likes-public-js-js-extra">
/* <![CDATA[ */
var simpleLikes = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","like":"Like","unlike":"Unlike"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/inc/backend/js/simple-likes-public.js?ver=0.5" id="simple-likes-public-js-js"></script>
<link rel="https://api.w.org/" href="https://www.0ffset.net/wp-json/" /><link rel="alternate" type="application/json" href="https://www.0ffset.net/wp-json/wp/v2/posts/3229" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.0ffset.net/xmlrpc.php?rsd" />
<link rel='shortlink' href='https://www.0ffset.net/?p=3229' />
<link rel="alternate" type="application/json+oembed" href="https://www.0ffset.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0ffset.net%2Freverse-engineering%2Fmalware-analysis%2Fanalysing-isfb-loader%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.0ffset.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.0ffset.net%2Freverse-engineering%2Fmalware-analysis%2Fanalysing-isfb-loader%2F&#038;format=xml" />
<!-- HFCM by 99 Robots - Snippet # 2: Google Search Console -->
<meta name="google-site-verification" content="GiKrV-8gpS5ome6djZo40nVLsbGQoZAn1N6UYY2qwJ0" />
<!-- /end HFCM by 99 Robots -->
<!-- HFCM by 99 Robots - Snippet # 5: Google Analytics -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YMWBZT97CQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YMWBZT97CQ');
</script>
<!-- /end HFCM by 99 Robots -->
<style type="text/css">
        /****Main Color****/

        	/*Background Color*/
            .bg-primary,
            .octf-btn,
            .octf-btn.octf-btn-second:hover, .octf-btn.octf-btn-second:focus,
            .main-navigation > ul > li:before,
            .cart-icon .count,
            .post-box .post-cat a,
            .post-box .btn-play:hover i,
            .page-pagination li span, .page-pagination li a:hover,
            .blog-post .share-post a,
            .post-nav a:before,
            .widget-area .widget .widget-title:before,
            .search-form .search-submit,
            .icon-box-s2.s2:after,
            .tech-box:hover,
            .ot-image-box:after,
            .service-box .icon-main,
            .serv-box-2:hover .icon-main,
            .project-slider .projects-box:hover .portfolio-info .btn-link,
            .project-slider .slick-arrow:hover,
            .ot-counter h6:before,
            .ot-progress .progress-bar,
            .video-popup a:hover,
            .ot-tabs .tab-link,
            .ot-tabs .tab-link.current, .ot-tabs .tab-link:hover,
            .ot-industries .indus-item .item-inner .overlay:after,
            .mc4wp-form-fields .subscribe-inner-form .subscribe-btn-icon{background:#0f4e73;}

            /*Border Color*/
            .post-box .btn-play:hover:before, .post-box .btn-play:hover:after,
            .page-pagination li span, .page-pagination li a:hover,
            .tech-box:hover,
            .video-popup a:hover span{border-color:#0f4e73;}

            /*Color*/
            .text-primary,
            .slick-arrow:not(.slick-disabled):hover,
            .btn-details,
            .btn-details:visited,
            a:hover, a:focus, a:active,
            .header-topbar a:hover,
            .extra-text a,
            .header-style-3 .header-topbar a:hover,
            .main-navigation ul > li > a:hover,
            .main-navigation ul li li a:before,
            .main-navigation ul li li a:hover,.main-navigation ul ul li.current-menu-item > a,.main-navigation ul ul li.current-menu-ancestor > a,
            .main-navigation ul > li.menu-item-has-children > a:hover:after,
            .octf-btn-cta .contact-header i,
            .header-style-3 .main-navigation ul.menu > li > a:hover,.header-style-3 .octf-btn-cta .octf-cta-icons i:hover,
            .header_mobile .mobile_nav .mobile_mainmenu li li a:hover,.header_mobile .mobile_nav .mobile_mainmenu ul > li > ul > li.current-menu-ancestor > a,
            .header_mobile .mobile_nav .mobile_mainmenu > li > a:hover, .header_mobile .mobile_nav .mobile_mainmenu > li.current-menu-item > a,.header_mobile .mobile_nav .mobile_mainmenu > li.current-menu-ancestor > a,
            .page-header,
            .page-header .breadcrumbs li:before,
            .post-box .entry-meta a:hover,
            .post-box .link-box a:hover,
            .post-box .btn-play i,
            .post-box .btn-readmore > a,
            .blog-post .author-bio .author-info .author-socials a:hover,
            .drop-cap span,
            .comments-area .comment-item .comment-meta .comment-reply-link,
            .comment-respond .comment-reply-title small a:hover,
            .icon-box-s2 .content-box h5 a:hover,
            .project-slider .projects-box .portfolio-info .btn-link i,
            .contact-info i,
            .ot-accordions .acc-item .acc-toggle:hover,
            .ot-accordions .acc-item.current .acc-toggle,
            .ot-accordions .acc-item.current .acc-toggle i,
            .ot-counter h6,
            .ot-counter2 .s-num,
            .team-wrap .team-social a:hover,
            .ot-pricing-table .inner-table h2,
            .ot-pricing-table .inner-table .details ul li.active:before,
            .ot-countdown li.seperator,
            .video-popup a,
            .dc-text .elementor-drop-cap span,
            .footer-menu ul li a:hover,
            .mc4wp-form-fields .subscribe-inner-form .subscribe-btn-icon:hover,
            #back-to-top{color: #0f4e73;}

            .wpcf7 .main-form{background-image: linear-gradient(90deg,#0f4e73 0%,#7141b1 100%);}
			

		/****Second Color****/
        
		    /*Background Color*/
                  .bg-second,
                  .octf-btn:hover, .octf-btn:focus,
                  .octf-btn.octf-btn-second,
                  .octf-btn.octf-btn-second:visited,
                  .post-box .post-cat a:hover,
                  .blog-post .tagcloud a:hover,
                  .widget .tagcloud a:hover,
                  .search-form .search-submit:hover,
                  .icon-box-s1 .line-box:after,
                  .project_filters li a:after,
                  .ot-tabs .tab-link:hover, .ot-tabs .tab-link:focus,
                  .wpcf7 .main-form button:hover{background:#7141b1;}

                  /*Color*/
                  blockquote:before,
                  .text-second,
                  .slick-dots li.slick-active button:before,
                  a,
                  a:visited,
                  .post-box .entry-meta,
                  .post-box .entry-meta a,
                  .post-box .link-box i,
                  .post-box .quote-box i,
                  .comment-form .logged-in-as a:hover,
                  .widget-area .widget ul:not(.recent-news) > li a:hover,
                  .widget-area .widget_categories ul li a:before,.widget-area .widget_product_categories ul li a:before,.widget-area .widget_archive ul li a:before,
                  .widget-area .widget_categories ul li a:hover,.widget-area .widget_product_categories ul li a:hover,.widget-area .widget_archive ul li a:hover,
                  .widget-area .widget_categories ul li a:hover + span,.widget-area .widget_product_categories ul li a:hover + span,.widget-area .widget_archive ul li a:hover + span,
                  .widget .recent-news h6 a:hover,
                  .ot-heading > span,
                  .icon-box-s1 .icon-main,
                  .icon-box-s2.s1 .icon-main, .icon-box-s2.s3 .icon-main,
                  .icon-box-s2.s2 .icon-main,
                  .serv-box .content-box ul li a:before,
                  .serv-box .content-box ul li:hover a, .serv-box .content-box ul li.active a,
                  .project_filters li a:hover, .project_filters li a.selected,
                  .ot-pricing-table .octf-btn:hover,
                  .dc-text.dc-text-second .elementor-drop-cap span{color: #7141b1;}

			</style><style type="text/css">	
            /**Main**/
                .woocommerce ul.products li.product .price .woocommerce-Price-amount, .woocommerce-page ul.products li.product .price .woocommerce-Price-amount,
                .woocommerce .woocommerce-Price-amount,
				.woocommerce div.product p.price,
				.woocommerce div.product span.price{
				  color: #0f4e73;
				}

				.woocommerce ul.products li.product .added_to_cart, .woocommerce-page ul.products li.product .added_to_cart,
				.woocommerce-mini-cart__buttons a.button.wc-forward,
				.woocommerce .widget_price_filter .price_slider_amount button.button,
				.woocommerce #respond input#submit.alt:hover, .woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover, .woocommerce input.button.alt:hover,.woocommerce #respond input#submit:hover, .woocommerce a.button:hover,.woocommerce input.button:hover, .woocommerce button.button.alt.disabled:hover,
				.woocommerce button.button,
				.woocommerce div.product .woocommerce-tabs ul.tabs li a:hover,
				.woocommerce div.product .woocommerce-tabs ul.tabs li.active a{
					background-color: #0f4e73;
				}

			/**Second**/

                .woocommerce table.shop_table td.product-name a:hover,
				.woocommerce-message:before,
				.woocommerce-info:before,
				.woocommerce ul.product_list_widget li a:not(.remove):hover,
				.woocommerce .woocommerce-widget-layered-nav-list li a:hover{
					color: #7141b1;
				}
				.woocommerce-mini-cart__buttons a.button.checkout{
					border-color: #7141b1;
				}
				.woocommerce-message,
				.woocommerce-info{
				  	border-top-color: #7141b1;
				}
				.woocommerce ul.products li.product .added_to_cart:hover, .woocommerce-page ul.products li.product .added_to_cart:hover,
				.woocommerce-mini-cart__buttons a.button.wc-forward:hover,
				.woocommerce-mini-cart__buttons a.button.checkout:hover,
				.woocommerce .widget_price_filter .ui-slider .ui-slider-range, .woocommerce .widget_price_filter .ui-slider .ui-slider-handle,
				.woocommerce #respond input#submit.alt, .woocommerce a.button.alt,.woocommerce button.button.alt, .woocommerce input.button.alt,.woocommerce #respond input#submit, .woocommerce a.button,.woocommerce input.button, .woocommerce button.button.alt.disabled,
				.woocommerce button.button:hover {
					background-color: #7141b1;
				}

			</style>	<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
	<meta name="generator" content="Elementor 3.18.3; features: e_dom_optimization, e_optimized_assets_loading, additional_custom_breakpoints, block_editor_assets_optimize, e_image_loading_optimization; settings: css_print_method-external, google_font-enabled, font_display-auto">
<style class="wpcode-css-snippet">.page-id-2616 .primary-sidebar { display: none; }</style><meta name="generator" content="Powered by Slider Revolution 6.6.7 - responsive, Mobile-Friendly Slider Plugin for WordPress with comfortable drag and drop interface." />
<link rel="icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-150x150.png" sizes="32x32" />
<link rel="icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" />
<meta name="msapplication-TileImage" content="https://www.0ffset.net/wp-content/uploads/2021/05/cropped-z2a_logo-300x300.png" />
<script>function setREVStartSize(e){
			//window.requestAnimationFrame(function() {
				window.RSIW = window.RSIW===undefined ? window.innerWidth : window.RSIW;
				window.RSIH = window.RSIH===undefined ? window.innerHeight : window.RSIH;
				try {
					var pw = document.getElementById(e.c).parentNode.offsetWidth,
						newh;
					pw = pw===0 || isNaN(pw) || (e.l=="fullwidth" || e.layout=="fullwidth") ? window.RSIW : pw;
					e.tabw = e.tabw===undefined ? 0 : parseInt(e.tabw);
					e.thumbw = e.thumbw===undefined ? 0 : parseInt(e.thumbw);
					e.tabh = e.tabh===undefined ? 0 : parseInt(e.tabh);
					e.thumbh = e.thumbh===undefined ? 0 : parseInt(e.thumbh);
					e.tabhide = e.tabhide===undefined ? 0 : parseInt(e.tabhide);
					e.thumbhide = e.thumbhide===undefined ? 0 : parseInt(e.thumbhide);
					e.mh = e.mh===undefined || e.mh=="" || e.mh==="auto" ? 0 : parseInt(e.mh,0);
					if(e.layout==="fullscreen" || e.l==="fullscreen")
						newh = Math.max(e.mh,window.RSIH);
					else{
						e.gw = Array.isArray(e.gw) ? e.gw : [e.gw];
						for (var i in e.rl) if (e.gw[i]===undefined || e.gw[i]===0) e.gw[i] = e.gw[i-1];
						e.gh = e.el===undefined || e.el==="" || (Array.isArray(e.el) && e.el.length==0)? e.gh : e.el;
						e.gh = Array.isArray(e.gh) ? e.gh : [e.gh];
						for (var i in e.rl) if (e.gh[i]===undefined || e.gh[i]===0) e.gh[i] = e.gh[i-1];
											
						var nl = new Array(e.rl.length),
							ix = 0,
							sl;
						e.tabw = e.tabhide>=pw ? 0 : e.tabw;
						e.thumbw = e.thumbhide>=pw ? 0 : e.thumbw;
						e.tabh = e.tabhide>=pw ? 0 : e.tabh;
						e.thumbh = e.thumbhide>=pw ? 0 : e.thumbh;
						for (var i in e.rl) nl[i] = e.rl[i]<window.RSIW ? 0 : e.rl[i];
						sl = nl[0];
						for (var i in nl) if (sl>nl[i] && nl[i]>0) { sl = nl[i]; ix=i;}
						var m = pw>(e.gw[ix]+e.tabw+e.thumbw) ? 1 : (pw-(e.tabw+e.thumbw)) / (e.gw[ix]);
						newh =  (e.gh[ix] * m) + (e.tabh + e.thumbh);
					}
					var el = document.getElementById(e.c);
					if (el!==null && el) el.style.height = newh+"px";
					el = document.getElementById(e.c+"_wrapper");
					if (el!==null && el) {
						el.style.height = newh+"px";
						el.style.display = "block";
					}
				} catch(e){
					console.log("Failure at Presize of Slider:" + e)
				}
			//});
		  };</script>
		<style type="text/css" id="wp-custom-css">
			.header-clone{
	height: 100px!important;
}
.elementor-widget-wrap>.elementor-element.btn-inline{
	display: inline-block;
	width: auto;
}
.elementor-3872 .elementor-element.elementor-element-4cff60df .elementor-icon-list-item span, .elementor-3872 .elementor-element.elementor-element-5e3bed1f .elementor-icon-list-item span {
    line-height: 16px;
}

.page-id-3872 #back-to-top{
	color: #656AE5;
}
.page-id-4858 #back-to-top{
	color: #53E79C;
}
.page-id-4899 #back-to-top{
	color: #35d3c9;
}


.post-box .entry-media img{
	max-width: 100%;
	object-fit: cover;
	height: 245px;
}



.post-box .entry-media .post-cat {
	left: 10px;
}

@media only screen and (max-width: 768px) {
	.post-cat a{
    margin-bottom: 10px;
  }
}

.post-box {
	margin-bottom: 30px;
}

.entry-content {
	padding: 90px 0 110px;
}


.blog-post .wp-post-image {
display: none;
}

.cartflows_step-template-default .primary-sidebar {
   display: none;
}		</style>
		<style id="kirki-inline-styles">.page-header{background-image:url("https://www.0ffset.net/wp-content/uploads/2022/09/emile-perron-xrVDYZRGdw4-unsplash.png");}#royal_preloader.royal_preloader_logo .royal_preloader_percentage{font-family:Roboto;font-size:13px;font-weight:400;letter-spacing:2px;line-height:40px;text-align:center;text-transform:none;}@media (max-width: 767px){}@media (min-width: 768px) and (max-width: 1024px){}@media (min-width: 1024px){}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}/* cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu72xMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu5mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7mxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* vietnamese */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7WxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu7GxMKTU1Kvnz.woff) format('woff');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://www.0ffset.net/wp-content/fonts/roboto/KFOmCnqEu92Fr1Mu4mxMKTU1Kg.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}</style></head>

<body class="post-template-default single single-post postid-3229 single-format-standard theme-engitech woocommerce-no-js royal_preloader woocommerce-active elementor-default elementor-kit-12 engitech-theme-ver-1.8.1 wordpress-version-6.4.2">
<div id="royal_preloader" data-width="346" data-height="153" data-url="https://www.0ffset.net/wp-content/uploads/2022/07/0ffset-rounded-01.png" data-color="#0a0f2b" data-bgcolor="#fff"></div><div id="page" class="site">
	<!-- #site-header-open -->
<header id="site-header" class="site-header header-static">

    <!-- #header-desktop-open -->
    <div class="header-desktop">		<div data-elementor-type="wp-post" data-elementor-id="2840" class="elementor elementor-2840" data-elementor-post-type="ot_header_builders">
									<section class="elementor-section elementor-top-section elementor-element elementor-element-65c14b10 elementor-section-content-middle ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="65c14b10" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-581decff ot-flex-column-vertical" data-id="581decff" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-6c62b145 elementor-shape-square elementor-grid-4 e-grid-align-left elementor-widget elementor-widget-social-icons" data-id="6c62b145" data-element_type="widget" data-widget_type="social-icons.default">
				<div class="elementor-widget-container">
					<div class="elementor-social-icons-wrapper elementor-grid">
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-twitter elementor-repeater-item-4bf2890" href="https://twitter.com/0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Twitter</span>
						<i class="fab fa-twitter"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-linkedin elementor-repeater-item-a79d483" href="https://www.linkedin.com/company/0ffset/" target="_blank">
						<span class="elementor-screen-only">Linkedin</span>
						<i class="fab fa-linkedin"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-youtube elementor-repeater-item-e6c93ca" href="https://www.youtube.com/channel/UCy21puSd9R3C5Xn46YI32_g" target="_blank">
						<span class="elementor-screen-only">Youtube</span>
						<i class="fab fa-youtube"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-mastodon elementor-repeater-item-fc77638" href="https://infosec.exchange/@0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Mastodon</span>
						<i class="fab fa-mastodon"></i>					</a>
				</span>
					</div>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-1ca041d7 ot-column-items-center ot-flex-column-vertical" data-id="1ca041d7" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-28dcb03 elementor-icon-list--layout-inline elementor-align-right elementor-list-item-link-full_width elementor-widget elementor-widget-icon-list" data-id="28dcb03" data-element_type="widget" data-widget_type="icon-list.default">
				<div class="elementor-widget-container">
					<ul class="elementor-icon-list-items elementor-inline-items">
							<li class="elementor-icon-list-item elementor-inline-item">
										<span class="elementor-icon-list-text"></span>
									</li>
								<li class="elementor-icon-list-item elementor-inline-item">
											<span class="elementor-icon-list-icon">
							<i aria-hidden="true" class="fas fa-map-pin"></i>						</span>
										<span class="elementor-icon-list-text">5 The Quadrant, Coventry</span>
									</li>
								<li class="elementor-icon-list-item elementor-inline-item">
											<a href="mailto:daniel@0ffset.net">

												<span class="elementor-icon-list-icon">
							<i aria-hidden="true" class="fas fa-envelope"></i>						</span>
										<span class="elementor-icon-list-text">contact@0ffset.net</span>
											</a>
									</li>
						</ul>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
				<section class="elementor-section elementor-top-section elementor-element elementor-element-4994a43 is-fixed ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="4994a43" data-element_type="section">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-2a40db59 ot-column-items-center ot-flex-column-vertical" data-id="2a40db59" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-7b08551e elementor-widget elementor-widget-ilogo" data-id="7b08551e" data-element_type="widget" data-widget_type="ilogo.default">
				<div class="elementor-widget-container">
						
	    	<div class="the-logo">
				<a href="https://www.0ffset.net/">
					<img src="https://www.0ffset.net/wp-content/uploads/2022/11/0ffset-rounded-01-1-1.png" alt="0ffset Training Solutions">
				</a>			        
		    </div>
		    
	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-57f4f99d ot-flex-column-vertical" data-id="57f4f99d" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-1ab58a34 elementor-widget elementor-widget-imenu" data-id="1ab58a34" data-element_type="widget" data-widget_type="imenu.default">
				<div class="elementor-widget-container">
						<nav id="site-navigation" class="main-navigation ">			
				<ul id="primary-menu" class="menu"><li id="menu-item-2315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2315"><a href="https://www.0ffset.net/">Home</a></li>
<li id="menu-item-6372" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6372"><a href="https://www.0ffset.net/blog/">Blog</a></li>
<li id="menu-item-6821" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-6821"><a href="https://www.0ffset.net/training/">Training</a>
<ul class="sub-menu">
	<li id="menu-item-7799" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7799"><a href="https://www.0ffset.net/training/zero2auto/">Zero2Automated</a></li>
	<li id="menu-item-7800" class="menu-item menu-item-type-post_type menu-item-object-e-landing-page menu-item-7800"><a href="https://www.0ffset.net/beginner/">The Beginner Course</a></li>
</ul>
</li>
<li id="menu-item-2015" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2015"><a href="https://www.0ffset.net/about-us/">Company</a></li>
<li id="menu-item-6374" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6374"><a href="https://www.0ffset.net/contact-us/">Contact Us</a></li>
</ul>			</nav>
	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-top-column elementor-element elementor-element-336223fd ot-flex-column-horizontal" data-id="336223fd" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-4c593 elementor-widget elementor-widget-isearch" data-id="4c593" data-element_type="widget" data-widget_type="isearch.default">
				<div class="elementor-widget-container">
						
	    	<div class="octf-search octf-btn-cta">
				<div class="toggle-search octf-cta-icons">
					<i class="flaticon-search"></i>
				</div>
				<!-- Form Search on Header -->
				<div class="h-search-form-field">
					<div class="h-search-form-inner">
						<form role="search" method="get" class="search-form" action="https://www.0ffset.net/" >
    <label><span class="screen-reader-text">Search for:</span>
    <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /></label>
	<button type="submit" class="search-submit"><i class="flaticon-search"></i></button>
    </form>					</div>									
				</div>
			</div>
		    
	    		</div>
				</div>
					</div>
		</div>
							</div>
		</section>
							</div>
		</div>    <!-- #header-desktop-close -->

    <!-- #header-mobile-open -->
    <div class="header_mobile">
	<div class="container">
		<div class="mlogo_wrapper clearfix">
	        <div class="mobile_logo">
				<a href="https://www.0ffset.net/">
					<img src="https://www.0ffset.net/wp-content/themes/engitech/images/logo.svg" alt="0ffset Training Solutions">
				</a>
	    	</div>
	        <div id="mmenu_toggle">
		        <button></button>
		    </div>
		    	    </div>
	    <div class="mmenu_wrapper">		
			<div class="mobile_nav collapse">
				<div class="mobile_mainmenu"><ul>
<li class="page_item page-item-23"><a href="https://www.0ffset.net/about/">About</a></li>
<li class="page_item page-item-1579"><a href="https://www.0ffset.net/about-us/">About Us</a></li>
<li class="page_item page-item-5 current_page_parent"><a href="https://www.0ffset.net/blog/">Blog</a></li>
<li class="page_item page-item-2615"><a href="https://www.0ffset.net/cart/">Cart</a></li>
<li class="page_item page-item-2616"><a href="https://www.0ffset.net/checkout/">Checkout</a></li>
<li class="page_item page-item-1476"><a href="https://www.0ffset.net/coming-soon-2/">Coming Soon</a></li>
<li class="page_item page-item-1370"><a href="https://www.0ffset.net/contact-us/">Contact Us</a></li>
<li class="page_item page-item-2877"><a href="https://www.0ffset.net/corporate/">Corporate/Bulk Orders</a></li>
<li class="page_item page-item-2642"><a href="https://www.0ffset.net/courses/">Courses</a></li>
<li class="page_item page-item-1390"><a href="https://www.0ffset.net/faqs/">FAQs</a></li>
<li class="page_item page-item-2274"><a href="https://www.0ffset.net/">Home</a></li>
<li class="page_item page-item-2617"><a href="https://www.0ffset.net/my-account/">My account</a></li>
<li class="page_item page-item-7264"><a href="https://www.0ffset.net/order-cancelled/">Order Cancelled</a></li>
<li class="page_item page-item-5602"><a href="https://www.0ffset.net/privacy-policy/">Privacy Policy</a></li>
<li class="page_item page-item-2614"><a href="https://www.0ffset.net/shop/">Shop</a></li>
<li class="page_item page-item-5608"><a href="https://www.0ffset.net/terms-and-conditions/">Terms And Conditions</a></li>
<li class="page_item page-item-3038 page_item_has_children"><a href="https://www.0ffset.net/training/">Training</a>
<ul class='children'>
	<li class="page_item page-item-2451"><a href="https://www.0ffset.net/training/zero2auto/">Zero2Automated: Advanced Malware Analysis</a></li>
</ul>
</li>
</ul></div>
			</div>   	
	    </div>
    </div>
</div>    <!-- #header-mobile-close -->

</header>
<!-- #site-header-close -->
<!-- #side-panel-open -->
<!-- #side-panel-close -->
	<div id="content" class="site-content">
	        
            <div class="page-header flex-middle"  style="background-image: url(https://www.0ffset.net/wp-content/uploads/2022/09/emile-perron-xrVDYZRGdw4-unsplash.png);" >
                <div class="container">
                    <div class="inner ">
                                                    <h1 class="page-title">Blog Post</h1>
                        <ul id="breadcrumbs" class="breadcrumbs none-style"><li><a href="https://www.0ffset.net">Home</a></li><li><a href="https://www.0ffset.net/blog/">Blog</a></li><li><a href="https://www.0ffset.net/category/reverse-engineering/malware-analysis/">Malware Analysis</a></li><li class="active">Analysing ISFB &#8211; The First Loader</li></ul>    
                            </div>
                </div>
            </div>
        	<div class="entry-content">
		<div class="container">
			<div class="row">
				<div id="primary" class="content-area col-lg-9 col-md-9 col-sm-12 col-xs-12">
					<main id="main" class="site-main">
						
					
 

<article id="post-3229" class="blog-post post-box post-3229 post type-post status-publish format-standard has-post-thumbnail hentry category-malware-analysis">
    
            <div class="entry-media">
                <div class="post-cat"><span class="posted-in"><a href="https://www.0ffset.net/category/reverse-engineering/malware-analysis/" rel="category tag">Malware Analysis</a></span></div>                <img fetchpriority="high" width="853" height="470" src="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo.png 853w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-600x331.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-300x165.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-768x423.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-720x397.png 720w" sizes="(max-width: 853px) 100vw, 853px" />            </div>
            
            <div class="inner-post">
        <header class="entry-header">

                        <div class="entry-meta">
                <span class="posted-on">_ <a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" rel="bookmark"><time class="entry-date published" datetime="2019-03-13T18:25:37+00:00">13th March 2019</time></a></span><span class="byline">_ <a class="url fn n" href="https://www.0ffset.net/author/dan489400/">0verfl0w_</a></span><span class="comment-num">_ <a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/#comments">2 Comments</a></span>            </div><!-- .entry-meta -->
            
            <h3 class="entry-title">Analysing ISFB &#8211; The First Loader</h3>
        </header><!-- .entry-header -->

        <div class="entry-summary">

            
<p class="has-very-dark-gray-color has-text-color">I&#8217;m finally getting round to writing this post &#8211; for the past few months I have been analysing different versions of ISFB/Ursnif/Gozi to gain a deeper understanding in the functionality of this specific malware. In this post, I will be detailing how to unpack and then analyse the first stage loader executable, and then use that information to extract the second stage loader DLL, known as <strong>rpcrt4.dll</strong>, which we will analyse in a later post. </p>



<p class="has-very-dark-gray-color has-text-color">In a nutshell, ISFB is a banking trojan used to steal financial information from unsuspecting victims. It utilizes several methods to do so, from stealing saved passwords to injecting JavaScript into predetermined websites. This specific sample of ISFB is version 2.14.60, and can be attributed to a specific ISFB v2 group based on the infection routine used &#8211; specifically the macros that execute a powershell command that is simply Base64 encoded. The group behind this sample also reuse the encryption key for different campaigns (the default key), making their samples easily identifiable compared to other large groups utilizing ISFB. I have been unable to locate specific threat actor names, and as a result, I will be referring to this group as <strong>Group&nbsp;53</strong>, based off of <a aria-label="this (opens in a new tab)" rel="noreferrer noopener" href="https://www.botconf.eu/wp-content/uploads/2018/12/2018-J-Wyke-Tracking-actors-through-their-webinjects-.pdf" target="_blank"><strong>this</strong></a> presentation by FireEye.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="1024" height="402" src="https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-1024x402.png" alt="" class="wp-image-4546" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-1024x402.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-600x235.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-300x118.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-768x301.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram-720x283.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/Untitled-Diagram.png 1241w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Similarly to other groups utilizing ISFB for financial gain or simply as a stager, <strong>Group&nbsp;53</strong> gains a foothold on the target&#8217;s system using a malicious Word document containing embedded macros, which in turn lead to the execution of a Powershell script responsible for downloading the first stage executable. Certain groups &#8220;partner&#8221; with other groups that are able to distribute malicious spam (malspam) on a large scale, such as the group behind Hancitor. This could potentially result in larger infection numbers, compared to those groups that are relying on their own distribution methods. I would assume &#8220;renting&#8221; a spot from the group behind Hancitor would be quite expensive as a result of its enormous outreach, which is why a lot of groups, including <strong>Group&nbsp;53</strong>, have to distribute their own malicious documents. I will be focusing on the unpacker executable and the first stage executable loader in this post, rather than the Word Document itself, as its functionality is quite straightforward. As always, the samples have been uploaded to <strong><a href="https://beta.virusbay.io/" target="_blank" rel="noreferrer noopener" aria-label="VirusBay (opens in a new tab)">VirusBay</a></strong>. So, let&#8217;s crack it open! </p>



<p class="has-very-dark-gray-color has-text-color"><strong>But</strong>, before I do I&#8217;d like to thank all of the people who helped me out in analysing the different samples of ISFB, including <strong><a href="https://twitter.com/VK_Intel" target="_blank" rel="noreferrer noopener" aria-label="@VK_Intel (opens in a new tab)">@VK_Intel</a></strong>, <strong><a rel="noreferrer noopener" aria-label="@Nazywam (opens in a new tab)" href="https://twitter.com/nazywam" target="_blank">@Nazywam</a></strong>, and <strong><a rel="noreferrer noopener" aria-label="@Maciekkotowicz (opens in a new tab)" href="https://twitter.com/maciekkotowicz" target="_blank">@Maciekkotowicz</a></strong> (for his great papers on ISFB). Anyway, let&#8217;s get on with the reversing!</p>



<p class="has-text-align-center"><strong>Part 1: Unpacking the first stage executable</strong></p>



<pre class="wp-block-code"><code>MD5 of First Stage Executable: bc72604061732a9280edbe5e2c1db33b</code></pre>



<p class="has-very-dark-gray-color has-text-color">Typically I would open it up in PEStudio or perhaps perform some static analysis, however at this point I have already determined that it is highly likely to be a sample of ISFB, based on the Word Macro, although we still want to unpack the first EXE to be 100% sure that it is in fact ISFB. First, let&#8217;s open it in IDA to try and find a call (or jmp) to a memory region or register &#8211; this could possibly be a call to the unpacked stage.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="1024" height="539" src="https://www.0ffset.net/wp-content/uploads/2021/06/ida-1024x539.png" alt="" class="wp-image-4547" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/ida-1024x539.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/ida-600x316.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/ida-300x158.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/ida-768x405.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/ida-720x379.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/ida.png 1310w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">It definitely looks like there is some unpacking going on here (based on the length and intricate flow shown in the image above), and upon looking at the strings in the binary we can see that there aren&#8217;t many that are legible, or meaningful. Normally when unpacking a sample, I start at the bottom and work my way up &#8211; most unpackers exit once the file has been unpacked &#8211; although this depends. In this case, the unpacker performs <strong>Self-Injection</strong>, and overwrites itself with the unpacked file. This is not unusual for ISFB, and if you analyse some other samples (even from other groups), you will most likely find this occurring too. This means that the unpacker does not exit until the unpacked file does, although we can assume that the last function called will transfer execution over to the unpacked executable.</p>



<p class="has-very-dark-gray-color has-text-color">In this specific file, there is no call or jmp to a register or memory region &#8211; however, there is a call to <strong>loc_42A880</strong>. It&#8217;s the last call in WinMain, so as mentioned before, this function is most likely responsible for transferring execution over to the EXE.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/loc-1024x516.png" alt="" class="wp-image-4549" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/loc-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/loc-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/loc-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/loc-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/loc-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/loc.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">When we jump into this function, it is clear that it hasn&#8217;t been converted to a function yet, and so we are unable to view it as a graph. Sometimes, you are able to turn it into a function by pressing &#8220;P&#8221;, although it doesn&#8217;t seem to work in this case. So, we will have to deal with the text mode. It is definitely possible to follow the jumps and conditional jumps to try and find the call or jump to our executable, but we can speed this up a bit. Locate a <strong>call</strong> instruction and click it &#8211; this should highlight the instruction and other instances of it. This doesn&#8217;t work for every sample, but it is worth a try to speed things up. Simply scroll down or up from where you are, looking for other instances of <strong>call</strong>. The last call I located took <strong>lpAddress</strong> as the first argument, so let&#8217;s take a look at this. <strong>lpAddress</strong> indicates that it contains an address to a region of memory, meaning it could contain the address of our unpacked executable.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/interesting-1024x516.png" alt="" class="wp-image-4550" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/interesting-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Inside this function, if we jump straight to the end, we can see a call to <strong>ESI</strong>. Hit space to jump from the Graph view back to Text view in order to get the address of this call. This could be the call to our unpacked EXE, and so we need the address of it to view it in x32dbg and put a breakpoint on it.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-1024x516.png" alt="" class="wp-image-4552" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_call.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">So the memory address to this call is <strong>0x0042A653</strong>, so let&#8217;s now open this up in x32dbg and jump to this address. Simply push CTRL-G in x32dbg and type in <strong>0042A653</strong>, and then hit enter &#8211; this will jump to that address, allowing you to put a breakpoint on it. Whilst attempting to unpack a sample, I prefer to open up Process Hacker alongside it, so that if I put a breakpoint on the wrong address and the unpacked process executes, I can easily detect it, either through the <strong>Network</strong> tab or through the <strong>Processes</strong> tab.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-1024x516.png" alt="" class="wp-image-4553" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-600x302.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/x32dbg.png 1312w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p class="has-very-dark-gray-color has-text-color">Once the breakpoint has been hit, step into <strong>ESI </strong>and in this sample there is what seems to be a second unpacking &#8220;stage&#8221; &#8211; this code was not here originally, in fact if we try and view it in IDA, you will simply see a lot of question marks and the variable <strong>unk_58FC08</strong>. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-1024x516.png" alt="" class="wp-image-4555" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/stepped_in.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/unk-1024x516.png" alt="" class="wp-image-4556" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/unk-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/unk-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/unk-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/unk-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/unk-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/unk.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">As it is difficult to statically analyse this section without dumping it and opening it up in IDA, I will be jumping over functions, rather than stepping through them manually. This will also help to speed things up, but make sure your network adapter is not attached, as one of these functions may execute the executable. </p>



<p class="has-very-dark-gray-color has-text-color">In the GIF below, you can see there is some form of loop going on, with XOR being used to XOR a byte at the memory address stored in EAX, with the value in DL. You might also notice that the assembly is changing as each loop goes on &#8211; this is another example of the second unpacking stage. We can simply put a breakpoint on the jmp and then run the program until it hits it.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="600" height="144" src="https://www.0ffset.net/wp-content/uploads/2021/06/xor_loop.gif" alt="" class="wp-image-4558"/></figure></div>



<p class="has-very-dark-gray-color has-text-color">Once we follow the jump, we are met with several calls to <strong>[ebx+xxxxxx]</strong>. Each of these could jump to the unpacked EXE, however as we progress further on, it is clear that these are simply calls to Windows API functions. Notice the call to <strong>EDI</strong>? EDI is pointing to a function that dynamically imports these APIs so that they can be called by the unpacking stub. The result is stored in EAX, and as seen in the image below, this specific call imported the API <strong>RtlExitUserThread</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/import_api-1024x516.png" alt="" class="wp-image-4559" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/import_api-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/import_api-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/import_api-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/import_api-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/import_api-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/import_api.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Scrolling down a bit, we can see a <strong>jmp&nbsp;eax</strong>, so let&#8217;s put a breakpoint on that and run to it, and then follow the jump.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-1024x516.png" alt="" class="wp-image-4560" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_jmp.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">This jump takes us to a newly allocated region of memory, with more code. I didn&#8217;t want to examine each function, so I scrolled down until the <strong>ret</strong> instruction, and started examining the (<strong>local</strong> &#8211; not API calls) functions backwards. The last function did not seem likely to be the executable &#8220;executor&#8221;, as there was no call or jump instruction to a different region of memory, however the second last function had some calls to <strong>[ebp+14]</strong> and <strong>[ebp+C]</strong>, so let&#8217;s put a few breakpoints on those.</p>



<figure class="wp-block-image"><img decoding="async" src="https://www.0ffset.net/wp-content/uploads/2019/01/useful_func-1024x516.png" alt="" class="wp-image-1814"/></figure>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-1024x516.png" alt="" class="wp-image-4562" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/inside_function-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/inside_function.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">However, upon executing the program and hitting the breakpoint, it is clear that they are simply calling <strong>LoadLibrary</strong> and <strong>GetProcAddress</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/not_first-1024x516.png" alt="" class="wp-image-4563" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/not_first-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/not_first-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/not_first-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/not_first-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/not_first-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/not_first.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/not_second-1024x516.png" alt="" class="wp-image-4564" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/not_second-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/not_second-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/not_second-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/not_second-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/not_second-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/not_second.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Therefore, we can simply return from this function, as it is just importing API&#8217;s, which isn&#8217;t extremely important to us yet. After exiting the function, there are several calls to API&#8217;s, in particular <strong>VirtualProtect</strong>. <strong>VirtualProtect</strong> is responsible for changing the permissions/protection of different memory regions, so that they are readable, writable, or executable (can be one, two, or all three). In this case, we can see that <strong>VirtualProtect</strong> is being used to change the protection of the memory region at <strong>0x00406000</strong>, which is the <strong>.BSS</strong> section. As I mentioned before, this unpacker overwrites itself with the unpacked executable, so it is safe to say that we are extremely close to the unpacked EXE. We could dump it now, but there could be some extra unpacking going on, so let&#8217;s wait until we jump to the <strong>0x00400000</strong> memory region. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="501" src="https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-1024x501.png" alt="" class="wp-image-4566" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-1024x501.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-600x293.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-300x147.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-768x376.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there-720x352.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/very_likely_there.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">At this point, there isn&#8217;t much going on in the function, so we can simply put a breakpoint on the <strong>ret</strong> instruction and return from this function.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="523" src="https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-1024x523.png" alt="" class="wp-image-4567" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-1024x523.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-600x307.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-300x153.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-768x392.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit-720x368.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/bp_on_exit.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Upon exiting the function, you&#8217;ll notice the memory address is in the <strong>0x00401000</strong> region. This is the unpacked program! Now we can dump it out, so make sure you have Process Hacker open, although you can dump it from x32dbg.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="517" src="https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-1024x517.png" alt="" class="wp-image-4568" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-1024x517.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-768x388.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/back_to_entry.png 1312w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">To dump it from memory, simply double click the process in Process Hacker, and right click the <strong>0x400000</strong> region of memory, and select <strong>Save</strong>. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="515" src="https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-1024x515.png" alt="" class="wp-image-4570" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-1024x515.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-600x302.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-768x386.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/dump-1-720x362.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/dump-1.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">Now we can open it up in PEBear and unmap the dumped file. Upon doing so, you can see that the imports have not been successfully resolved by PEBear. This is why we need to unmap the file. When a program is about to be executed, it needs to be mapped in memory, so that it can be interpreted correctly. Therefore, PEBear is unable to resolve the imports until we unmap it. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-1024x516.png" alt="" class="wp-image-4571" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/err_imp-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/err_imp.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">To do so, we simply change the <strong>Raw&nbsp;Addr.</strong> so that it matches the <strong>Virtual&nbsp;Addr.</strong>, and then change the <strong>Raw&nbsp;Size</strong> accordingly. This should result in something looking like the image below.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-1024x516.png" alt="" class="wp-image-4572" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/need_fix-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/need_fix.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-very-dark-gray-color has-text-color">We can check the imports and sure enough, there are 4 imported DLL&#8217;s, meaning we have the correctly unmapped file. We can now save this to the desktop and congratulations! You have now successfully unpacked the first stage! Let&#8217;s open it up in IDA for further analysis!</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-1024x516.png" alt="" class="wp-image-4574" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/fixed_imp.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="283" height="135" src="https://www.0ffset.net/wp-content/uploads/2021/06/success_unpacked.png" alt="" class="wp-image-4575"/></figure></div>



<p class="has-text-align-center"><strong>Part 2: Analysing the Dumped Executable</strong></p>



<pre class="wp-block-code"><code>MD5 of Dumped Executable: 0063316975e55c765cd12e3d91820478</code></pre>



<p>Upon opening the file in IDA, we can see that the main function only calls one local function and then exits, so it&#8217;s not too difficult to find the malicious code. If you&#8217;re not sure if a certain sample is ISFB or not, one telltale sign can be found in the strings window. Most, if not all, ISFB payloads (version 2 &#8211; haven&#8217;t taken a look at version 3 yet so not sure) store a compile/campaign start date in plaintext that is used for string decryption. In this sample, the date is <strong>Jan&nbsp;28&nbsp;2019</strong>, so a relatively new sample at the time of writing this. I will go over the string decryption method soon, but first let&#8217;s take a look at what happens first in the function.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/strings-1024x516.png" alt="" class="wp-image-4577" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/strings-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/strings-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/strings-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/strings-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/strings-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/strings.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Strings</figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="356" height="639" src="https://www.0ffset.net/wp-content/uploads/2021/06/main-1.png" alt="" class="wp-image-4578" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/main-1.png 356w, https://www.0ffset.net/wp-content/uploads/2021/06/main-1-167x300.png 167w" sizes="(max-width: 356px) 100vw, 356px" /></figure></div>



<p>There are several functions called inside this function, so let&#8217;s take it section by section, so first let&#8217;s take a look at the first four functions. From the image below, it is clear that the return value of <strong>sub_401C69</strong> (stored in <strong>eax</strong>) needs to match the value in <strong>esi</strong>, otherwise it will jump to the exit. The second called function &#8211; <strong>sub_401E4F</strong> &#8211; seems to do the same thing. The third function seems to be a check for something, as <strong>1</strong> is moved into a DWORD based on the result of a bit-wise AND (<strong>test</strong> performs a bit-wise AND on the two values, however it just sets flags based on the result, which is not stored) on <strong>eax</strong>. Finally, the fourth function seems to act in the same way as the first and second function, in the sense that the returned value is compared to the value in <strong>esi</strong>, and it will exit if the conditions are not met. Anyway, enough assuming, let&#8217;s actually take a look at these functions.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="442" height="660" src="https://www.0ffset.net/wp-content/uploads/2021/06/first_4.png" alt="" class="wp-image-4579" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/first_4.png 442w, https://www.0ffset.net/wp-content/uploads/2021/06/first_4-201x300.png 201w" sizes="(max-width: 442px) 100vw, 442px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="293" height="562" src="https://www.0ffset.net/wp-content/uploads/2021/06/main_2_layout.png" alt="" class="wp-image-4580" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/main_2_layout.png 293w, https://www.0ffset.net/wp-content/uploads/2021/06/main_2_layout-156x300.png 156w" sizes="(max-width: 293px) 100vw, 293px" /></figure></div>



<p>Taking a look at the first function (the main bit), we can see that the malware is opening it&#8217;s own process and storing the handle in a DWORD, which is set to <strong>-1</strong> if the malware failed to open the process. This then returns back to the main function, where the returned result is compared against the value in <strong>ESI</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="512" height="656" src="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_bits.png" alt="" class="wp-image-4582" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/interesting_bits.png 512w, https://www.0ffset.net/wp-content/uploads/2021/06/interesting_bits-234x300.png 234w" sizes="(max-width: 512px) 100vw, 512px" /></figure></div>



<p>The second function is where things start to get interesting. In the image below, you&#8217;ll notice the compile date being moved into <strong>ESI</strong>, which, as I mentioned before, is used for string decryption. You might already know this, but for those that don&#8217;t, ISFB contains a <strong>.BSS</strong> section, which contains multiple strings that are all encrypted using a ROR-XOR algorithm. The XOR key is calculated based on a given date, and in order to decrypt the strings, ISFB needs to perform the calculations again to get the correct key, allowing us to easily reverse it. But first, let&#8217;s take a look at the two functions called beforehand.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="960" height="950" src="https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn.png" alt="" class="wp-image-4583" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn.png 960w, https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn-100x100.png 100w, https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn-600x594.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn-300x297.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn-768x760.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/secon_fucn-720x713.png 720w" sizes="(max-width: 960px) 100vw, 960px" /></figure></div>



<p>Looking at the first function, you&#8217;ll notice <strong>ssb.</strong> (endian issues, as it is stored as hex &#8211; actually is <strong>.bss</strong>) being compared to the value at <strong>[ECX]</strong>, inside a loop. In order to decrypt the strings in the .BSS section, ISFB must first locate the .BSS section, and in order to do so, it simply reads it&#8217;s own PE header and gets the size and address of the required section. If the value at <strong>[ECX]</strong> doesn&#8217;t match <strong>.bss</strong>, <strong>40</strong> is added the the memory address in <strong>ECX</strong>, due to the fact that the spacing between the section descriptors/structures (<strong>.text</strong>, <strong>.data</strong>, etc.) is 40 bytes. The loop will the continue. If there is a match, the length of the string is checked, making sure that it is not longer than 4 bytes. The malware does this by checking the byte after the string, and comparing it to zero. If the string is the correct length, the memory address pointing to &#8220;<strong>.bss</strong>&#8221; is moved into <strong>EDX</strong>. If everything is successful, ISFB will get the address and size of the .BSS section and store it in memory. In this case, the address is <strong>0x6000</strong> (add this to the image base and you will be able to locate it), and the size is <strong>0x1000</strong>. If this is still difficult to understand, there is an image of what the section table looks like in x32dbg &#8211; this should help you to understand how it is able to get the address and size.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="536" height="640" src="https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop.png" alt="" class="wp-image-4584" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop.png 536w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop-251x300.png 251w" sizes="(max-width: 536px) 100vw, 536px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="519" height="648" src="https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop_finish.png" alt="" class="wp-image-4586" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop_finish.png 519w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_loop_finish-240x300.png 240w" sizes="(max-width: 519px) 100vw, 519px" /><figcaption>Function: sub_401C0F #2<br></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="448" src="https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-1024x448.png" alt="" class="wp-image-4587" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-1024x448.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-600x262.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-300x131.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-768x336.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss-720x315.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/memory_dump_bss.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>With that function analysed, let&#8217;s move onto the next one. The main purpose of this function is to add a vectored exception handler using <strong>AddVectoredExceptionHandler</strong>. The second argument is a pointer to the handler function that will be executed when the program runs into an exception, so lets take a look at the function <strong>Exception_Handle_Function</strong>.q</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="853" height="470" src="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo.png" alt="" class="wp-image-4589" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo.png 853w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-600x331.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-300x165.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-768x423.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo-720x397.png 720w" sizes="(max-width: 853px) 100vw, 853px" /></figure>



<p>This function checks the value of the exception &#8211; whether it is an <strong>EXCEPTION_ACCESS_VIOLATION </strong>or <strong>EXCEPTION_SINGLE_STEP</strong>, however they both end up executing the same function, so lets move into that function.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="554" height="637" src="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo_2.png" alt="" class="wp-image-4590" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo_2.png 554w, https://www.0ffset.net/wp-content/uploads/2021/06/bss_psuedo_2-261x300.png 261w" sizes="(max-width: 554px) 100vw, 554px" /></figure></div>



<p>The important part of this function happens soon after it is executed. In the image below, you&#8217;ll be able to make out a loop, as well as two XOR instructions and a ROR instruction. This is the BSS section decryption &#8211; the XOR key that is created later on is actually <strong>arg_8</strong>, so take note of that. So, now we know that there will be an exception that is caused at some point, which will in turn execute the BSS string decryption function. Now we have this information, we can move onto reversing how the XOR key is created from the compilation/campaign date.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="544" height="524" src="https://www.0ffset.net/wp-content/uploads/2021/06/decryption.png" alt="" class="wp-image-4591" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/decryption.png 544w, https://www.0ffset.net/wp-content/uploads/2021/06/decryption-300x289.png 300w" sizes="(max-width: 544px) 100vw, 544px" /></figure></div>



<p>As the XOR key is based off of the date, thats where we need to look. First, the address of the BSS section (<strong>0x6000</strong>) is moved into EAX, and the size of it (<strong>0x1000</strong>) is moved into EDX. Then, the memory address of the compile date is moved into ESI, and a memory address (pointing to an empty section of memory) is moved into EDI. The compile date is then moved into that empty region of memory, using <strong>MOVSD</strong>, which moves a DWORD from the memory address in ESI to the memory address in EDI. Next, the first DWORD of the compile date is moved into ECX, and this is XOR&#8217;ed against the second DWORD of the compile date. Then, the result of this is added to the address of the BSS section (<strong>0x6000</strong> here) and the value <strong>0xE</strong>. This is then pushed as the first argument for the next function that will be called.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="454" height="562" src="https://www.0ffset.net/wp-content/uploads/2021/06/xor_form.png" alt="" class="wp-image-4593" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/xor_form.png 454w, https://www.0ffset.net/wp-content/uploads/2021/06/xor_form-242x300.png 242w" sizes="(max-width: 454px) 100vw, 454px" /></figure></div>



<p>Taking a look at the function, <strong>arg_0</strong> (the XOR key) is used in a Rotate Left instruction. Here, we see BL being moved into CL, which is incremented by 1 and used to rotate the XOR key left by 1. This results in the final XOR key that is used to decrypt the BSS strings.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="512" height="481" src="https://www.0ffset.net/wp-content/uploads/2021/06/rol_key.png" alt="" class="wp-image-4594" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/rol_key.png 512w, https://www.0ffset.net/wp-content/uploads/2021/06/rol_key-300x282.png 300w" sizes="(max-width: 512px) 100vw, 512px" /></figure></div>



<p>Once we have performed these calculations, we get this as the key: <strong>0x249d730c</strong>. Whilst it is possible to get the strings from a debugger and copy it over to an IDA instance, I prefer to replicate custom routines using Python. I&#8217;m currently polishing up the decryption script I have been using, and when it is complete, you can get it <strong>here</strong> (my GitHub). Simply put, the algorithm decrypts the data in DWORDs, using a mixture of XOR&#8217;s and rotate right (ROR) instructions. First, we&#8217;re going to want to copy out the data in the BSS section. View it in the hex editor mode, select the entire section (where there is data), and then go <strong>Edit-&gt;Export&nbsp;Data</strong>, and you can copy the unspaced data. Next, we need to parse this blob of data so that we can decrypt it.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="383" src="https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-1024x383.png" alt="" class="wp-image-4596" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-1024x383.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-600x225.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-300x112.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-768x288.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss-720x270.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bss.png 1047w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-1024x516.png" alt="" class="wp-image-4597" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/export_bs-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/export_bs.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>To parse it, I will be using python. All we need to do is split the hex bytes by 4, and store that in a list. This means each value will be a DWORD. If you follow the commands below, you should be able to get the output seen in the image.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="456" src="https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-1024x456.png" alt="" class="wp-image-4598" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-1024x456.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-600x267.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-300x134.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-768x342.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword-720x321.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/parse_into_dword.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Next, we&#8217;re going to use CyberChef to do a bit more fixing, although we will be replacing different characters, so that there is an <strong>0x</strong> before every DWORD, and so Python won&#8217;t treat the list as a list of strings.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="529" src="https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-1024x529.png" alt="" class="wp-image-4600" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-1024x529.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-600x310.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-300x155.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-768x397.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking-720x372.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/bit_of_baking.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>So now you should have a suitable list of hex DWORDs which we can then decrypt. In order to decrypt it, you simply have to copy it into the script and make sure the key is correct, and then it will decrypt and spit out the raw data, as well as a list of integers, and you will see why just now. In the image below, you can see the decryption part of my script, which isn&#8217;t too complicated, so if it hasn&#8217;t gone up on my GitHub yet, it shouldn&#8217;t be too difficult to replicate.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="499" src="https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-1024x499.png" alt="" class="wp-image-4602" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-1024x499.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-600x292.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-300x146.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-768x374.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption-720x351.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/replicate_decryption.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Once the script has decrypted the data, the output looks like this:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="557" src="https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-1024x557.png" alt="" class="wp-image-4604" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-1024x557.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-600x326.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-300x163.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-768x418.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings-720x392.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/decrypted_strings.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>So now we can copy the decrypted strings over to IDA. There is an extremely basic IDA Python script in the image below, which overwrites bytes at <strong>dest</strong> with bytes of data in <strong>data</strong>. The list <strong>data</strong> will contain the integer values that our script printed to the terminal, so you can simply copy it from there and paste it into the document.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="632" height="264" src="https://www.0ffset.net/wp-content/uploads/2021/06/copy_bytes.png" alt="" class="wp-image-4605" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/copy_bytes.png 632w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bytes-600x251.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/copy_bytes-300x125.png 300w" sizes="(max-width: 632px) 100vw, 632px" /></figure></div>



<p>From there, we need to import it as a script/module in IDA, so you can do that either by importing the file, or by copying the text and pasting it into the box as shown below. All you need to do then is click <strong>Run</strong>, and it should be imported &#8211; although we physically have to call the script, <strong>Run</strong> won&#8217;t execute it &#8211; at least not in this case.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-1024x516.png" alt="" class="wp-image-4607" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/ida_py-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/ida_py.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Upon typing <strong>PatchArr()</strong> into the console and hitting enter, the script should overwrite all bytes in the BSS section with our decrypted strings, so you should see something similar to the image below.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-1024x516.png" alt="" class="wp-image-4608" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/corrected_bss.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>We can then reanalyse the payload, by going <strong>Options-&gt;General-&gt;Analysis-&gt;Reanalyze Program</strong>, and it should recognize most of the strings, although there will be the occasional error.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-1024x516.png" alt="" class="wp-image-4610" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/final_bss_strings.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>With the newly decrypted BSS section, we should be able to analyse the rest of the payload without issues.</p>



<p>Once the strings have been decrypted, ISFB then calls a function that utilizes one of the decrypted strings &#8211; <strong>IsWow64Process</strong>. As you probably have guessed, this checks to see if the architecture of the system is 64 bit or not. The result (stored in EAX &#8211; <strong>1</strong> if x64, <strong>0</strong> if not) is then tested. If the system is not 64 bit, the variable <strong>var_4</strong> in the graph below is used in an AND operation with EAX, which would be equal to <strong>0</strong>, meaning the value in <strong>var_4</strong> would be <strong>0</strong>. If the system is 64 bit, this is skipped. Then, regardless of the system architecture, the value in <strong>var_4</strong> is moved into EAX, which is the return value. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="315" height="659" src="https://www.0ffset.net/wp-content/uploads/2021/06/check_wow64.png" alt="" class="wp-image-4612" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/check_wow64.png 315w, https://www.0ffset.net/wp-content/uploads/2021/06/check_wow64-143x300.png 143w" sizes="(max-width: 315px) 100vw, 315px" /></figure></div>



<p>If we back out of the function, we can see EAX is tested again, and if the result is not zero, the value <strong>1</strong> will be moved into the DWORD <strong>dword_405478</strong>. As the system I am running on is 64 bit, <strong>dword_405478 </strong>will contain the value <strong>1</strong>. If we search for cross references to this DWORD, we can find test instructions that use it. Therefore we can determine this is an indicator of the architecture.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="720" height="317" src="https://www.0ffset.net/wp-content/uploads/2021/06/tests.png" alt="" class="wp-image-4613" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/tests.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/tests-600x264.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/tests-300x132.png 300w" sizes="(max-width: 720px) 100vw, 720px" /></figure></div>



<p>The next function that is called is quite complex. In a nutshell, this function is responsible for getting the address to a select few API calls. To do this, it uses a list of predefined values, a &#8220;key&#8221;, and a hashing routine. First, let&#8217;s take a look at the key and find out what it is. Looking at the image below, just before the value in <strong>hModule</strong> is moved into ECX, EAX is XOR&#8217;d with a DWORD inside the binary, however upon viewing this DWORD, it is empty &#8211; this means it is resolved dynamically. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="603" height="674" src="https://www.0ffset.net/wp-content/uploads/2021/06/load_apis.png" alt="" class="wp-image-4615" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/load_apis.png 603w, https://www.0ffset.net/wp-content/uploads/2021/06/load_apis-600x671.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/load_apis-268x300.png 268w" sizes="(max-width: 603px) 100vw, 603px" /></figure></div>



<p>To find out what this DWORD will contain, we need to find cross references to it &#8211; specifically, we are looking for a reference to it being used as the destination in a MOV instruction. Luckily enough for us, it only appears once as the destination, inside the BSS Decrypt function. From the image below, we can see that a DWORD from a string is moved into ECX, which is then used in a subtraction and addition instruction. In this case, it may be much easier to understand what is going on by looking at it in a decompiler.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="721" height="332" src="https://www.0ffset.net/wp-content/uploads/2021/06/get_key.png" alt="" class="wp-image-4617" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/get_key.png 721w, https://www.0ffset.net/wp-content/uploads/2021/06/get_key-600x276.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/get_key-300x138.png 300w" sizes="(max-width: 721px) 100vw, 721px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="830" height="370" src="https://www.0ffset.net/wp-content/uploads/2021/06/decompiler.png" alt="" class="wp-image-4618" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/decompiler.png 830w, https://www.0ffset.net/wp-content/uploads/2021/06/decompiler-600x267.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/decompiler-300x134.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/decompiler-768x342.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/decompiler-720x321.png 720w" sizes="(max-width: 830px) 100vw, 830px" /></figure></div>



<p>So, from the looks of it, we can get the key used by performing a simple operation, as seen below:</p>



<pre class="wp-block-code"><code>key = (dword string&#91;4] + dword string&#91;0]) - dword string&#91;12]
key = ("ion=" + "vers") - "oft="
We need to convert these values to hex to perform addition and subtraction:
key = (0x696f6e3d + 0x76657273) - 0x6f66743d
key = 0x706E6C73
Convert the key from hex and we get this: "pnls"</code></pre>



<p>We can double check this by looking at the binary in a debugger, as shown in the image below.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/pnls-1024x516.png" alt="" class="wp-image-4620" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/pnls-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/pnls-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/pnls-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/pnls-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/pnls-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/pnls.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Now we have the key, let&#8217;s take a look at the values used for determining which API to import. This is quite simple to find, as it is already inside the executable. We can also see that EDI is being used as a counter, as each loop it is incremented by 4, until the value reaches 20, where it returns. This means there are 5 API&#8217;s in total that are looked up using this method. The values in the embedded list are all XOR&#8217;d by the key, which results in the hash lookup value used for comparison. So, from this, we can start examining the hashing algorithm to see how it functions and to locate what API&#8217;s are lookup up and stored.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="713" height="585" src="https://www.0ffset.net/wp-content/uploads/2021/06/loop.png" alt="" class="wp-image-4621" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/loop.png 713w, https://www.0ffset.net/wp-content/uploads/2021/06/loop-600x492.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/loop-300x246.png 300w" sizes="(max-width: 713px) 100vw, 713px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="731" height="179" src="https://www.0ffset.net/wp-content/uploads/2021/06/vals.png" alt="" class="wp-image-4623" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/vals.png 731w, https://www.0ffset.net/wp-content/uploads/2021/06/vals-600x147.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/vals-300x73.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/vals-720x176.png 720w" sizes="(max-width: 731px) 100vw, 731px" /></figure></div>



<p>As the function is quite large, I will focus on the section that calls the hashing function. The three arguments passed to this function are; the address of the DLL, the value <strong>0</strong>, and the correct hash for comparison. The function uses the base address to perform some calculations in order to get to the export table inside the DLL. From there, it loops through each of the exports and hashes the name of the export, which is then compared to the predefined hash. If the hashes match, the function retrieves the address to the exported API, and overwrites the predefined hash with the address for later use. If they do not match, the function simply continues onto the next export, until a match is finally discovered.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="269" height="580" src="https://www.0ffset.net/wp-content/uploads/2021/06/large_func.png" alt="" class="wp-image-4624" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/large_func.png 269w, https://www.0ffset.net/wp-content/uploads/2021/06/large_func-139x300.png 139w" sizes="(max-width: 269px) 100vw, 269px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="502" src="https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-1024x502.png" alt="" class="wp-image-4626" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-1024x502.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-600x294.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-300x147.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-768x377.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/checking_part-720x353.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/checking_part.png 1225w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Taking a look at the actual hashing function, it is quite difficult to come to the conclusion (especially for a beginner) that the function is responsible for hashing, until it is run in a debugger. There is definitely something happening in this function from a static analysis perspective, as there are multiple logic instructions, but we can&#8217;t know for sure until we analyse it further.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="624" height="652" src="https://www.0ffset.net/wp-content/uploads/2021/06/crc_algo.png" alt="" class="wp-image-4627" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/crc_algo.png 624w, https://www.0ffset.net/wp-content/uploads/2021/06/crc_algo-600x627.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/crc_algo-287x300.png 287w" sizes="(max-width: 624px) 100vw, 624px" /></figure></div>



<p>Taking a look in a debugger, it is clear that [edx*4+404108] and [ecx*4+404108] are values from a lookup table, as the XOR values used constantly change, however the values are repeated, and therefore we can determine that they are not randomized. Base64 encoding/decoding use lookup tables as well, so if you have looked at that before (or at least the psuedocode), you might be able to recognize the lookup table aspect here. When we take a look at the memory region where the lookup table is located, it is easy to see where it begins and ends. So, now we know that there is a lookup table, how do we find out the hashing mechanism in use? </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/lookup-1024x516.png" alt="" class="wp-image-4629" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/lookup-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/lookup-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/lookup-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/lookup-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/lookup-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/lookup.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Typically, custom encryption and hashing implementations are quite difficult to determine, unless you know what you are looking for. As long as the algorithm is publicly available (such as AES or Serpent), and not a custom developed one by the author, there will almost always be specific values or instructions that stick out to those who have looked at crypto before &#8211; these are known as Constants. We will revisit these later (in the next post) when looking at the other encryption methods used in this sample, however to sum it up, it basically refers to values that must be used in the algorithm to achieve the correct results. In this case, let&#8217;s take one value from the lookup table: 0xA00AE278. We can run a quick search for this value online, and as you can see from the image below, this is definitely linked to CRC-32, although it is more of a variant &#8211; we just need to find out which variant.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="883" height="678" src="https://www.0ffset.net/wp-content/uploads/2021/06/search.png" alt="" class="wp-image-4630" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/search.png 883w, https://www.0ffset.net/wp-content/uploads/2021/06/search-600x461.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/search-300x230.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/search-768x590.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/search-720x553.png 720w" sizes="(max-width: 883px) 100vw, 883px" /></figure></div>



<p>In this specific sample, the program loops through the NTDLL.DLL export functions and hashes them all until it finds a matching hash. What makes hashing worse is that hashes are irreversable, meaning the only way you can find the matching hash is by brute forcing &#8211; to do this you could hash each API exported by NTDLL until you found the matching hashes, but this is too time consuming, and it is quite simple to find the matching API anyway &#8211; all you have to do is put a breakpoint on the instruction that is hit if a match is found, and execute the program. Once the breakpoint is hit, you&#8217;ll be able to locate the correct API. From the image below, you can see the first API call that matches is ZwGetContextThread. We can now use this to get the variant of CRC-32 used.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-1024x516.png" alt="" class="wp-image-4632" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/correct_api-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/correct_api.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>In order to do so, we can use this <a rel="noreferrer noopener" aria-label="site (opens in a new tab)" href="https://crccalc.com/" target="_blank"><strong>site</strong></a>, which is extremely useful. It hashes the input using several different variants of CRC-8, CRC-16, and CRC-32, allowing us to compare the value from the debugger to the output of the different variants. With the API name, ZwGetContextThread, and the required output, 0x5A3D66E4, we can find the variant used: CRC-32/JAMCRC.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="648" src="https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-1024x648.png" alt="" class="wp-image-4634" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-1024x648.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-600x380.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-300x190.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-768x486.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/crcjam-720x456.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/crcjam.png 1125w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>As we can find out the matching APIs, there is no need to write a brute force script, although for families <a rel="noreferrer noopener" aria-label="such as GootKit (opens in a new tab)" href="https://r3mrum.wordpress.com/2018/02/15/string-hashing-reverse-engineering-an-anti-analysis-control/" target="_blank"><strong>such as GootKit</strong></a>, this is sometimes necessary. So, the 5 APIs imported are: ZwGetContextThread, ZwSetContextThread, ZwReadVirtualMemory, ZwWriteVirtualMemory, and ZwAllocateVirtualMemory. With that, we can move out of this function, and onto the next.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/before-1024x516.png" alt="" class="wp-image-4635" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/before-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/before-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/before-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/before-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/before-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/before.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-1024x516.png" alt="" class="wp-image-4637" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/overwritten-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/overwritten.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>The next function simply retrieves the file name to store in memory, potentially for use later on in the sample. The next function gets much more interesting, so lets move onto that.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="577" height="443" src="https://www.0ffset.net/wp-content/uploads/2021/06/get_filename.png" alt="" class="wp-image-4638" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/get_filename.png 577w, https://www.0ffset.net/wp-content/uploads/2021/06/get_filename-300x230.png 300w" sizes="(max-width: 577px) 100vw, 577px" /></figure></div>



<p>If you&#8217;ve looked at ISFB or read anything about it before, you might be aware of an embedded FJ, F1, or JJ structure that is located just after the section table. This structure contains pointers to appended (also known as joined) data, such as configuration information, an RSA public key, or even another executable. There are differences between FJ, F1, and JJ, although they are quite small changes. In this case, the sample is using an embedded JJ structure, identifiable from the magic value 0x4A4A (&#8220;JJ&#8221;).</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="570" src="https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-1024x570.png" alt="" class="wp-image-4640" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-1024x570.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-600x334.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-300x167.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-768x428.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex-720x401.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/jj_hex.png 1052w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>The format of this structure is shown below:</p>



<pre class="wp-block-code"><code>Joined Resource Structure {
	WORD	Magic Value
	WORD	Flags
	DWORD	XOR Key
	DWORD	CRC-32 Hash
	DWORD	Address
	DWORD	Size
}</code></pre>



<p>The parsed structure in this binary can be seen below:</p>



<pre class="wp-block-code"><code>Joined Resource Structure {
	WORD	0x4A4A
	WORD	0x0001
	DWORD	0xD4B1C68F
	DWORD	0x9E154A0C
	DWORD	0x00008400
	DWORD	0x0000B600
}</code></pre>



<p>The function we are looking at is responsible for parsing this structure and locating the needed data. The main argument for this function is the third one, which is the result of an XOR between the &#8220;pnls&#8221; string and an embedded hex value. The first and second arguments are simply the start and end of an empty region of memory, so they are not that important right now.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="383" height="381" src="https://www.0ffset.net/wp-content/uploads/2021/06/args-1.png" alt="" class="wp-image-4642" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/args-1.png 383w, https://www.0ffset.net/wp-content/uploads/2021/06/args-1-100x100.png 100w, https://www.0ffset.net/wp-content/uploads/2021/06/args-1-300x298.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/args-1-150x150.png 150w" sizes="(max-width: 383px) 100vw, 383px" /></figure></div>



<p>The first half of the parsing function traverses through the MZ and PE header until it has reached the resource structure located just after the section table. It then checks that the magic value is in fact &#8220;JJ&#8221; (0x4A4A), otherwise it will add 0x14 to the current address and try again. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="921" height="664" src="https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj.png" alt="" class="wp-image-4643" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj.png 921w, https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj-600x433.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj-300x216.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj-768x554.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/make_sure_jj-720x519.png 720w" sizes="(max-width: 921px) 100vw, 921px" /></figure></div>



<p>Once the structure has been located successfully, the function compares the third argument (0x9E154A0C) with the embedded CRC-32 hash, which is also 0x9E154A0C. If these do not match, the function will return or loop around again. If they do match, the function performs a bitwise AND on the structure flag and 0x2, which must return 0, otherwise the function will loop or return. If 0 is returned, a heap is allocated based on the size value stored in the structure. From there, it will get the full memory address of the joined data by adding the address in the structure to the base address of the executable, and then a bitwise AND is performed on the structure flag and 0x1. If the result is 0 the joined data is not compressed and is encoded, and if the result is not 0 (which in this case it is 1), the joined data is compressed. As the joined data is compressed in this binary, we will focus on the compression method. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="608" height="610" src="https://www.0ffset.net/wp-content/uploads/2021/06/second_part.png" alt="" class="wp-image-4645" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/second_part.png 608w, https://www.0ffset.net/wp-content/uploads/2021/06/second_part-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/second_part-100x100.png 100w, https://www.0ffset.net/wp-content/uploads/2021/06/second_part-600x602.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/second_part-150x150.png 150w" sizes="(max-width: 608px) 100vw, 608px" /></figure></div>



<p>The two arguments pushed to the function are the location of the compressed data, and the address of the newly allocated heap.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="504" height="630" src="https://www.0ffset.net/wp-content/uploads/2021/06/compress.png" alt="" class="wp-image-4646" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/compress.png 504w, https://www.0ffset.net/wp-content/uploads/2021/06/compress-240x300.png 240w" sizes="(max-width: 504px) 100vw, 504px" /></figure></div>



<p>Looking at an overview of the function, you can see it is quite intricate and difficult to follow. Remember what I was saying about crypto constants earlier? They are also present in some, if not all, (de)compression routines, although it is much more difficult to identify the algorithm compared to encryption algorithms.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="247" height="459" src="https://www.0ffset.net/wp-content/uploads/2021/06/compress_flow.png" alt="" class="wp-image-4648" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/compress_flow.png 247w, https://www.0ffset.net/wp-content/uploads/2021/06/compress_flow-161x300.png 161w" sizes="(max-width: 247px) 100vw, 247px" /></figure></div>



<p>Searching through the graph, there are calls to the same functions several times over, but we are looking for a hardcoded value that is not stored in memory. Sure enough, after searching through the right branch, we can see a CMP instruction being used, comparing the value in esi to the value 0x7D00. Using this, we can search &#8220;0x7d00 compression&#8221; on Google and after scrolling down a bit, come across this <a rel="noreferrer noopener" aria-label="site (opens in a new tab)" href="https://searchcode.com/codesearch/view/11902540/" target="_blank"><strong>site</strong></a>. Comparing this python code:</p>



<pre class="wp-block-code"><code>def lengthdelta(offset):
    if offset &lt; 0x80 or 0x7D00 &lt;= offset:
        return 2
    elif 0x500 &lt;= offset:
        return 1
    return 0</code></pre>



<p>To a section of the assembly:</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="209" height="631" src="https://www.0ffset.net/wp-content/uploads/2021/06/matches.png" alt="" class="wp-image-4649" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/matches.png 209w, https://www.0ffset.net/wp-content/uploads/2021/06/matches-99x300.png 99w" sizes="(max-width: 209px) 100vw, 209px" /></figure></div>



<p>We can see some clear similarities. From this, we can deduce that the decompression algorithm used here is APLib, and with this knowledge we can write a simple extraction script to extract any joined data from the binary and decompress it using the great Python library <a rel="noreferrer noopener" aria-label="Mlib (opens in a new tab)" href="https://pypi.org/project/mLib/" target="_blank"><strong>Mlib</strong></a>, created by Mak. You might be wondering how I was able to determine if something was decompressed before even looking at the function. I have read up on ISFB and have also analysed it quite frequently, however it is quite easy to figure out that the joined data is compressed by simply looking at it. Opening up the binary in a hex editor and going to the location of the joined data, you might be able to recognize the string &#8220;This Program Cannot Be Run In DOS Mode&#8221;, although part of it is obfuscated. Recognizing compression also depends on the level of compression, however for the ISFB malware strain, APLib is the defacto compression method for now, so it is relatively simple.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="638" height="564" src="https://www.0ffset.net/wp-content/uploads/2021/06/compressed.png" alt="" class="wp-image-4651" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/compressed.png 638w, https://www.0ffset.net/wp-content/uploads/2021/06/compressed-600x530.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/compressed-300x265.png 300w" sizes="(max-width: 638px) 100vw, 638px" /></figure></div>



<p>Backing out from the decompression function, the program makes sure that the size of the decompressed executable is the same size as the value stored in the JJ structure. If the sizes do not match, the decompressed executable is cleared from memory, using HeapFree(). Then, the malware XORs the first DWORD of the decompressed data with the XOR key stored in the structure. Taking a look at the decompressed data, we can see that the first DWORD of the executable is not valid &#8211; it should look like 00009000, but instead looks like 54205BD4. After the XOR, the valid value can be seen. The function cleans up after itself, and then returns back to the calling function. If you were to dump the executable at this stage and add &#8220;MZ&#8221; to the start, you would be unable to open it in PE Bear &#8211; this is due to the fact that not only is &#8220;MZ&#8221; missing, &#8220;PE&#8221; is also missing from the header, so make sure you add that as well.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-1024x516.png" alt="" class="wp-image-4653" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/xor-1-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/xor-1.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/after-1-1024x516.png" alt="" class="wp-image-4655" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/after-1-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/after-1-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/after-1-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/after-1-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/after-1-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/after-1.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Back in the calling function, the malware then overwrites the decompressed executable using a rolling XOR algorithm. I&#8217;m not exactly sure why it does this, as the executable is later decrypted, so if someone could let me know that would be great! Anyway, once the executable has been encrypted, the function carries on.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-1024x516.png" alt="" class="wp-image-4657" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/rolling_xor_result.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>First, it creates a new file mapping, and calls MapViewOfFile, and then copies it&#8217;s filename to the newly mapped region, before calling UnmapViewOfFile. Again, I&#8217;m not too sure why this is being called, as it doesn&#8217;t seem to do anything, but if someone could drop an answer to this that would be great, and I can incorporate it into the post.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="432" height="648" src="https://www.0ffset.net/wp-content/uploads/2021/06/map_file.png" alt="" class="wp-image-4658" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/map_file.png 432w, https://www.0ffset.net/wp-content/uploads/2021/06/map_file-200x300.png 200w" sizes="(max-width: 432px) 100vw, 432px" /></figure></div>



<p>Moving on, the final function in this sample is called. This is quite a large function, so I will attempt to summarize the main points. Firstly, the function begins by moving different pointers around, and then compares the first 2 bytes of the encrypted executable to the value 0x5A4D (MZ) to check if the data is encrypted or not. As it is encrypted, the result will not be 0, and so it will allocate a heap based on the size seen in the embedded JJ structure. Next, it will call another function responsible for performing another rolling XOR algorithm, that will decrypt the data. This is a bit different to the last one, but should return the same executable that was decompressed earlier. Then, it will locate the value in the PE header that indicates the architecture of the executable, which in this case is 0x14C, meaning it is x86 based.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="577" height="630" src="https://www.0ffset.net/wp-content/uploads/2021/06/executable_stuf.png" alt="" class="wp-image-4659" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/executable_stuf.png 577w, https://www.0ffset.net/wp-content/uploads/2021/06/executable_stuf-275x300.png 275w" sizes="(max-width: 577px) 100vw, 577px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="607" height="627" src="https://www.0ffset.net/wp-content/uploads/2021/06/check_arch.png" alt="" class="wp-image-4661" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/check_arch.png 607w, https://www.0ffset.net/wp-content/uploads/2021/06/check_arch-600x620.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/check_arch-290x300.png 290w" sizes="(max-width: 607px) 100vw, 607px" /></figure></div>



<p>Next, the malware will allocate a brand new section of memory using NtCreateSection(), which will be set to Read-Write-eXecute. Eventually, this will contain the decompressed executable.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="780" height="585" src="https://www.0ffset.net/wp-content/uploads/2021/06/create_section.png" alt="" class="wp-image-4663" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/create_section.png 780w, https://www.0ffset.net/wp-content/uploads/2021/06/create_section-600x450.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/create_section-300x225.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/create_section-768x576.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/create_section-720x540.png 720w" sizes="(max-width: 780px) 100vw, 780px" /></figure></div>



<p>From there, an address located inside the newly created section of memory will be formed, pointing to 0x0022EC50, which will be used later. The created section of memory is replicated, to the address 0x00240000. Next, the program begins to copy over the executable to the new addresses, however it skips the entire MZ header and simply copies everything from the PE header. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="909" height="617" src="https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz.png" alt="" class="wp-image-4664" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz.png 909w, https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz-600x407.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz-300x204.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz-768x521.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/missing_mz-720x489.png 720w" sizes="(max-width: 909px) 100vw, 909px" /></figure></div>



<p>Then, a function is called that imports some more API calls from NTDLL, however this time it is not done using CRC hashes, and the name is simply passed as an argument. The imported API calls are; LdrLoadDll, LdrGetProcedureAddress, and ZwProtectVirtualMemory. The pointers to the addresses are stored in the same region of memory, split by 4 null bytes each. These addresses are then copied over to the executable at 0x00220000 for usage during it&#8217;s execution. Next, a region of code is copied over to the executable in memory, just 40 bytes after the loaded APIs. This is what will be called before the next stage is completely executed.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="483" height="648" src="https://www.0ffset.net/wp-content/uploads/2021/06/load_more_apis.png" alt="" class="wp-image-4665" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/load_more_apis.png 483w, https://www.0ffset.net/wp-content/uploads/2021/06/load_more_apis-224x300.png 224w" sizes="(max-width: 483px) 100vw, 483px" /></figure></div>



<p>Continuing on, the next function is responsible for passing execution over to the executable. There are 2 functions that pass over execution to the executable, however they depend on the architecture. In this case, I will be looking at the x64 version. It is quite simple, as all it does is call the function at the address 0x0022E040, which will prepare the next stage. Therefore, you can think of this stage as another &#8220;unpacker&#8221;, as all it does is unpacks the executable, however there are many functions that carry over to the next stage, making it much easier to analyse.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-1024x516.png" alt="" class="wp-image-4666" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/next_stage-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/next_stage.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>When we step into the function, there is an int3 waiting for us, which acts as a breakpoint that raises an exception, stopping us from stepping over it. To fix this, we can put a breakpoint on the previous call, restart the debugger and then run it until the breakpoint is hit. This should hopefully remove the int3.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="349" src="https://www.0ffset.net/wp-content/uploads/2021/06/int_3-1024x349.png" alt="" class="wp-image-4668" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/int_3-1024x349.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/int_3-600x204.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/int_3-300x102.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/int_3-768x261.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/int_3-720x245.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/int_3.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>As it didn&#8217;t remove it in my case, I will use Immunity Debugger to carry on this section. The code is responsible for importing DLLs using the previously imported API&#8217;s &#8211; First, there is a loop which stores a DLL name in memory that will be loaded using LdrLoadDll. Then, a list of hardcoded APIs are looped over, with each being passed to LdrGetProcedureAddress. The DLLs that are loaded are; NTDLL.DLL, KERNEL32.DLL, AND OLEAUT32.DLL.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/immunity-1024x516.png" alt="" class="wp-image-4669" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/immunity-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/immunity-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/immunity-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/immunity-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/immunity-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/immunity.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-1024x516.png" alt="" class="wp-image-4671" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/import_apis-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/import_apis.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-1024x516.png" alt="" class="wp-image-4672" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/api_to_import.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>Once the APIs have been imported, ZwProtectVirtualMemory is called several times in a loop to alter the protections on several regions of memory. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="515" src="https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-1024x515.png" alt="" class="wp-image-4675" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-1024x515.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-600x302.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-768x386.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem-720x362.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/protect_mem.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>In order to jump to where the execution of the payload happens, we want to put a breakpoint on a call to a register, which in this instance is EBX. Run to that, and then step into it, and you should find yourself in the next stage of ISFB!</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="516" src="https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-1024x516.png" alt="" class="wp-image-4676" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-1024x516.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-768x387.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec-720x363.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/transfer_exec.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="517" src="https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-1024x517.png" alt="" class="wp-image-4677" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-1024x517.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-600x303.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-300x151.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-768x388.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb-720x364.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_of_isfb.png 1313w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p>All we need to do now is to dump it out, add &#8220;MZ&#8221; and &#8220;PE&#8221; to the header, unmap and rebase it using PE Bear, and then we can start analysing the next stage!</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="652" height="540" src="https://www.0ffset.net/wp-content/uploads/2021/06/add_header.png" alt="" class="wp-image-4679" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/add_header.png 652w, https://www.0ffset.net/wp-content/uploads/2021/06/add_header-600x497.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/add_header-300x248.png 300w" sizes="(max-width: 652px) 100vw, 652px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="593" src="https://www.0ffset.net/wp-content/uploads/2021/06/unmap-1024x593.png" alt="" class="wp-image-4681" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/unmap-1024x593.png 1024w, https://www.0ffset.net/wp-content/uploads/2021/06/unmap-600x348.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/unmap-300x174.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/unmap-768x445.png 768w, https://www.0ffset.net/wp-content/uploads/2021/06/unmap-720x417.png 720w, https://www.0ffset.net/wp-content/uploads/2021/06/unmap.png 1068w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="669" height="672" src="https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida.png" alt="" class="wp-image-4682" srcset="https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida.png 669w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida-100x100.png 100w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida-600x603.png 600w, https://www.0ffset.net/wp-content/uploads/2021/06/entry_in_ida-150x150.png 150w" sizes="(max-width: 669px) 100vw, 669px" /></figure></div>



<pre class="wp-block-code"><code>MD5 of Dumped DLL: 52b4480de6f4d4f32fba2b535941c284</code></pre>



<p>Congratulations! You have managed to analyse the loader and &#8220;unpack&#8221; the next stage, which I will be analysing in the next post (because this one has now amassed over 6,000 words which is much longer than I planned). So, feel free to ask any questions you have down below, or over Twitter (<strong><a rel="noreferrer noopener" aria-label="@0verfl0w_ (opens in a new tab)" href="https://twitter.com/0verfl0w_" target="_blank">@0verfl0w_</a></strong>) and I will be glad to answer them! I apologize again for the lack of posts recently, I&#8217;ve been working on my course as well, so I&#8217;ve had a lot of stuff to do! Hopefully the next post on ISFB shouldn&#8217;t take too long to do, so make sure to sign up to my mailing list to stay updated whenever I post! Thanks again 🙂</p>

        </div><!-- .entry-content -->
        <div class="entry-footer clearfix">
            <span class="sl-wrapper"><a href="https://www.0ffset.net/wp-admin/admin-ajax.php?action=process_simple_like&post_id=3229&nonce=3c5728b9c0&is_comment=0&disabled=true" class="sl-button sl-button-3229 liked" data-nonce="3c5728b9c0" data-post-id="3229" data-iscomment="0" title="Unlike"><span class="sl-icon"><svg role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart-full" d="M124 20.4C111.5-7 73.7-4.8 64 19 54.3-4.9 16.5-7 4 20.4c-14.7 32.3 19.4 63 60 107.1C104.6 83.4 138.7 52.7 124 20.4z"/>&#9829;</svg></span><span class="sl-count">1</a><span id="sl-loader"></span></span>        </div>
        <div class="share-post"></div>        <div class="author-bio" ><div class="author-image"><img alt='' src='https://secure.gravatar.com/avatar/4646d0a6fcf15f17545b9a8708b8c3b4?s=250&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4646d0a6fcf15f17545b9a8708b8c3b4?s=500&#038;d=mm&#038;r=g 2x' class='avatar avatar-250 photo' height='250' width='250' decoding='async'/></div><div class="author-info"><p class="title text-primary font-second">Author</p><h6>0verfl0w_</h6><p class="des"></p><div class="author-socials"></div></div></div>        <div class="post-nav clearfix"><div class="post-prev"><a href="https://www.0ffset.net/reverse-engineering/malware-analysis/reversing-hancitor-again/" rel="prev"><h6>Revisiting Hancitor in Depth</h6><span>5th February 2019</span></a></div><div class="post-next"><a href="https://www.0ffset.net/reverse-engineering/analyzing-isfb-second-loader/" rel="next"><h6>Analyzing ISFB &#8211; The Second Loader</h6><span>25th May 2019</span></a></div></div>    </div>
</article>

<div id="comments" class="comments-area">

    
        <h4 class="comments-title">Comments (2)</h4>

        <ol class="comment-list">
            
        <li id="comment-36" class="pingback even thread-even depth-1 comment-item">
            <article class="comment-wrap clearfix">

                <div class="gravatar">
                                    </div>

                <div class="comment-content">
                    <div class="comment-meta">
                        <h6 class="comment-author">Analyzing ISFB - The Second Loader - 0ffset</h6>
                        <span class="comment-time">25th May 2019</span>
                        <div class="comment-reply"></div>
                    </div>
                    <div class="comment-text">
                                                    <p>[&#8230;] haven&#8217;t checked out my last post on ISFB where we analyzed the first loader, check that out here to get some context for this part. The second loader is part of the infection chain for a group of [&#8230;]</p>
                                            </div>
                </div>

            </article>
        </li>

        </li><!-- #comment-## -->

        <li id="comment-37" class="pingback odd alt thread-odd thread-alt depth-1 comment-item">
            <article class="comment-wrap clearfix">

                <div class="gravatar">
                                    </div>

                <div class="comment-content">
                    <div class="comment-meta">
                        <h6 class="comment-author">Dissection of an Incident &#8211; Part 2 &#8211; Insinuator.net</h6>
                        <span class="comment-time">30th October 2019</span>
                        <div class="comment-reply"></div>
                    </div>
                    <div class="comment-text">
                                                    <p>[&#8230;] <a href="https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/" rel="ugc">https://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/</a> [&#8230;]</p>
                                            </div>
                </div>

            </article>
        </li>

        </li><!-- #comment-## -->
        </ol><!-- .comment-list -->

                    <p class="no-comments">Comments are closed.</p>
        
</div><!-- #comments -->
					</main><!-- #main -->
				</div><!-- #primary -->
				
				
<aside id="primary-sidebar" class="widget-area primary-sidebar col-lg-3 col-md-3 col-sm-12 col-xs-12">
	<section id="recent_news-1" class="widget widget_recent_news"><h5 class="widget-title">Recent Posts</h5>            <ul class="recent-news clearfix">
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/guloaders-stack-manipulation/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-720x720.png 720w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/12/gl_decomp_view-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/guloaders-stack-manipulation/">GuLoader&#8217;s Unique Approach to Obfuscation: Understanding Stack Manipulation</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">4th December 2022</span>
                        </span>
                                            </div>
                </li>
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/yara-byte-patterns/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/11/featured-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/11/featured-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-720x720.png 720w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/11/featured-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/yara-byte-patterns/">Developing YARA Rules Based on Byte Patterns: ROMCOM</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">27th November 2022</span>
                        </span>
                                            </div>
                </li>
                                                <li class="clearfix"> 
                                        <div class="thumb">
                        <a href="https://www.0ffset.net/reverse-engineering/analysing-snake-ransomware/">
                            <img width="150" height="150" src="https://www.0ffset.net/wp-content/uploads/2022/11/image034-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" decoding="async" srcset="https://www.0ffset.net/wp-content/uploads/2022/11/image034-150x150.png 150w, https://www.0ffset.net/wp-content/uploads/2022/11/image034-300x300.png 300w, https://www.0ffset.net/wp-content/uploads/2022/11/image034-100x100.png 100w" sizes="(max-width: 150px) 100vw, 150px" />                        </a>
                    </div>
                                        <div class="entry-header">
                        <h6>
                            <a href="https://www.0ffset.net/reverse-engineering/analysing-snake-ransomware/">Reversing Golang Developed Ransomware: SNAKE</a>
                        </h6>
                                                <span class="post-on">
                            <span class="entry-date">23rd November 2022</span>
                        </span>
                                            </div>
                </li>
                            </ul>

    </section></aside><!-- #secondary -->
			</div>
		</div>	
	</div>

	</div><!-- #content -->
	<footer id="site-footer" class="site-footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">		<div data-elementor-type="wp-post" data-elementor-id="1308" class="elementor elementor-1308" data-elementor-post-type="ot_footer_builders">
									<section class="elementor-section elementor-top-section elementor-element elementor-element-d0f9bfa ot-traditional elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="d0f9bfa" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;gradient&quot;}">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-89daaf1 ot-flex-column-vertical" data-id="89daaf1" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<section class="elementor-section elementor-inner-section elementor-element elementor-element-e89c64b elementor-section-full_width ot-traditional elementor-section-height-default elementor-section-height-default" data-id="e89c64b" data-element_type="section">
						<div class="elementor-container elementor-column-gap-extended">
					<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-8d8441e ot-flex-column-vertical" data-id="8d8441e" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-8914b33 elementor-widget elementor-widget-icontact_info" data-id="8914b33" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    				        		<i class="flaticon-world-globe"></i>					</div>
		        	<p>5 The Quadrant, Coventry, U.K.</p>
		        	<h6>Our Address</h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-5ebca85 ot-flex-column-vertical" data-id="5ebca85" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-4405434 elementor-widget elementor-widget-icontact_info" data-id="4405434" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    		<img src="https://www.0ffset.net/wp-content/uploads/2022/07/0ffset-rounded-01.png" alt="">		        							</div>
		        	<p></p>
		        	<h6></h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-33 elementor-inner-column elementor-element elementor-element-c9201b5 ot-flex-column-vertical" data-id="c9201b5" data-element_type="column">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-1a1bfdb elementor-widget elementor-widget-icontact_info" data-id="1a1bfdb" data-element_type="widget" data-widget_type="icontact_info.default">
				<div class="elementor-widget-container">
										<div class="contact-info box-style2">
					<div class="box-icon">
									    				        		<i class="flaticon-envelope"></i>					</div>
		        	<p>contact@0ffset.net</p>
		        	<h6>Our Mailbox</h6>			        				        
			    </div>
		    	    		</div>
				</div>
					</div>
		</div>
							</div>
		</section>
				<div class="elementor-element elementor-element-c208bbf elementor-widget elementor-widget-text-editor" data-id="c208bbf" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
							<p><span style="color: #000000;">Copyright © 2022 <strong><a style="color: #000000;" href="http://0ffset.net">0ffset Training Solutions LTD.</a></strong> All Rights Reserved.</span></p>						</div>
				</div>
				<div class="elementor-element elementor-element-9438214 elementor-grid-3 elementor-shape-rounded e-grid-align-center elementor-widget elementor-widget-social-icons" data-id="9438214" data-element_type="widget" data-widget_type="social-icons.default">
				<div class="elementor-widget-container">
					<div class="elementor-social-icons-wrapper elementor-grid">
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-twitter elementor-animation-float elementor-repeater-item-a24d46e" href="https://twitter.com/0verfl0w_" target="_blank">
						<span class="elementor-screen-only">Twitter</span>
						<i class="fab fa-twitter"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-linkedin-in elementor-animation-float elementor-repeater-item-b0dbeaa" href="https://www.linkedin.com/company/0ffset/" target="_blank">
						<span class="elementor-screen-only">Linkedin-in</span>
						<i class="fab fa-linkedin-in"></i>					</a>
				</span>
							<span class="elementor-grid-item">
					<a class="elementor-icon elementor-social-icon elementor-social-icon-youtube elementor-animation-float elementor-repeater-item-6b456a7" href="https://www.youtube.com/channel/UCy21puSd9R3C5Xn46YI32_g" target="_blank">
						<span class="elementor-screen-only">Youtube</span>
						<i class="fab fa-youtube"></i>					</a>
				</span>
					</div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
							</div>
		</footer></div><!-- #page -->


		<script>
			window.RS_MODULES = window.RS_MODULES || {};
			window.RS_MODULES.modules = window.RS_MODULES.modules || {};
			window.RS_MODULES.waiting = window.RS_MODULES.waiting || [];
			window.RS_MODULES.defered = true;
			window.RS_MODULES.moduleWaiting = window.RS_MODULES.moduleWaiting || {};
			window.RS_MODULES.type = 'compiled';
		</script>
		<a id="back-to-top" href="#" class="show"><i class="flaticon-up-arrow"></i></a>		<div data-elementor-type="popup" data-elementor-id="7991" class="elementor elementor-7991 elementor-location-popup" data-elementor-settings="{&quot;entrance_animation&quot;:&quot;none&quot;,&quot;prevent_close_on_esc_key&quot;:&quot;yes&quot;,&quot;avoid_multiple_popups&quot;:&quot;yes&quot;,&quot;entrance_animation_duration&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:1.1999999999999999555910790149937383830547332763671875,&quot;sizes&quot;:[]},&quot;a11y_navigation&quot;:&quot;yes&quot;,&quot;triggers&quot;:{&quot;scrolling_offset&quot;:10,&quot;scrolling&quot;:&quot;yes&quot;,&quot;scrolling_direction&quot;:&quot;down&quot;},&quot;timing&quot;:{&quot;times_times&quot;:1,&quot;times&quot;:&quot;yes&quot;,&quot;devices_devices&quot;:[&quot;desktop&quot;,&quot;mobile&quot;],&quot;devices&quot;:&quot;yes&quot;,&quot;times_count&quot;:&quot;close&quot;}}" data-elementor-post-type="elementor_library">
								<section class="elementor-section elementor-top-section elementor-element elementor-element-16a20fb3 elementor-section-height-min-height elementor-section-items-stretch elementor-reverse-mobile ot-traditional elementor-section-boxed elementor-section-height-default" data-id="16a20fb3" data-element_type="section" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
						<div class="elementor-container elementor-column-gap-default">
					<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-40851bae ot-flex-column-vertical" data-id="40851bae" data-element_type="column" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
			<div class="elementor-widget-wrap elementor-element-populated">
								<div class="elementor-element elementor-element-2f4506f elementor-widget elementor-widget-heading" data-id="2f4506f" data-element_type="widget" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h4 class="elementor-heading-title elementor-size-default">The Remastered<br>Beginner Malware Analysis Course</h4>		</div>
				</div>
				<div class="elementor-element elementor-element-4076d27b animated-slow elementor-invisible elementor-widget elementor-widget-heading" data-id="4076d27b" data-element_type="widget" data-settings="{&quot;_animation&quot;:&quot;bounceIn&quot;,&quot;_animation_delay&quot;:0}" data-widget_type="heading.default">
				<div class="elementor-widget-container">
			<h2 class="elementor-heading-title elementor-size-default">Pre-registration is now open</h2>		</div>
				</div>
				<div class="elementor-element elementor-element-cba2cc5 elementor-widget elementor-widget-text-editor" data-id="cba2cc5" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
							<p style="text-align: center;">Don&#8217;t miss out! Add your email to get notified of course updates, and grab a <strong>15% discount</strong> as well as <strong>1-week early access</strong>!</p>						</div>
				</div>
				<div class="elementor-element elementor-element-6450da54 elementor-button-align-center labelcentered elementor-widget elementor-widget-form" data-id="6450da54" data-element_type="widget" data-settings="{&quot;step_next_label&quot;:&quot;Next&quot;,&quot;step_previous_label&quot;:&quot;Previous&quot;,&quot;button_width&quot;:&quot;100&quot;,&quot;step_type&quot;:&quot;number_text&quot;,&quot;step_icon_shape&quot;:&quot;circle&quot;}" data-widget_type="form.default">
				<div class="elementor-widget-container">
					<form class="elementor-form" method="post" name="preregister">
			<input type="hidden" name="post_id" value="7991"/>
			<input type="hidden" name="form_id" value="6450da54"/>
			<input type="hidden" name="referer_title" value="Analysing ISFB – The First Loader | 0ffset Training Solutions" />

							<input type="hidden" name="queried_id" value="3229"/>
			
			<div class="elementor-form-fields-wrapper elementor-labels-">
								<div class="elementor-field-type-text elementor-field-group elementor-column elementor-field-group-field_1887d7b elementor-col-80 elementor-field-required">
												<label for="form-field-field_1887d7b" class="elementor-field-label elementor-screen-only">
								Name							</label>
														<input size="1" type="text" name="form_fields[field_1887d7b]" id="form-field-field_1887d7b" class="elementor-field elementor-size-sm  elementor-field-textual" placeholder="Name" required="required" aria-required="true">
											</div>
								<div class="elementor-field-type-email elementor-field-group elementor-column elementor-field-group-field_ac3dc4b elementor-col-80 elementor-field-required">
												<label for="form-field-field_ac3dc4b" class="elementor-field-label elementor-screen-only">
								Email							</label>
														<input size="1" type="email" name="form_fields[field_ac3dc4b]" id="form-field-field_ac3dc4b" class="elementor-field elementor-size-sm  elementor-field-textual" placeholder="Email" required="required" aria-required="true">
											</div>
								<div class="elementor-field-group elementor-column elementor-field-type-submit elementor-col-100 e-form__buttons">
					<button type="submit" class="elementor-button elementor-size-sm elementor-animation-sink">
						<span >
															<span class=" elementor-button-icon">
																										</span>
																						<span class="elementor-button-text">Secure Early-Access</span>
													</span>
					</button>
				</div>
			</div>
		</form>
				</div>
				</div>
					</div>
		</div>
				<div class="elementor-column elementor-col-50 elementor-top-column elementor-element elementor-element-4b6d4c9 ot-flex-column-vertical" data-id="4b6d4c9" data-element_type="column" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
			<div class="elementor-widget-wrap elementor-element-populated">
					<div class="elementor-background-overlay"></div>
								<div class="elementor-element elementor-element-1663789e elementor-widget elementor-widget-spacer" data-id="1663789e" data-element_type="widget" data-widget_type="spacer.default">
				<div class="elementor-widget-container">
					<div class="elementor-spacer">
			<div class="elementor-spacer-inner"></div>
		</div>
				</div>
				</div>
					</div>
		</div>
							</div>
		</section>
						</div>
			<script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script>
	
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="pswp__bg"></div>
	<div class="pswp__scroll-wrap">
		<div class="pswp__container">
			<div class="pswp__item"></div>
			<div class="pswp__item"></div>
			<div class="pswp__item"></div>
		</div>
		<div class="pswp__ui pswp__ui--hidden">
			<div class="pswp__top-bar">
				<div class="pswp__counter"></div>
				<button class="pswp__button pswp__button--close" aria-label="Close (Esc)"></button>
				<button class="pswp__button pswp__button--share" aria-label="Share"></button>
				<button class="pswp__button pswp__button--fs" aria-label="Toggle fullscreen"></button>
				<button class="pswp__button pswp__button--zoom" aria-label="Zoom in/out"></button>
				<div class="pswp__preloader">
					<div class="pswp__preloader__icn">
						<div class="pswp__preloader__cut">
							<div class="pswp__preloader__donut"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
				<div class="pswp__share-tooltip"></div>
			</div>
			<button class="pswp__button pswp__button--arrow--left" aria-label="Previous (arrow left)"></button>
			<button class="pswp__button pswp__button--arrow--right" aria-label="Next (arrow right)"></button>
			<div class="pswp__caption">
				<div class="pswp__caption__center"></div>
			</div>
		</div>
	</div>
</div>
<script type="text/template" id="tmpl-variation-template">
	<div class="woocommerce-variation-description">{{{ data.variation.variation_description }}}</div>
	<div class="woocommerce-variation-price">{{{ data.variation.price_html }}}</div>
	<div class="woocommerce-variation-availability">{{{ data.variation.availability_html }}}</div>
</script>
<script type="text/template" id="tmpl-unavailable-variation-template">
	<p>Sorry, this product is unavailable. Please choose a different combination.</p>
</script>
<link rel='stylesheet' id='elementor-post-2840-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-2840.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-post-1308-css' href='https://www.0ffset.net/wp-content/uploads/elementor/css/post-1308.css?ver=1703230942' type='text/css' media='all' />
<link rel='stylesheet' id='e-animations-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/animations/animations.min.css?ver=3.18.3' type='text/css' media='all' />
<link rel='stylesheet' id='google-fonts-2-css' href='https://fonts.googleapis.com/css?family=Nunito+Sans%3A100%2C100italic%2C200%2C200italic%2C300%2C300italic%2C400%2C400italic%2C500%2C500italic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic%2C900%2C900italic&#038;display=auto&#038;ver=6.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-shared-0-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/fontawesome.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-fa-brands-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/brands.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='elementor-icons-fa-solid-css' href='https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/font-awesome/css/solid.min.css?ver=5.15.3' type='text/css' media='all' />
<link rel='stylesheet' id='rs-plugin-settings-css' href='https://www.0ffset.net/wp-content/plugins/revslider/public/assets/css/rs6.css?ver=6.6.7' type='text/css' media='all' />
<style id='rs-plugin-settings-inline-css' type='text/css'>
#rs-demo-id {}
</style>
<link rel='stylesheet' id='photoswipe-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/photoswipe/photoswipe.min.css?ver=8.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='photoswipe-default-skin-css' href='https://www.0ffset.net/wp-content/plugins/woocommerce/assets/css/photoswipe/default-skin/default-skin.min.css?ver=8.4.0' type='text/css' media='all' />
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=5.8.5" id="swv-js"></script>
<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/www.0ffset.net\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.8.5" id="contact-form-7-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/revslider/public/assets/js/rbtools.min.js?ver=6.6.7" defer async id="tp-tools-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/revslider/public/assets/js/rs6.min.js?ver=6.6.7" defer async id="revmin-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/royal_preloader.min.js?ver=20180910" id="royal-preloader-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.magnific-popup.min.js?ver=20180910" id="magnific-popup-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.isotope.min.js?ver=20190829" id="isotope-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/slick.min.js?ver=20180910" id="slick-slider-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/easypiechart.min.js?ver=20190829" id="easypiechart-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/jquery.countdown.min.js?ver=20180910" id="countdown-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/elementor.js?ver=20180910" id="engitech-elementor-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/elementor-header.js?ver=20180910" id="engitech-elementor-header-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/scripts.js?ver=20180910" id="engitech-scripts-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/themes/engitech/js/header-mobile.js?ver=20180910" id="engitech-header-mobile-scripts-js"></script>
<script type="text/javascript" id="eael-general-js-extra">
/* <![CDATA[ */
var localize = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","nonce":"69af3b5912","i18n":{"added":"Added ","compare":"Compare","loading":"Loading..."},"eael_translate_text":{"required_text":"is a required field","invalid_text":"Invalid","billing_text":"Billing","shipping_text":"Shipping","fg_mfp_counter_text":"of"},"page_permalink":"https:\/\/www.0ffset.net\/reverse-engineering\/malware-analysis\/analysing-isfb-loader\/","cart_redirectition":"no","cart_page_url":"https:\/\/www.0ffset.net\/cart\/","el_breakpoints":{"mobile":{"label":"Mobile Portrait","value":767,"default_value":767,"direction":"max","is_enabled":true},"mobile_extra":{"label":"Mobile Landscape","value":880,"default_value":880,"direction":"max","is_enabled":false},"tablet":{"label":"Tablet Portrait","value":1024,"default_value":1024,"direction":"max","is_enabled":true},"tablet_extra":{"label":"Tablet Landscape","value":1200,"default_value":1200,"direction":"max","is_enabled":false},"laptop":{"label":"Laptop","value":1366,"default_value":1366,"direction":"max","is_enabled":false},"widescreen":{"label":"Widescreen","value":2400,"default_value":2400,"direction":"min","is_enabled":false}}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/essential-addons-for-elementor-lite/assets/front-end/js/view/general.min.js?ver=5.9.3" id="eael-general-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/webpack-pro.runtime.min.js?ver=3.18.2" id="elementor-pro-webpack-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/webpack.runtime.min.js?ver=3.18.3" id="elementor-webpack-runtime-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/frontend-modules.min.js?ver=3.18.3" id="elementor-frontend-modules-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/dist/i18n.min.js?ver=7701b0c3857f914212ef" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" id="elementor-pro-frontend-js-before">
/* <![CDATA[ */
var ElementorProFrontendConfig = {"ajaxurl":"https:\/\/www.0ffset.net\/wp-admin\/admin-ajax.php","nonce":"97a94573c1","urls":{"assets":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor-pro\/assets\/","rest":"https:\/\/www.0ffset.net\/wp-json\/"},"shareButtonsNetworks":{"facebook":{"title":"Facebook","has_counter":true},"twitter":{"title":"Twitter"},"linkedin":{"title":"LinkedIn","has_counter":true},"pinterest":{"title":"Pinterest","has_counter":true},"reddit":{"title":"Reddit","has_counter":true},"vk":{"title":"VK","has_counter":true},"odnoklassniki":{"title":"OK","has_counter":true},"tumblr":{"title":"Tumblr"},"digg":{"title":"Digg"},"skype":{"title":"Skype"},"stumbleupon":{"title":"StumbleUpon","has_counter":true},"mix":{"title":"Mix"},"telegram":{"title":"Telegram"},"pocket":{"title":"Pocket","has_counter":true},"xing":{"title":"XING","has_counter":true},"whatsapp":{"title":"WhatsApp"},"email":{"title":"Email"},"print":{"title":"Print"}},"woocommerce":{"menu_cart":{"cart_page_url":"https:\/\/www.0ffset.net\/cart\/","checkout_page_url":"https:\/\/www.0ffset.net\/checkout\/","fragments_nonce":"a56fd03f4a"}},"facebook_sdk":{"lang":"en_GB","app_id":""},"lottie":{"defaultAnimationUrl":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor-pro\/modules\/lottie\/assets\/animations\/default.json"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/frontend.min.js?ver=3.18.2" id="elementor-pro-frontend-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/lib/waypoints/waypoints.min.js?ver=4.0.2" id="elementor-waypoints-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/jquery/ui/core.min.js?ver=1.13.2" id="jquery-ui-core-js"></script>
<script type="text/javascript" id="elementor-frontend-js-before">
/* <![CDATA[ */
var elementorFrontendConfig = {"environmentMode":{"edit":false,"wpPreview":false,"isScriptDebug":false},"i18n":{"shareOnFacebook":"Share on Facebook","shareOnTwitter":"Share on Twitter","pinIt":"Pin it","download":"Download","downloadImage":"Download image","fullscreen":"Fullscreen","zoom":"Zoom","share":"Share","playVideo":"Play Video","previous":"Previous","next":"Next","close":"Close","a11yCarouselWrapperAriaLabel":"Carousel | Horizontal scrolling: Arrow Left & Right","a11yCarouselPrevSlideMessage":"Previous slide","a11yCarouselNextSlideMessage":"Next slide","a11yCarouselFirstSlideMessage":"This is the first slide","a11yCarouselLastSlideMessage":"This is the last slide","a11yCarouselPaginationBulletMessage":"Go to slide"},"is_rtl":false,"breakpoints":{"xs":0,"sm":480,"md":768,"lg":1025,"xl":1440,"xxl":1600},"responsive":{"breakpoints":{"mobile":{"label":"Mobile Portrait","value":767,"default_value":767,"direction":"max","is_enabled":true},"mobile_extra":{"label":"Mobile Landscape","value":880,"default_value":880,"direction":"max","is_enabled":false},"tablet":{"label":"Tablet Portrait","value":1024,"default_value":1024,"direction":"max","is_enabled":true},"tablet_extra":{"label":"Tablet Landscape","value":1200,"default_value":1200,"direction":"max","is_enabled":false},"laptop":{"label":"Laptop","value":1366,"default_value":1366,"direction":"max","is_enabled":false},"widescreen":{"label":"Widescreen","value":2400,"default_value":2400,"direction":"min","is_enabled":false}}},"version":"3.18.3","is_static":false,"experimentalFeatures":{"e_dom_optimization":true,"e_optimized_assets_loading":true,"additional_custom_breakpoints":true,"theme_builder_v2":true,"block_editor_assets_optimize":true,"landing-pages":true,"e_image_loading_optimization":true,"e_global_styleguide":true,"page-transitions":true,"notes":true,"form-submissions":true,"e_scroll_snap":true},"urls":{"assets":"https:\/\/www.0ffset.net\/wp-content\/plugins\/elementor\/assets\/"},"swiperClass":"swiper-container","settings":{"page":[],"editorPreferences":[]},"kit":{"active_breakpoints":["viewport_mobile","viewport_tablet"],"global_image_lightbox":"yes","lightbox_enable_counter":"yes","lightbox_enable_fullscreen":"yes","lightbox_enable_zoom":"yes","lightbox_enable_share":"yes","lightbox_title_src":"title","lightbox_description_src":"description","woocommerce_notices_elements":[]},"post":{"id":3229,"title":"Analysing%20ISFB%20%E2%80%93%20The%20First%20Loader%20%7C%200ffset%20Training%20Solutions","excerpt":"","featuredImage":"https:\/\/www.0ffset.net\/wp-content\/uploads\/2021\/06\/bss_psuedo.png"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor/assets/js/frontend.min.js?ver=3.18.3" id="elementor-frontend-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/elementor-pro/assets/js/elements-handlers.min.js?ver=3.18.2" id="pro-elements-handlers-js"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/zoom/jquery.zoom.min.js?ver=1.7.21-wc.8.4.0" id="zoom-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/flexslider/jquery.flexslider.min.js?ver=2.7.2-wc.8.4.0" id="flexslider-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/photoswipe/photoswipe.min.js?ver=4.1.1-wc.8.4.0" id="photoswipe-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/photoswipe/photoswipe-ui-default.min.js?ver=4.1.1-wc.8.4.0" id="photoswipe-ui-default-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/underscore.min.js?ver=1.13.4" id="underscore-js"></script>
<script type="text/javascript" id="wp-util-js-extra">
/* <![CDATA[ */
var _wpUtilSettings = {"ajax":{"url":"\/wp-admin\/admin-ajax.php"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-includes/js/wp-util.min.js?ver=6.4.2" id="wp-util-js"></script>
<script type="text/javascript" id="wc-add-to-cart-variation-js-extra">
/* <![CDATA[ */
var wc_add_to_cart_variation_params = {"wc_ajax_url":"\/?wc-ajax=%%endpoint%%","i18n_no_matching_variations_text":"Sorry, no products matched your selection. Please choose a different combination.","i18n_make_a_selection_text":"Please select some product options before adding this product to your basket.","i18n_unavailable_text":"Sorry, this product is unavailable. Please choose a different combination."};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/add-to-cart-variation.min.js?ver=8.4.0" id="wc-add-to-cart-variation-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="wc-single-product-js-extra">
/* <![CDATA[ */
var wc_single_product_params = {"i18n_required_rating_text":"Please select a rating","review_rating_required":"yes","flexslider":{"rtl":false,"animation":"slide","smoothHeight":true,"directionNav":false,"controlNav":"thumbnails","slideshow":false,"animationSpeed":500,"animationLoop":false,"allowOneSlide":false},"zoom_enabled":"1","zoom_options":[],"photoswipe_enabled":"1","photoswipe_options":{"shareEl":false,"closeOnScroll":false,"history":false,"hideAnimationDuration":0,"showAnimationDuration":0},"flexslider_enabled":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.0ffset.net/wp-content/plugins/woocommerce/assets/js/frontend/single-product.min.js?ver=8.4.0" id="wc-single-product-js" defer="defer" data-wp-strategy="defer"></script>
		<script>'undefined'=== typeof _trfq || (window._trfq = []);'undefined'=== typeof _trfd && (window._trfd=[]),_trfd.push({'tccl.baseHost':'secureserver.net'}),_trfd.push({'ap':'wpaas'},{'server':'4b522bc6-b590-e72d-e2cb-58a1b520225d.secureserver.net'},{'pod':'n3nlwppod03'},{'storage':'n3cephmah003pod03_data12'},{'xid':'42941395'},{'wp':'6.4.2'},{'php':'8.0.30'},{'loggedin':'0'},{'cdn':'0'},{'builder':'wp-block-editor'},{'theme':'engitech'},{'wds':'0'},{'wp_alloptions_count':'715'},{'wp_alloptions_bytes':'286772'})</script>
		<script>window.addEventListener('click', function (elem) { var _elem$target, _elem$target$dataset, _window, _window$_trfq; return (elem === null || elem === void 0 ? void 0 : (_elem$target = elem.target) === null || _elem$target === void 0 ? void 0 : (_elem$target$dataset = _elem$target.dataset) === null || _elem$target$dataset === void 0 ? void 0 : _elem$target$dataset.eid) && ((_window = window) === null || _window === void 0 ? void 0 : (_window$_trfq = _window._trfq) === null || _window$_trfq === void 0 ? void 0 : _window$_trfq.push(["cmdLogEvent", "click", elem.target.dataset.eid]));});</script>
		<script src='https://img1.wsimg.com/tcc/tcc_l.combined.1.0.6.min.js'></script>
		<script src='https://img1.wsimg.com/traffic-assets/js/tccl-tti.min.js' onload="window.tti.calculateTTI()"></script>
		
</body>
</html>
