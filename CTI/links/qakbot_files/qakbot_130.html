<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Deep Analysis of QBot Banking Trojan - n1ghtw0lf</title>
<meta name="description" content="Qbot is a modular information stealer also known as Qakbot. It has been active for years since 2007. It has… ">


  <meta name="author" content="Abdallah Elshinbary">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="n1ghtw0lf">
<meta property="og:title" content="Deep Analysis of QBot Banking Trojan">
<meta property="og:url" content="https://n1ght-w0lf.github.io/malware%20analysis/qbot-banking-trojan/">


  <meta property="og:description" content="Qbot is a modular information stealer also known as Qakbot. It has been active for years since 2007. It has… ">



  <meta property="og:image" content="https://n1ght-w0lf.github.io/assets/images/malware-analysis/qbot-banking-trojan/logo.png">





  <meta property="article:published_time" content="2020-07-15T00:00:00+00:00">





  

  


<link rel="canonical" href="https://n1ght-w0lf.github.io/malware%20analysis/qbot-banking-trojan/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Abdallah Elshinbary",
      "url": "https://n1ght-w0lf.github.io/"
    
  }
</script>


  <meta name="google-site-verification" content="J3MnMF94zaZhTUoNtUiRt9cKsr7hiMyTxEdAvQ3GfmY" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="n1ghtw0lf Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site_data/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site_data/favicon-16x16.png">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/site_data/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          n1ghtw0lf
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/#malware-analysis">Malware Analysis</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#binary-exploitation">Binary Exploitation</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#ctf-writeups">CTF Writeups</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#tutorials">Tutorials</a>
            </li><li class="masthead__menu-item">
              <a href="/categories">All Categories</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/site_data/avatar.jpg" alt="Abdallah Elshinbary" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Abdallah Elshinbary</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Malware Analysis &amp; Reverse Engineering Adventures.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="" rel="nofollow noopener noreferrer"><i class="fas fa-briefcase" aria-hidden="true"></i><span class="label">OPEN TO WORK</span></a></li>
          
        
          
            <li><a href="mailto:abdallahelshinbary82@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://twitter.com/_n1ghtw0lf" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/abdallah-elshinbary/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/n1ght-w0lf" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/n1ghtw0lf" rel="nofollow noopener noreferrer"><i class="fas fa-mug-hot" aria-hidden="true"></i><span class="label">Buy Me a Coffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Deep Analysis of QBot Banking Trojan">
    <meta itemprop="description" content="QBot is a modular information stealer also known as Qakbot or Pinkslipbot. It has been active for years since 2007. It has historically been known as a banking Trojan, meaning that it steals financial data from infected systems.">
    <meta itemprop="datePublished" content="2020-07-15T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Deep Analysis of QBot Banking Trojan
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  11 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#infection-flow">Infection Flow</a></li>
  <li><a href="#unpacking">Unpacking</a></li>
  <li><a href="#encrypted-strings">Encrypted Strings</a></li>
  <li><a href="#anti-analysis">Anti-Analysis</a>
    <ul>
      <li><a href="#checking-vm">Checking VM</a></li>
      <li><a href="#checking-processes">Checking Processes</a></li>
      <li><a href="#checking-dlls">Checking DLLs</a></li>
      <li><a href="#checking-filename">Checking Filename</a></li>
      <li><a href="#checking-cpu">Checking CPU</a></li>
    </ul>
  </li>
  <li><a href="#back-to-parent">Back To Parent</a></li>
  <li><a href="#configuration-file">Configuration File</a></li>
  <li><a href="#persistence">Persistence</a></li>
  <li><a href="#process-injection">Process Injection</a></li>
  <li><a href="#core-module">Core Module</a></li>
  <li><a href="#c2-communication">C2 Communication</a></li>
  <li><a href="#commands-list">Commands List</a>
    <ul>
      <li><a href="#command-13-lateral-movement">Command 13: Lateral Movement</a></li>
      <li><a href="#command-21-collecting-installed-applications">Command 21: Collecting Installed Applications</a></li>
      <li><a href="#command-31-fetching-plugins">Command 31: Fetching Plugins</a></li>
    </ul>
  </li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#iocs">IOCs</a></li>
  <li><a href="#references">References</a></li>
</ul>

            </nav>
          </aside>
        
        <p>QBot is a modular information stealer also known as Qakbot or Pinkslipbot. It has been active for years since 2007. It has historically been known as a banking Trojan, meaning that it steals financial data from infected systems.</p>

<h1 id="infection-flow">Infection Flow</h1>

<p>QBot can be delivered in various different ways including Malspam (Malicious Spam) or dropped by other malware families like Emotet.</p>

<p>The infection flow for this campaign is as follows:</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/1.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/1.png" alt="1" /></a></p>

<p>First, the victim receives a phishing email with a link to a malicious zip file.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/2.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/2.png" alt="2" /></a></p>

<p>The zip file contains a very obfuscated VBS file which downloads and launches Qbot executable.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/3.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/3.png" alt="3" /></a></p>

<p>The VBS file tries to download Qbot from different places:</p>

<ul>
  <li>http://st29[.]ru/tbzirttmcnmb/88888888.png</li>
  <li>http://restaurantbrighton[.]ru/uyqcb/88888888.png</li>
  <li>http://royalapartments[.]pl/vtjwwoqxaix/88888888.png</li>
  <li>http://alergeny.dietapacjenta[.]pl/pgaakzs/88888888.png</li>
  <li>http://egyorg[.]com/vxvipjfembb/88888888.png</li>
</ul>

<p>Notice the misleading URL, it looks like it’s downloading a PNG image but the raw data says something else.</p>

<h1 id="unpacking">Unpacking</h1>

<p>QBot is packed with a custom packer, but the unpacking process is really simple. It allocates memory for the unpacked code using <code class="language-plaintext highlighter-rouge">VirtualAlloc()</code> and changes memory protection using <code class="language-plaintext highlighter-rouge">VirtualProtect()</code>. So we just need 2 breakpoints at  <code class="language-plaintext highlighter-rouge">VirtualAlloc()</code>  and  <code class="language-plaintext highlighter-rouge">VirtualProtect()</code>.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/4.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/4.png" alt="4" /></a></p>

<h1 id="encrypted-strings">Encrypted Strings</h1>

<p>Most of QBot strings are encrypted (stored in a continuous blob) and they are decrypted on demand. The decryption routine accepts one argument which is the  index to the string then it XORs it with a hardcoded bytes array until it encounters a null byte.</p>

<p>We can use IDAPython to decrypt the strings and add them as comments.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">idc</span>
<span class="kn">import</span> <span class="nn">idautils</span>

<span class="n">dec_routine</span> <span class="o">=</span> <span class="mh">0x4065B7</span>
<span class="n">enc_strings</span> <span class="o">=</span> <span class="mh">0x40B930</span>
<span class="n">bytes_arr</span> <span class="o">=</span> <span class="mh">0x410120</span>

<span class="k">def</span> <span class="nf">decrypt_string</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mh">0x36F4</span><span class="p">:</span>
        <span class="k">return</span>    <span class="c1"># out of bounds
</span>    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_wide_byte</span><span class="p">(</span><span class="n">enc_strings</span><span class="o">+</span><span class="n">idx</span><span class="p">)</span> <span class="o">^</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_wide_byte</span><span class="p">(</span><span class="n">bytes_arr</span> <span class="o">+</span> <span class="p">(</span><span class="n">idx</span><span class="o">&amp;</span><span class="mh">0x3F</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">xrefs</span> <span class="o">=</span> <span class="n">idautils</span><span class="p">.</span><span class="n">CodeRefsTo</span><span class="p">(</span><span class="n">dec_routine</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xrefs</span><span class="p">:</span>
    <span class="n">ea</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">prev_head</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_imm</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">decrypt_string</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">set_cmt</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>And here is the result, that’s much easier to work with.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/5.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/5.png" alt="5" /></a></p>

<p>This should take care of most of the strings, the rest of strings indexes are calculated dynamically at runtime.</p>

<p>We decrypt all strings by looping through the encrypted blob and decrypt strings one by one.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mh">0x36F4</span><span class="p">:</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">decrypt_string</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="anti-analysis">Anti-Analysis</h1>

<p>QBot spawns a new process of itself with the  <code class="language-plaintext highlighter-rouge">"/C"</code> parameter, this process is responsible for doing Anti-Analysis checks.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/6.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/6.png" alt="6" /></a></p>

<p>The parent process checks the exit code of this spawned process. If the exit code is not 0, it means that QBot is being analyzed (and so it exits).</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/7.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/7.png" alt="7" /></a></p>

<p>So let’s go over the anti-analysis techniques.</p>

<h2 id="checking-vm">Checking VM</h2>

<p>In VMWare, communication with the host is done through a specific I/O  port <code class="language-plaintext highlighter-rouge">(0x5658)</code>, so QBot uses the <code class="language-plaintext highlighter-rouge">in</code> assembly instruction to detect VMWare by reading from this port and checking the return value in <code class="language-plaintext highlighter-rouge">ebx</code> if it’s equal to <code class="language-plaintext highlighter-rouge">VMXh</code> (VMware magic value).</p>

<p>If we are outside VMWare, a privilege error occurs and this code will return 0.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/8.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/8.png" alt="8" /></a></p>

<p>Another Anti-VM trick is to check hardware devices against known devices names used by VMs and Sandboxes.</p>

<p>Here is the list of devices names.</p>

<details style="color: #EEFFFF; font-family: monospace !default; font-size: 0.85em; background: #263238; border: 1px solid #263238; border-radius: 3px; padding: 10px; line-height: 2.2; overflow-x: scroll;">
    <summary style="outline: none; cursor: pointer">
        <span style="color: darkgray">
            Expand to see more
        </span><br />
<div style="height: 1px"></div>
&emsp; VMware Pointing<br />
&emsp; VMware Accelerated<br />
&emsp; VMware SCSI<br />
&emsp; VMware SVGA<br />
&emsp; VMware Replay<br />
&emsp; VMware server memory<br />
</summary>
&emsp; CWSandbox<br />
&emsp; Virtual HD<br />
&emsp; QEMU<br />
&emsp; Red Hat VirtIO<br />
&emsp; srootkit<br />
&emsp; VMware VMaudio<br />
&emsp; VMware Vista<br />
&emsp; VBoxVideo<br />
&emsp; VBoxGuest<br />
&emsp; vmxnet<br />
&emsp; vmscsi<br />
&emsp; VMAUDIO<br />
&emsp; vmdebug<br />
&emsp; vm3dmp<br />
&emsp; vmrawdsk<br />
&emsp; vmx_svga<br />
&emsp; ansfltr<br />
&emsp; sbtisht<br />
</details>

<h2 id="checking-processes">Checking Processes</h2>

<p>QBot loops through running processes and compares their executable names against known analysis tools.</p>

<details style="color: #EEFFFF; font-family: monospace !default; font-size: 0.85em; background: #263238; border: 1px solid #263238; border-radius: 3px; padding: 10px; line-height: 2.2; overflow-x: scroll;">
    <summary style="outline: none; cursor: pointer">
        <span style="color: darkgray">
            Expand to see more
        </span><br />
<div style="height: 1px"></div>
&emsp; Fiddler.exe<br />
&emsp; samp1e.exe<br />
&emsp; sample.exe<br />
&emsp; runsample.exe<br />
&emsp; lordpe.exe<br />
&emsp; regshot.exe<br />
</summary>
&emsp; Autoruns.exe<br />
&emsp; dsniff.exe<br />
&emsp; VBoxTray.exe<br />
&emsp; HashMyFiles.exe<br />
&emsp; ProcessHacker.exe<br />
&emsp; Procmon.exe<br />
&emsp; Procmon64.exe<br />
&emsp; netmon.exe<br />
&emsp; vmtoolsd.exe<br />
&emsp; vm3dservice.exe<br />
&emsp; VGAuthService.exe<br />
&emsp; pr0c3xp.exe<br />
&emsp; CFF Explorer.exe<br />
&emsp; dumpcap.exe<br />
&emsp; Wireshark.exe<br />
&emsp; idaq.exe<br />
&emsp; idaq64.exe<br />
&emsp; TPAutoConnect.exe<br />
&emsp; ResourceHacker.exe<br />
&emsp; vmacthlp.exe<br />
&emsp; OLLYDBG.EXE<br />
&emsp; windbg.exe<br />
&emsp; bds-vision-agent-nai.exe<br />
&emsp; bds-vision-apis.exe<br />
&emsp; bds-vision-agent-app.exe<br />
&emsp; MultiAnalysis_v1.0.294.exe<br />
&emsp; x32dbg.exe<br />
&emsp; VBoxService.exe<br />
&emsp; Tcpview.exe<br />
</details>

<h2 id="checking-dlls">Checking DLLs</h2>

<p>Sandbox detection can be done by enumerating loaded DLLs and comparing them against known DLLs used by sandboxes. Here it’s just using 2 of them.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ivm-inject.dll     # Buster Sandbox Analyzer
SbieDll.dll        # SandBoxie
</code></pre></div></div>

<h2 id="checking-filename">Checking Filename</h2>

<p>Some sandboxes may change the sample file name. So QBot checks if its process name contains one of these strings.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sample
mlwr_smpl
artifact.exe
</code></pre></div></div>

<h2 id="checking-cpu">Checking CPU</h2>

<p>The last check is done using <code class="language-plaintext highlighter-rouge">CPUID</code> instruction. First it is executed with <code class="language-plaintext highlighter-rouge">EAX=0</code> to get the CPU vendor and compares it with <code class="language-plaintext highlighter-rouge">GenuineIntel</code> (Intel processor).</p>

<p>Then it is executed with <code class="language-plaintext highlighter-rouge">EAX=1</code> to get the processors features.</p>

<p>On a physical machine the last bit will be equal to 0. On a guest VM it will equal to 1.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/9.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/9.png" alt="9" /></a></p>

<h1 id="back-to-parent">Back To Parent</h1>

<p>After the Anti-Analysis checks, QBot drops a copy of itself along with a configuration file at <code class="language-plaintext highlighter-rouge">"%APPDATA%\Microsoft\&lt;random_folder_name&gt;"</code>.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/10.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/10.png" alt="10" /></a></p>

<p>Finally, QBot starts the dropped copy in a new process and overwrites itself with a legitimate executable, here it’s  <code class="language-plaintext highlighter-rouge">"calc.exe"</code>.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/11.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/11.png" alt="11" /></a></p>

<h1 id="configuration-file">Configuration File</h1>

<p>The dropped configuration file is accessed frequently by Qbot, this file is RC4 encrypted. By setting a breakpoint before the contents of the file gets encrypted I got the following data:</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>10=spx143</td>
      <td>Campaign ID</td>
    </tr>
    <tr>
      <td>11=2</td>
      <td>Number of hardcoded C2</td>
    </tr>
    <tr>
      <td>1=13.59.00-24/06/2020</td>
      <td>Date of Qbot install in HH:MM:ss-dd/mm/yyyy</td>
    </tr>
    <tr>
      <td>2=1592996340</td>
      <td>Victim Qbot install</td>
    </tr>
    <tr>
      <td>50=1</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>5=VgBCAE8AWABTAFYAUgA7ADIA</td>
      <td>Victim network shares</td>
    </tr>
    <tr>
      <td>38=1593047244</td>
      <td>Last victim call to C2 (Unix time)</td>
    </tr>
    <tr>
      <td>45=187.163.101.137</td>
      <td>C2 IP</td>
    </tr>
    <tr>
      <td>46=995</td>
      <td>C2 port</td>
    </tr>
    <tr>
      <td>39=45.242.76.104</td>
      <td>Victim external IP</td>
    </tr>
    <tr>
      <td>43=1593006172</td>
      <td>Time of record (Unix time)</td>
    </tr>
    <tr>
      <td>49=1</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<h1 id="persistence">Persistence</h1>

<p>QBot achieves persistence by creating a new registry value under the key <code class="language-plaintext highlighter-rouge">"HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</code>. It also registers a scheduled task that runs every 5 hours.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/12.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/12.png" alt="12" /></a></p>

<h1 id="process-injection">Process Injection</h1>

<p>QBot tries to inject its unpacked code in one of these processes <code class="language-plaintext highlighter-rouge">("explorer.exe", "mobsync.exe", "iexplorer.exe")</code> and it uses <code class="language-plaintext highlighter-rouge">Process Hollowing</code> technique to achieve that.</p>

<p>It first starts a new suspended process with <code class="language-plaintext highlighter-rouge">CreateProcessW()</code> then it writes the injected code into the target process using <code class="language-plaintext highlighter-rouge">ZwCreateSection()</code>, <code class="language-plaintext highlighter-rouge">ZwMapViewOfSection()</code> and <code class="language-plaintext highlighter-rouge">ZwWriteVirtualMemory()</code>.</p>

<p>Finally it sets the thread context to jump to the injected code and resume execution with <code class="language-plaintext highlighter-rouge">ResumeThread()</code>.</p>

<h1 id="core-module">Core Module</h1>

<p>The injected code loads and decrypts one of its resources  <code class="language-plaintext highlighter-rouge">"307"</code> . After dumping it, I found out that it’s a DLL (this is the core module).</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/13.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/13.png" alt="13" /></a></p>

<p>From now on, we will be analyzing the core DLL of QBot.</p>

<p>The core module has 2 resources both RC4 encrypted.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/14.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/14.png" alt="14" /></a></p>

<p>The first resource gets loaded into memory then RC4 decrypted.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/15.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/15.png" alt="15" /></a></p>

<p>The contents of the decrypted resource are:</p>

<ul>
  <li>
    <p>10=spx143 (Campaign ID)</p>
  </li>
  <li>
    <p>3=1592482956 (Timestamp)</p>
  </li>
</ul>

<p>After some digging, I found out how the resources are decrypted. The first <strong>20</strong> bytes of each resource are the RC4 key of this resource, and the rest are the actual encrypted data.</p>

<p>So by using this find, we can decrypt the other resource <code class="language-plaintext highlighter-rouge">"311"</code>.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/16.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/16.png" alt="16" /></a></p>

<p>Great!!! Now we have the list of C2 servers (150 servers!).</p>

<p>The reason there is many controllers is that these are actually just proxies of infected bots acting as intermediate nodes between the victim and the real C2 and thus hiding the backend infrastructure of the attacker.</p>

<p>So it works like this:</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/17.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/17.png" alt="17" /></a></p>

<h1 id="c2-communication">C2 Communication</h1>

<p>QBot obfuscates its communication with the C2 server by encrypting the payloads using RC4 and encoding the result using Base64.</p>

<p>The communication is also done over SSL, you can notice that the traffic has unusual certificate issuer data.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/18.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/18.png" alt="18" /></a></p>

<p>We can use <code class="language-plaintext highlighter-rouge">Fiddler</code> to intercept and decrypt the HTTPS traffic.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/19.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/19.png" alt="19" /></a></p>

<p>The RC4 key for encrypting the payload is the SHA1 hash of the first 16 bytes of the Base64-decoded payload + a hardcoded salt (The salt is stored as an encrypted string).</p>

<p>Here is an implementation of the decryption algorithm:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HARDCODED_SALT</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"jHxastDcds)oMc=jvh7wdUhxcsdt2"</span>    <span class="c1"># decrypted string
</span>
<span class="k">def</span> <span class="nf">decrypt_payload</span><span class="p">(</span><span class="n">encrypted_blob</span><span class="p">):</span>
    <span class="n">b64_decoded</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encrypted_blob</span><span class="p">)</span>
    <span class="n">decryption_key</span> <span class="o">=</span> <span class="n">b64_decoded</span><span class="p">[:</span><span class="mh">0x10</span><span class="p">]</span> <span class="o">+</span> <span class="n">HARDCODED_SALT</span>
    <span class="n">sha1hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha1</span><span class="p">()</span>
    <span class="n">sha1hash</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">decryption_key</span><span class="p">)</span>
    <span class="n">decryption_key_hash</span> <span class="o">=</span> <span class="n">sha1hash</span><span class="p">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">rc4</span> <span class="o">=</span> <span class="n">ARC4</span><span class="p">(</span><span class="n">decryption_key_hash</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rc4</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">b64_decoded</span><span class="p">[</span><span class="mh">0x10</span><span class="p">:])</span>
</code></pre></div></div>

<p>The decrypted payload is in JSON form.</p>

<ul>
  <li>Decrypted C2 Request: {“8”:9,”1”:17,”2”:”pnmfcq111232”}</li>
  <li>Decrypted C2 Response: {“8”:5,”16”:770897804,”39”:”V4UnoDQSEblewhh63UfUqAns”,”38”:1}</li>
</ul>

<h1 id="commands-list">Commands List</h1>

<p>After establishing communication, the C2 server will send commands indexes to be executed.</p>

<p>Here is the list of commands and their corresponding indexes (I have renamed the important commands).</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/20.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/20.png" alt="20" /></a></p>

<p>It’s worth mentioning that dynamic imports of the core DLL are stored in the same format as commands <code class="language-plaintext highlighter-rouge">"&lt;address, API_index, DLL_index&gt;"</code>, the API and DLL indexes are passed to the string decryption routine which returns their corresponding names then it uses <code class="language-plaintext highlighter-rouge">LoadLibrary</code> and <code class="language-plaintext highlighter-rouge">GetProcAddress</code> to resolve the imports.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/21.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/21.png" alt="21" /></a></p>

<p>Let’s go through some of the interesting commands.</p>

<h2 id="command-13-lateral-movement">Command 13: Lateral Movement</h2>

<p>QBot can spread through the network by enumerating network shares using <code class="language-plaintext highlighter-rouge">WNetOpenEnumW()</code> and <code class="language-plaintext highlighter-rouge">WNetEnumResourceW</code>() then it drops a copy of Qbot into the shared folders.</p>

<p>Then the dropped executable is registered as an auto-start service on the target machine. The names for the service and the dropped file are randomly generated strings.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/22.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/22.png" alt="22" /></a></p>

<p>Finally, Qbot deletes the created service and dropped file from the target machine (as it’s successfully infected).</p>

<h2 id="command-21-collecting-installed-applications">Command 21: Collecting Installed Applications</h2>

<p>QBot can collect installed applications by enumeration subkeys of the registry key <code class="language-plaintext highlighter-rouge">"HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall"</code>.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/23.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/23.png" alt="23" /></a></p>

<p>The collected data is appended to the end of a string containing additional information about the victim’s machine and time of collection.</p>

<p><code class="language-plaintext highlighter-rouge">t=i1 time=[&lt;time_of_collect&gt;] ext_ip=[&lt;external_IP&gt;] dnsname=[?] hostname=[&lt;computer_name&gt;] user=[] domain=[] is_admin=[&lt;YES/NO&gt;] os=[&lt;windows_ver&gt;] qbot_version=[&lt;qbot_ver&gt;] install_time=[&lt;qbot_install_time&gt;] exe=[&lt;injected_process&gt;] prod_id=[NULL] iface_n=[&lt;interface_IP&gt;/&lt;interface_IP&gt;] UP] soft=[&lt;app1;ver&gt;|&lt;app2;ver&gt;|...]</code></p>

<p>Example of collected data:</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/24.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/24.png" alt="24" /></a></p>

<p>Then the data is RC4 encrypted and written to <code class="language-plaintext highlighter-rouge">"wdqlxw32.dll"</code> at the same directory of QBot.</p>

<p>Finally, <code class="language-plaintext highlighter-rouge">"wdqlxw32.dll"</code> is Zlib compressed and RC4 encrypted again then it’s saved to <code class="language-plaintext highlighter-rouge">"cwdqlxw32.dll"</code> and the original <code class="language-plaintext highlighter-rouge">"wdqlxw32.dll"</code> is deleted.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/25.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/25.png" alt="25" /></a></p>

<p>The compressed file is then transfered to the C2 server (RC4 encrypted and Base64 encoded) in the key <code class="language-plaintext highlighter-rouge">"36"</code> and the compressed file <code class="language-plaintext highlighter-rouge">"cwdqlxw32.dll"</code> is also deleted.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/26.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/26.png" alt="26" /></a></p>

<h2 id="command-31-fetching-plugins">Command 31: Fetching Plugins</h2>

<p>As we said before, QBot is known to be a modular malware. It can load additional plugins received from the C2 server (plugins are RC4 encrypted and Base64 encoded).</p>

<p>QBot tries to inject the received plugin in 3 different processes depending on the machine architecture.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/27.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/27.png" alt="27" /></a></p>

<p>It creates a new suspended process then writes the plugin to the process memory using <code class="language-plaintext highlighter-rouge">WriteProcessMemory()</code> and then resumes the injected process.</p>

<p><a href="/assets/images/malware-analysis/qbot-banking-trojan/28.png"><img src="/assets/images/malware-analysis/qbot-banking-trojan/28.png" alt="28" /></a></p>

<p>At the time of writing this, Qbot has 3 different plugins (“Password grabber”, “Cookie grabber”, “UPnP module”).</p>

<h1 id="conclusion">Conclusion</h1>

<p>QBot is considered to be a sophisticated malware, it’s receiving regular updates from time to time and it’s not likely to go away anytime soon.</p>

<p>There is still more features that I didn’t cover such as WebInjects so maybe I will come back to Qbot later I guess :)</p>

<h1 id="iocs">IOCs</h1>

<h4 id="hashes"><u>Hashes</u></h4>

<p>VBS File: b734caf792c968ca1870c3ec7dda68ad5dc47fef548751afb8509752c185a756</p>

<p>QBot: 112a64190b9a0f356880eebf05e195f4c16407032bf89fa843fd136da6f5d515</p>

<h4 id="urls"><u>URLs</u></h4>

<p>http://st29[.]ru/tbzirttmcnmb/88888888.png</p>

<p>http://restaurantbrighton[.]ru/uyqcb/88888888.png</p>

<p>http://royalapartments[.]pl/vtjwwoqxaix/88888888.png</p>

<p>http://alergeny.dietapacjenta[.]pl/pgaakzs/88888888.png</p>

<p>http://egyorg[.]com/vxvipjfembb/88888888.png</p>

<h4 id="c2-domains"><u>C2 Domains</u></h4>

<p>39.36.254.179:995</p>

<p>24.139.132.70:443</p>

<p>24.202.42.48:2222</p>

<p>72.204.242.138:443</p>

<p>172.242.156.50:995</p>

<p>72.204.242.138:20</p>

<p>68.174.15.223:443</p>

<p>74.193.197.246:443</p>

<p>96.56.237.174:990</p>

<p>64.19.74.29:995</p>

<p>70.168.130.172:443</p>

<p>189.236.166.167:443</p>

<p>68.4.137.211:443</p>

<p>76.187.8.160:443</p>

<p>76.86.57.179:2222</p>

<p>73.226.220.56:443</p>

<p>67.250.184.157:443</p>

<p>75.183.171.155:3389</p>

<p>173.172.205.216:443</p>

<p>173.3.132.17:995</p>

<p>172.78.30.215:443</p>

<p>207.255.161.8:32103</p>

<p>75.137.239.211:443</p>

<p>68.49.120.179:443</p>

<p>206.51.202.106:50003</p>

<p>82.127.193.151:2222</p>

<p>207.255.161.8:2222</p>

<p>207.255.161.8:2087</p>

<p>24.152.219.253:995</p>

<p>187.19.151.218:995</p>

<p>197.37.48.37:993</p>

<p>188.241.243.175:443</p>

<p>72.88.119.131:443</p>

<p>89.137.211.239:443</p>

<p>108.30.125.94:443</p>

<p>187.163.101.137:995</p>

<p>100.19.7.242:443</p>

<p>45.77.164.175:443</p>

<p>80.240.26.178:443</p>

<p>66.208.105.6:443</p>

<p>207.246.75.201:443</p>

<p>199.247.22.145:443</p>

<p>199.247.16.80:443</p>

<p>95.77.223.148:443</p>

<p>68.60.221.169:465</p>

<p>5.107.220.84:2222</p>

<p>41.228.212.22:443</p>

<p>86.233.4.153:2222</p>

<p>68.200.23.189:443</p>

<p>201.146.127.158:443</p>

<p>79.114.199.39:443</p>

<p>87.65.204.240:995</p>

<p>71.74.12.34:443</p>

<p>217.162.149.212:443</p>

<p>195.162.106.93:2222</p>

<p>75.165.112.82:50002</p>

<p>201.248.102.4:2078</p>

<p>96.41.93.96:443</p>

<p>89.247.216.127:443</p>

<p>84.232.238.30:443</p>

<p>103.238.231.40:443</p>

<p>174.34.67.106:2222</p>

<p>98.115.138.61:443</p>

<p>91.125.21.16:2222</p>

<p>84.247.55.190:443</p>

<p>193.248.44.2:2222</p>

<p>74.135.37.79:443</p>

<p>78.96.190.54:443</p>

<p>86.126.97.183:2222</p>

<p>2.50.47.97:2222</p>

<p>68.39.160.40:443</p>

<p>96.232.203.15:443</p>

<p>86.144.150.29:2222</p>

<p>71.220.191.200:443</p>

<p>24.231.54.185:2222</p>

<p>80.14.209.42:2222</p>

<p>24.164.79.147:443</p>

<p>70.183.127.6:995</p>

<p>47.153.115.154:993</p>

<p>184.180.157.203:2222</p>

<p>50.104.68.223:443</p>

<p>67.165.206.193:995</p>

<p>200.113.201.83:993</p>

<p>47.153.115.154:465</p>

<p>24.42.14.241:995</p>

<p>189.160.203.110:443</p>

<p>188.27.76.139:443</p>

<p>207.255.161.8:32102</p>

<p>49.207.105.25:443</p>

<p>71.210.177.4:443</p>

<p>117.242.253.163:443</p>

<p>50.244.112.106:443</p>

<p>69.92.54.95:995</p>

<p>41.34.91.90:995</p>

<p>72.204.242.138:53</p>

<p>41.97.138.74:443</p>

<p>72.29.181.77:2078</p>

<p>71.88.168.176:443</p>

<p>2.50.171.142:443</p>

<p>67.83.54.76:2222</p>

<p>86.125.145.90:2222</p>

<p>47.153.115.154:995</p>

<p>24.122.157.93:443</p>

<p>47.146.169.85:443</p>

<p>72.181.9.163:443</p>

<p>187.155.74.5:443</p>

<p>71.209.187.4:443</p>

<p>74.75.216.202:443</p>

<p>24.44.180.236:2222</p>

<p>24.43.22.220:993</p>

<p>108.188.116.179:443</p>

<p>100.4.173.223:443</p>

<p>76.170.77.99:443</p>

<p>70.95.118.217:443</p>

<p>134.0.196.46:995</p>

<p>68.225.56.31:443</p>

<p>72.204.242.138:32102</p>

<p>72.204.242.138:50001</p>

<p>108.190.151.108:2222</p>

<p>72.204.242.138:465</p>

<p>50.244.112.10:443</p>

<p>173.22.120.11:2222</p>

<p>24.43.22.220:995</p>

<p>24.43.22.220:443</p>

<p>92.17.167.87:2222</p>

<p>72.209.191.27:443</p>

<p>72.204.242.138:80</p>

<p>72.204.242.138:443</p>

<p>71.187.170.235:443</p>

<p>96.56.237.174:32103</p>

<p>71.187.7.239:443</p>

<p>184.98.104.7:995</p>

<p>70.124.29.226:443</p>

<p>137.99.224.198:443</p>

<p>73.23.194.75:443</p>

<p>151.205.102.42:443</p>

<p>64.224.76.152:443</p>

<p>72.204.242.138:32100</p>

<p>173.187.101.221:443</p>

<p>72.179.13.59:443</p>

<p>208.93.202.49:443</p>

<p>70.174.3.241:443</p>

<p>96.37.137.42:443</p>

<p>76.111.128.194:443</p>

<p>67.209.195.198:3389</p>

<p>61.3.184.27:443</p>

<p>24.42.14.241:443</p>

<p>74.56.167.31:443</p>

<p>5.193.61.212:2222</p>

<p>117.216.177.171:443</p>

<h1 id="references">References</h1>

<p><a href="https://www.youtube.com/watch?v=iB1psRMtlqg">Demystifying QBot Banking Trojan - BSides Belfast</a></p>

<p><a href="https://www.virusbulletin.com/virusbulletin/2017/06/vb2016-paper-diving-pinkslipbots-latest-campaign">https://www.virusbulletin.com/virusbulletin/2017/06/vb2016-paper-diving-pinkslipbots-latest-campaign</a></p>

<p><a href="https://www.fortinet.com/blog/threat-research/deep-analysis-qbot-campaign">https://www.fortinet.com/blog/threat-research/deep-analysis-qbot-campaign</a></p>

<p><a href="https://www.vkremez.com/2018/07/lets-learn-in-depth-reversing-of-qakbot.html">https://www.vkremez.com/2018/07/lets-learn-in-depth-reversing-of-qakbot.html</a></p>

<p><a href="https://www.hexacorn.com/blog/2016/07/01/enter-sandbox-part-12-the-library-of-naughty-libraries/">https://www.hexacorn.com/blog/2016/07/01/enter-sandbox-part-12-the-library-of-naughty-libraries/</a></p>

<p><a href="https://www.cyberbit.com/blog/endpoint-security/anti-vm-and-anti-sandbox-explained/">https://www.cyberbit.com/blog/endpoint-security/anti-vm-and-anti-sandbox-explained/</a></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#malware-analysis" class="page__taxonomy-item" rel="tag">Malware Analysis</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-07-15T00:00:00+00:00">July 15, 2020</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/malware%20analysis/anubis-banking-malware/" class="pagination--pager" title="Deep Analysis of Anubis Banking Malware
">Previous</a>
    
    
      <a href="/tutorials/qiling-for-malware-analysis-part-1/" class="pagination--pager" title="Qiling For Malware Analysis: Part 1
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Abdallah Elshinbary. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <script>
  window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
  ga('create','UA-165194559-1','auto');
  ga('set', 'anonymizeIp', false);
  ga('send','pageview')
</script>
<script src="https://www.google-analytics.com/analytics.js" async></script>









  </body>
</html>
