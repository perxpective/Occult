

<!doctype html>

<html lang="en">
    <head>
        


    
    <title>From Macros to No Macros: Continuous Malware Improvements by QakBot | Splunk</title>
	<meta name="description" content="This blog, the Splunk Threat Research Team (STRT) showcases a year's evolution of QakBot. We also dive into a recent change in tradecraft meant to evade security controls. Last, we reverse engineered the QakBot loader to showcase some of its functions. "/>
    <meta name="robots"/>
	<meta charset="utf-8"/>
    
	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-57x57.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-114x114.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-72x72.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-144x144.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-60x60.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-120x120.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-76x76.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-152x152.png"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-196x196.png" sizes="196x196"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-96x96.png" sizes="96x96"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-32x32.png" sizes="32x32"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-16x16.png" sizes="16x16"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-128.png" sizes="128x128"/>
	<link rel="shortcut icon" type="image/x-icon" href="/content/dam/splunk2/images/icons/favicons/favicon.ico"/>
	<meta name="application-name" content="Splunk"/>
	<meta name="msapplication-TileColor" content="#FFFFFF"/>
	<meta name="msapplication-TileImage" content="/content/dam/splunk2/images/icons/favicons/mstile-144x144.png"/>
	<meta name="msapplication-square70x70logo" content="/content/dam/splunk2/images/icons/favicons/mstile-70x70.png"/>
	<meta name="msapplication-square150x150logo" content="/content/dam/splunk2/images/icons/favicons/mstile-150x150.png"/>
	<meta name="msapplication-wide310x150logo" content="/content/dam/splunk2/images/icons/favicons/mstile-310x150.png"/>
	<meta name="msapplication-square310x310logo" content="/content/dam/splunk2/images/icons/favicons/mstile-310x310.png"/>

	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta property="og:title" content="From Macros to No Macros: Continuous Malware Improvements by QakBot"/>
    <meta property="og:description" content="This blog, the Splunk Threat Research Team (STRT) showcases a year's evolution of QakBot. We also dive into a recent change in tradecraft meant to evade security controls. Last, we reverse engineered the QakBot loader to showcase some of its functions. "/>

    

    <meta property="og:image" content="https://www.splunk.com/content/dam/splunk-blogs/images/en_us/2022/heroqak.jpg"/>
    <meta property="og:site_name" content="Splunk-Blogs"/>
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html"/>
	<meta name="article-published_time" property="article:published_time" content="2022-12-01T12:16:10.877-09:00"/>
	<meta name="publish_date" property="og:publish_date" content="2022-12-01T12:16:10.877-09:00"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="From Macros to No Macros: Continuous Malware Improvements by QakBot"/>
    <meta name="twitter:description" content="This blog, the Splunk Threat Research Team (STRT) showcases a year's evolution of QakBot. We also dive into a recent change in tradecraft meant to evade security controls. Last, we reverse engineered the QakBot loader to showcase some of its functions. "/>
    <meta name="twitter:image" content="https://www.splunk.com/content/dam/splunk-blogs/images/en_us/2022/heroqak.jpg"/>

	<link rel="canonical" href="https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html"/>

    <!-- /*[if lt IE 9]*/>
    	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <!/*[endif]*/-->

	<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>

	<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
	
    	
    		<script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"From Macros to No Macros: Continuous Malware Improvements by QakBot","image":["/content/dam/splunk-blogs/images/author-profile-pics/securityresearch_main.jpg","/content/dam/splunk-blogs/images/en_us/2022/heroqak.jpg"],"datePublished":"2022-12-01T12:16:10.877-09:00","dateModified":"2022-12-01T12:16:10.877-09:00"}</script>
    	
	

	
        
            <script> var splunkMeta = {"site":{"language":"en","environment":"production","siteName":"splunk-blogs"},"page":{"modifiedDate":"07-20-2023","urlPath":"https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html","originalPublishDate":"12-01-2022","productArea":"N/A","freeSplunkButton":"https://www.splunk.com/en_us/download/splunk-cloud.html","blogAuthorName":"Splunk Threat Research Team ","blogCategory":"Security","blogBylineDate":"December 01, 2022","campaignGroup":"N/A","containForm":"no","template":"Splunk Blogs Site Page"}};</script>
        
    

	
	<!-- /* Google Tag Manager */-->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=o-xJwbLiQcDVavG_5omUxQ&gtm_preview=env-316&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-TPV7TP');</script>
	<!-- /* End Google Tag Manager */-->
	

        



    
<link rel="stylesheet" href="/etc/clientlibs/splunk/splunk-blogs/dist.f4a6d5de22e92ca789b501f10a94f933.css" type="text/css">




    
<script type="text/javascript" src="/etc.clientlibs/splunk-blogs/components/structure/generalpage/clientlibs/jquery.7c14a783dfeb3d238ccd3edd840d82ee.js"></script>











        <!--WWW-13669: Observability blogs header spacing bug fix-->        
        <script>
            var pageUrl = window.location.href;
            if (pageUrl.indexOf('observability') != -1) {
                document.querySelector('html').classList.add('o11y');
            }
        </script>    
        
    
<script type="text/javascript" src="/etc.clientlibs/splunk-blogs/components/structure/generalpage/clientlibs.3cf9c61ade4978db0e6e55e07ea59f38.js"></script>



        <script>
            if(Cookies.get('WEBID')===undefined && Cookies.get('fed.IsLoggedIn')==='1' && Cookies.get('wcmmode')===undefined && document.getElementById("sharedglobalheader")===null){
                window.location.href= "/saml/login?redirecturl="+encodeURIComponent(window.location.href);
            }
        </script>    
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="M7Q82-FTRNS-TEZ4E-UCSZ2-NQJ9C",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"M7Q82-FTRNS-TEZ4E-UCSZ2-NQJ9C";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="3k5k6vl4tpppgzmsviba-f-060eea071-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"36","ak.cp":"640520","ak.ai":parseInt("418654",10),"ak.ol":"0","ak.cr":6,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"9f918ea8","ak.r":6099,"ak.a2":n,"ak.m":"a","ak.n":"essl","ak.bpcip":"218.186.175.0","ak.cport":16070,"ak.gh":"124.155.222.239","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1704110594","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==66tP9JjRWwAJB+0P++CXF1usX6VUPqrPOAVug1svLUCLuf2AXUBcHL1wX98FRB1CpIBvjj57jLflitkJqJ2p6JvenDrBufb8VJSxj4bIXsTR8OS+F2rnk2ORncPb5lYW1r9DzrDVYccx+ylUrr1798c38PgInLXjpOLAUfw3gKILy8yQtgNVrSQFZysG/Tkx+W9j+CjfWv/dWwu2fYaCndD1iZbxE3lEFhFgwg8yKexMViENNLcCNIfB69tQoG8zYxNuAx6s7iSc+4JDs5i4yiwwv5nClV1VoFc7O/FwZxIPAKlyM+uw5+5YkqJm3AtQP1WzbKBqkLEIp9WJ2EibK+JrQPq28j8Usvr/5FbmtRuLBWy3aAhtgEzO4mc8FGfa32+G+hd8ZNEv1NmxYiXSNYl5sPLECXVqb9YKFzQPZpo=","ak.pv":"229","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
    
    <body lang="en-US">        
        <!--[if lt IE 7]>
        	<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        
  <!-- /* Google Tag Manager (noscript) */-->
  <noscript><iframe title="GTM NoScript" src="https://www.googletagmanager.com/ns.html?id=GTM-TPV7TP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- /* End Google Tag Manager (noscript) */ -->

<!-- /* start: Header section */-->
  
  <div id="iframe-modal" class="modal fade overlay-form-modal" role="dialog">
    <div id="header-signup-xcomp" class="overlay-form overlay" style="margin-right:-600px;"></div>
  </div>
  <header>
         


<div class="section"><div class="new"></div>
</div><div class="iparys_inherited"><div class="headerIParsys iparsys parsys"><div class="globalheader parbase section">

<!-- /* start: Header section */-->

<!-- /* Header Desktop Section Start*/-->
<div class="splunk-header-v3">
  <nav class="navbar navbar-default navbar-fixed-top navbar-splunk-v3 ">
    <div class="container-fluid custom-masthead">
      <div class="navbar-header">
        <a class="navbar-brand" href="https://www.splunk.com">

          <img class="lazyLoad" data-src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/> </a>
        </a>
      </div>
      <ul class="nav navbar-nav navbar-right ">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle cm-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="splunk-icon icon-expanded-splunk-sites-launchpad"></span>Splunk Sites<span class="caret"></span></a>
          <ul class="dropdown-menu cm-dropdown cm-sites">
            <li class="ss-list">
              <a href="https://answers.splunk.com/index.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-answers gray"></span>
                
                
                <span class="link-text">Answers</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/blog" target="_blank">
                <span class="link-img splunk-icon icon-expanded-blogs gray"></span>
                
                
                <span class="link-text">Blogs</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/community.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-community gray"></span>
                
                
                <span class="link-text">Community</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://conf.splunk.com" target="_blank">
                <span class="link-img splunk-icon icon-expanded-conf gray"></span>
                
                
                <span class="link-text">.conf</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://dev.splunk.com" target="_blank">
                <span class="link-img splunk-icon icon-expanded-dev gray"></span>
                
                
                <span class="link-text">Developers</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://docs.splunk.com/Documentation" target="_blank">
                <span class="link-img splunk-icon icon-expanded-docs gray"></span>
                
                
                <span class="link-text">Documentation</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunkcom gray"></span>
                
                
                <span class="link-text">Splunk.com </span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://splunkbase.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunkbase gray"></span>
                
                
                <span class="link-text">Splunkbase</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://splunklive.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunklive gray"></span>
                
                
                <span class="link-text">SplunkLive!</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/customer-success.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-support gray"></span>
                
                
                <span class="link-text">Support</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/training.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-training gray"></span>
                
                
                <span class="link-text">Training</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://usergroups.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-usergroups gray"></span>
                
                
                <span class="link-text">User Groups</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="/en_us/resources/videos.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunktv gray"></span>
                
                
                <span class="link-text">Splunk TV</span>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="container-fluid masthead">
      
      <div class="navbar-header">
        <a href="https://www.splunk.com" class="navbar-brand">
          <img class="lazyLoad" data-src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/> </a>
        </a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-left">
          <li class="dropdown mega-menu-nav">
            <a href="https://www.splunk.com/en_us/blog" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">BLOGS
              <span class="caret"></span><span class="vertical-divider"></span></a>
          </li>
          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">CATEGORIES<span class="caret"></span></a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="mega-menu-heading-titleContainer">
                            <div class="mega-menu-heading-title splunk2-h5">Categories</div>
                            <div class="mega-menu-heading-title-icon close-icon">
                                <a href="#" class="splunk-icon icon-expanded-close-btn" id="Top_Nav-Close"></a>
                            </div>
                        </div>
                        <div role="separator" class="divider"></div>
                        
                    </div>  
                </div>
                <div class="row">
                  <div class="col-sm-9">
                    <div class="row">
                      <!--/* Html will be rendered from globalhead.js */ -->
                      <div class="col-xs-4">	<ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/bulletins.html">				<img src="/content/dam/splunk-blogs/images/category/bulletins.svg">Bulletins			</a>		</li>		<li>			<a href="/en_us/blog/conf-splunklive.html">				<img src="/content/dam/splunk-blogs/images/category/conf-splunklive.svg">.conf & .conf Go			</a>		</li>		<li>			<a href="/en_us/blog/customers.html">				<img src="/content/dam/splunk-blogs/images/category/customers.svg">Customers & Community			</a>		</li>		<li>			<a href="/en_us/blog/devops.html">				<img src="/content/dam/splunk-blogs/images/category/devops.svg">DevOps			</a>		</li>		<li>			<a href="/en_us/blog/industries.html">				<img src="/content/dam/splunk-blogs/images/category/industries.svg">Industries			</a>		</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/it.html">				<img src="/content/dam/splunk-blogs/images/category/it.svg">IT			</a>		</li>		<li>			<a href="/en_us/blog/leadership.html">				<img src="/content/dam/splunk-blogs/images/category/leadership.svg">Leadership			</a>		</li>		<li>			<a href="/en_us/blog/learn.html">				<img src="/content/dam/splunk-blogs/images/category/default-category.svg">Learn			</a>		</li>		<li>			<a href="/en_us/blog/partners.html">				<img src="/content/dam/splunk-blogs/images/category/partners.svg">Partners			</a>		</li>		<li>			<a href="/en_us/blog/platform.html">				<img src="/content/dam/splunk-blogs/images/category/platform.svg">Platform			</a>		</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/security.html">				<img src="/content/dam/splunk-blogs/images/category/security.svg">Security			</a>		</li>		<li>			<a href="/en_us/blog/splunk-for-good.html">				<img src="/content/dam/splunk-blogs/images/category/splunk-for-good.svg">Global Impact			</a>		</li>		<li>			<a href="/en_us/blog/splunklife.html">				<img src="/content/dam/splunk-blogs/images/category/splunklife.svg">Splunk Life			</a>		</li>		<li>			<a href="/en_us/blog/tips-and-tricks.html">				<img src="/content/dam/splunk-blogs/images/category/tips-and-tricks.svg">Tips & Tricks			</a>		</li>	</ul></div>
                    </div>
                  </div>
                  
                  <div class="col-sm-3 mega-menu-spotlight">
                    <div class="spotlight-img"><img class="lazyLoad" alt="Category Spot Image" data-src="/content/dam/splunk2/images/spotlight/spot-light-promo-cloud-on-AWS.jpg"/></div>
                    <div class="mega-menu-heading splunk2-eyebrow">Partner Solution</div>
                    <div class="title splunk2-h5">Splunk Cloud on AWS</div>
                    <p class="mega-menu-heading-description splunk-body">Simplify your procurement process and subscribe to Splunk Cloud via the AWS marketplace</p>
                    <div class="splunk-button-aem">
                        <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="https://aws.amazon.com/marketplace/saas/pp/B06XK299KV?ref=_splunk_awspartnerpage">Learn More</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </li>

          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">AUTHORS
              <span class="caret"></span></a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="mega-menu-heading-titleContainer">
                            <div class="mega-menu-heading-title splunk2-h5">Authors</div>
                            <div class="mega-menu-heading-title-icon close-icon">
                                <a href="#" class="splunk-icon icon-expanded-close-btn" id="Top_Nav-Close"></a>
                            </div>
                        </div>
                        <div role="separator" class="divider"></div>
                    </div>
                </div>
                <div class="row">
                  <div class="col-sm-9">
                    <div class="row">
                      <!-- /*Html will be rendered from globalhead.js */ -->
                      <div class="col-xs-4">	<ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/garysteele.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/gary-steele-headshot.png.thumb.png"/>Gary Steele     </a>   </li>   <li>     <a href="/en_us/blog/author/chockin.html">         <img src="/content/dam/splunk2/images/photos/leadership/claire-hockin.jpg.thumb.png"/>Claire Hockin     </a>   </li>   <li>     <a href="/en_us/blog/author/tomc.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/tomc-headshot.jpeg.thumb.png"/>Tom Casey     </a>   </li>   <li>     <a href="/en_us/blog/author/pjenner.html">         <img src="/content/dam/splunk-blogs/images/petra-jenner-square.png.thumb.png"/>Petra Jenner     </a>   </li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/sdavies.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/sdavies.jpg.thumb.png"/>Simon Davies     </a>   </li>   <li>     <a href="/en_us/blog/author/rkovar.html">         <img src="/content/splunk-blogs/en_us/author/rkovar.thumb.png"/>Ryan Kovar     </a>   </li>   <li>     <a href="/en_us/blog/author/kdeiglmeier.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/kriss_ deiglmeier_headshot.jpg.thumb.png"/>Kriss Deiglmeier     </a>   </li>   <li>     <a href="/en_us/blog/author/browan.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/browan-headshot.jpg.thumb.png"/>Bill Rowan     </a>   </li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/amaraqa.html">         <img src="/content/splunk-blogs/en_us/author/amaraqa.thumb.png"/>Ammar Maraqa     </a>   </li>   <li>     <a href="/en_us/blog/author/tpavlovich.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/toni-pavlovich-headshot.jpg.thumb.png"/>Toni Pavlovich     </a>   </li>   <li>     <a href="/en_us/blog/author/smorgan.html">         <img src="/content/splunk-blogs/en_us/author/smorgan.thumb.png"/>Scott Morgan     </a>   </li>   <li>     <a href="/en_us/blog/author/sgivens.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/sharyl-givens-headshot.jpg.thumb.png"/>Sharyl Givens     </a>   </li>	<li class="mega-menu-spotlight">        <div class="splunk-button-aem">            <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="/en_us/blog/author.html">Browse All Authors...</a>        </div>	</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">	</ul></div>
                    </div>
                  </div>
                  <div class="col-sm-3 mega-menu-spotlight">
                    <div class="spotlight-img"><img class="lazyLoad" alt="Author Spot Image" data-src="/content/dam/splunk2/images/spotlight/spot-light-promo-ebook-machine-data.jpg"/></div>
                    <div class="mega-menu-heading splunk2-eyebrow">E-book</div>
                    <div class="title splunk2-h5">The Essential Guide to Machine Data</div>
                    <p class="mega-menu-heading-description splunk-body">Unlock the secrets of machine data with our new guide</p>
                    <div class="splunk-button-aem">
                        <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="https://www.splunk.com/en_us/form/the-essential-guide-to-data.html">Get the E-book</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </li>

          <li class="dropdown mega-menu-nav">
            <a href="/en_us/blog/subscribe.html" target="_parent" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">SUBSCRIBE
              <span class="caret"></span></a>
          </li>
        </ul>

        <ul class="nav navbar-nav navbar-right">

          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle search-icon" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
              <span class="splunk-icon icon-expanded-search-icon"></span>
              <span class="splunk-icon icon-expanded-close-btn"></span>
            </a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                  <div class="input-group">
                    <form action="/en_us/blog/search.html" id="searchForm" method="get">
                      <input class="form-control mm-input" placeholder="Search Blogs" type="text" value="" id="query" name="query"/>
                      <span class="splunk-icon icon-expanded-search-icon form-control-feedback"></span>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <li>
              
              
              
                <div class="free-splunk">
                  <a href="https://www.splunk.com/en_us/download/splunk-cloud.html" class="btn hidden-xs">
                    Free Splunk
                  </a>
                </div>
              
            </li>

        </ul>


      </div>
    </div>

  </nav>
</div>


<!-- /*Header Mobile Section Start*/-->
<div class="splunk-header-v3-mobile">
  <nav>
    <div class="header-main">
      <a href="https://www.splunk.com" class="logo">
        <img class="lazyLoad" data-src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/>
      </a>
      
      
      
        <a href="https://www.splunk.com/en_us/download/splunk-cloud.html" class="free-splunk-mobile"> Free Splunk</a>
      
      
      <div class="hamburger-container collapsed" data-toggle="collapse" data-target="#header-collapse" aria-expanded="false">
        <div class="hamburger hamburger--spin" type="button">
            <span class="hamburger-box">
              <span class="hamburger-inner"></span>   
            </span>
          </div>
      </div>
    </div>
    <div class="header-collapse collapse" id="header-collapse">
      <div class="search">
        <form action="/en_us/blog/search.html" id="searchForm" method="get">
          <input type="text" placeholder="Search Blogs" name="query" value="" class="form-control" id="query"/>
          <span class="splunk-icon icon-expanded-search-icon"></span>
        </form>
      </div>
      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed site-title separator-bottom" data-toggle="collapse" data-target="#customers">
        <a href="https://www.splunk.com/en_us/blog">BLOGS</a>
      </div>
      <!-- /*END of menu title and list items */-->
      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#products">
        CATEGORIES
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list darkened-menu-list collapse" id="products">
        <ul>
          <!-- /*Html will be rendered from globalhead.js  */-->
          		<li>			<a href="/en_us/blog/bulletins.html">Bulletins			</a>		</li>		<li>			<a href="/en_us/blog/conf-splunklive.html">.conf & .conf Go			</a>		</li>		<li>			<a href="/en_us/blog/customers.html">Customers & Community			</a>		</li>		<li>			<a href="/en_us/blog/devops.html">DevOps			</a>		</li>		<li>			<a href="/en_us/blog/industries.html">Industries			</a>		</li>		<li>			<a href="/en_us/blog/it.html">IT			</a>		</li>		<li>			<a href="/en_us/blog/leadership.html">Leadership			</a>		</li>		<li>			<a href="/en_us/blog/learn.html">Learn			</a>		</li>		<li>			<a href="/en_us/blog/partners.html">Partners			</a>		</li>		<li>			<a href="/en_us/blog/platform.html">Platform			</a>		</li>		<li>			<a href="/en_us/blog/security.html">Security			</a>		</li>		<li>			<a href="/en_us/blog/splunk-for-good.html">Global Impact			</a>		</li>		<li>			<a href="/en_us/blog/splunklife.html">Splunk Life			</a>		</li>		<li>			<a href="/en_us/blog/tips-and-tricks.html">Tips & Tricks			</a>		</li>
        </ul>
      </div>
      

      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#solutions">
        <div class="separator-top"></div>
        AUTHORS
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list darkened-menu-list collapse" id="solutions">
        <ul>
          <!-- /* Html will be rendered from globalhead.js  */-->
             <li>     <a href="/en_us/blog/author/garysteele.html">Gary Steele     </a>   </li>   <li>     <a href="/en_us/blog/author/chockin.html">Claire Hockin     </a>   </li>   <li>     <a href="/en_us/blog/author/tomc.html">Tom Casey     </a>   </li>   <li>     <a href="/en_us/blog/author/pjenner.html">Petra Jenner     </a>   </li>   <li>     <a href="/en_us/blog/author/sdavies.html">Simon Davies     </a>   </li>   <li>     <a href="/en_us/blog/author/rkovar.html">Ryan Kovar     </a>   </li>   <li>     <a href="/en_us/blog/author/kdeiglmeier.html">Kriss Deiglmeier     </a>   </li>   <li>     <a href="/en_us/blog/author/browan.html">Bill Rowan     </a>   </li>   <li>     <a href="/en_us/blog/author/amaraqa.html">Ammar Maraqa     </a>   </li>   <li>     <a href="/en_us/blog/author/tpavlovich.html">Toni Pavlovich     </a>   </li>   <li>     <a href="/en_us/blog/author/smorgan.html">Scott Morgan     </a>   </li>   <li>     <a href="/en_us/blog/author/sgivens.html">Sharyl Givens     </a>   </li>	<li>        <div class="splunk-button-aem">            <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="/en_us/blog/author.html">Browse All Authors...</a>        </div>	</li>
        </ul>
      </div>
      

      
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#customers">
        <div class="separator-top"></div>
        <a href="/en_us/blog/subscribe.html" target="_parent">SUBSCRIBE</a>
      </div>
      

      <!-- /*menu title and list items */-->
      <div class="generic-menu-title collapsed" data-toggle="collapse" data-target="#splunksites">
        <div class="separator-top"></div>
        <span class="splunk-icon icon-expanded-splunk-sites-launchpad"></span> Splunk Sites
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list collapse" id="splunksites">
        <ul>
          <li>
            <a href="https://answers.splunk.com/index.html" target="_blank">Answers</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/blog" target="_blank">Blogs</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/community.html" target="_blank">Community</a>
          </li>
        
          <li>
            <a href="https://conf.splunk.com" target="_blank">.conf</a>
          </li>
        
          <li>
            <a href="https://dev.splunk.com" target="_blank">Developers</a>
          </li>
        
          <li>
            <a href="https://docs.splunk.com/Documentation" target="_blank">Documentation</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/" target="_blank">Splunk.com </a>
          </li>
        
          <li>
            <a href="https://splunkbase.splunk.com/" target="_blank">Splunkbase</a>
          </li>
        
          <li>
            <a href="https://splunklive.splunk.com/" target="_blank">SplunkLive!</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/customer-success.html" target="_blank">Support</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/training.html" target="_blank">Training</a>
          </li>
        
          <li>
            <a href="https://usergroups.splunk.com/" target="_blank">User Groups</a>
          </li>
        
          <li>
            <a href="/en_us/resources/videos.html" target="_blank">Splunk TV</a>
          </li>
        </ul>
      </div>
      <!-- /*END of menu title and list items */-->
    </div>
  </nav>
</div>



<script src="/etc/clientlibs/splunk/splunk-core/source/js/vendor/jquery_cookie.js"></script>
<script src="/etc/clientlibs/splunk/splunk-com/source/js/mobile-detect.min.js"></script>
<script src="/etc/clientlibs/splunk/splunk-com/source/js/cx-form-iphone-fix.js"></script>
<script>
  var ssoid = $.cookie("WEBID");
  if (ssoid) {
    $.ajax({
      cache: false,
      url: "/api/bin/user/info",
      dataType: "json",
      success: function (userinfo) {
        if (!userinfo.login_status) {
          loadExLaneForm();
        }
      },
      failure: function () {
        loadExLaneForm();
      }
    });
  } else {
    loadExLaneForm();
  }
  function loadExLaneForm() {
    var isMobile = false;
    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {
      isMobile = true;
    }
    var md = new MobileDetect(window.navigator.userAgent);
    var dimensions = md.getOverlaySignupIframeSize();
    //Fix for WWW-437
    //update old-flow-mobile to new-flow-mobile
    $("#free-splunk-click-mobile").addClass("express-lane-open");
    //update old-flow-desktop to new-flow-desktop
    $("#free-splunk-click-desktop").addClass("express-lane-open");
    //add data-target value only for guest user
    $('#free-splunk-click-desktop, #free-splunk-click-mobile').attr('data-target','#iframe-modal');
    $('#iframe-modal').css('z-index','30000');
    var lang = '';
    var pageLocale = document.getElementsByTagName('body')[0].getAttribute('lang');
    // if the lang attribute is null
    if (!pageLocale) {
      lang = 'en_us';
    } else {
      // if the lang attribute is not null
      if (pageLocale == "zh-Hans") {
        pageLocale = "zh-hans_cn";
      } else {
        pageLocale = pageLocale.replaceAll("-", "_").toLowerCase().trim();
      }
      lang = pageLocale;
      if (lang.length === 0 || lang == "ko_kr" || lang == "zh_tw" || lang == "zh" || lang == "en") {
        lang = 'en_us';
      }
    }
    $(".express-lane-open").click(function (e) {
      if ($(e.target).hasClass("express-lane-open")) {
        e.preventDefault();
        $("#header-signup-xcomp").html('');
        $.getScript("//account.splunk.com/sign-up/js/xcomponent.min.js",function(){
          $.getScript("//account.splunk.com/sign-up/js/splunk-xcomponent.js",function(){
            /**
            * sign up form - express flow.
            */
            signupXcomponent.render({
              dimensions: {
                width: dimensions.width,
                height: dimensions.height
              },
              theme: "light",
              locale: lang,
              redirectUrl: "https:\/\/www.splunk.com\/en_us\/download\/splunk\u002Dcloud.html",
              isMobile: isMobile,
              isQuickAccess: true,
              isRecaptcha: false,
              customProps: {
                leadSource: "splunk"
              },
              onSignup: function (data) {
                try {
                  if (data.status == "close") {
                    $("html").removeClass("iphone-fix");
                    $("body").removeClass("iphone-fix");
                  }
                } catch (e) {
                  //do nothing
                  console.log("no status to close");
                }
                nextAction(data);
              },
              isCloseButtonOn: true,
              title: "Get Started With Splunk",
              id: "header-signup-xcomp"
            }, '#header-signup-xcomp');
            $("#header-signup-xcomp").animate({ "margin-right": '0px' });
          });
        });
      }
    });
  }

  // Hide iframe form on click of modal overlay
  $("#iframe-modal").click(function(){
    $(".overlay-form").animate({"margin-right": '-'+$('.overlay-form').width()+"px"});
    $("html").removeClass("iphone-fix stop-scrolling");
    $("body").removeClass("iphone-fix");
  });

  // Listener event to handle click event from iframe or child window
  var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
  var eventer = window[eventMethod];
  var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";

  // Listen to message from child window
  eventer(messageEvent,function(e) {
      var key = e.message ? "message" : "data";
      var data = e[key];
      //run function//
      console.log(data);
      if(data == "hide-signup-form") {
        $('#iframe-modal').modal('hide');
        $("html").removeClass("iphone-fix stop-scrolling");
        $("body").removeClass("iphone-fix");
        $(".overlay-form").animate({"margin-right": '-'+$('.overlay-form').width()+"px"});
      }
  },false);

  $("#free-splunk-click-desktop").click(function(){
      $('html').addClass('stop-scrolling');
  });
</script>

    
<link rel="stylesheet" href="/etc.clientlibs/splunk-blogs/components/content/globalheader/clientlibOnetrust.30b72d438139d3b33d4999d2371681b7.css" type="text/css">


</div>
</div>
</div>


  </header>

  



<div>




</div>





<div class="blog-post">

	<!-- Start: blogpost Hero -->
    <div class="hero">
      <div class="background-image lazyLoad" style="background-image: url();" data-background-image="/content/dam/splunk-blogs/images/en_us/2022/heroqak.jpg"></div>
      <div class="background-blend-multiply" style="background-color:rgba(0,0,0,0.55);"></div>
      <div class="container main-container">
        <div class="row main-row">
          <div class="col-xs-12">
            <div class="blog-type splunk2-eyebrow">
              SECURITY
            </div>
            <h1 class="splunk2-h2 blog-title">
              From Macros to No Macros: Continuous Malware Improvements by QakBot
            </h1>
          </div>
        </div>
      </div>
    </div>
    <!-- End of blogpost hero -->
<!-- /* end: author blog list */-->
<!-- /* start: main content body */-->
<div class="main-body">
  <div class="container">
    <div class="row">
      <div class="col-sm-1 col-sm-offset-1">
        
          <div class="blog-post">
            <div class="social-band">
              <span class="social-band-title body-small">Share: </span>
              <ul>
                <li>
                  <!-- /*twitter supports title, url and hashtag */-->
                  <a class="twitter button-wrap social-icon" href="#" title="Share on Twitter" data-title="From Macros to No Macros: Continuous Malware Improvements by QakBot" data-url="https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html" data-hashtag="#splunkBlogs">
                  </a>
                </li>
                <li>
                  <!-- /* facebook only support url, facebook will pull data from page url */-->
                  <a class="facebook button-wrap social-icon" href="#" title="Share on Facebook" data-title="From Macros to No Macros: Continuous Malware Improvements by QakBot" data-url="https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html">
                  </a>
                </li>
                <li>
                  <!-- /* linkedIn only supports url linkedin will pull data from page url */-->
                  <a class="linkedin button-wrap social-icon" href="#" title="Share on LinkedIn" data-title="From Macros to No Macros: Continuous Malware Improvements by QakBot" data-url="https://www.splunk.com/en_us/blog/security/from-macros-to-no-macros-continuous-malware-improvements-by-qakbot.html">
                  </a>
                </li>
              </ul>
            </div>
          </div>

        
      </div>
      <div class="col-sm-9">
        <div class="blog-postdate">
               <span><a href="/en_us/blog/author/secmrkt-research.html" title="">
                 <img src="/content/dam/splunk-blogs/images/author-profile-pics/securityresearch_main.jpg" alt="Splunk Threat Research Team "/>
                 </a> By  <a class="author-name" href="/en_us/blog/author/secmrkt-research.html" title="">Splunk Threat Research Team </a> December 01, 2022
               </span>
        </div>
        <div class="copy-content splunk-body">
          
          <div data-emptytext="Blogs details page content">
            <p>In 2007 we saw the initial beginnings and rise of QakBot, the same year when Windows XP and Windows Server 2003 were still the primary operating systems in the enterprise. QakBot, or QuackBot, made its presence known as a banking trojan and a loader. Over time, it continually developed and became a standard in malicious software circles. Today, we see QakBot used by a varied group of adversaries in a variety of ways, such as deploying ransomware, persistence, and stealing credentials. Before an adversary has access to an endpoint or the ability to move laterally, they have to gain initial access. That initial access vector continues to evolve and keep pace with operating systems, browsers, and antivirus vendors to ensure the deliverability of malicious payloads.&nbsp;</p>
<p>In this blog, the Splunk Threat Research Team (STRT) showcases a year's evolution of QakBot. We also dive into a recent change in tradecraft meant to evade security controls. Last, we reverse engineered the QakBot loader to showcase some of its functions.&nbsp;</p>
<h2>Introduction</h2>
<p>In <a href="https://www.bleepingcomputer.com/news/microsoft/microsoft-starts-blocking-office-macros-by-default-once-again/" target="_blank">February 2022</a> Microsoft pushed an update to disable macros by default in Office products. A huge win within the industry is to prevent the vast amount of initial access vectors into an organization. It wasn’t long before adversaries began to update their tradecraft to use everything except macros. Similar to what was mentioned by Bleeping Computer in February, DarkReading mentioned in this <a href="https://www.darkreading.com/endpoint/post-macro-world-container-files-distribute-malware-replacement" target="_blank">article</a>, the change went to HTML Applications (.hta) and was very successful. Over time, we began to hear of Mark-of-the-Web (MOTW) bypasses. Windows MOTW is a simple feature in the OS that labels items and scrutinizes them as they are downloaded. As outlined by <a href="https://outflank.nl/blog/2020/03/30/mark-of-the-web-from-a-red-teams-perspective/" target="_blank">Outflank</a> in 2020, the role of MOTW in security measures is used by Windows SmartScreen, and Protected view sandbox in Excel and Word, to name a few. How does an adversary bypass these controls? Some downloaded files do not get scrutinized, therefore evading MOTW and allowing for process execution. One popular format that we see today includes the delivery of ISO files within an HTML file. Most containers, like ISO or VHDX, are not scrutinized by MOTW.&nbsp;</p>
<p><i>Want to simulate Mark of the Web Bypasses? Check out Atomic <a href="https://www.splunk.com/en_us/blog/learn/red-team-vs-blue-team.html">Red Team</a> <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.005/T1553.005.md" target="_blank">T1553.005</a>.&nbsp;</i></p>
<p>Below is a timeline of changes from June to October. Proxylife monitors and tracks QakBot campaigns and daily shares the indicators for each campaign. We began looking at how QakBot operated in June, four months after Microsoft disabled macros, and we can see the pattern of using .html files with embedded zip, and img files.</p>
<p>The simple flow chart below shows the basic infection flow of this QakBot sample.</p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/simpleflow.png" class="aligncenter"></p>
<p>To follow this evolution we monitor Proxylife as well as other sources (Proxylife monitors Qakbot’s evolution and shares campaign indicators).&nbsp;</p>
<p>Based on this and other sources, below is a timeline of changes from June to October captured by Proxylife updates. We began looking at how QakBot operated in June, four months after Microsoft disabled macros, and we can see the pattern of using .html files with embedded zip and img files.</p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/proxylife.png" class="aligncenter" width="75%"></p>
<p>Immediately following, we see that on June 13, 2022 the campaign changed to using HTML smuggling with an embedded ZIP+.LNK file. Adversaries change their tradecraft frequently when attempting to see what sticks as far as evasion goes, and this is a great view into that.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/june13tweet.png" class="aligncenter"><sup><i>Reference <a href="https://twitter.com/pr0xylife/status/1536386977863442432?s=20&amp;t=fSjHaanAd6CHJhqB3g2mFw" target="_blank">tweet</a></i></sup></p>
<p>Jumping forward three months, we can see the more widespread use of HTML smuggling with ZIP and ISO attachments. In this particular sample, the .LNK will execute a javascript file that loads the .cmd (batch script) to continue on.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/sep28qakbot.png" class="aligncenter"><sup><i><br>
Reference <a href="https://twitter.com/pr0xylife/status/1575165550254526465?s=20&amp;t=fSjHaanAd6CHJhqB3g2mFw" target="_blank">tweet</a></i></sup></p>
<p>While reviewing the QakBot samples outlined above, we found a particularly distinct sample that was being utilized. Once we began digging into the HTML we noticed that it had evasive techniques built in that piqued our interest. We found that <a href="https://twitter.com/pr0xylife/status/1585364758836150272?s=20&amp;t=qi-rUq0r5uLI9QhEXCNPWQ" target="_blank">ProxyLife</a> had shared this sample on Twitter, along with the other campaigns that utilized HTML smuggling, along with a password-protected zip that contained the ISO.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/qakbotbbo4.png" class="aligncenter"><i><sup><br>
Reference <a href="https://twitter.com/pr0xylife/status/1585364758836150272?s=20&amp;t=qi-rUq0r5uLI9QhEXCNPWQ" target="_blank">tweet</a></sup></i></p>
<p>What we don’t see here is the functionality being used to evade controls. It’s easy to say “HTML smuggling” or “ISO containers”, but what is the core behavior underneath it all that is making each of these different?</p>
<ul>
<li>Reverse Base64 html file (2nd stage)</li>
<li>2nd stage contained embedded password protected zip file</li>
<li>ISO file contained within Zip, including LNK and QakBot loader</li>
</ul>
<p>&nbsp;We will explore this sample and showcase everything in more detail.</p>
<h3>HTML smuggling</h3>
<p>This has become the de facto standard for the delivery of malicious payloads as of late. What is HTML smuggling? As defined by MITRE ATT&amp;CK <a href="https://attack.mitre.org/techniques/T1027/006/" target="_blank">T1027.006</a>, “HTML documents can store large binary objects known as JavaScript blobs (immutable data that represents raw bytes) that can later be constructed into file-like objects. Data may also be stored in Data URLs, which enable embedding media type or MIME files inline of HTML documents.”</p>
<p>Below we showcase two ways to view these campaigns, one from the victim perspective and the other from within the code.&nbsp;</p>
<p><b>Victim Perspective</b></p>
<h4><img src="/content/dam/splunk-blogs/images/en_us/2022/userlandviewimage.png" class="aligncenter"></h4>
<p>For the end user, this particular sample requires the downloading and opening of the HTML file. Once opened, the <b>attachment.zip</b> saves to disk, and the end user must now enter the password to decrypt the contents. Once decrypted, mount the ISO (by double-clicking) and finally click the <b>A.LNK file.</b></p>
<p><b>View Within Code</b></p>
<p style="text-align: center;"><sup><i><img src="/content/dam/splunk-blogs/images/en_us/2022/flow2.png" class="aligncenter">(For a larger resolution of this diagram visit this <a href="https://imgur.com/a/Bl7esEB" target="_blank">link</a>)</i></sup></p>
<p><b>Stage 1 HTML</b></p>
<p>This HTML file contains a reversed base64 encoded string initialized in div id = <b>“MS860aTc”</b> which contains the stage 2 javascript. To be able to execute this stage 2 javascript, it creates an HTML element with the tag “embed” that will be appended to the code body of this HTML using “document.body.appendChild(element)”. The width and height frame properties of the “embed” element are also hidden (value = 1) to hide the stage 2 javascript execution from the user.</p>
<p>Figure 1 is the screenshot of the main code of the stage 1 HTML file with annotations</p>
<p><br>
<img src="/content/dam/splunk-blogs/images/en_us/2022/stage1-html.png" class="aligncenter"></p>
<p style="text-align: center;"><sup><i>Figure 1</i></sup></p>
<p><b>Stage2 HTML File</b></p>
<p>The stage 2 HTML contains javascript that will decode a base64 encoded (password protected) zip file initialized in variable “gdhpoIyu”. After decoding, it will try to convert the decoded base64 data into an unsigned integer byte array that will be used to create a blob file object as a ZIP file. Then it will use a javascript static method &nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL" target="_blank">URL.CreateObjectURL</a> with the new blob file object as a parameter that will be loaded using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/assign" target="_blank">windows.location.assign()</a> method.</p>
<p>Figure 2 shows the stage 2 HTML&nbsp; javascript code and the portion of the base64 encoded zip file that contains the malicious ISO file.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/stage-2.png" class="aligncenter"><i style="text-align: center;"><sup>Figure 2</sup></i></p>
<p>Figure 3 shows the effect of the stage 2 HTML file as you run the main HTML (stage 1). Notice that it automatically dropped the zip file in the compromised host.</p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/html-1.png" class="aligncenter"></p>
<p style="text-align: center;"><sup><i>Figure 3</i></sup></p>
<p><b>ISO File</b></p>
<p>Once the ZIP is extracted and decrypted using the password “PG1”, we will be able to get the “A7490.iso” that contains an <b>A.LNK</b> file and a hidden tools folder.</p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/rootdrive.png" class="aligncenter"></p>
<p>Hidden Folder Contents</p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/hiddenfoldercontents.png" class="aligncenter"></p>
<p>Within the hidden <b>tools </b>folder is protracted.cmd&nbsp; (bat file) and the malicious bucketfuls.dat (.dll) that will be loaded.</p>
<h4><b style="font-family: proxima_nova, Helvetica, Arial, sans-serif; font-size: 18px;">LNK and Batch Script</b></h4>
<p>To the victim, the .LNK will be the only thing inside the ISO as the tools directory is hidden.&nbsp;</p>
<p>Below is the breakdown of the two files which showcases how the adversary attempts to evade detection.</p>
<p>LNK</p>
<p>Within the LNK it gives away the .cmd file that will run from within the hidden tools directory -</p>
<table>
<tbody><tr><td><pre>
C:\Windows\System32\cmd.exe /c tools\protracted.cmd re gs v
</pre>
</td>
</tr></tbody></table>
<p><br>
Note the <b>re gs</b> and <b>v </b>arguments, at first glance it doesn’t make sense and seems out of place until we look at the .cmd file.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/protractedcmd.png" class="aligncenter"><sup><i>Figure 4</i></sup></p>
<p>The .cmd file uses a few tricks to evade controls. First, lines 4-7 are using <b>set</b>, which will _set_ environment variables for the different strings. On line 6 we see the % symbols, which are passed in from the LNK file (re gs v) to complete the regsvr32.exe process name.&nbsp;</p>
<p>Line 9 will set “copy” as a variable. The final call on line 16 will now look like this:</p>
<table>
<tbody><tr><td><pre>
copy %systemroot%\system32\regsvr32.exe %temp%\envelopingConcussion.com
</pre>
</td>
</tr></tbody></table>
<p>This will copy regsvr32.exe from system32 to the \appdata\local\temp directory and rename regsvr32.exe to envelopingConcussion.com.&nbsp;</p>
<p>Now, envelopingConcussion.com will run tools\bucketfuls.dat.&nbsp;</p>
<p>In Splunk:</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/renamedregsvr32.png" class="aligncenter"><sup><i>Figure 5</i></sup></p>
<p>Now we will switch gears and dive into the different QakBot capabilities found within the DLL that gets loaded.&nbsp;</p>
<h3>System Owner/User Discovery</h3>
<p>Figure 6 is a screenshot of QakBot code that will execute several Windows commands to collect system and network information that will be sent to the remote C2 server.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/recon.png" class="aligncenter"><sup><i>Figure 6</i></sup></p>
<p>The table below is the complete list of the Windows commands that it will execute on the compromised host.</p>
<h3>Table 1</h3>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><th scope="col" style="text-align: center;">Command</th>
<th scope="col" style="text-align: center;">Description</th>
</tr><tr><td><p style="text-align: center;">ipconfig /all</p>
</td>
<td><p style="text-align: center;">List all TCP/IP <a href="https://www.splunk.com/en_us/blog/learn/network-configuration.html">network configuration</a></p>
</td>
</tr><tr><td style="text-align: center;">nslookup -querytype=ALL -timeout=12 _ldap._tcp.dc._msdcs.%s</td>
<td><p style="text-align: center;">Query SRV records of the domain from the main DNS record of the compromised host (%s is the domain name)</p>
</td>
</tr><tr><td><p style="text-align: center;">nltest /domain_trusts /all_trusts</p>
</td>
<td><p style="text-align: center;">Enumerate domain trusts</p>
</td>
</tr><tr><td><p style="text-align: center;">net localgroup</p>
</td>
<td><p style="text-align: center;">Get local groups information</p>
</td>
</tr><tr><td style="text-align: center;">qwinsta</td>
<td><p style="text-align: center;">Displays information about sessions on a Remote Desktop Session Host server.&nbsp;</p>
</td>
</tr><tr><td><p style="text-align: center;">route print</p>
</td>
<td><p style="text-align: center;">Get route information</p>
</td>
</tr><tr><td><p style="text-align: center;">arp -a</p>
</td>
<td><p style="text-align: center;">Get ARP information</p>
</td>
</tr><tr><td><p style="text-align: center;">cmd /c set</p>
</td>
<td><p style="text-align: center;">Get environment variables</p>
</td>
</tr><tr><td><p style="text-align: center;">whoami /all</p>
</td>
<td><p style="text-align: center;">Get user, group, and privilege information of the compromised host</p>
</td>
</tr><tr><td><p style="text-align: center;">netstat -nao</p>
</td>
<td><p style="text-align: center;">Get the active network connections in the compromised host&nbsp;</p>
</td>
</tr><tr><td><p style="text-align: center;">net view</p>
</td>
<td><p style="text-align: center;">Displays a list of domains, computers, or resources that are being shared by the specified computer.</p>
</td>
</tr><tr><td><p style="text-align: center;">net share</p>
</td>
<td style="text-align: center;">Displays information about all of the resources that are shared on the local computer</td>
</tr></tbody></table>
<p style="padding-top: 25px;">This event can be seen using the Sysmon event logs in Splunk. Figure 7 shows how the QakBot malware injected in the <b>wermgr.exe</b> process executes the following Windows native commands that we’ve listed in the above table.</p>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/reconsearch.png" class="aligncenter"><sup><i>Figure 7</i></sup></p>
<p>As part of this Tactic, it will also execute several WMI query commands to gain more system information about the compromised host. Table 2 shows the list of WMI classes it uses in its WMI query to collect more information.</p>
<h3>Table 2</h3>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><th scope="col">WMI Class</th>
<th scope="col">Description</th>
</tr><tr><td><p>Win32_ComputerSystem</p>
</td>
<td><p>System Information (AdminPasswordStatus, Model, Name, Manufacturer and many more)</p>
</td>
</tr><tr><td><p>Win32_Bios</p>
</td>
<td><p>BIOS information (e.g BIOSVersion, PrimaryBIOS, serialNumber)</p>
</td>
</tr><tr><td><p>Win32_Product</p>
</td>
<td><p>Product and software information</p>
</td>
</tr><tr><td><p>Win32_PhysicalMemory</p>
</td>
<td><p>Physical RAM information</p>
</td>
</tr><tr><td><p>Win32_DiskDrive</p>
</td>
<td><p>Hard disk information like the partition, free size, model.</p>
</td>
</tr><tr><td><p>Win32_Processor</p>
</td>
<td><p>CPU processor information</p>
</td>
</tr><tr><td>Win32_OperatingSystem</td>
<td><p>OS information</p>
</td>
</tr><tr><td>SELECT * FROM antivirusProduct</td>
<td><p>List all antivirus Products Installed in Windows OS.</p>
<p>&nbsp;</p>
</td>
</tr></tbody></table>
<p style="padding-top: 25px;">Additionally, it will also make Windows API calls to get the computer name, system metrics, Active Directory domain status, system info, all processes and its modules, windows architecture (x32/x64), and OS version.</p>
<p>Figure 8 shows a code snippet of how it gets the computer name and the volume information of the compromised host.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/getcomputername.png" class="aligncenter"><span style="vertical-align: super;"><sup><i>Figure 8</i></sup></span></p>
<p>Figure 9 shows the short code snippet of how it sets up and executes the WMI command listed in the table above to perform system discovery on the compromised host.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/figure9r.png" class="aligncenter"><sup><i>Figure 9</i></sup></p>
<h3>Persistence</h3>
<p>QakBot will also create a registry run key entry or Scheduled Task to execute itself upon the reboot of the compromised host. Figure 10 shows the code snippet of this sample that creates scheduled tasks or creates registry run keys.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/persistence.png" class="aligncenter"><span style="text-align: center;"><sup><i>Figure 10</i></sup></span></p>
<p><img src="/content/dam/splunk-blogs/images/en_us/2022/regrunsearch.png" class="aligncenter"></p>
<p>We also saw a function in its code capable of creating services for its malicious code to gain privileges or persist on the target host machine. Unfortunately, this <a href="https://www.splunk.com/en_us/blog/learn/ttp-tactics-techniques-procedures.html">TTP</a> was not triggered during our testing. Figure 11 is a screenshot of how it registers a service control handler for its file.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/registerservice.png" class="aligncenter"><sup><i>Figure 11</i></sup></p>
<h3>Execution</h3>
<p>This QakBot sample can execute the dropped .DLL copy of itself or a .DLL plugin downloaded from its <a href="https://www.splunk.com/en_us/blog/learn/c2-command-and-control.html">Command and Control (C2)</a> server using several techniques available in Windows Operating System such as Living on The Land Application (LOLBIN)&nbsp; or through scripts.</p>
<p>Figure 12 shows how it uses the WMI command in .VBScript to copy files.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/impersonatecscript.png" class="aligncenter"><sub><i>Figure 12</i></sub></p>
<p>Below is a short table of commands we saw during our analysis for its Execution Tactics</p>
<h3>Table 3</h3>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><th scope="col" style="text-align: center;">Command</th>
<th scope="col" style="text-align: center;">Description</th>
</tr><tr><td><p style="text-align: center;">Regsvr32.exe &lt;dll_file_path&gt;</p>
</td>
<td><p style="text-align: center;">Execute dropped randomly generated DLL file name using regsvr32.exe.</p>
</td>
</tr><tr><td><p style="text-align: center;">Rundll32.exe &lt;dll_file_path&gt;</p>
</td>
<td><p style="text-align: center;">Execute dropped randomly generated DLL file name using rundll32.exe.</p>
</td>
</tr><tr><td><p style="text-align: center;">Set objWMIService = GetObject(&quot;winmgmts:&quot; &amp; &quot;{impersonationLevel=impersonate}!\\.\%coot\cimv2&quot;)</p>
<p style="text-align: center;">Set objProcess = GetObject(&quot;winmgmts:root\cimv2:Win32_Process&quot;)</p>
<p style="text-align: center;">errReturn = objProcess.Create(&quot;%s&quot;, null, nul, nul)</p>
</td>
<td><p style="text-align: center;">Execute a process using a WMI object in VBScript.</p>
</td>
</tr><tr><td><p style="text-align: center;">“runas”</p>
</td>
<td><p style="text-align: center;">Shellexecute a command line with “runas “ parameter to gain admin privileges in its execution</p>
</td>
</tr><tr><td><p style="text-align: center;">Powershell.exe -encodedCommand</p>
</td>
<td><p style="text-align: center;">Execute a base64 encoded PowerShell script</p>
</td>
</tr><tr><td><p style="text-align: center;">Wmic process call create expand &lt;lolbin&gt; &lt;dll_file_path&gt;</p>
</td>
<td style="text-align: center;">Execute its dropped DLL copy of itself or .dll component using WMIC in a batch script.<br>
E.g Wmic process call creates expand regsvr32.exe &lt;dll_file_path&gt;</td>
</tr></tbody></table>
<h3 style="padding-top: 25px;">Defense Evasion, Privilege Escalation - Process Injection</h3>
<p>When The .DLL stager or the .DLL loader is executed by the .batch script inside the .ISO file using regsvr32.exe, It will inject its malicious code to a legitimate Windows OS process to perform defense evasion.&nbsp;</p>
<p>Figure 13 shows the code and how it creates a suspended process (the wermgr.exe) as the first step of the <a href="https://attack.mitre.org/techniques/T1055/012/" target="_blank">process hollowing technique</a>.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/suspproc.png" class="aligncenter"><sup><i>Figure 13</i></sup></p>
<p>After creating a suspended process, it will create a new section on that process that can fit its QakBot .DLL code. Then, it will map and allocate memory pages on that section and write its malicious code on that mapped section using WriteProcessMemory() API. Figure 13.1 is the code snippet of this process.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/processinjection.png" class="aligncenter"><sub><i>Figure 13.1</i></sub></p>
<p>Below is the list of possible processes where it can inject the QakBot core .DLL during its executions:</p>
<ul>
<li>%SystemRoot%\SysWOW64\OneDriveSetup.exe</li>
<li>%SystemRoot%\SysWOW64\dxdiag.exe</li>
<li>%SystemRoot%\SysWOW64\explorer.exe</li>
<li>%SystemRoot%\SysWOW64\mobsync.exe</li>
<li>%SystemRoot%\SysWOW64\msra.exe</li>
<li>%SystemRoot%\SysWOW64\wermgr.exe</li>
<li>%SystemRoot%\SysWOW64\xwizard.exe</li>
<li>%SystemRoot%\System32\OneDriveSetup.exe</li>
<li>%SystemRoot%\System32\dxdiag.exe</li>
<li>%SystemRoot%\System32\mobsync.exe</li>
<li>%SystemRoot%\System32\msra.exe</li>
<li>%SystemRoot%\System32\wermgr.exe</li>
<li>%SystemRoot%\System32\xwizard.exe</li>
<li>%SystemRoot%\explorer.exe</li>
</ul>
<h3>&nbsp;</h3>
<h3>Anti-Analysis and Anti-Debugging</h3>
<p>Aside from Process Injections, it also has several functions that check if it is being debugged, being run in a sandbox, or being analyzed in a research lab.&nbsp;</p>
<p>This QakBot variant has 2 conditions that serve as a killswitch for its execution.</p>
<ol>
<li>It checks if the file <b>“C:\INTERNAL\__empty</b>” exists. This file can be used to check the existence of Windows Defender emulation. If this file exists it will right away return 0 that will exit its code execution.</li>
<li>The second one is checking the environment variable <b>“SELF_TEST_1”</b>. If this environment variable exists it will exit the process.</li>
</ol>
<p>Figure 14 shows the screenshots of its code that checks the following killswitch</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/killswitch.png" class="aligncenter"><sup><i>Figure 14</i></sup></p>
<p>Figure 15 shows its code snippet and how it checks if its code is being debugged using the <a href="https://en.wikipedia.org/wiki/Process_Environment_Block#:~:text=In%20computing%20the%20Process%20Environment,other%20than%20the%20operating%20system." target="_blank">Process Environment Block Structure</a>. If the BeingDebugged flag is True, it will xor encrypt the 2 decryption key tables in addresses 0x1001E16B0 and 0x1001E050 then exit its process.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/debug.png" class="aligncenter"><i style="vertical-align: super;"><sup>Figure 15</sup></i></p>
<p>It also enumerates all the running processes on the compromised host and checks if one of those processes is on the list below (Table 4) which is related to security, malware analysis tools, and sandbox.</p>
<h3>Table 4</h3>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><td><ul>
<li>frida-winjector-helper-32.exe</li>
<li>frida-winjector-helper-64.exe</li>
<li>tcpdump.exe</li>
<li>windump.exe</li>
<li>ethereal.exe</li>
<li>wireshark.exe</li>
<li>ettercap.exe</li>
<li>rtsniff.exe</li>
<li>packetcapture.exe</li>
<li>capturenet.exe</li>
<li>ResourceHacker.exe</li>
<li>sniff_hit.exe</li>
</ul>
</td>
<td><ul>
<li>qak_proxy</li>
<li>dumpcap.exe</li>
<li>CFF Explorer.exe</li>
<li>not_rundll32.exe</li>
<li>ProcessHacker.exe</li>
<li>tcpview.exe</li>
<li>filemon.exe</li>
<li>procmon.exe</li>
<li>idaq64.exe</li>
<li>loaddll32.exe&nbsp;&nbsp;</li>
</ul>
</td>
<td><ul>
<li>PETools.exe</li>
<li>ImportREC.exe</li>
<li>LordPE.exe</li>
<li>SysInspector.exe</li>
<li>proc_analyzer.exe</li>
<li>sysAnalyzer.exe&nbsp;</li>
<li>sniff_hit.exe</li>
<li>joeboxcontrol.exe</li>
<li>joeboxserver.exe</li>
<li>x64dbg.exe</li>
<li>Fiddler.exe</li>
<li>sysAnalyzer.exe</li>
</ul>
</td>
</tr></tbody></table>
<p style="padding-top: 25px;">It also has a list of processes it checks (Table 5) related to antivirus products such as AVG, Dr. Web, Fortinet, TrendMicro, F-Secure, ByteFence Anti-Malware, BitDefender, Avast, Windows Defender, Comodo Internet Security and ESET.</p>
<h3>Table 5</h3>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><td><ul>
<li>avgcsrvx.exe</li>
<li>avgsvcx.exe</li>
<li>avgcsrva.exe</li>
<li>dwengine.exe</li>
<li>dwarkdaemon.exe</li>
<li>dwwatcher.exe</li>
<li>fmon.exe</li>
<li>coreServiceShell.exe</li>
<li>PccNTMon.exe</li>
<li>NTRTScan.exe</li>
<li>bdagent.exe</li>
</ul>
</td>
<td><ul>
<li>vsserv.exe</li>
<li>vsservppl.exe</li>
<li>AvastSvc.exe</li>
<li>mcshield.exe</li>
<li>MsMpEng.exe</li>
<li>vkise.exe</li>
<li>isesrv.exe</li>
<li>cmdagent.exe</li>
<li>egui.exe</li>
<li>ekrn.exe</li>
<li>fshoster32.exe</li>
<li>ByteFence.exe</li>
</ul>
</td>
</tr></tbody></table>
<p style="padding-top: 25px;">It also checks antivirus .DLL’s component if it is loaded on the compromised host. Figure 16 shows the function that checks if the Avast module (awshooka.dll and aswhookx.dll) is installed or running on the compromised host.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/avast.png" class="aligncenter"><br>
<i><sup>Figure 16</sup></i></p>
<h3>Command and Control (C2)</h3>
<p>This malware is capable of communicating to its C2 server to send the collected data in the compromised Windows OS and also to download configuration files, plugins, or other malware.&nbsp;</p>
<p>Figure 17 shows the code snippet that contains a function renamed as “mw_internet_crack_send_request” that will send a request to its C2 using <a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-httpsendrequesta" target="_blank">HttpSendRequestA()</a> API. Then it will be followed by another function that will read the reply from the HTTP Request and save it to a file that could be either a configuration file or other malware to be executed in the target or compromised host.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/internetreadfile.png" class="aligncenter"><i><sup>Figure 17</sup></i></p>
<p>This malware also uses a named pipe to communicate to its other process running on the compromised host. Figure 18 is a code snippet showing how it creates named pipes and reads data or files sent or transferred on that randomly generated named pipe.</p>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/namedpipe.png" class="aligncenter"><sup><i>Figure 18</i></sup></p>
<p>Figure 19 shows how Sysmon Event=17, 18 (CreateNamedPipe And ConnectNamedPipe) captured the creation and connection of the injected QakBot in legitimate wermgr.exe process to its randomly generated named pipe.</p>
<pre>
`sysmon` EventCode IN (17, 18) Image= &quot;*\\wermgr.exe&quot; EventType IN ( &quot;CreatePipe&quot;, &quot;ConnectPipe&quot;)&nbsp;
| stats&nbsp; min(_time) as firstTime max(_time) as lastTime count by Image EventType ProcessGuid ProcessId PipeName SecurityID EventCode Computer UserID&nbsp;
| `security_content_ctime(firstTime)`&nbsp;
| `security_content_ctime(lastTime)`&nbsp;
</pre>
<p style="text-align: center;"><img src="/content/dam/splunk-blogs/images/en_us/2022/namedpipesearch.png" class="aligncenter"><sub><i>Figure 19</i></sub></p>
<p>In addition to all this, we are also sharing the decrypted data section of this QakBot variant that contains more TTPs.&nbsp;</p>
<p><a href="https://gist.github.com/tccontre/360dbda059562b67b983d58ae70ac371">https://gist.github.com/tccontre/360dbda059562b67b983d58ae70ac371</a></p>
<p>As defenders, it doesn’t end here. QakBot and other frameworks will continue to improve, evading next-generation controls in place. We must continue to dissolve these loaders into their smallest form and share with the greater security community their tradecraft to help everyone defend their organization.&nbsp;</p>
<h2>Automate with Splunk SOAR Playbooks&nbsp;</h2>
<p>All of the previously listed detections create entries in the risk index by default, and can be used seamlessly with risk notables and the <a href="https://docs.splunk.com/Documentation/ESSOC/3.52.0/user/Useplaybookpack">Risk Notable Playbook Pack</a>. The community Splunk SOAR playbooks below can be used in conjunction with some of the previously described analytics:</p>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
<tbody><tr><th scope="col" style="text-align: left;">Playbook</th>
<th scope="col" style="text-align: left;">Description</th>
</tr><tr><td style="text-align: center;"><p style="text-align: left;"><a href="https://research.splunk.com/playbooks/internal_host_winrm_investigate/">Internal Host WinRM Investigate</a></p>
</td>
<td><p style="text-align: left;">This playbook performs a general investigation on key aspects of a windows device using windows remote management. Important files related to the endpoint are generated, bundled into a zip, and copied to the container vault.</p>
</td>
</tr><tr><td style="text-align: center;"><p style="text-align: left;"><a href="https://research.splunk.com/playbooks/block_indicators/">Block Indicators</a></p>
</td>
<td><p style="text-align: left;">This playbook retrieves IP addresses, domains, and file hashes, blocks them on various services, and adds them to specific blocklists as custom lists.</p>
</td>
</tr><tr><td style="text-align: center;"><p style="text-align: left;"><a href="https://research.splunk.com/playbooks/internal_host_winrm_response/">Internal Host WinRM Response</a></p>
</td>
<td><p style="text-align: left;">This playbook accepts a list of hosts and filenames to remediate on the endpoint. If filenames are provided, the endpoints will be searched and then the user can approve deletion. Then the user is prompted to quarantine the endpoint.</p>
</td>
</tr></tbody></table>
<h2>Detection</h2>
<p style="padding-top: 25px;">Splunk Threat Research Team has curated new and old analytics and tagged them to the <a href="https://research.splunk.com/stories/qakbot/" target="_blank">QakBot Analytic Story</a> to help security analysts detect adversaries leveraging the QakBot malware. This analytic story introduces 43 detections across MITRE ATT&amp;CK techniques.</p>
<p>For this release, we used and considered the relevant data endpoint telemetry sources such as:</p>
<ul>
<li>Process Execution &amp; Command Line Logging</li>
<li>Windows Security Event Id 4688, Sysmon, or any Common Information Model compliant EDR technology.</li>
<li>Windows Security Event Log</li>
<li>Windows System Event Log</li>
</ul>
<h2>Why Should You Care?</h2>
<p>With this article the Splunk Threat Research Team (STRT) enables security analysts, blue teamers and Splunk customers to identify one of the <a href="https://www.cisa.gov/uscert/ncas/alerts/aa22-216a" target="_blank">CISA TOP malware strains</a> . This article helps the community discover QakBot tactics, techniques and procedures. By understanding QakBot behaviors, we were able to generate telemetry and datasets to develop and test Splunk detection analytics designed to defend and respond against this threat.</p>
<h2>Learn More</h2>
<p>You can find the latest content about security analytic stories on <a href="https://github.com/splunk/security-content/releases/tag/v3.12.0" target="_blank">GitHub</a> and in <a href="https://splunkbase.splunk.com/app/3449/" target="_blank">Splunkbase</a>. <a href="https://splunkbase.splunk.com/app/3435/" target="_blank">Splunk Security Essentials</a> also has all of these detections available now.&nbsp;</p>
<p>For a full list of security content, check out the <a href="https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements" target="_blank">release notes</a> on <a href="https://docs.splunk.com/Documentation/ESSOC" target="_blank">Splunk Docs</a>.</p>
<h2>Feedback</h2>
<p>Any feedback or requests? Feel free to put in an issue on GitHub and we’ll follow up. Alternatively, join us on the <a href="https://splunk-usergroups.slack.com/" target="_blank">Slack</a> channel #security-research. Follow <a href="https://docs.splunk.com/Documentation/Community/1.0/community/Chat" target="_blank">these instructions</a> if you need an invitation to our Splunk user groups on Slack.</p>
<h2>Contributors</h2>
<p><i>We would like to thank the authors <a href="https://twitter.com/tccontre18" target="_blank">Teoderick Contreras</a>, <a href="https://twitter.com/M_haggis" target="_blank">Michael Haag</a> and collaborators&nbsp; Lou Stella, Mauricio Velazco, Rod Soto, Jose Hernandez, Patrick Bareiss, Bhavin Patel, and Eric McGinnis for their contributions to this post.</i></p>
<p><i>We would like to extend a huge thank you to <a href="https://twitter.com/pr0xylife" target="_blank">@proxylife</a> for sharing his research and this malware sample that helped the STRT produce this analysis.</i></p>
<table cellpadding="5" cellspacing="0" border="1" width="100%">
</table>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /* end: main content body */-->


<!-- ======== parsys obersvability  ============ -->

<!-- /* start: author bio blurb */-->
<div class="author-intro">
  <div class="container">
    <div class="row">

      <div class="col-sm-4 col-sm-offset-1">
        <div class="author-image">
          <img src="/content/dam/splunk-blogs/images/author-profile-pics/securityresearch_main.jpg" alt="Splunk Threat Research Team "/>
        </div>
        <div class="author-handle">
          <div class="splunk2-eyebrow">Posted by</div>
          <h4 class="splunk2-h5"><a href="/en_us/blog/author/secmrkt-research.html" class="author-name splunk2-color splunk-black">Splunk Threat Research Team </a></h4>
          <!-- /* start: social band, links only */-->
          <div class="author-blurb">
            
          </div>
          <!-- /* end: social band, links only */-->
        </div>
      </div>

      <div class="col-sm-6">
        <div class="author-description body-small">
          <p> </p>
<p>The Splunk Threat Research Team is an active part of a customer’s overall defense strategy by enhancing Splunk security offerings with verified research and security content such as use cases, detection searches, and playbooks. We help security teams around the globe strengthen operations by providing tactical guidance and insights to detect, investigate and respond against the latest threats. The Splunk Threat Research Team focuses on understanding how threats, actors, and vulnerabilities work, and the team replicates attacks which are stored as datasets in the <a href="https://github.com/splunk/attack_data/" target="_blank">Attack Data repository</a>. <br />
<span style="background-color: transparent;"><br />
 Our goal is to provide security teams with research they can leverage in their day to day operations and to become the industry standard for SIEM detections. We are a team of industry-recognized experts who are encouraged to improve the security industry by sharing our work with the community via conference talks, open-sourcing projects, and writing white papers or blogs. You will also find us presenting our research at conferences such as Defcon, Blackhat, RSA, and many more.</span></p>
<p><br />
Read more <a href="https://github.com/splunk/security_content" target="_blank">Splunk Security Content</a>. </p>

        </div>
      </div>

    </div>
  </div>
</div>
<!-- /*end: author bio blurb */-->
<!-- this is optional only need more changes -->


<!-- /*Start: Related Posts section */-->
<div id="related-posts" class="category">
	<section class="blog-list">
		<div class="container">
		    <div class="row">
		    	<h4 class="splunk2-h3" style="text-align:center;">Related Posts</h4>
				<div id="related-posts-list" class="col-sm-10 col-sm-offset-1">
				</div>
			</div>
		</div>
	</section>
</div>
<!-- /* End: Related Posts section */-->

<script src="/etc/clientlibs/splunk/splunk-blogs/dist/js/rteImage.js"></script>
<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<script>
    $(document).ready(function() {
        var numberOfResults = 4;
        var requestType = "relatedposts";
        var pagePath = "\/content\/splunk\u002Dblogs\/en_us\/category\/security\/from\u002Dmacros\u002Dto\u002Dno\u002Dmacros\u002Dcontinuous\u002Dmalware\u002Dimprovements\u002Dby\u002Dqakbot";
        var languageLocale = $('body').attr('lang').toLowerCase().replace('-','_') ;
        var html = "";
        $.ajax({
            type: "GET",
            url: "/bin/splunk/blogs/related.json",
            dataType: "json",
            data: {
            	requestType: requestType,
                numberOfResults: numberOfResults,
                pagePath: pagePath,
                languageLocale: languageLocale
            },
            success: function (response) {
                if (response.length >= 1) {
                	$('#related-posts').css('display','block');
                } else {
                	$('#related-posts').css("display", "none");
                }
                $(response).each(function (i, data) {
                    if (i <= numberOfResults) {
                        html += "<div class=\"blog-list-item\">";
                        html += "   <div class=\"blog-item-img\">";
                        html += "  <a href=\"" + data.blogPath + "\" title=\"\" style=\"background-image: url(" + ((data.blogThumbNail) ?
                            (data.blogThumbNail) : '/content/dam/splunk-blogs/images/logos/default-blogpost-image.jpg') + ");\">";
                        html += "  </a>";
                        html += "   </div>";
                        html += "   <div class=\"blog-item-text\">";
                        html += "    <div class=\"splunk2-eyebrow\">";
                        html += "       <a href=\"" + data.categoryPage + "\" title=\"\">" + data.categoryTitle + "</a>";
                        html += "    </div>";
                        html += "    <h5 class=\"splunk2-h4\">";
                        html += "     <a href=\"" + data.blogPath + "\" title=\"\" style=\"color:#0c1724\">" + data.blogTitle + "</a>";
                        html += "    </h5>";
                        html += "    <div class=\"blog-author-wrapper body-small\">";
                        html += "    <span class=\"blog-author \">";
                        html += "     <a class=\"sp-btn-green-clear\" href=\"" + data.authorPage + "\" title=\"\"><img src=\"" +
                            data.authorThumbNail + "\" alt=\"\"></a> By <a href=\"" + data.authorPage + "\" title=\"\">" + data.authorName +
                            "</a>";
                        html += "    </span>";
                        html += "    <span class=\"blog-date\">" + data.date + "</span>";
                        html += "   </div>";
                        html += "  </div>";
                        html += "</div>";
                    }
                });
                $("#related-posts-list").append(html);
            }
        });
    });
</script>
  <!-- /* start: footer section */-->
  <footer class="splunk-footer fat-footer splunk-footer-v2" id="footer">
      	


<div class="section"><div class="new"></div>
</div><div class="iparys_inherited"><div class="footerIParsys iparsys parsys"><div class="globalfooter parbase section">

<!-- /*start: footer section */ -->
  
    <div class="section">
    <div class="container">
        <div class="row">
            <div class="footer-links-v2 clearfix container responsive-padding">
                
                <div class="col-sm-8">
                    <div class="top-footer-block-container inverted">
                        <div class="top-footer-block">
                            <a href="https://www.splunk.com/en_us/newsroom.html" target="_blank">
                                <span class="splunk-icon icon-splunk-newspaper"> </span>
                                News 
                            </a>
                        </div>
                        <div class="top-footer-block">
                            <a href="https://www.splunk.com/en_us/about-us/events.html" target="_blank ">
                                <span class="splunk-icon icon-splunk-events-icon"> </span>
                                Events 
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4"></div>
                <div class="col-sm-12">
                    <div class="footer-line-separator"></div> 
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="clearfix container responsive-padding">
            <div class="col-sm-1"></div>
            <div class="col-sm-2 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" data-toggle="collapse" data-target="#products-mobile-dropdown" aria-expanded="false">Splunk on Twitter
                    <span class="splunk-icon icon-chevron-down"></span>
                    <span class="splunk-icon icon-chevron-up"></span>
                </button>
                <nav>
                    <ul class="footer-links-v2 ul-bottom-padding collapse" id="products-mobile-dropdown">
                         <li>
                             <a href="https://twitter.com/splunk" target="_blank">@Splunk</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkanswers" target="_blank">@splunkanswers</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkdev" target="_blank">@splunkdev</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkUK" target="_blank">@SplunkUK</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkDE" target="_blank">@SplunkDE</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkGov" target="_blank">@SplunkGov</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkforgood" target="_blank">@SplunkforGood</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkdocs" target="_blank">@SplunkDocs</a>
                         </li>  
                    </ul>
                </nav>
            </div>
            <div class="col-sm-3 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#facebook-mobile-dropdown">Splunk on Facebook
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="facebook-mobile-dropdown">
                       <li>
                           <a href="https://www.facebook.com/splunk" target="_blank">Like us on Facebook</a>
                       </li>
                    
                       <li>
                           <a href="https://www.facebook.com/splunkuniversityjobs" target="_blank">Like Splunk University on Facebook</a>
                       </li>
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#slideshare-mobile-dropdown">Splunk on SlideShare
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="slideshare-mobile-dropdown">
                       <li>
                           <a href="https://www.slideshare.net/Splunk" target="_blank">Follow us on SlideShare</a>
                       </li>
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#instagram-mobile-dropdown">Splunk on Instagram
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="instagram-mobile-dropdown">
                        <li>
                            <a href="https://www.instagram.com/splunk/" target="_blank">Follow us on Instagram</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="col-sm-3 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#linkedin-mobile-dropdown">Splunk on LinkedIn
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="linkedin-mobile-dropdown">
                        <li>
                            <a href="https://www.linkedin.com/company/splunk" target="_blank">Follow us on LinkedIn</a>
                        </li>  
                    
                        <li>
                            <a href="https://www.linkedin.com/showcase/-conf-splunk-worldwide-users%27%E2%80%8B-conference/" target="_blank">Follow .conf on LinkedIn</a>
                        </li>  
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#youtube-mobile-dropdown">Splunk on YouTube
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="youtube-mobile-dropdown">
                         <li>
                             <a href="https://www.youtube.com/user/splunkvideos" target="_blank">Subscribe to our Channel</a>
                         </li>
                    </ul>
                </nav>
            </div>
            <div class="col-sm-2 main-blocks splunk-sites">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" data-toggle="collapse" data-target="#sites-mobile-dropdown" aria-expanded="false">SPLUNK SITES
                    <span class="splunk-icon icon-chevron-down"></span>
                    <span class="splunk-icon icon-chevron-up"></span>
                </button>
                <nav>
                    <ul class="footer-links-v2 collapse" id="sites-mobile-dropdown">
                        <li>
                            <span><a href="https://community.splunk.com/t5/Splunk-Answers/ct-p/en-us-splunk-answers" target="_blank"> Answers</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/community.html" target="_blank"> Community</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://conf.splunk.com/" target="_blank"> .conf</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://dev.splunk.com/" target="_blank"> Developers</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://docs.splunk.com/Documentation" target="_blank"> Documentation</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com" target="_blank"> Splunk.com</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://splunkbase.splunk.com/" target="_blank"> Splunkbase</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.mypromomall.com/splunk" target="_blank"> T-Shirt Store</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/customer-success.html" target="_blank"> Support</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/training.html" target="_blank"> Training</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://usergroups.splunk.com/" target="_blank"> User Groups</a></span>
                        </li>                        
                    </ul>
                </nav>
            </div>
            <div class="col-sm-1"></div>
        </div>
        <div class="copyright-section container">
            <div class="map-links map-links-social">
                <div class="splunk-footer-logo">
                    <a href="https://www.splunk.com">
                        <img class="footer-logo lazyLoad" data-src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="Splunk" title=""/>
                   </a>
                </div>
               <div class="footer-links-v2">
                    <div class="top-footer-block-container social-icons">
                        <a href="https://twitter.com/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-twitter first-social-icon first-social-icon"></span></a>
                    
                        <a href="https://www.facebook.com/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-facebook first-social-icon "></span></a>
                    
                        <a href="https://www.linkedin.com/company/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-linkedIn first-social-icon "></span></a>
                    
                        <a href="https://www.instagram.com/splunk/" target="_blank"><span class="splunk-icon icon-expanded-splunk-instagram first-social-icon "></span></a>
                    
                        <a href="https://www.youtube.com/user/splunkvideos" target="_blank"><span class="splunk-icon icon-expanded-splunk-youtube first-social-icon "></span></a>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 map-links">
                <span class="copyright">© 2005-2023 Splunk Inc. All rights reserved. </span>
                <ul>
                    <li>
                        <a href="https://www.splunk.com/en_us/site-map.html" target="_blank">Sitemap</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/about-splunk/contact-us.html#tabs/tab_parsys_tabs_OfficeLocations_1" target="_blank">Contact</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/careers.html" target="_blank">Careers</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/privacy/privacy-policy.html" target="_blank">Privacy</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/terms/terms-of-use.html" target="_blank">Terms of Use</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/export-controls.html" target="_blank">Export Control</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/pdfs/legal/splunk-modern-slavery-act-transparancy-statement.pdf" target="_blank">Modern Slavery Statement</a>
                    </li>
                </ul>
                <div class="copyright-links"><span>Splunk, Splunk&gt; and Turn Data Into Doing are trademarks or registered trademarks of Splunk Inc. in the United States and other countries. All other brand names, product names, or trademarks belong to their respective owners.</span></div>
            </div>
        </div>
    </div>
</div>
  
  <!-- /*end: footer section */--></div>
<div class="reference parbase section"><div class="cq-dd-paragraph"><div class="plain_html plain-html base-component parbase">
   
     
        

    


    
    
    
    


    
	
	<section class="rte-container" data-track-analytics="true">
		
	    
	    <!-- OneTrust Cookies Consent Notice start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="9ff638b7-8097-449d-9741-7b3c526b0da7"></script>
<script type="text/javascript">
function OptanonWrapper() { window.dataLayer.push( { event: 'OneTrustGroupsUpdated' } ) ; }
</script>
<!-- OneTrust Cookies Consent Notice end -->

<style>
#iframe-modal.modal.fade.show:not(.in) {
  display: none !important;
}
</style>
	 </section>



    
   
    
        

    

</div>
</div>
</div>
<div class="plain-html base-component parbase section">
   
     
        

    


    
    
    
    


    
	
	<section class="rte-container" data-track-analytics="true">
		
	    
	    <script>
  // WWW-15508
    const arrangeCategories = ()=> {
      $('.mega-menu-list li:first').hide();
      $('.mega-menu-list:eq(1) li:first').hide();    
      var el1 = $('.mega-menu-list:eq(1) li:first').html();
      $('.mega-menu-list:eq(0)').append(`<li>${el1}</li>`);    
      var el2 = $('.mega-menu-list:eq(2) li:first').html();
      $('.mega-menu-list:eq(2) li:first').hide();
      $('.mega-menu-list:eq(1)').append(`<li>${el2}</li>`); 
      $('.generic-menu-list li:first').hide();   
  }
  arrangeCategories();  

</script>
<!--<script src="https://www.splunk.com/etc.clientlibs/clientlibs/granite/jquery.0811b5e7037ada110b591bbd86240386.js"></script>-->
<style>
.comments{display:none;}
</style>

<style>/*
#onetrust-pc-sdk .ot-pc-footer {
    position: relative !important;
    border-top: none !important;
}

#onetrust-pc-sdk .ot-grp-desc {
	font-size: 18px !important;
}

#onetrust-pc-sdk {
	width: 920px !important;
	max-width: 920px !important;
}

#onetrust-pc-sdk .ot-always-active,
#onetrust-pc-sdk .ot-desc-cntr h4 {
	font-size: 21px !important;
	color: #363C44 !important;
}

#onetrust-pc-sdk .ot-switch-nob:before {
	top: 0 !important;
}

#onetrust-consent-sdk #onetrust-pc-sdk *:focus, #onetrust-consent-sdk #onetrust-pc-sdk .ot-vlst-cntr > a:focus {
	outline: none !important;
}
#onetrust-pc-sdk .ot-pc-header {
	border-bottom: none !important;
}
#onetrust-pc-sdk .ot-grp-desc {
	line-height: 140% !important;
}
html #onetrust-pc-sdk .ot-always-active {
	color: #656c76 !important;
}
#onetrust-pc-sdk .ot-desc-cntr {
	margin-top: 0 !important;
}
#onetrust-pc-sdk .category-menu-switch-handler {
	padding-top: 6.5px !important;
	padding-bottom: 6.5px !important;
}

html #onetrust-pc-sdk .ot-switch-nob {
    border: 1px solid #656c76 !important;
    background: #c4c4c4 !important;
    height: 20px !important;
}
html #onetrust-pc-sdk .ot-tgl input:checked+.ot-switch .ot-switch-nob {
	border-color: #ce0070 !important;
    background-color: transparent !important;
}
html #onetrust-pc-sdk .ot-tgl input:checked+.ot-switch .ot-switch-nob:before {
    background-color: #c2006b !important;
    -webkit-transform: translateX(18px) !important;
    transform: translateX(18px) !important;
}
html #onetrust-consent-sdk #onetrust-pc-sdk h3 {
    padding-left: 6px !important;
    font-size: 18px !important;
    font-weight: 700 !important;
    line-height: 110% !important;
    color: #656c76 !important;
}
html #onetrust-consent-sdk #onetrust-pc-sdk .ot-active-menu h3 {
    border-color: #ce0070 !important;
    color: #0c1724 !important;
}
#onetrust-pc-sdk #ot-pc-title {
	font-size: 21px !important;
}*/
</style>
<script>
jQuery(document).ready(function ($) {
$('img').removeAttr('srcset');
});
</script>
	 </section>



    
   
    
        

    

</div>
</div>
</div>

  </footer>

        




    
<script type="text/javascript" src="/etc/clientlibs/splunk/splunk-blogs/dist.8893e66c60fecea4caa448892255d88b.js"></script>




        

    </body>
</html>
