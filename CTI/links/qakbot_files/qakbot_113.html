<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://blog.vincss.net/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="VinCSS Blog - Atom" href="https://blog.vincss.net/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="VinCSS Blog - RSS" href="https://blog.vincss.net/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="VinCSS Blog - Atom" href="https://www.blogger.com/feeds/6563680253018836381/posts/default" />

<link rel="alternate" type="application/atom+xml" title="VinCSS Blog - Atom" href="https://blog.vincss.net/feeds/7681247460033113183/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w400-h286/image1.png' rel='image_src'/>
<meta content='https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html' property='og:url'/>
<meta content='[RE021] Qakbot analysis –  Dangerous malware has been around for more than a decade' property='og:title'/>
<meta content='  1. Overview QakBot  ( also known as QBot, QuakBot, Pinkslipbot ) is one of the famous Banking Trojan  with the main task to steal banking ...' property='og:description'/>
<meta content='https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w1200-h630-p-k-no-nu/image1.png' property='og:image'/>
<title>VinCSS Blog: [RE021] Qakbot analysis &#8211;  Dangerous malware has been around for more than a decade</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Ethereal
Designer: Jason Morrow
URL:      jasonmorrow.etsy.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#000000"/>
<Group description="Body Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#666666"/>
</Group>
<Group description="Background" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#fb5e53"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="body.border.color" description="Border Color" type="color" default="#fb5e53"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#2198a6"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#4d469c"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#91b5d4"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Times, 'Times New Roman', FreeSerif, serif"/>
<Variable name="header.text.color" description="Text Color" type="color" default="#ff8b8b"/>
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#666666"/>
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#ffffff"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#ffa183"/>
<Variable name="tabs.background.color" description="Background Color" type="color" default="#ffdfc7"/>
<Variable name="tabs.border.bevel.color" description="Bevel Color" type="color" default="#fb5e53"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 24px Times, Times New Roman, serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#2198a6"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="widget.title.border.bevel.color" description="Bevel Color" type="color" default="#dbdbdb"/>
</Group>
<Group description="Accents" selector=".main-inner .widget">
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#cccccc"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#dbdbdb"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#111e44" default="$(color) none repeat-x scroll top left"/>
<Variable name="body.background.gradient" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.imageBorder" description="Body Image Border" type="url"
default="none"/>
<Variable name="body.background.imageBorder.position.left" description="Body Image Border Left" type="length"
default="0" min="0" max="400px"/>
<Variable name="body.background.imageBorder.position.right" description="Body Image Border Right" type="length"
default="0" min="0" max="400px"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none"/>
<Variable name="content.background.gradient" description="Content Gradient" type="url" default="none"/>
<Variable name="link.decoration" description="Link Decoration" type="string" default="none"/>
<Variable name="link.visited.decoration" description="Link Visited Decoration" type="string" default="none"/>
<Variable name="link.hover.decoration" description="Link Hover Decoration" type="string" default="underline"/>
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="15px" min="0" max="100px"/>
<Variable name="date.space" description="Date Space" type="length" default="15px" min="0" max="100px"/>
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" min="0" max="100px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string" default=""/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
background: #111e44 url(//1.bp.blogspot.com/-kBNZW-jKm4Y/XgLebatzEII/AAAAAAAAAVA/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw/s0/header-bottom.png) no-repeat fixed bottom center;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #91b5d4;
}
a:visited {
text-decoration: none;
color: #4d469c;
}
a:hover {
text-decoration: underline;
color: #b8cada;
}
.main-inner {
padding-top: 15px;
}
.body-fauxcolumn-outer {
background: transparent none repeat-x scroll top center;
}
.content-fauxcolumns .fauxcolumn-inner {
background: #111e44 url(https://resources.blogblog.com/blogblog/data/1kt/ethereal/white-fade.png) repeat-x scroll top left;
border-left: 1px solid #111e44;
border-right: 1px solid #111e44;
}
/* Flexible Background
----------------------------------------------- */
.content-fauxcolumn-outer .fauxborder-left {
width: 100%;
padding-left: 0;
margin-left: -0;
background-color: transparent;
background-image: none;
background-repeat: no-repeat;
background-position: left top;
}
.content-fauxcolumn-outer .fauxborder-right {
margin-right: -0;
width: 0;
background-color: transparent;
background-image: none;
background-repeat: no-repeat;
background-position: right top;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
/* Header
----------------------------------------------- */
.header-inner {
padding: 27px 0 3px;
}
.header-inner .section {
margin: 0 35px;
}
.Header h1 {
font: normal normal 60px Times, 'Times New Roman', FreeSerif, serif;
color: #ffffff;
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 115%;
color: #666666;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
position: relative;
background: transparent;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner {
padding: 0;
}
.tabs-inner .section {
margin: 0 35px;
}
*+html body .tabs-inner .widget li {
padding: 1px;
}
.PageList {
border-bottom: 1px solid #c2d8fa;
}
.tabs-inner .widget li.selected a,
.tabs-inner .widget li a:hover {
position: relative;
-moz-border-radius-topleft: 5px;
-moz-border-radius-topright: 5px;
-webkit-border-top-left-radius: 5px;
-webkit-border-top-right-radius: 5px;
-goog-ms-border-top-left-radius: 5px;
-goog-ms-border-top-right-radius: 5px;
border-top-left-radius: 5px;
border-top-right-radius: 5px;
background: #4eabff none ;
color: #ffffff;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
margin-right: 1px;
padding: .65em 1.5em;
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #666666;
background-color: #c2d8fa;
-moz-border-radius-topleft: 5px;
-moz-border-radius-topright: 5px;
-webkit-border-top-left-radius: 5px;
-webkit-border-top-right-radius: 5px;
-goog-ms-border-top-left-radius: 5px;
-goog-ms-border-top-right-radius: 5px;
border-top-left-radius: 5px;
border-top-right-radius: 5px;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 12px Verdana, Geneva, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.main-inner .column-left-inner {
padding: 0 0 0 20px;
}
.main-inner .column-left-inner .section {
margin-right: 0;
}
.main-inner .column-right-inner {
padding: 0 20px 0 0;
}
.main-inner .column-right-inner .section {
margin-left: 0;
}
.main-inner .section {
padding: 0;
}
.main-inner .widget {
padding: 0 0 15px;
margin: 20px 0;
border-bottom: 1px solid #dbdbdb;
}
.main-inner .widget h2 {
margin: 0;
padding: .6em 0 .5em;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
padding-top: 15px;
}
.main-inner .widget .widget-content {
margin: 0;
padding: 15px 0 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -15px -15px -15px;
padding: 0;
list-style: none;
}
.main-inner .sidebar .widget h2 {
border-bottom: 1px solid #f6f6f6;
}
.main-inner .widget #ArchiveList {
margin: -15px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #ffffff;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
.main.section {
margin: 0 20px;
}
body .main-inner .Blog {
padding: 0;
background-color: transparent;
border: none;
}
.main-inner .widget h2.date-header {
border-bottom: 1px solid #f6f6f6;
}
.date-outer {
position: relative;
margin: 15px 0 20px;
}
.date-outer:first-child {
margin-top: 0;
}
.date-posts {
clear: both;
}
.post-outer, .inline-ad {
border-bottom: 1px solid #dbdbdb;
padding: 30px 0;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body img {
padding: 8px;
}
h3.post-title, h4 {
font: normal bold 36px Times, Times New Roman, serif;
color: #ffff00;
}
h3.post-title a {
font: normal bold 36px Times, Times New Roman, serif;
color: #ffff00;
text-decoration: none;
}
h3.post-title a:hover {
color: #b8cada;
text-decoration: underline;
}
.post-header {
margin: 0 0 1.5em;
}
.post-body {
line-height: 1.4;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
background: #111e44 url(https://resources.blogblog.com/blogblog/data/1kt/ethereal/white-fade.png) repeat-x scroll top left;
}
.comments .comments-content .loadmore a {
border-top: 1px solid #f6f6f6;
border-bottom: 1px solid #f6f6f6;
}
.comments .comment-thread.inline-thread {
background: #111e44 url(https://resources.blogblog.com/blogblog/data/1kt/ethereal/white-fade.png) repeat-x scroll top left;
}
.comments .continue {
border-top: 2px solid #f6f6f6;
}
/* Footer
----------------------------------------------- */
.footer-inner {
padding: 30px 0;
overflow: hidden;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto
}
.mobile .body-fauxcolumn-outer {
background: ;
}
.mobile .content-fauxcolumns .fauxcolumn-inner {
opacity: 0.75;
}
.mobile .content-fauxcolumn-outer .fauxborder-right {
margin-right: 0;
}
.mobile-link-button {
background-color: #4eabff;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile-index-contents {
color: #444444;
}
.mobile .body-fauxcolumn-outer {
background-size: 100% auto;
}
.mobile .mobile-date-outer {
border-bottom: transparent;
}
.mobile .PageList {
border-bottom: none;
}
.mobile .tabs-inner .section {
margin: 0;
}
.mobile .tabs-inner .PageList .widget-content {
background: #4eabff none;
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #ffffff;
}
.mobile .footer-inner {
overflow: visible;
}
body.mobile .AdSense {
margin: 0 -10px;
}
body .navbar {
display: none;
}
.header-inner .section {
margin: 0px !important;
}
.header-inner{
padding-top: 0px !important;
padding-bottom: 25px !important;
}
--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 230px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 230px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("230px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 230px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 230px;
margin-right: -230px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<style>
    body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/s0\/header-bottom.png);}
    
@media (max-width: 200px) { body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/w200\/header-bottom.png);}}
@media (max-width: 400px) and (min-width: 201px) { body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/w400\/header-bottom.png);}}
@media (max-width: 800px) and (min-width: 401px) { body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/w800\/header-bottom.png);}}
@media (max-width: 1200px) and (min-width: 801px) { body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/w1200\/header-bottom.png);}}
/* Last tag covers anything over one higher than the previous max-size cap. */
@media (min-width: 1201px) { body {background-image:url(\/\/1.bp.blogspot.com\/-kBNZW-jKm4Y\/XgLebatzEII\/AAAAAAAAAVA\/AHCkCE1UuNIYx2kW1HS6z6Z-AX2CuL8FACK4BGAYYCw\/w1600\/header-bottom.png);}}
  </style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=6563680253018836381&amp;zx=e940f65e-36ab-4ac5-ad63-ff27ae756feb' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=6563680253018836381&amp;zx=e940f65e-36ab-4ac5-ad63-ff27ae756feb' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar no-items section' id='navbar' name='Navbar'>
</div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<a href='https://blog.vincss.net/' style='display: block'>
<img alt="VinCSS Blog" height="320px; " id="Header1_headerimg" src="//2.bp.blogspot.com/-2y67_wsq62Y/XgLtKAHBmII/AAAAAAAAAVk/MOId9qXvxNkpd_hMARMvfvpEqSREcmTlACK4BGAYYCw/s1600/Banner---Xanh-den-do-trang-3.png" style="display: block" width="1254px; ">
</a>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w400-h286/image1.png' itemprop='image_url'/>
<meta content='6563680253018836381' itemprop='blogId'/>
<meta content='7681247460033113183' itemprop='postId'/>
<a name='7681247460033113183'></a>
<h3 class='post-title entry-title' itemprop='name'>
[RE021] Qakbot analysis &#8211;  Dangerous malware has been around for more than a decade
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7681247460033113183' itemprop='description articleBody'>
<p style="text-align: justify;">&nbsp;</p><h3><!--[if !supportLists]--><span style="color: #ffa400;">1. <!--[endif]-->Overview</span><o:p></o:p></h3><p style="text-align: justify;"><b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #fcff01;">QakBot</span></span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #fcff01;"> </span>(<i>also known as QBot, QuakBot, Pinkslipbot</i>)
is one of the famous <b><span style="color: #fcff01;">Banking Trojan</span></b>
with the main task to steal banking credentials, online banking session
information, or any other banking data. Although detected by anti-virus
software vendors since 2008, but util now it&#8217;s still operating and keep continuously
maintained by the gangs behind it. Qakbot continuously evolves by applying advance
or new techniques to evade detection and avoid reverse analysis, making
analysis more difficult. In recent reports, it could be used to drop other
malware such as <a href="https://www.buguroo.com/en/labs/ransomware-prolock-uses-the-qakbot-banking-trojan-to-infect-users" target="_blank">ProLock</a>,
<a href="https://www.recordedfuture.com/egregor-ransomware-attacks/" target="_blank">Egregor</a>
ransomware.</span></p><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/s636/image1.png" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="455" data-original-width="636" height="286" src="https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w400-h286/image1.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Source:
<a href="https://www.crowdstrike.com/resources/reports/global-threat-report/" target="_blank"><i>CrowdStrike 2021 Global Threat Report</i></a></span></td></tr></tbody></table><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Qakbot
can be distributed via <a href="https://blog.vincss.net/2021/01/re019-phan-tich-tu-a-den-x-chien-dich-tan-cong-thuc-te-su-dung-Emotet-gan-day.html" target="_blank">Emotet</a>,
however Emotet has been <a href="https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action" target="_blank">taken down recently</a>, currently this malware uses email spam and phishing
campaigns as main method. Unlike Emotet that uses MS-Word in conjunction with
VBA to download malicious payload, Qakbot uses MS-Excel with the support of <a href="https://blog.vincss.net/2020/01/cac-ki-thuat-macro-malware-pho-bien.html" target="_blank">Excel 4.0 Macro (XLM macro)</a> to download and execute malicious payload on the
victim's computer.</span><br /><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">In
this article, we will analyze how QakBot infects after launched by malicious
Excel document, the techniques used to make the analysis difficult, and how to
extract the C2 list. QakBot&#8217;s persistence can not be detected at runtime, the
run key only created before system shutdown or enter suspended state, and
deleted immediately after QakBot is executed again. Qakbot also applied
encryption techniques to conceal information, as well as encrypt the payload on
memory.</span></p><p style="text-align: justify;"><span></span></p><a name='more'></a><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Hashes
used in this post:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Document
template: <a href="https://www.virustotal.com/gui/file/0c611fc0b990b1269c7e5d98613c9e0ab4d3a1166370ed707b8d6063f05f6de0/detection" target="_blank">a7ba7bd69d41f3be1e69740c33c4fbf8</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Loader
DLL: <a href="https://www.virustotal.com/gui/file/9a353d4b85b3097762282703f1807c2b459698966b967280c8e4e13cc56d2e28/detection" target="_blank">c0675c5d2bc7ccf59e50977dd71f28ec</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Unpacked
DLL (<i>Main payload</i>): <a href="https://www.virustotal.com/gui/file/8dc342f51990e0212a34ce1ed94a79301f250c7b8f4f58757d2fc767cb25b6b1/detection" target="_blank">4279ff089ffdb4db21677b96a1364969</a></span></li></ul><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QKsWdmkAYZs/YFMoZ_8mwDI/AAAAAAAACN4/sPsSeg8yhyU1L7DVRwrZTfwYrtngBYidwCNcBGAsYHQ/s1152/image1_1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="629" data-original-width="1152" height="350" src="https://1.bp.blogspot.com/-QKsWdmkAYZs/YFMoZ_8mwDI/AAAAAAAACN4/sPsSeg8yhyU1L7DVRwrZTfwYrtngBYidwCNcBGAsYHQ/w640-h350/image1_1.png" width="640" /></a></div><h3><span style="color: #ffa400;">2. <!--[endif]-->Document template and XLM
macro</span><o:p></o:p></h3><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Qakbot
templates are constantly changing depending on the campaign, the final target
of attackers for leveraging templates to trick the victims into enabling macros
to start the infection. This type of maldocs will usually have a cell is &#8220;</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Auto_Open cell</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">&#8221;, its functionality which is similar to the &#8220;</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Sub AutoOpen()</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">&#8221; function in VBA to automatically run macros
when victim press &#8220;<b>Enable Content</b>&#8221;
button.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-M8RzmEPZKCw/YFMomHRjEGI/AAAAAAAACN8/P_A0OxDH9GQkYdJC4KOU2XmV9WH7QszIQCNcBGAsYHQ/s949/image2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="898" data-original-width="949" height="379" src="https://1.bp.blogspot.com/-M8RzmEPZKCw/YFMomHRjEGI/AAAAAAAACN8/P_A0OxDH9GQkYdJC4KOU2XmV9WH7QszIQCNcBGAsYHQ/w400-h379/image2.png" width="400" /></a></div><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">As
already mentioned, these templates use <b>Excel
4.0 macros</b> (<i>predate VBA macros</i>), they
are composed of functions placed inside cells of a macro sheet. To analyze this
form of macro can use following tools:</span><div><ul style="text-align: left;"><li><span face="Tahoma, sans-serif"><span style="font-size: 14.6667px;"><a href="https://github.com/DidierStevens/DidierStevensSuite/" target="_blank">oledump.py and plugin_biff.py</a></span></span></li><li><span face="Tahoma, sans-serif"><a href="https://github.com/DissectMalware/XLMMacroDeobfuscator" target="_blank">XLMMacroDeobfuscator</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://cerbero.io/" target="_blank">Cerbero Suite</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Microsoft
Excel</span></li></ul><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #ffa400;"><b>2.1. XLMMacroDeobfuscator</b></span></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">This
tool allows to extract the cells&#8217;s content, shows which macro sheet has cell is
&#8220;</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Auto_Open cell</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">&#8221;, and utilizes an internal XLM emulator to
interpret the macros, without fully performing the code.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-A1VB_9saCFA/YFMpu-3ef1I/AAAAAAAACOI/4i9GbWys7Zc2P3MZckiUpufENvWT1u96gCNcBGAsYHQ/s1288/image3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="247" data-original-width="1288" height="122" src="https://1.bp.blogspot.com/-A1VB_9saCFA/YFMpu-3ef1I/AAAAAAAACOI/4i9GbWys7Zc2P3MZckiUpufENvWT1u96gCNcBGAsYHQ/w640-h122/image3.png" width="640" /></a></div><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">However,
cause macros in maldocs usually implement obfuscation techniques, so that the
emulate function of the tool does not always work well:</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-IkCajTsm_WY/YFMp4VBqr7I/AAAAAAAACOM/XyyJCMSNmmcj0bNxBjgLSOqX4ebYoCkgQCNcBGAsYHQ/s1627/image4.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="210" data-original-width="1627" height="82" src="https://1.bp.blogspot.com/-IkCajTsm_WY/YFMp4VBqr7I/AAAAAAAACOM/XyyJCMSNmmcj0bNxBjgLSOqX4ebYoCkgQCNcBGAsYHQ/w640-h82/image4.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">2.2. Cerbero
Suite</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Cerbero
Suite is developed by <b><a href="https://twitter.com/erikpistelli" target="_blank">Erik Pistelli</a></b>.
The latest version added support for the XLSB format, so that now it can
decompiles both XLS and XLSB formulas and also support previews spreadsheets same
as opening in Microsoft Excel. Furthermore, it also provides the ability to emulate
Microsoft Excel formulas. During the discussion with the author, I and my
friend have commented and provided samples to him for improving the functionality
of the product.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Like
<b>XLMMacroDeobfuscator</b>, when analyzing
maldoc, this tool also shows the starting point of execution (entry point) is
the cell containing </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Auto_Open</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QnDUu8VsCvY/YFMqQXwWkCI/AAAAAAAACOY/jLyJNRfV7xU1VRnMZukb-W2Ugus2A-hPQCNcBGAsYHQ/s844/image5.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="607" data-original-width="844" height="288" src="https://1.bp.blogspot.com/-QnDUu8VsCvY/YFMqQXwWkCI/AAAAAAAACOY/jLyJNRfV7xU1VRnMZukb-W2Ugus2A-hPQCNcBGAsYHQ/w400-h288/image5.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">With
the help of emulate feature, we can spot that the maldoc registered an API is </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">URLDownloadToFileA</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> , then use this function for downloading
payloads from multiple addresses:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-rTqQBeQMEyY/YFMqbxxynhI/AAAAAAAACOc/zll6923xc0ADtViJxtewKwA8BLFy_QjjwCNcBGAsYHQ/s705/image6.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="705" data-original-width="610" height="400" src="https://1.bp.blogspot.com/-rTqQBeQMEyY/YFMqbxxynhI/AAAAAAAACOc/zll6923xc0ADtViJxtewKwA8BLFy_QjjwCNcBGAsYHQ/w346-h400/image6.png" width="346" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">If
successfully download one of the above payloads, it will use </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rundll32.exe</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to execute:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QF2FBXI5AvA/YFMqklF-vvI/AAAAAAAACOk/h_VelI71FOc-wkty_H2xg2LI1NSpoELQgCNcBGAsYHQ/s790/image7.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="366" data-original-width="790" height="296" src="https://1.bp.blogspot.com/-QF2FBXI5AvA/YFMqklF-vvI/AAAAAAAACOk/h_VelI71FOc-wkty_H2xg2LI1NSpoELQgCNcBGAsYHQ/w640-h296/image7.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">2.3. Microsoft
Excel</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
above mentioned tools based on <a href="https://github.com/DissectMalware/xlrd2" target="_blank">xlrd2</a>,
<a href="https://github.com/DissectMalware/pyxlsb2" target="_blank">pyxlsb2</a> and its own
parser to extract cells and other information from xls, xlsb and xlsm files. Therefore,
in case these tools cannot satisfied, using <b>Microsoft Excel</b> is still the best option.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">When
analyzing with MS Excel, navigate to the cell containing </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Auto_Open</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, select the <b>Macros</b> feature and click <b>Step
Into</b> to open the <b>Single Step</b>
window:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-LHfpoinU3B0/YFMrAcl_QuI/AAAAAAAACOw/DDQuxTcJYy0VyOnsXbTfJ3dimCLaQ-yJwCNcBGAsYHQ/s632/image8.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="413" data-original-width="632" height="261" src="https://1.bp.blogspot.com/-LHfpoinU3B0/YFMrAcl_QuI/AAAAAAAACOw/DDQuxTcJYy0VyOnsXbTfJ3dimCLaQ-yJwCNcBGAsYHQ/w400-h261/image8.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">By
using </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Step Into</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> or </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Evaluate</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to
trace each cell in the same column and display the value of each Formula, we get
the following information:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-XB63Qnu0Lxw/YFMrIS0ZosI/AAAAAAAACO0/RwuMIRZoC0g075XSzik38_m1vzd4IcxIgCNcBGAsYHQ/s783/image9.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="360" data-original-width="783" height="184" src="https://1.bp.blogspot.com/-XB63Qnu0Lxw/YFMrIS0ZosI/AAAAAAAACO0/RwuMIRZoC0g075XSzik38_m1vzd4IcxIgCNcBGAsYHQ/w400-h184/image9.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-wdpmBSrE1Xo/YFMrNpf-BOI/AAAAAAAACO4/9gmL3gtVxgYwDcTPtNlIN9rKLX4W1W4AgCNcBGAsYHQ/s681/image10.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="464" data-original-width="681" height="272" src="https://1.bp.blogspot.com/-wdpmBSrE1Xo/YFMrNpf-BOI/AAAAAAAACO4/9gmL3gtVxgYwDcTPtNlIN9rKLX4W1W4AgCNcBGAsYHQ/w400-h272/image10.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">To
sum up, when Qakbot maldoc executes its macro code, it will download payload to
victim&#8217;s computer and run this payload by using </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rundll32.exe</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">3. Loader
payload</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">3.1. Basic
analysis</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">As
analyzed above, the downloaded payload is a DLL. This DLL exports 4 functions, one
of which is </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">DllRegisterServer</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> function is called by the command </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rundll32</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-FfWLT-2pL00/YFMrmGnKwiI/AAAAAAAACPA/Xajmbe0fvn8NBRfuKEfwWbbGeXP5BN8EwCNcBGAsYHQ/s567/image11.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="402" data-original-width="567" height="284" src="https://1.bp.blogspot.com/-FfWLT-2pL00/YFMrmGnKwiI/AAAAAAAACPA/Xajmbe0fvn8NBRfuKEfwWbbGeXP5BN8EwCNcBGAsYHQ/w400-h284/image11.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Based
on the imported APIs list, we can predictable that it will use it to unpack
another payload:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QRoMqT_kglY/YFMrr8C62JI/AAAAAAAACPE/Yz--FB2HU_c6CzDtpaMKwGcy2aUJzIqlACNcBGAsYHQ/s608/image12.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="378" data-original-width="608" height="249" src="https://1.bp.blogspot.com/-QRoMqT_kglY/YFMrr8C62JI/AAAAAAAACPE/Yz--FB2HU_c6CzDtpaMKwGcy2aUJzIqlACNcBGAsYHQ/w400-h249/image12.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">This
DLL is digitally signed to avoid detection by anti-virus software and other detection
systems:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-yz71YjiX69M/YFMrx4qxuMI/AAAAAAAACPI/7WQnaC5eKJk-ti-bA-sfsCbdVYZu3gFGQCNcBGAsYHQ/s407/image13.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="396" data-original-width="407" src="https://1.bp.blogspot.com/-yz71YjiX69M/YFMrx4qxuMI/AAAAAAAACPI/7WQnaC5eKJk-ti-bA-sfsCbdVYZu3gFGQCNcBGAsYHQ/s320/image13.png" width="320" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">3.2. Technical
analysis</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">This
DLL when executed will allocate and unpack the main payload to the allocated
memory and execute this payload:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-HN5GQtQfxxw/YFMr8zl4VwI/AAAAAAAACPQ/z6LaSHnPe7oHCJT8DB4IgNwCcAKO0Dg5wCNcBGAsYHQ/s1472/image14.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="660" data-original-width="1472" height="286" src="https://1.bp.blogspot.com/-HN5GQtQfxxw/YFMr8zl4VwI/AAAAAAAACPQ/z6LaSHnPe7oHCJT8DB4IgNwCcAKO0Dg5wCNcBGAsYHQ/w640-h286/image14.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Dump
payload from memory to disk for later analysis. Dumped payload is also a DLL,
was built with </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Microsoft
Visual C++</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: major-latin; mso-bidi-language: AR-SA; mso-bidi-theme-font: major-latin; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: major-latin;">,</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> original
name is </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">stager_1.dll</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> and exports only one function is </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">DllRegisterServer</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Nsy9dYBiptU/YFMsDeG7ufI/AAAAAAAACPY/KdDrs071yTQOeYNGY89CICUH-jV8BFPkgCNcBGAsYHQ/s634/image15.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="391" data-original-width="634" height="246" src="https://1.bp.blogspot.com/-Nsy9dYBiptU/YFMsDeG7ufI/AAAAAAAACPY/KdDrs071yTQOeYNGY89CICUH-jV8BFPkgCNcBGAsYHQ/w400-h246/image15.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">To
make sure the dumped payload is correct, usually in the resource section of
this payload must has resource names are "</span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">308</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">" and "</span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">311</span></b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">".</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--4dlgJHTPYY/YFMsLFSToZI/AAAAAAAACPc/qnR_nzlKRXkIzULuGSkeKI7mDml1IEQhACNcBGAsYHQ/s532/image16.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="339" data-original-width="532" height="255" src="https://1.bp.blogspot.com/--4dlgJHTPYY/YFMsLFSToZI/AAAAAAAACPc/qnR_nzlKRXkIzULuGSkeKI7mDml1IEQhACNcBGAsYHQ/w400-h255/image16.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4. Some
techniques used in the main payload</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.1. Junk
code</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">A
well-known technique that's used in many samples, is junk code insertion. With
this technique, the malware inserts lots of code that never gets executed, a
call that never returns, or conditional jumps with conditions that would never
be met. The main goal of this code is to make the code graph look more
complicated than it actually is and to waste the reverse engineer's time analyzing.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">With
Qakbot's payload, the malware author inserts useless API calls alternating between
real instructions, in addition to the time-consuming goal, it can cause disturbing
information when executing in the sandbox environment or via applications that
log windows APIs call.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-yvySi0EyJ7k/YFMsdvWjBcI/AAAAAAAACPo/R2IfC7KzOzgIzMGiLRCdSdhdIu6d3HglACNcBGAsYHQ/s646/image17.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="262" data-original-width="646" height="163" src="https://1.bp.blogspot.com/-yvySi0EyJ7k/YFMsdvWjBcI/AAAAAAAACPo/R2IfC7KzOzgIzMGiLRCdSdhdIu6d3HglACNcBGAsYHQ/w400-h163/image17.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-DFezJIz17Yo/YFMskTuHFaI/AAAAAAAACPs/3yacP2cUcBoZVMadazOR0I21DvPB9W4BwCNcBGAsYHQ/s1088/image18.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="567" data-original-width="1088" height="334" src="https://1.bp.blogspot.com/-DFezJIz17Yo/YFMskTuHFaI/AAAAAAAACPs/3yacP2cUcBoZVMadazOR0I21DvPB9W4BwCNcBGAsYHQ/w640-h334/image18.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.2 Use
non-standard calling convention</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
common standard calling conventions when analyzing malware are </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">cdecl</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">stdcall</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">thiscall</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> or </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">fastcall</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. Howerver,
to complicate the analysis task, Qakbot added non-standard calling convention
that making it difficult to recognize the parameters passed to the function as
well as Hexrays when decompiles will fail.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">For
example, the following function takes 3 parameters, in which the first and
third parameters are pushed onto the stack, and the second parameter is
assigned to </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">eax</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. At this point, Hexrays will miss the parameter
when decompile code:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-GqYiliN4j-I/YFMs4KdaAXI/AAAAAAAACP4/dULrdp2BjAcdKeG7FBdrplypurS_NaEgwCNcBGAsYHQ/s1154/image19.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="207" data-original-width="1154" height="114" src="https://1.bp.blogspot.com/-GqYiliN4j-I/YFMs4KdaAXI/AAAAAAAACP4/dULrdp2BjAcdKeG7FBdrplypurS_NaEgwCNcBGAsYHQ/w640-h114/image19.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">IDA
supports the user-defined calling convention, read <a href="https://www.hex-rays.com/products/ida/support/idadoc/1361.shtml">this
article</a>. With the above case, we can redefine function prototype as
follows: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">int
__usercall sub_100184FE@&lt;eax&gt;(int arg1, int arg2@&lt;eax&gt;, int arg3)</span>. </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: major-latin; mso-bidi-language: AR-SA; mso-bidi-theme-font: major-latin; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: major-latin;">Result</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-OYzm1Nwwoqw/YFMtARg4STI/AAAAAAAACP8/4MENf51Dn20DX4QL2nc-hSBMHwprh7apwCNcBGAsYHQ/s1214/image20.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="189" data-original-width="1214" height="100" src="https://1.bp.blogspot.com/-OYzm1Nwwoqw/YFMtARg4STI/AAAAAAAACP8/4MENf51Dn20DX4QL2nc-hSBMHwprh7apwCNcBGAsYHQ/w640-h100/image20.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Another
example, the function below takes an parameter and this parameter is assigned
to the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">eax</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> register. Incorrect recognition lead to Hexrays
decompiles missing a parameter:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-zjt4KGMlwK4/YFMtHMAJ8EI/AAAAAAAACQA/SeS8yCsYtTE3puVNRVE5sqNAKhNO_BdzQCNcBGAsYHQ/s1140/image21.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="170" data-original-width="1140" height="96" src="https://1.bp.blogspot.com/-zjt4KGMlwK4/YFMtHMAJ8EI/AAAAAAAACQA/SeS8yCsYtTE3puVNRVE5sqNAKhNO_BdzQCNcBGAsYHQ/w640-h96/image21.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">To
help Hexrays decompiles correctly, we can explicitly specify the locations of
arguments and the return value like this: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">int *__usercall
sub_10017EC5@&lt;eax&gt;(unsigned int arg1@&lt;eax&gt;)</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. And here is the result:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-mYaBrlZyJBo/YFMtOX0vFnI/AAAAAAAACQI/FlDPdcir4-kxiGdCj7K53swKkElcE_wEQCNcBGAsYHQ/s1240/image22.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="166" data-original-width="1240" height="86" src="https://1.bp.blogspot.com/-mYaBrlZyJBo/YFMtOX0vFnI/AAAAAAAACQI/FlDPdcir4-kxiGdCj7K53swKkElcE_wEQCNcBGAsYHQ/w640-h86/image22.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.3. Decrypt
strings</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Like
Emotet, all strings are encrypted and decrypted at runtime into memory only and
destroyed right afterwards. Most of QakBot strings are encrypted and stored in
a continuous blob. The decryption function accepts one argument which is the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">index</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to the string, then it </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">xors</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> it with a hardcoded bytes array. During the analysis
this payload, we found <b>02 byte arrays</b>
which containing the value of the original string already encrypted:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-H_sHj6-65F0/YFMtc7zj_QI/AAAAAAAACQQ/NtYKJUnKdEMxGE0Wx0Cop0S2i3W3JasyACNcBGAsYHQ/s951/image23.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="480" data-original-width="951" height="203" src="https://1.bp.blogspot.com/-H_sHj6-65F0/YFMtc7zj_QI/AAAAAAAACQQ/NtYKJUnKdEMxGE0Wx0Cop0S2i3W3JasyACNcBGAsYHQ/w400-h203/image23.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-gXVCyMZjYiQ/YFMtg4TDFhI/AAAAAAAACQU/uGrynan4BMkTmWVlmVfRJut2vLoteAR5ACNcBGAsYHQ/s951/image24.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="536" data-original-width="951" height="225" src="https://1.bp.blogspot.com/-gXVCyMZjYiQ/YFMtg4TDFhI/AAAAAAAACQU/uGrynan4BMkTmWVlmVfRJut2vLoteAR5ACNcBGAsYHQ/w400-h225/image24.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Corresponding
to each above array will have a byte array containing the values used for xor
to decode to get the real strings:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-5-SxJDJ8DlM/YFMtoSpHmuI/AAAAAAAACQY/AmSjpDAIckgyQKQngd4L6InO6cWDduJgACNcBGAsYHQ/s891/image25.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="239" data-original-width="891" height="108" src="https://1.bp.blogspot.com/-5-SxJDJ8DlM/YFMtoSpHmuI/AAAAAAAACQY/AmSjpDAIckgyQKQngd4L6InO6cWDduJgACNcBGAsYHQ/w400-h108/image25.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-uNLl84_u648/YFMtsjHFbvI/AAAAAAAACQg/B4aP28MtVZQXQZMfTlKKPaa1OfwpKeNcwCNcBGAsYHQ/s939/image26.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="224" data-original-width="939" height="95" src="https://1.bp.blogspot.com/-uNLl84_u648/YFMtsjHFbvI/AAAAAAAACQg/B4aP28MtVZQXQZMfTlKKPaa1OfwpKeNcwCNcBGAsYHQ/w400-h95/image26.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">As
mentioned, The decryption function accepts one argument which is the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">index</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to the string. Inside this function will call
the main routine to decrypt the string that malware need to use:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-jKz9B5nsdVQ/YFMt0L0F0CI/AAAAAAAACQo/vPbon8PEt7UV0TM0n9fwiSEkfMpsInENwCNcBGAsYHQ/s1319/image27.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="176" data-original-width="1319" height="86" src="https://1.bp.blogspot.com/-jKz9B5nsdVQ/YFMt0L0F0CI/AAAAAAAACQo/vPbon8PEt7UV0TM0n9fwiSEkfMpsInENwCNcBGAsYHQ/w640-h86/image27.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">f_decrypt_string</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> in the figure does the following:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Based
on the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">index</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> value passed to the function, computes the
length of the string to be decryped.</span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Allocates
memory to store the decrypted string.</span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Through
the loop to <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">xor</span><span style="font-size: 11pt; line-height: 130%;"> with bytes of </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">xor_bytes_arr</span><span style="font-size: 11pt; line-height: 130%;"> array
to retrieve the original string.</span></span></li></ul><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-a7RZPh6Cvus/YFMuDSXayLI/AAAAAAAACQ4/LjpN3vV2SgMQKwH3-29kjtO6P1Nhk0ZZACNcBGAsYHQ/s791/image28.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="440" data-original-width="791" height="356" src="https://1.bp.blogspot.com/-a7RZPh6Cvus/YFMuDSXayLI/AAAAAAAACQ4/LjpN3vV2SgMQKwH3-29kjtO6P1Nhk0ZZACNcBGAsYHQ/w640-h356/image28.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">By
using IDAPython, we can rewrite the code to decrypt the strings and add them as
comments:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--gee4Z-vUwY/YFMuKrsU09I/AAAAAAAACQ8/R5qkphZdNPkpuQQ2bZuu75DZoK3LqFb1gCNcBGAsYHQ/s942/image29.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="727" data-original-width="942" height="309" src="https://1.bp.blogspot.com/--gee4Z-vUwY/YFMuKrsU09I/AAAAAAAACQ8/R5qkphZdNPkpuQQ2bZuu75DZoK3LqFb1gCNcBGAsYHQ/w400-h309/image29.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
results before and after the script execution will make the analysis easier:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-CiPrbzql9-k/YFMuRpk0SEI/AAAAAAAACRA/NgBkd3mEKgE4DsEXUPeMq-QVknfvFL0PwCNcBGAsYHQ/s1298/image30.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="459" data-original-width="1298" height="226" src="https://1.bp.blogspot.com/-CiPrbzql9-k/YFMuRpk0SEI/AAAAAAAACRA/NgBkd3mEKgE4DsEXUPeMq-QVknfvFL0PwCNcBGAsYHQ/w640-h226/image30.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Do
the same with other decryption functions. However, the strings shown in the above
picture are the results obtained after decrypting pre-assigned indexes in
Qakbot's code. The rest of strings indexes are calculated dynamically at
runtime. For example the following code snippet:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-W5Fm18hJ6xk/YFMuYRWy99I/AAAAAAAACRI/DMXf9OsusD8UlY2R0srB4_eS1pwmzRmiwCNcBGAsYHQ/s596/image31.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="519" data-original-width="596" height="349" src="https://1.bp.blogspot.com/-W5Fm18hJ6xk/YFMuYRWy99I/AAAAAAAACRI/DMXf9OsusD8UlY2R0srB4_eS1pwmzRmiwCNcBGAsYHQ/w400-h349/image31.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Therefore,
to get the entire decrypted strings along with associated index, use the
following code:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-uNABzFkgd0s/YFMufs6a_KI/AAAAAAAACRQ/8WtF6LyhuOYRuNYnSCxQmsenop0tkpbZQCNcBGAsYHQ/s597/image32.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="191" data-original-width="597" height="127" src="https://1.bp.blogspot.com/-uNABzFkgd0s/YFMufs6a_KI/AAAAAAAACRQ/8WtF6LyhuOYRuNYnSCxQmsenop0tkpbZQCNcBGAsYHQ/w400-h127/image32.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Please
see the<span style="color: #666666;"> </span></span><!--[if supportFields]><b style='mso-bidi-font-weight:normal'><span
style='font-size:11.0pt;line-height:130%;font-family:"Tahoma",sans-serif;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Tahoma;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><span style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'>&#160;</span>REF _Ref66799407 \h<span
style='mso-spacerun:yes'>&#160; </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span></span></b><![endif]--><b><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #fcff01;">Appendix
1 &#8211; Complete list of decrypted strings</span><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F00520065006600360036003700390039003400300037000000</w:data>
</xml><![endif]--></span></b><!--[if supportFields]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;line-height:130%;font-family:"Tahoma",sans-serif;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Tahoma;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><span style='mso-element:field-end'></span></span></b><![endif]--><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> below.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.4. Dynamic
APIs resolve</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Based
on the results decrypted strings, get a list of major DLLs that Qakbot will uses
to obtain the necessary API functions:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-YVGu5O66oiM/YFMuw4aDKtI/AAAAAAAACRg/OPauLF48DxQwljDCoKB5RK5A_h1v1fZjQCNcBGAsYHQ/s562/image33.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="290" data-original-width="562" height="206" src="https://1.bp.blogspot.com/-YVGu5O66oiM/YFMuw4aDKtI/AAAAAAAACRg/OPauLF48DxQwljDCoKB5RK5A_h1v1fZjQCNcBGAsYHQ/w400-h206/image33.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
will find the address of the API functions through lookup a pre-computed hash
based on the API function name. For each above DLLs will have an array that stored
pre-computed hashes. Below is an illustration of an array that stores
pre-computed hashes of API functions belong to </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">kernel32.dll</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. </span><i><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: major-latin; mso-bidi-language: AR-SA; mso-bidi-theme-font: major-latin; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: major-latin;">(This array will then be overwritten by the real
address of the corresponding API)</span></i><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-FdeNaia1Eow/YFMu4ya-cnI/AAAAAAAACRk/lnn99ZtJHRoa1RE9tK_tatQKSvrAL8hBwCNcBGAsYHQ/s777/image34.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="364" data-original-width="777" height="188" src="https://1.bp.blogspot.com/-FdeNaia1Eow/YFMu4ya-cnI/AAAAAAAACRk/lnn99ZtJHRoa1RE9tK_tatQKSvrAL8hBwCNcBGAsYHQ/w400-h188/image34.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">For
calculating hashes, the payload uses an additional table containing the values
used for </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">xor</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> at address </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">0x1002B6F8 (g_xor_key_tbl)</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. The search algorithm used by Qakbot as
follows:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-GlqeRgWuk0M/YFMu-herOdI/AAAAAAAACRo/oL5NQoh2u5k7IHgGeK5hPSncsLJOw169QCNcBGAsYHQ/s1325/image35.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="812" data-original-width="1325" height="392" src="https://1.bp.blogspot.com/-GlqeRgWuk0M/YFMu-herOdI/AAAAAAAACRo/oL5NQoh2u5k7IHgGeK5hPSncsLJOw169QCNcBGAsYHQ/w640-h392/image35.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Rewrite
the hash function, combine with IDAPython to retrieve a list of APIs and
generate a corresponding enum list for the calculated hashes:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-wH326wGt400/YFMvGOlU4iI/AAAAAAAACRs/4nIa3u03gwgdYE3Gv_6GYLToaFtzn09AgCNcBGAsYHQ/s1210/image36.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="163" data-original-width="1210" height="86" src="https://1.bp.blogspot.com/-wH326wGt400/YFMvGOlU4iI/AAAAAAAACRs/4nIa3u03gwgdYE3Gv_6GYLToaFtzn09AgCNcBGAsYHQ/w640-h86/image36.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">And
here is the result:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-zO0jeoM3U00/YFMvNHuBXjI/AAAAAAAACR0/49qqDs85HCEr1nQtIwT3hG7VKllK1rjuACNcBGAsYHQ/s1205/image37.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="603" data-original-width="1205" height="320" src="https://1.bp.blogspot.com/-zO0jeoM3U00/YFMvNHuBXjI/AAAAAAAACR0/49qqDs85HCEr1nQtIwT3hG7VKllK1rjuACNcBGAsYHQ/w640-h320/image37.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">From
this result, create a corresponding struct and apply this struct in the
relevant code, </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">we</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> will </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">recover</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> the call to the API functions. </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">T</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">hat&#8217;s
much easier to work with</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-cbHcxVxQukQ/YFMvWH3i1wI/AAAAAAAACR8/q2kRMATNKRgvQMbDlRaJJNbBmUwGhRiugCNcBGAsYHQ/s1706/image38.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="420" data-original-width="1706" height="158" src="https://1.bp.blogspot.com/-cbHcxVxQukQ/YFMvWH3i1wI/AAAAAAAACR8/q2kRMATNKRgvQMbDlRaJJNbBmUwGhRiugCNcBGAsYHQ/w640-h158/image38.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.5. Check
protection solutions on victim machine</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Qakbot
create a list of processes related to endpoint protection solutions including
the fields: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">group_id</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">group_index</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. Use
the loop for decrypting the corresponding strings to get a list of the process
names:</span></p><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGridLight" style="border-collapse: collapse; border: medium none; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;">
 <tbody><tr style="height: 1pt; mso-yfti-firstrow: yes; mso-yfti-irow: 0;">
  <td style="border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p align="center" class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-align: center; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;">group_id<o:p></o:p></span></p>
  </td>
  <td style="border-left: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p align="center" class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-align: center; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;">group_index<o:p></o:p></span></p>
  </td>
  <td style="border-left: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p align="center" class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-align: center; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;">process name<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 1;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x1<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x660<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">ccSvcHst.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 2;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x2<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x8C6<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">avgcsrvx.exe;avgsvcx.exe;avgcsrva.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 3;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x4<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x2E7<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">MsMpEng.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 4;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x8<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x1A6<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">mcshield.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 5;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x10<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x6AD<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">avp.exe;kavtray.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 6;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x20<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x398<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">egui.exe;ekrn.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 7;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x40<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x141<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">bdagent.exe;vsserv.exe;vsservppl.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 8;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x80<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x912<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">AvastSvc.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 9;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x100<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x1B3<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">coreServiceShell.exe;PccNTMon.exe;NTRTScan.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 10;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x200<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x90<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">SAVAdminService.exe;SavService.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 11;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x400<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x523<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">fshoster32.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 12;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x800<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x77C<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">WRSA.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 13;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x1000<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x8F0<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">vkise.exe;isesrv.exe;cmdagent.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 14;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x2000<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x7F9<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p align="left" class="MsoNormal" style="margin: 0cm 0cm 0.0001pt; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">ByteFence.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 15;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x4000<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x726<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p align="left" class="MsoNormal" style="margin: 0cm 0cm 0.0001pt; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%;">MBAMService.exe;mbamgui.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="height: 1pt; mso-yfti-irow: 16; mso-yfti-lastrow: yes;">
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 91.9pt;" valign="top" width="123">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0x8000<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 134.65pt;" valign="top" width="180">
  <p class="MsoNormal" style="margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 9.0pt;">0xAFA<o:p></o:p></span></p>
  </td>
  <td style="border-bottom-color: rgb(191, 191, 191); border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor; border-left-color: initial; border-right-color: rgb(191, 191, 191); border-style: none solid solid none; border-top-color: initial; border-width: medium 1pt 1pt medium; height: 1pt; mso-border-alt: solid #BFBFBF .5pt; mso-border-bottom-themecolor: background1; mso-border-bottom-themeshade: 191; mso-border-left-alt: solid #BFBFBF .5pt; mso-border-left-themecolor: background1; mso-border-left-themeshade: 191; mso-border-right-themecolor: background1; mso-border-right-themeshade: 191; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 240.7pt;" valign="top" width="321">
  <p align="left" class="MsoNormal" style="margin: 0cm 0cm 0.0001pt; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">fmon.exe</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%;"><o:p></o:p></span></p>
  </td>
 </tr>
</tbody></table><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">After
that, payload uses the functions </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">CreateToolhelp32Snapshot</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">; </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Process32First</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">; </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">Process32Next</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to
enumerate all the processes running on the victim machine, check the name of
the process is in the above list. If has:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Processes
belong to the same list, return the corresponding <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">group_id</span><span style="font-size: 11pt; line-height: 130%;">. For example: if has </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">avp.exe;kavtray.exe</span><span style="font-size: 11pt; line-height: 130%;"> will return </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">0x10</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Processes
belong to different lists, the result is <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">or</span><span style="font-size: 11pt; line-height: 130%;"> of
the corresponding </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">group_id.</span><span style="font-size: 11pt; line-height: 130%;"> For example, if hash </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 8.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">avp.exe;kavtray.exe</span><span style="font-size: 12pt; line-height: 130%;"> </span><span style="font-size: 11pt; line-height: 130%;">and </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">AvastSvc.exe</span><span style="font-size: 11pt; line-height: 130%;"> then
the result is </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">0x10
| 0x80 = 0x90</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></span></li></ul><div style="text-align: justify;"><i><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">This
result will affect to the flow of process injection. For example, if the victim
machine uses Kaspersky protection (has </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">avp.exe</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">
process), Qakbot will inject code into </span><span style="color: #fcff01; font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">mobsync.exe</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">
instead of </span><span style="color: #fcff01; font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></i></div><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.6. Anti-sandbox</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.6.1. Checking
file name</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
checks whether its name is in the blacklist including: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">artifact.exe;mlwr_smpl;sample;sandbox;cuckoo-</span>;virus</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">. Some sandboxes may change the sample file name.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-9cDmUW_mnc8/YFMwTGmm8yI/AAAAAAAACSE/TD-srbzciYYyfhRC2kneTV57e4WDKE1UACNcBGAsYHQ/s1065/image39.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="322" data-original-width="1065" height="194" src="https://1.bp.blogspot.com/-9cDmUW_mnc8/YFMwTGmm8yI/AAAAAAAACSE/TD-srbzciYYyfhRC2kneTV57e4WDKE1UACNcBGAsYHQ/w640-h194/image39.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.6.2 . Checking
processes</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
checks whether the running processes are in the blacklist, including: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">srvpost.exe;frida-winjector-helper-32.exe;frida-winjector-helper-64.exe</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-KhDilqdQZ0o/YFMwjdmMXGI/AAAAAAAACSM/2zvgs8v7kR4SGvrzgdBV7zFepuQLNHmqgCNcBGAsYHQ/s731/image40.png" style="margin-left: 1em; margin-right: 1em;"><span style="color: #ffa400;"><img border="0" data-original-height="564" data-original-width="731" height="309" src="https://1.bp.blogspot.com/-KhDilqdQZ0o/YFMwjdmMXGI/AAAAAAAACSM/2zvgs8v7kR4SGvrzgdBV7zFepuQLNHmqgCNcBGAsYHQ/w400-h309/image40.png" width="400" /></span></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.6.3. Checking
Device</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
uses API functions </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">SetupDiGetClassDevsA</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">SetupDiEnumDeviceInfo</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">SetupDiGetDeviceRegistryPropertyA</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> of </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">setupapi.dll</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> to
get information about the device on the system, and then check with the
blacklist included: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">A3E64E55_pr;VboxVideo;Red
Hat VirtIO;QEMU</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-zblJRgVDNnc/YFMw2JywCbI/AAAAAAAACSU/3LUnCp9ax50XMZ-bzgBZ0_S99j8PJq1VgCNcBGAsYHQ/s1178/image41.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="687" data-original-width="1178" height="374" src="https://1.bp.blogspot.com/-zblJRgVDNnc/YFMw2JywCbI/AAAAAAAACSU/3LUnCp9ax50XMZ-bzgBZ0_S99j8PJq1VgCNcBGAsYHQ/w640-h374/image41.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.6.4. Checking
hostname and account</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
check whether the hostname and logon account in the blacklist list: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">VIRTUAL-PC</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> and </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">Virtual</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">.</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QesjofFGvnE/YFMxH9FADrI/AAAAAAAACSc/ufl4bsODmEAJi-4LRAiNhvfkCgMHbmF6QCNcBGAsYHQ/s1061/image42.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="263" data-original-width="1061" height="158" src="https://1.bp.blogspot.com/-QesjofFGvnE/YFMxH9FADrI/AAAAAAAACSc/ufl4bsODmEAJi-4LRAiNhvfkCgMHbmF6QCNcBGAsYHQ/w640-h158/image42.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">If
it detects any of those, the execution flow will run into an infinite loop:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-IYplKCsuhFc/YFMxS0EPnmI/AAAAAAAACSg/f2rCzs9QUR8W7rTJIB_dx9Yuva6_QP2tQCNcBGAsYHQ/s926/image43.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="284" data-original-width="926" height="196" src="https://1.bp.blogspot.com/-IYplKCsuhFc/YFMxS0EPnmI/AAAAAAAACSg/f2rCzs9QUR8W7rTJIB_dx9Yuva6_QP2tQCNcBGAsYHQ/w640-h196/image43.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.7. Configuration
info and List of C2 (IP &amp; Port)</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">As
mentioned above, the payload if dumped correctly will have resource names:
"</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">308</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">" and "</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">311</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">".</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> </span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Based
on </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">the decrypted strings</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, we can find the code related to these strings:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-D4ODuLJ90HQ/YFMxgkpBo1I/AAAAAAAACSo/mftMbtcP9Us21I56SG1vgrBJpTwu5pZsACNcBGAsYHQ/s611/image44.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="170" data-original-width="611" height="111" src="https://1.bp.blogspot.com/-D4ODuLJ90HQ/YFMxgkpBo1I/AAAAAAAACSo/mftMbtcP9Us21I56SG1vgrBJpTwu5pZsACNcBGAsYHQ/w400-h111/image44.png" width="400" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.7.1. Decrypt
configuration info</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Qakbot's
configuration is stored in resource </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">308</span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">, the
code related to this resource will do:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Call
decrypt function with </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">index</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> value </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">0x3F5</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">to retrieve</span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> </span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">the string </span><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">&#8220;</span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">308</span></b><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">&#8221;.</span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Use
API functions of <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">kernel32</span><span lang="VI" style="font-size: 11pt; line-height: 130%;"> are </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">FindResourceA</span><span lang="VI" style="font-size: 11pt; line-height: 130%;">; </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">SizeofResource</span><span lang="VI" style="font-size: 11pt; line-height: 130%;">; </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">LoadResource</span><span style="font-size: 11pt; line-height: 130%;"> <span lang="VI">to load the data stored in this resource
into the allocated memory.</span></span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" lang="VI" style="font-size: 11pt; line-height: 130%; mso-ansi-language: VI; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span lang="VI">Call
the function to <span style="font-size: 11pt; line-height: 130%;">decrypt</span><span lang="VI" style="font-size: 11pt; line-height: 130%;"> the data.</span></span></span></span></li></ul><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qDxu1YOzVWU/YFMx6Est6YI/AAAAAAAACS0/ybApUwUc9acOSFTkxkYyufcONLJh6aEJgCNcBGAsYHQ/s902/image45.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="186" data-original-width="902" height="132" src="https://1.bp.blogspot.com/-qDxu1YOzVWU/YFMx6Est6YI/AAAAAAAACS0/ybApUwUc9acOSFTkxkYyufcONLJh6aEJgCNcBGAsYHQ/w640-h132/image45.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Payload
will re-check the size of the resource and call </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">f_decrypt_res_data_by_using_RC4</span></span><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"> function to decrypt:</span></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-rU0adnSn6qM/YFMyJEaXtKI/AAAAAAAACS4/ch7UrwFpLGUYmS-8vDggGv6LzK53XXF3ACNcBGAsYHQ/s1483/image46.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="309" data-original-width="1483" height="134" src="https://1.bp.blogspot.com/-rU0adnSn6qM/YFMyJEaXtKI/AAAAAAAACS4/ch7UrwFpLGUYmS-8vDggGv6LzK53XXF3ACNcBGAsYHQ/w640-h134/image46.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">According
to the pseudocode, the whole decrypting process as follows:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
first <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">20 bytes</span><span style="font-size: 11pt; line-height: 130%;"> of data are the RC4 key, and the rest are the
actual encrypted data need to be decrypt.</span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Use
RC4 algorithm with the obtained key to decrypt the data. The data after decrypted
includes:</span></span></li><ul><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">The
first <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">20 bytes </span><span style="font-size: 11pt; line-height: 130%;">of the decrypted data will contain the SHA1 hash
calculated over the rest of the decrypted data.</span></span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">Decrypted
data is the rest of data after subtracting 20 bytes of SHA1.</span></span></span></li></ul><li><span face="Tahoma, sans-serif"><span style="font-size: 14.6667px;">SHA1
is used as a verification for correct decryption.</span></span></li></ul><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">The
entire process above is illustrated as picture below:</span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-t6NKkfxB_8E/YFMyh450v_I/AAAAAAAACTE/eQhKU2naHiUTvmfd98sP3Ew8FhjHxQSawCNcBGAsYHQ/s1313/image47.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="340" data-original-width="1313" height="166" src="https://1.bp.blogspot.com/-t6NKkfxB_8E/YFMyh450v_I/AAAAAAAACTE/eQhKU2naHiUTvmfd98sP3Ew8FhjHxQSawCNcBGAsYHQ/w640-h166/image47.png" width="640" /></a></div><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">The
contents of the decrypted resource &#8220;</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">308</span><span style="font-size: 11pt; line-height: 130%;">&#8221;
are:</span></span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">10=biden02<span style="font-size: 11pt; line-height: 130%;"> --&gt; CampaignID</span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">3=1614154620<span style="font-size: 11pt; line-height: 130%;">&nbsp;&nbsp; --&gt;
Unix Timestamp (Wed 24 February 2021 08:17:00 UTC)</span></span></span></li></ul><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.7.2. C2s
list (IP &amp; Port)</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">So
by using this method, we can decrypt the other resource "</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">311</span><span style="font-size: 11pt; line-height: 130%;">":</span></span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-JgnXuoWB7Po/YFMy3OEFLmI/AAAAAAAACTM/7ASIJoLU4K8ox8wEGQeHnh5kn2QKtqXRwCNcBGAsYHQ/s950/image48.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="123" data-original-width="950" height="82" src="https://1.bp.blogspot.com/-JgnXuoWB7Po/YFMy3OEFLmI/AAAAAAAACTM/7ASIJoLU4K8ox8wEGQeHnh5kn2QKtqXRwCNcBGAsYHQ/w640-h82/image48.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">We
obtained a list of IP addresses and ports separated by the value </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">01</span><span style="font-size: 11pt; line-height: 130%;">:</span></span><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-xNRdgH1Q_Zw/YFMy-f6BSvI/AAAAAAAACTQ/n17d2NBU4RIvHdrZxbrp28aC4q1YNLfQQCNcBGAsYHQ/s630/image49.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="234" data-original-width="630" height="238" src="https://1.bp.blogspot.com/-xNRdgH1Q_Zw/YFMy-f6BSvI/AAAAAAAACTQ/n17d2NBU4RIvHdrZxbrp28aC4q1YNLfQQCNcBGAsYHQ/w640-h238/image49.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Please
see </span><!--[if supportFields]><b style='mso-bidi-font-weight:normal'><span
style='font-size:11.0pt;line-height:130%;font-family:"Tahoma",sans-serif;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Tahoma;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><span style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'>&#160;</span>REF _Ref66804075 \h<span
style='mso-spacerun:yes'>&#160; </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span></span></b><![endif]--><b><span style="font-size: 11pt; line-height: 130%;">Appendix
2 &#8211; C2s list<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F00520065006600360036003800300034003000370035000000</w:data>
</xml><![endif]--></span></b><!--[if supportFields]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;line-height:130%;font-family:"Tahoma",sans-serif;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Tahoma;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><span style='mso-element:field-end'></span></span></b><![endif]--><span style="font-size: 11pt; line-height: 130%;"> below for the complete list.</span></span><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.8. Process
Injection</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Qakbot
select which process to inject its unpacked code based on the operating system
environment and </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">group_id</span><span style="font-size: 11pt; line-height: 130%;"> information related to the protection solutions
that mentioned above.</span></span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-tMfmSYEwC40/YFMzPnJVFNI/AAAAAAAACTc/KYe3fyT-NpcPugfVwNVNNDlcXkaNZO83ACNcBGAsYHQ/s1024/image50.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="486" data-original-width="1024" height="304" src="https://1.bp.blogspot.com/-tMfmSYEwC40/YFMzPnJVFNI/AAAAAAAACTc/KYe3fyT-NpcPugfVwNVNNDlcXkaNZO83ACNcBGAsYHQ/w640-h304/image50.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Next:</span><p></p><p style="text-align: justify;"></p><ul><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">It
uses <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">CreateProcessW</span><span style="font-size: 11pt; line-height: 130%;"> starts a new </span><b><span style="font-size: 11pt; line-height: 130%;">suspended</span></b><span style="font-size: 11pt; line-height: 130%;"> process. <i>But for simplicity we will only follow
the </i></span><i><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe</span><span style="font-size: 11pt; line-height: 130%;"> process injection path.</span></i></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Create
a new memory region on the <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe</span><span style="font-size: 11pt; line-height: 130%;"> process with </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">RWX</span><span style="font-size: 11pt; line-height: 130%;"> protection
by using the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">NtCreateSection</span><span style="font-size: 11pt; line-height: 130%;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">NtMapViewOfSection</span><span style="font-size: 11pt; line-height: 130%;"> APIs.</span></span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">Copy
the entire Qakbot payload to the memory created above.</span></span></span></li></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-WtPo_V4387A/YFMze7QdcNI/AAAAAAAACTg/hdUevejhLG4xGyEzS72EA-6cjALMrgGwQCNcBGAsYHQ/s1223/image51.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="801" data-original-width="1223" height="420" src="https://1.bp.blogspot.com/-WtPo_V4387A/YFMze7QdcNI/AAAAAAAACTg/hdUevejhLG4xGyEzS72EA-6cjALMrgGwQCNcBGAsYHQ/w640-h420/image51.png" width="640" /></a></div><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Use
the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">GetThreadContext</span><span style="font-size: 11pt; line-height: 130%;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">NtProtectVirtualMemory</span><span style="font-size: 11pt; line-height: 130%;">, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">NtWriteVirtualMemory</span><span style="font-size: 11pt; line-height: 130%;"> functions to overwrite the </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe&#8217;s</span><span style="font-size: 11pt; line-height: 130%;"> entry point with a jump instruction to the
function address of the Qakbot payload:</span></span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-GHLtTda2990/YFMzraDY-FI/AAAAAAAACTo/XIx9Gr-CYl0qyqyukEDR7S-9rySN9zbXgCNcBGAsYHQ/s1149/image52.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="916" data-original-width="1149" height="510" src="https://1.bp.blogspot.com/-GHLtTda2990/YFMzraDY-FI/AAAAAAAACTo/XIx9Gr-CYl0qyqyukEDR7S-9rySN9zbXgCNcBGAsYHQ/w640-h510/image52.png" width="640" /></a></div><br /><div style="text-align: justify;"><span style="font-size: 11pt; line-height: 130%;">Finally,
it resume execution with </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">ResumeThread</span><span style="font-size: 11pt; line-height: 130%;">. At
this time, </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe</span><span style="font-size: 11pt; line-height: 130%;"> will execute from its entry point, and execute
the jump to the function address of the Qakbot payload:</span></div><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-3MO3vTYwYQk/YFMz2zsFmoI/AAAAAAAACTw/rc3Oy0Y0_RcQaKpjO2x1AuVYJjrMTJZ-QCNcBGAsYHQ/s1472/image53.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="366" data-original-width="1472" height="160" src="https://1.bp.blogspot.com/-3MO3vTYwYQk/YFMz2zsFmoI/AAAAAAAACTw/rc3Oy0Y0_RcQaKpjO2x1AuVYJjrMTJZ-QCNcBGAsYHQ/w640-h160/image53.png" width="640" /></a></div><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.9. Overwrite
payload and encrypt payload on memory</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">To
make difficult for people who perform incident response, Qakbot does overwrite
null bytes on the payload itself on disk (but keep </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">DOS_HEADER,
NT_HEADERS, SECTION_HEADER</span><span style="font-size: 11pt; line-height: 130%;">) and
at the same time, it also encrypts all payloads to store on memory for implementing
persistence technique. This ensures that all Qakbot's main code will be
executed from the injected process as </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">explorer.exe</span><span style="font-size: 11pt; line-height: 130%;"> or
</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">mobsync.exe</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-E8Rc5BUt_Kk/YFM0QqGiezI/AAAAAAAACT8/ME-zbz4C1yoj0qHPZjP8ojQTe5D5xksewCNcBGAsYHQ/s821/image54.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="482" data-original-width="821" height="376" src="https://1.bp.blogspot.com/-E8Rc5BUt_Kk/YFM0QqGiezI/AAAAAAAACT8/ME-zbz4C1yoj0qHPZjP8ojQTe5D5xksewCNcBGAsYHQ/w640-h376/image54.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.10. Persistence
operation</span></b></span><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.10.1. Run
key persistence</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Creating
persistence made after process injection step. At this point, Qakbot will
create a thread that performs the task:</span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Call
<span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">RegisterClassExA</span><span style="font-size: 11pt; line-height: 130%;"> to create a window with random class name.</span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Setup
a callback function <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">f_process_wnd_message</span></span><span style="font-size: 11pt; line-height: 130%;"> for processing windows messages.</span></span></span></li></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ku6i1Suvmb0/YFM0v9vqe-I/AAAAAAAACUE/nYZHAZofby4cPUkn9hDvz_CPuTxWm_diQCNcBGAsYHQ/s979/image55.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="679" data-original-width="979" height="444" src="https://1.bp.blogspot.com/-ku6i1Suvmb0/YFM0v9vqe-I/AAAAAAAACUE/nYZHAZofby4cPUkn9hDvz_CPuTxWm_diQCNcBGAsYHQ/w640-h444/image55.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Windows
messages are processed into </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;">f_process_wnd_message</span></span><span style="font-size: 11pt; line-height: 130%;"> as follows:</span></span><p></p><p style="text-align: justify;"></p><ul><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">When
receive system shutdown message (<span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">WM_QUERYENDSESSION</span><span style="font-size: 11pt; line-height: 130%;">) or power-management broadcast message (</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">WM_POWERBROADCAST</span><span style="font-size: 11pt; line-height: 130%;">) that along with event notify the computer
enter suspended state (</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">PBT_APMSUSPEND</span><span style="font-size: 11pt; line-height: 130%;">), call </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">f_install_persistence()</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">When
receive power-management broadcast message (<span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">WM_POWERBROADCAST</span><span style="font-size: 11pt; line-height: 130%;">) that along with events notify the computer
enter resume state (</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">PBT_APMRESUMESUSPEND
|| PBT_APMRESUMEAUTOMATIC</span><span style="font-size: 11pt; line-height: 130%;">),
call </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">f_uninstall_prev_persistence()</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></span></li></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-YkGWQRTfP6U/YFM1A9G79VI/AAAAAAAACUM/rhX0hxj4Ehs5yv9xfMwzQx3hQV8FmfkKgCNcBGAsYHQ/s1047/image56.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="569" data-original-width="1047" height="348" src="https://1.bp.blogspot.com/-YkGWQRTfP6U/YFM1A9G79VI/AAAAAAAACUM/rhX0hxj4Ehs5yv9xfMwzQx3hQV8FmfkKgCNcBGAsYHQ/w640-h348/image56.png" width="640" /></a></div><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #fcff01;"><b>f_install_persistence()</b></span><span style="font-size: 11pt; line-height: 130%;"><b> </b>perfoms the following tasks:</span></span></li><ul><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Decrypt
previously encrypted payloads using RC4 into memory.</span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Setup
command for execute payload: <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">regsvr32.exe -s &lt;Qakbot_module_path&gt;</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">Create
a registry value name which is random alphabet characters at registry key <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span><span style="font-size: 11pt; line-height: 130%;"> for saving above command.</span></span></span></span></li></ul></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-23R_f4fTjVE/YFM1e30HAZI/AAAAAAAACUY/WWTg23nMdiwR4oq9nl11AXNTsOspeUrLwCNcBGAsYHQ/s895/image57.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="351" data-original-width="895" height="250" src="https://1.bp.blogspot.com/-23R_f4fTjVE/YFM1e30HAZI/AAAAAAAACUY/WWTg23nMdiwR4oq9nl11AXNTsOspeUrLwCNcBGAsYHQ/w640-h250/image57.png" width="640" /></a></div><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #fcff01;">f_uninstall_prev_persistence()</span></b><span style="font-size: 11pt; line-height: 130%;"> perfoms the opposite tasks:</span></span></li><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Delete
previous created persistence key.</span></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Delete
payload on disk.</span></span></li></ul></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Ba3JYkjGE64/YFM1zF_M75I/AAAAAAAACUk/6jk5Yt8ZeKUYxelBbV-BLMdxwsPCXGBTQCNcBGAsYHQ/s868/image58.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="588" data-original-width="868" height="434" src="https://1.bp.blogspot.com/-Ba3JYkjGE64/YFM1zF_M75I/AAAAAAAACUk/6jk5Yt8ZeKUYxelBbV-BLMdxwsPCXGBTQCNcBGAsYHQ/w640-h434/image58.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">By this
way, QakBot&#8217;s persistence can not be detected at runtime.</span><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.10.2. Fake
scheduled task persistence</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">In
addition to creating the run key persistence as above, Qakbot also creates a
fake persistence which is scheduled tasks to deceive us. Task is created with a
random name through the following command: </span><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">"%s\system32\schtasks.exe" /Create /RU
"NT AUTHORITY\SYSTEM" /tn %s /tr "%s" /SC ONCE /Z /ST
%02u:%02u /ET %02u:%02u</span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">For
example: </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">"C:\Windows\system32\schtasks.exe"
/Create /RU "NT AUTHORITY\SYSTEM" /tn gyfzcixqb /tr
"regsvr32.exe -s
\"C:\Users\REM\Desktop\Qakbot_DLL_unpacked.bin\"" /SC ONCE /Z
/ST 12:39 /ET 12:51</span></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">However,
at this time the payload on the disk has been erased data, only keep
information of </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-font-size: 10.0pt; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">DOS_HEADER, NT_HEADERS, SECTION_HEADER</span><span style="font-size: 11pt; line-height: 130%;">.</span></span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ff3HixsbAk4/YFM2Wo6ChwI/AAAAAAAACUs/1JB33wc_2hUqoOr2AkmGHjogQHVkWNu0wCNcBGAsYHQ/s834/image59.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="804" data-original-width="834" height="385" src="https://1.bp.blogspot.com/-ff3HixsbAk4/YFM2Wo6ChwI/AAAAAAAACUs/1JB33wc_2hUqoOr2AkmGHjogQHVkWNu0wCNcBGAsYHQ/w400-h385/image59.png" width="400" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">4.11. C2
Communication</span></b></span><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">To
making difficulties for the analyst as well as protection systems, Qakbot will
encrypt its POST request before communicate with C2 server. A Qakbot's POST
request will usually look like this:</span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Cy4f7aPt2ks/YFM2mYPA7TI/AAAAAAAACU0/yac6C3Oy3Kkjc6zw09FhMDuyFT6pKoPPQCNcBGAsYHQ/s765/image60.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="369" data-original-width="765" height="193" src="https://1.bp.blogspot.com/-Cy4f7aPt2ks/YFM2mYPA7TI/AAAAAAAACU0/yac6C3Oy3Kkjc6zw09FhMDuyFT6pKoPPQCNcBGAsYHQ/w400-h193/image60.png" width="400" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Before
encrypted, POST request looks like this:</span><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-2EjXTpP2v8E/YFM22iljRzI/AAAAAAAACU8/J1NZgyFYKysjgWJBKIXd5-xqa0ECzrfXACNcBGAsYHQ/s907/image61.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="211" data-original-width="907" height="148" src="https://1.bp.blogspot.com/-2EjXTpP2v8E/YFM22iljRzI/AAAAAAAACU8/J1NZgyFYKysjgWJBKIXd5-xqa0ECzrfXACNcBGAsYHQ/w640-h148/image61.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">This
POST request will be encrypted and then sent to the C2 server:</span><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-AgSdTlO1yNE/YFM2_xQKK_I/AAAAAAAACVA/gfujzjWidtYl-W-4hgusqC3KGvSu4RyxACNcBGAsYHQ/s1230/image62.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="524" data-original-width="1230" height="272" src="https://1.bp.blogspot.com/-AgSdTlO1yNE/YFM2_xQKK_I/AAAAAAAACVA/gfujzjWidtYl-W-4hgusqC3KGvSu4RyxACNcBGAsYHQ/w640-h272/image62.png" width="640" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">In
the above pseudocode:</span><p></p><p style="text-align: justify;"></p><ul style="text-align: left;"><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #fcff01;">f_encrypt_POST_request_by_RC4</span></b><span style="font-size: 11pt; line-height: 130%;"> performs:</span></span></li><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;">Creates
an <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rc4_key</span><span style="font-size: 11pt; line-height: 130%;"> with 16 bytes long.</span></span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">This<span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"> rc4_key</span><span style="font-size: 11pt; line-height: 130%;"> will
be concatenated with the decrypted string is &#8220;</span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">jHxastDcds)oMc=jvh7wdUhxcsdt2</span><span style="font-size: 11pt; line-height: 130%;">&#8221;. Then use SHA1 to take this data and produce
hash value.</span></span></span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">Use
calculated hash as an <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rc4_key</span><span style="font-size: 11pt; line-height: 130%;"> for encrypting POST request.</span></span></span></span></span></li><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;"><span style="font-size: 11pt; line-height: 130%;">The
result is a memory area of the first 16 bytes of <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rc4_key</span><span style="font-size: 11pt; line-height: 130%;">
and the POST request is encrypted.</span></span></span></span></span></span></li></ul></ul><p></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-dbmwVQYHjwE/YFM3ZY9G-VI/AAAAAAAACVM/20_fQc5t1HMQQIgCfE53XFvi5VX6v6BgQCNcBGAsYHQ/s1691/image63.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="321" data-original-width="1691" height="122" src="https://1.bp.blogspot.com/-dbmwVQYHjwE/YFM3ZY9G-VI/AAAAAAAACVM/20_fQc5t1HMQQIgCfE53XFvi5VX6v6BgQCNcBGAsYHQ/w640-h122/image63.png" width="640" /></a></div><ul><li style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #fcff01;">f_base64_transform</span></b><span style="font-size: 11pt; line-height: 130%;"> will perform encode the entire memory
containing </span><span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;">rc4_key</span><span style="font-size: 11pt; line-height: 130%;"> and ecnryted POST request in base64 format.</span></span></li></ul><div><span face="Tahoma, sans-serif"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-rs18gvfdYSs/YFM3raEc8yI/AAAAAAAACVU/cReezoOn7i4gRyOIYdwoBShWBcyDxnIZQCNcBGAsYHQ/s788/image64.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="219" data-original-width="788" height="178" src="https://1.bp.blogspot.com/-rs18gvfdYSs/YFM3raEc8yI/AAAAAAAACVU/cReezoOn7i4gRyOIYdwoBShWBcyDxnIZQCNcBGAsYHQ/w640-h178/image64.png" width="640" /></a></div><ul><li style="text-align: justify;"><span face="Tahoma, sans-serif"><span style="font-size: 14.6667px;">Finally,
call <span style="font-family: &quot;Cascadia Code&quot;; font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"><span style="color: #fcff01;"><b>f_send_POST_request_to_C2</b></span></span><span style="font-size: 11pt; line-height: 130%;"> to send this POST request to C2.</span></span></span></li></ul></span></div><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">Based
on the entire process above, here is an implementation of the decryption
algorithm:</span></p><p style="text-align: justify;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Tc4tIDnJRP0/YFM38UJbizI/AAAAAAAACVc/HyZWCB2YLLsFFawi_9ZfXEQ_M5z_bqYUQCNcBGAsYHQ/s504/image65.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="298" data-original-width="504" height="236" src="https://1.bp.blogspot.com/-Tc4tIDnJRP0/YFM38UJbizI/AAAAAAAACVc/HyZWCB2YLLsFFawi_9ZfXEQ_M5z_bqYUQCNcBGAsYHQ/w400-h236/image65.png" width="400" /></a></div><br /><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;">5. Conclusion</span></b></span><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;">After
more than a decade, Qakbot still exists, evolve and always is a permanent
threat for large organizations today. The use of the XLSB documents leads to
lower detection rates by security solutions, which are mostly focused on the
more common modern VBA macro malware. In addition, QakBot&#8217;s payloads also
employs a robust set of anti-analysis features, advanced techniques to evade
detection and frustrate analysis. The gangs behind Qakbot are also active in
adding more sophisticated techniques for further development and feature
expansion. So far, the identities of people behind Qbot are unknown. Hopefully,
in the near future, Qakbot will be taken down similar to Emotet.</span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="color: #ffa400;"><b>6. References</b></span></span></p><p style="text-align: justify;"></p><ul><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://www.malware-traffic-analysis.net/2021/02/24/index.html" target="_blank">https://www.malware-traffic-analysis.net/2021/02/24/index.html</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot" target="_blank">https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://any.run/malware-trends/qbot" target="_blank">https://any.run/malware-trends/qbot</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://isc.sans.edu/forums/diary/Emotet+Qakbot+more+Emotet/26750" target="_blank">https://isc.sans.edu/forums/diary/Emotet+Qakbot+more+Emotet/26750</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://www.youtube.com/watch?v=iB1psRMtlqg" target="_blank">Demystifying QBot BankingTrojan - Nick Summerlin and Jorge Rodriguez</a></span></li><li><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><a href="https://n1ght-w0lf.github.io/malware%20analysis/qbot-banking-trojan/" target="_blank">DeepAnalysis of QBot Banking Trojan</a></span></li></ul><p></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;"><a name="_Ref66701346"><span style="font-size: 11pt; line-height: 130%;"><br /></span></a></span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;"><a name="_Ref66799407"></a><a name="_Ref66701346"><span style="font-size: 11pt; line-height: 130%;">7. Appendix
1 &#8211; </span></a><span style="font-size: 11pt; line-height: 130%;">Complete list of decrypted strings</span></span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"></span></p><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGridLight" style="border-collapse: collapse; border: medium none; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;">
 <tbody><tr>
  <td style="background: none 0% 0% repeat scroll rgb(141, 179, 226); border: 1pt solid rgb(191, 191, 191); mso-background-themecolor: text2; mso-background-themetint: 102; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p class="MsoNormal" style="text-indent: 0cm;"><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">index
  boundary: 0xB10</span></b><b><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x0, decrypted string:
  tcpdump.exe;windump.exe;ethereal.exe;wireshark.exe;ettercap.exe;rtsniff.exe;packetcapture.exe;capturenet.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6d, decrypted string: %SystemRoot%\SysWOW64\explorer.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x90, decrypted string: SAVAdminService.exe;SavService.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0xb3, decrypted string: user32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0xbe, decrypted string: mpr.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0xc6, decrypted string: Mozilla/5.0 (Windows NT 6.1; rv:77.0) Gecko/20100101
  Firefox/77.0<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x108, decrypted string: advapi32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x115, decrypted string: %SystemRoot%\System32\mobsync.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x137, decrypted string: ntdll.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x141, decrypted string: bdagent.exe;vsserv.exe;vsservppl.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x166, decrypted string: Initializing database...<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x17f, decrypted string: %SystemRoot%\SysWOW64\mobsync.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1a1, decrypted string: .cfg<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1a6, decrypted string: mcshield.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1b3, decrypted string: coreServiceShell.exe;PccNTMon.exe;NTRTScan.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1e2, decrypted string: shell32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1ee, decrypted string: image/jpeg<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x1f9, decrypted string: image/gif<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x203, decrypted string: C:\INTERNAL\__empty<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x217, decrypted string: %SystemRoot%\SysWOW64\xwizard.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x239, decrypted string: t=%s time=[%02d:%02d:%02d-%02d/%02d/%d]<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x261, decrypted string: abcdefghijklmnopqrstuvwxyz<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x27c, decrypted string: SOFTWARE\Wow6432Node\Microsoft AntiMalware\SpyNet<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x2ae, decrypted string: \sf2.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x2b7, decrypted string: Content-Type: application/x-www-form-urlencoded<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x2e7, decrypted string: MsMpEng.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x2f3, decrypted string: %SystemRoot%\SysWOW64\explorer.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x316, decrypted string: image/pjpeg<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x322, decrypted string: SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x357, decrypted string: %SystemRoot%\System32\xwizard.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x379, decrypted string: Software\Microsoft<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x38c, decrypted string: cscript.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x398, decrypted string: egui.exe;ekrn.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x3aa, decrypted string: SOFTWARE\Wow6432Node\Microsoft\Windows
  Defender\Spynet<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x3e1, decrypted string: WScript.Sleep %u<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">Set
  objWMIService = GetObject("winmgmts:" &amp;
  "{impersonationLevel=impersonate}!\\.\%coot\cimv2")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">Set
  objProcess = GetObject("winmgmts:root\cimv2:Win32_Process")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">errReturn
  = objProcess.Create("%s", null, nul, nul)<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">WSCript.Sleep
  2000<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">Set
  fso = CreateObject("Scripting.FileSystemObject")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">fso.DeleteFile("%s")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x523, decrypted string: fshoster32.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x532, decrypted string: ALLUSERSPROFILE<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x542, decrypted string: kernel32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x54f, decrypted string: application/x-shockwave-flash<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x56d, decrypted string: Set objWMIService = GetObject("winmgmts:"
  &amp; "{impersonationLevel=impersonate}!\\.\%coot\cimv2")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">Set
  objProcess = GetObject("winmgmts:root\cimv2:Win32_Process")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">errReturn
  = objProcess.Create("%s", null, nul, nul)<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x641, decrypted string: %SystemRoot%\explorer.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x65b, decrypted string: c:\\<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x660, decrypted string: ccSvcHst.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x66d, decrypted string: %ProgramFiles(x86)%\Internet Explorer\iexplore.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6a0, decrypted string: netapi32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6ad, decrypted string: avp.exe;kavtray.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6c1, decrypted string: crypt32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6cd, decrypted string: shlwapi.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6d9, decrypted string: snxhk_border_mywnd<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x6ec, decrypted string: SOFTWARE\Microsoft\Microsoft AntiMalware\SpyNet<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x71c, decrypted string: wpcap.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x726, decrypted string: MBAMService.exe;mbamgui.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x742, decrypted string: \\.\pipe\<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x74c, decrypted string: .dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x751, decrypted string: SOFTWARE\Microsoft\Windows Defender\SpyNet<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x77c, decrypted string: WRSA.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x785, decrypted string: reg.exe ADD "HKLM\%s" /f /t %s /v
  "%s" /d "%s"<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index:
  0x7b4, decrypted string: 1234567890</span><o:p></o:p></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x7bf, decrypted string: wmic process call
  create 'expand "%S" "%S"'<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x7ec, decrypted string: wtsapi32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x7f9, decrypted string: ByteFence.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x807, decrypted string:
  SubmitSamplesConsent<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x81c, decrypted string:
  {%02X%02X%02X%02X-%02X%02X-%02X%02X-%02X%02X-%02X%02X%02X%02X%02X%02X}<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x863, decrypted string: NTUSER.DAT<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x86e, decrypted string: .dat<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x873, decrypted string: cmd.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x87b, decrypted string: .exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x880, decrypted string: %s\system32\<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x88d, decrypted string: ws2_32.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x898, decrypted string:
  %ProgramFiles%\Internet Explorer\iexplore.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x8c6, decrypted string:
  avgcsrvx.exe;avgsvcx.exe;avgcsrva.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x8ec, decrypted string: */*<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x8f0, decrypted string:
  vkise.exe;isesrv.exe;cmdagent.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x912, decrypted string: AvastSvc.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x91f, decrypted string: c:\hiberfil.sysss<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x931, decrypted string: wininet.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x93d, decrypted string:
  %SystemRoot%\explorer.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0x957, decrypted string: Set objWMIService
  = GetObject("winmgmts:" &amp; "{impersonationLevel=impersonate}!\\.\%coot\cimv2")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">Set colFiles =
  objWMIService.ExecQuery("Select * From CIM_DataFile Where Name =
  '%s'")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">For Each objFile in colFiles<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">objFile.Copy("%s")<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">Next<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xa43, decrypted string:
  aabcdeefghiijklmnoopqrstuuvwxyyz<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xa64, decrypted string: urlmon.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xa6f, decrypted string: SpyNetReporting<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xa7f, decrypted string: setupapi.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xa8c, decrypted string:
  aaebcdeeifghiiojklmnooupqrstuuyvwxyyaz<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xab3, decrypted string:
  SOFTWARE\Microsoft\Microsoft Antimalware\Exclusions\Paths<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xaed, decrypted string: aswhookx.dll<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xafa, decrypted string: fmon.exe<o:p></o:p></span></p>
  <p class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-size: 11.0pt; mso-bidi-font-weight: bold;">index: 0xb03, decrypted string: aswhooka.dll</span><b><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td style="background: none 0% 0% repeat scroll rgb(141, 179, 226); border-top: none; border: 1pt solid rgb(191, 191, 191); mso-background-themecolor: text2; mso-background-themetint: 102; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p class="MsoNormal" style="text-indent: 0cm;"><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">index
  boundary: 0x435</span></b><b><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x0, decrypted string:
  \System32\WindowsPowerShell\v1.0\powershell.exe<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x30, decrypted string:
  srvpost.exe;frida-winjector-helper-32.exe;frida-winjector-helper-64.exe<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x78, decrypted string: powershell.exe<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x87, decrypted string: /t4<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x8b, decrypted string: %s \"$%s =
  \\\"%s\\\\; &amp; $%s\"<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0xaa, decrypted string:
  SOFTWARE\Microsoft\Windows\CurrentVersion\Run<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0xd8, decrypted string:
  A3E64E55_pr;VBoxVideo<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0xee, decrypted string: .lnk<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0xf3, decrypted string: at.exe %u:%u
  "%s" /I<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x108, decrypted string: Red Hat VirtIO;QEMU<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x11c, decrypted string: net view /all<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x12a, decrypted string: nslookup
  -querytype=ALL -timeout=10 _ldap._tcp.dc._msdcs.%s<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x166, decrypted string: ipconfig /all<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x174, decrypted string:
  SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1ad, decrypted string: regsvr32.exe -s <o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1be, decrypted string: %s "$%s =
  \"%s\"; &amp; $%s"<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1d7, decrypted string: Microsoft<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1e1, decrypted string: Self test
  FAILED!!!<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1f5, decrypted string: 311<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x1f9, decrypted string: %s %04x.%u %04x.%u
  res: %s seh_test: %u consts_test: %d vmdetected: %d createprocess: %d<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x252, decrypted string: whoami /all<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x25e, decrypted string: cmd /c set<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x269, decrypted string: qwinsta<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x271, decrypted string: arp -a<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x278, decrypted string: nltest
  /domain_trusts /all_trusts<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x29a, decrypted string: route print<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x2a6, decrypted string:
  "%s\system32\schtasks.exe" /Create /RU "NT
  AUTHORITY\SYSTEM" /tn %s /tr "%s" /SC ONCE /Z /ST %02u:%02u
  /ET %02u:%02u<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x31b, decrypted string: VIRTUAL-PC<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x326, decrypted string:&nbsp; /c ping.exe -n 6 127.0.0.1 &amp;&nbsp; type "%s\System32\calc.exe" &gt;
  "%s"<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x368, decrypted string: error res='%s'
  err=%d len=%u<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x385, decrypted string: net share<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x38f, decrypted string: Virtual<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x397, decrypted string: net localgroup<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x3a6, decrypted string:
  artifact.exe;mlwr_smpl;sample;sandbox;cuckoo-;virus<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x3da, decrypted string: Self test OK.<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x3e8, decrypted string: netstat -nao<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x3f5, decrypted string: 308<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x3f9, decrypted string: ProfileImagePath<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x40a, decrypted string: amstream.dll<o:p></o:p></span></p>
  <p align="left" class="MsoNormal" style="text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 8pt; line-height: 130%; mso-bidi-font-weight: bold;">index: 0x417, decrypted string:
  jHxastDcds)oMc=jvh7wdUhxcsdt2<o:p></o:p></span></p>
  </td>
 </tr>
</tbody></table><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;"><a name="_Ref66395893"><span style="font-size: 11pt; line-height: 130%;"><br /></span></a></span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><b><span style="color: #ffa400;"><a name="_Ref66804075"></a><a name="_Ref66395986"></a><a name="_Ref66395893"><span style="font-size: 11pt; line-height: 130%;">8. Appendix
2 &#8211; C2</span></a><span style="font-size: 11pt; line-height: 130%;">s</span><span style="font-size: 11pt; line-height: 130%;">
list</span></span></b></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"></span></p><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGridLight" style="border-collapse: collapse; border: medium none; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;">
 <tbody><tr>
  <td style="background: none 0% 0% repeat scroll rgb(141, 179, 226); border: 1pt solid rgb(191, 191, 191); mso-background-themecolor: text2; mso-background-themetint: 102; mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p class="MsoNormal" style="text-indent: 0cm;"><b><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt; line-height: 130%; mso-bidi-font-size: 11.0pt;">QakBot
  C2 List</span></b><b><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td style="border-top: none; border: 1pt solid rgb(191, 191, 191); mso-border-alt: solid #BFBFBF .5pt; mso-border-themecolor: background1; mso-border-themeshade: 191; mso-border-top-alt: solid #BFBFBF .5pt; mso-border-top-themecolor: background1; mso-border-top-themeshade: 191; padding: 0cm 5.4pt; width: 467.25pt;" valign="top" width="623">
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">98.173.34.213:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">160.3.187.114:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">73.25.124.140:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.50.118.93:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">82.127.125.209:990<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">83.110.109.106:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">79.129.121.81:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.223.234.23:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">125.63.101.62:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">113.22.175.141:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">172.78.30.215:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">47.146.169.85:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">47.22.148.6:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">76.25.142.196:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">78.63.226.32:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">105.198.236.101:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">75.67.192.125:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">176.181.247.197:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">105.96.8.96:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">108.31.15.10:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">176.205.222.30:2078<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">115.133.243.6:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">83.110.11.244:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">195.43.173.70:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">197.51.82.72:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">89.137.211.239:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">105.198.236.99:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">144.139.47.206:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">202.188.138.162:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.43.22.218:993<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">69.58.147.82:2078<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">157.131.108.180:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">92.59.35.196:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">195.12.154.8:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">86.160.137.132:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">59.90.246.200:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">96.57.188.174:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">172.87.157.235:3389<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.211.177.183:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">173.184.119.153:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">50.244.112.106:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">144.139.166.18:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">90.65.236.181:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">81.150.181.168:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">68.186.192.69:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">74.222.204.82:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">197.161.154.132:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">38.92.225.121:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">197.45.110.165:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.117.132.169:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">85.52.72.32:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">217.133.54.140:32100<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">193.248.221.184:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">95.77.223.148:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">83.110.103.152:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">80.227.5.69:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">209.210.187.52:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">50.29.166.232:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">108.160.123.244:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.152.219.253:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">81.97.154.100:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">203.198.96.37:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">80.11.173.82:8443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">97.69.160.4:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">196.151.252.84:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">172.115.177.204:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">98.121.187.78:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">47.187.108.172:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">216.201.162.158:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">140.82.49.12:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.199.192.62:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.88.193.17:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">182.48.193.200:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.187.170.235:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">77.211.30.202:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">77.27.204.204:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">96.37.113.36:993<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">187.250.39.162:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">122.148.156.131:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">173.21.10.71:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">119.153.43.235:3389<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.74.12.34:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">75.118.1.141:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">75.136.26.147:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">67.6.12.4:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">71.197.126.250:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">78.185.59.190:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">125.239.152.76:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.46.53.140:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">98.240.24.57:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">199.19.117.131:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">113.211.120.112:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">74.68.144.202:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">73.153.211.227:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">98.252.118.134:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.222.59.177:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">187.250.177.33:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">186.28.55.211:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.210.115.207:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">90.101.117.122:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">72.240.200.181:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">151.205.102.42:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.55.112.61:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">82.12.157.95:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.146.183.105:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">72.252.201.69:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">109.12.111.14:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.229.150.54:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">209.210.187.52:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">67.8.103.21:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">47.196.192.184:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">24.139.72.117:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">79.115.174.55:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">94.53.92.42:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">86.236.77.68:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">89.3.198.238:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">213.60.147.140:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">84.247.55.190:8443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">2.7.116.188:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">106.51.85.162:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">87.202.87.210:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">142.117.191.18:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">196.221.207.137:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">188.26.91.212:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">108.46.145.30:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">125.209.114.182:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">27.223.92.142:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">173.25.45.66:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">32.210.98.6:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">65.27.228.247:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">108.29.32.251:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">189.223.97.175:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">78.97.207.104:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">181.48.190.78:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">2.232.253.79:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">136.232.34.70:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">207.246.77.75:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.77.115.208:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">207.246.77.75:8443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.63.107.192:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.77.117.108:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.77.117.108:8443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.77.115.208:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.77.117.108:443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">144.202.38.185:2222<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">149.28.98.196:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">144.202.38.185:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">149.28.101.90:8443<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">149.28.99.97:995<o:p></o:p></span></p>
  <p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; text-indent: 0cm;"><span style="font-family: &quot;Cascadia Code&quot;; font-size: 9pt;">45.32.211.207:995</span><b><o:p></o:p></b></p>
  </td>
 </tr>
</tbody></table><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><br /></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><span style="font-size: 14.6667px;"><i>Click <a href="https://blog.vincss.net/2021/03/re021-qakbot-ma-doc-nguy-hiem-ton-tai-hon-mot-thap-ki.html" target="_blank">here </a>for Vietnamese version.</i></span></span></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><br /></span></p><p class="MsoNormal"><b><span style="color: #fcff01; font-size: medium;">Tran Trung Kien (aka m4n0w4r)&#8202;<o:p></o:p></span></b></p><p class="MsoNormal"><b><span style="color: #fcff01; font-size: medium;">Malware Analysis Expert<o:p></o:p></span></b></p><p class="MsoNormal"><o:p><b><span style="color: #fcff01; font-size: medium;">&nbsp;</span></b></o:p></p><p style="text-align: justify;"><span face="Tahoma, sans-serif" style="line-height: 130%;"><b><span style="color: #fcff01; font-size: medium;">





</span></b></span></p><p class="MsoNormal"><b><span style="color: #fcff01; font-size: medium;">R&amp;D Center - VinCSS (a member of Vingroup)</span></b><o:p></o:p></p><p style="text-align: justify;"><br /></p><p style="text-align: justify;"><span face="&quot;Tahoma&quot;,sans-serif" style="font-size: 11pt; line-height: 130%; mso-ansi-language: EN-US; mso-ascii-theme-font: minor-latin; mso-bidi-font-family: &quot;Times New Roman&quot;; mso-bidi-language: AR-SA; mso-bidi-theme-font: minor-bidi; mso-fareast-font-family: Tahoma; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin;"><br /></span></p></div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
</span>
<span class='post-timestamp'>
at
<meta content='https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html' itemprop='url'/>
<a class='timestamp-link' href='https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2021-03-18T22:53:00+07:00'>Thursday, March 18, 2021</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
</span>
<div class='post-share-buttons goog-inline-block'>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://blog.vincss.net/search/label/Malware%20Analysis' rel='tag'>Malware Analysis</a>,
<a href='https://blog.vincss.net/search/label/Qakbot' rel='tag'>Qakbot</a>,
<a href='https://blog.vincss.net/search/label/Qbot' rel='tag'>Qbot</a>,
<a href='https://blog.vincss.net/search/label/Reverse%20Engineering' rel='tag'>Reverse Engineering</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>7 comments:</h4>
<div class='comments-content'>
<script async='async' src='' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id='comment-holder'>
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c7061085537789946136"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/08603646708683946380" rel="nofollow">Unknown</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1621591095194#c7061085537789946136">May 21, 2021 at 4:58&#8239;PM</a></span></div><p class="comment-content">great job</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7061085537789946136">Reply</a><span class="item-control blog-admin blog-admin pid-290952831"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=7061085537789946136">Delete</a></span></span></div><div class="comment-replies"><div id="c7061085537789946136-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c7061085537789946136-ra" class="thread-chrome thread-expanded"><div></div><div id="c7061085537789946136-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7061085537789946136">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7061085537789946136-ce"></div></li><li class="comment" id="c6967905714487980486"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/09968883709089077545" rel="nofollow">Chatrt.dk</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642063772334#c6967905714487980486">January 13, 2022 at 3:49&#8239;PM</a></span></div><p class="comment-content">Can we have the IDB file?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6967905714487980486">Reply</a><span class="item-control blog-admin blog-admin pid-1437693584"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=6967905714487980486">Delete</a></span></span></div><div class="comment-replies"><div id="c6967905714487980486-rt" class="comment-thread inline-thread"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c6967905714487980486-ra" class="thread-chrome thread-expanded"><div><li class="comment" id="c1144861929086002040"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/08753808122487712259" rel="nofollow">Admin</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642224184660#c1144861929086002040">January 15, 2022 at 12:23&#8239;PM</a></span></div><p class="comment-content">So sorry, right now I can not share my IDB!<br><br>Regards,</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-52721009"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=1144861929086002040">Delete</a></span></span></div><div class="comment-replies"><div id="c1144861929086002040-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1144861929086002040-ra" class="thread-chrome thread-expanded"><div></div><div id="c1144861929086002040-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1144861929086002040">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1144861929086002040-ce"></div></li><li class="comment" id="c6769904630102326879"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/09968883709089077545" rel="nofollow">Chatrt.dk</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642293298645#c6769904630102326879">January 16, 2022 at 7:34&#8239;AM</a></span></div><p class="comment-content">I understand and it is completely ok and up to you of course. It&#8217;s just because I&#8217;ve tried using the various public python scripts to resolve the APIs, as I can&#8217;t really analyze this malware without knowing which APIs it calls :/<br><br>If it&#8217;s not too much to ask, would you spend a few minutes applying these scripts on a sample and then share the resulting IDB with me? Or at least just tell me how I execute the python functions with the correct parameters?<br><br>Sample:<br>https://bazaar.abuse.ch/sample/f07fcf86314fa15184d72e18227d81edf1ff35dfefc87097ebef39ff14f874f2/<br><br>Python scripts:<br>https://github.com/0ffsetTrainingSolutions/QakbotTools<br><br>Tutorial:<br>https://www.0ffset.net/reverse-engineering/malware-analysis/qakbot-browser-hooking-p1/<br><br>Thank you so much in advance if you&#8217;d help me out with this!</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-1437693584"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=6769904630102326879">Delete</a></span></span></div><div class="comment-replies"><div id="c6769904630102326879-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c6769904630102326879-ra" class="thread-chrome thread-expanded"><div></div><div id="c6769904630102326879-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6769904630102326879">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6769904630102326879-ce"></div></li><li class="comment" id="c1449255007621826822"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/08753808122487712259" rel="nofollow">Admin</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642326300698#c1449255007621826822">January 16, 2022 at 4:45&#8239;PM</a></span></div><p class="comment-content">OK, I will try to take a look at this sample and hope can help you. Can you drop your email or twitter account, I will ping you back!<br><br>Regards,</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-52721009"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=1449255007621826822">Delete</a></span></span></div><div class="comment-replies"><div id="c1449255007621826822-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1449255007621826822-ra" class="thread-chrome thread-expanded"><div></div><div id="c1449255007621826822-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1449255007621826822">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1449255007621826822-ce"></div></li><li class="comment" id="c9067671248568554756"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/09968883709089077545" rel="nofollow">Chatrt.dk</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642342797235#c9067671248568554756">January 16, 2022 at 9:19&#8239;PM</a></span></div><p class="comment-content">Thank you very much!<br><br>E-mail is phpnull at h0tmail.com</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-1437693584"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=9067671248568554756">Delete</a></span></span></div><div class="comment-replies"><div id="c9067671248568554756-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c9067671248568554756-ra" class="thread-chrome thread-expanded"><div></div><div id="c9067671248568554756-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="9067671248568554756">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c9067671248568554756-ce"></div></li><li class="comment" id="c6540511070077751361"><div class="avatar-image-container"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/08753808122487712259" rel="nofollow">Admin</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html?showComment=1642406788138#c6540511070077751361">January 17, 2022 at 3:06&#8239;PM</a></span></div><p class="comment-content">@Chatrt.dk: Check your email! Hope this help!<br><br>Regards,</p><span class="comment-actions secondary-text"><span class="item-control blog-admin blog-admin pid-52721009"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=6563680253018836381&amp;postID=6540511070077751361">Delete</a></span></span></div><div class="comment-replies"><div id="c6540511070077751361-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c6540511070077751361-ra" class="thread-chrome thread-expanded"><div></div><div id="c6540511070077751361-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6540511070077751361">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6540511070077751361-ce"></div></li></div><div id="c6967905714487980486-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6967905714487980486">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6967905714487980486-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self">Add comment</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="7681247460033113183"><a target="_self">Load more...</a></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/6563680253018836381?po=7681247460033113183&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/4235886812-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://blog.vincss.net/2021/03/ex006-hanh-trinh-khai-thac-lo-hong-cve-2021-22986.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://blog.vincss.net/2021/03/re021-qakbot-ma-doc-nguy-hiem-ton-tai-hon-mot-thap-ki.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://blog.vincss.net/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://blog.vincss.net/feeds/7681247460033113183/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://blog.vincss.net/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget Label' data-version='1' id='Label1'>
<h2>Categories</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://blog.vincss.net/search/label/Cyber%20Security%20Products'>Cyber Security Products</a>
<span dir='ltr'>(1)</span>
</li>
<li>
<a dir='ltr' href='https://blog.vincss.net/search/label/Cyber%20Security%20Researches'>Cyber Security Researches</a>
<span dir='ltr'>(18)</span>
</li>
<li>
<a dir='ltr' href='https://blog.vincss.net/search/label/Cyber%20Security%20Techniques'>Cyber Security Techniques</a>
<span dir='ltr'>(5)</span>
</li>
<li>
<a dir='ltr' href='https://blog.vincss.net/search/label/Reverse%20Engineering'>Reverse Engineering</a>
<span dir='ltr'>(29)</span>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget PopularPosts' data-version='1' id='PopularPosts1'>
<h2>Popular Posts</h2>
<div class='widget-content popular-posts'>
<ul>
<li>
<a href='https://blog.vincss.net/2021/02/re020-elephantrat-kunming-version-our-latest-discovered-RAT-of-Panda.html'>[RE020] ElephantRAT (Kunming version): our latest discovered RAT of Panda and  the similarities with recently Smanager RAT</a>
</li>
<li>
<a href='https://blog.vincss.net/2022/05/re027-nhom-apt-mustang-panda-co-the-van-dang-tiep-tuc-hoat-dong-tan-cong-vao-cac-to-chuc-tai-Vietnam.html'>[RE027] Nhóm APT Mustang Panda có thể vẫn đang tiếp tục hoạt động tấn công vào các tổ chức tại Việt Nam</a>
</li>
<li>
<a href='https://blog.vincss.net/2022/05/re027-china-based-apt-mustang-panda-might-have-still-continued-their-attack-activities-against-organizations-in-Vietnam.html'>[RE027] China-based APT Mustang Panda might still have continued their attack activities against organizations in Vietnam</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget Stats' data-version='1' id='Stats1'>
<h2>Total Pageviews</h2>
<div class='widget-content'>
<div id='Stats1_content' style='display: none;'>
<span class='counter-wrapper graph-counter-wrapper' id='Stats1_totalCount'>
</span>
<div class='clear'></div>
</div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot section' id='footer-1'><div class='widget Text' data-version='1' id='Text1'>
<h2 class='title'>Disclaimer</h2>
<div class='widget-content'>
1. Các nội dung trên blog này nằm trong khuôn khổ các hoạt động đóng góp cho cộng đồng an ninh mạng Việt Nam của Công ty Cổ phần Dịch vụ An ninh mạng VinCSS thuộc Tập đoàn Vingroup.<br/><br/>2. Các chuyên gia về dịch ngược và phân tích mã độc của VinCSS sẽ phân tích các mã độc phức tạp, nguy hiểm nhắm đến và đe doạ trực tiếp các cơ quan, tổ chức và cá nhân Việt Nam. Chúng tôi chú trọng công bố sớm các đặc tính kỹ thuật và nhận dạng của mã độc để giúp cộng đồng phòng chống, giảm thiểu thiệt hại. Chúng tôi sẽ cố gắng phối hợp và hỗ trợ các cơ quan chức năng trong phạm vi có thể và luôn đặt đạo đức nghề nghiệp lên hàng đầu.<br/><br/>3. VinCSS luôn cố gắng tối đa để đảm bảo tính chính xác của các mẫu sample, nội dung phân tích. Tuy nhiên, chúng tôi sẽ không chịu bất cứ trách nhiệm nào liên quan đến việc sử dụng lại, suy diễn hay các thiệt hại khác có thể xảy ra cho bên thứ ba khi các thông tin được công bố hay do sử dụng lại các thông tin trên blog này.
</div>
<div class='clear'></div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Công ty Cổ phần Dịch vụ An ninh mạng VinCSS. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3069997043-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5sCCsKy5ttK8sH4RyYpKPTU-vMxQ:1704110770878';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d6563680253018836381','//blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html','6563680253018836381');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '6563680253018836381', 'title': 'VinCSS Blog', 'url': 'https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html', 'canonicalUrl': 'https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html', 'homepageUrl': 'https://blog.vincss.net/', 'searchUrl': 'https://blog.vincss.net/search', 'canonicalHomepageUrl': 'https://blog.vincss.net/', 'blogspotFaviconUrl': 'https://blog.vincss.net/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22VinCSS Blog - Atom\x22 href\x3d\x22https://blog.vincss.net/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22VinCSS Blog - RSS\x22 href\x3d\x22https://blog.vincss.net/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22VinCSS Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/6563680253018836381/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22VinCSS Blog - Atom\x22 href\x3d\x22https://blog.vincss.net/feeds/7681247460033113183/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/1a807f1b871b67af', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '7681247460033113183', 'postImageThumbnailUrl': 'https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/s72-w400-c-h286/image1.png', 'postImageUrl': 'https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w400-h286/image1.png', 'pageName': '[RE021] Qakbot analysis \u2013  Dangerous malware has been around for more than a decade', 'pageTitle': 'VinCSS Blog: [RE021] Qakbot analysis \u2013  Dangerous malware has been around for more than a decade'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': '[RE021] Qakbot analysis \u2013  Dangerous malware has been around for more than a decade', 'description': '\xa0 1. Overview QakBot  ( also known as QBot, QuakBot, Pinkslipbot ) is one of the famous Banking Trojan  with the main task to steal banking ...', 'featuredImage': 'https://1.bp.blogspot.com/-vOIiVzDaaco/YFMnyOu47uI/AAAAAAAACNw/hnjfYu6cQbc1EcBPGaM8FJcu_OsGgEBhgCNcBGAsYHQ/w400-h286/image1.png', 'url': 'https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 7681247460033113183}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1294958110-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/3268905543-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar-right-1', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts1', 'sidebar-right-1', document.getElementById('PopularPosts1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_StatsView', new _WidgetInfo('Stats1', 'sidebar-right-1', document.getElementById('Stats1'), {'title': 'Total Pageviews', 'showGraphicalCounter': true, 'showAnimatedCounter': true, 'showSparkline': false, 'statsUrl': '//blog.vincss.net/b/stats?style\x3dBLACK_TRANSPARENT\x26timeRange\x3dALL_TIME\x26token\x3dAPq4FmAbN-UmChM0UewGwTzHgt0rvjGv5tZ5o0hlrGRw_moAtXR21YgvFmjJ3fBoDuAcvsTgtSB_2jhUVrlT7PgfFtwLD1W4uA'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'footer-1', document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>