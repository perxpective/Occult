
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page teal-layer">
    <head>
        
        <!--<sly data-sly-test="false">-->
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>

            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>New Variant of QakBot Being Spread by HTML File Attached to Phishing Emails</title>
    <meta name="keywords" content="email phishing,phishing,FortiGuard Labs Threat Research,malware analysis,html"/>
    <meta name="description" content="FortiGuard Labs discovered a phishing campaign spreading a new variant of the information stealer and banking Trojan QakBot. Read our blog to learn how the QakBot variant operates. "/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="New Variant of QakBot Being Spread by HTML File Attached to Phishing Emails"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="FortiGuard Labs discovered a phishing campaign spreading a new variant of the information stealer and banking Trojan QakBot. Read our blog to learn how the QakBot variant operates. …"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-images/qakbot-variant-phishing-html-hero.jpg"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Xiaopeng Zhang"/>

    <meta property="article:section" content="FortiGuard Labs Threat Research"/>


    <meta property="article:published_time" content="2022-07-19T17:45:00.000Z"/>


    <meta property="article:tag" content="email phishing"/>

    <meta property="article:tag" content="phishing"/>

    <meta property="article:tag" content="malware analysis"/>

    <meta property="article:tag" content="html"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    






    </head>
    <body>
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-images/qakbot-variant-phishing-html-hero.jpg);">
    <img class="ratio" alt="New Variant of QakBot Being Spread by HTML File Attached to Phishing Emails" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">FortiGuard Labs Threat Research</p>
        
        
        

        <h1 class="b4-hero__headline">New Variant of QakBot Being Spread by HTML File Attached to Phishing Emails</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                              <a href="/blog/search?author=Xiaopeng+Zhang">Xiaopeng Zhang</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | July 19, 2022</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Fortinet’s FortiGuard Labs captured a phishing email as part of a phishing campaign spreading a new variant of QakBot. Also known as QBot, QuackBot, or Pinkslipbot, QakBot is an information stealer and banking Trojan that has been captured and analyzed by security researchers since 2007.</p>
<p>I performed a deep analysis on this phishing campaign and the new QakBot variant using the captured email. In this analysis, you will learn how the attached HTML file leads to downloading and executing the new QakBot variant, what actions it takes on the victim’s device, and how it sends the collected data from the victim’s device to its C2 server. </p>
<p style="margin-left: 40.0px;"><b>Affected platforms:</b> Microsoft Windows<br />
<b>Impacted parties:</b> Microsoft Windows Users<br />
<b>Impact: </b>Controls victim’s device and collects sensitive information<br />
<b>Severity level: </b>Critical<br />
</p>
<h2>Phishing Email and the Attached HTML File</h2>
<p>Figure 1.1 shows the phishing email used by hackers to lure the recipient into opening the attached HTML file (ScannedDocs_1586212494.html). This phishing email has been marked as SPAM by Fortinet’s FortiMail.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image.img.png/1658166579100/img1.1.png" alt="Screenshot of the captured phishing email" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 1.1 – Display of the captured phishing email</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The HTML file contains a piece of javascript code that is automatically executed once it is opened in a web browser by the recipient. It decodes a base64 string held by a local variable. It then calls a built-in function, navigator.msSaveOrOpenBlob(), to save the base64 decoded data (a ZIP archive) to a local file named “ScannedDocs_1586212494.zip”. Figure 1.2 shows the defined variables with the base64 string and the ZIP file name.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_1478536344.img.png/1658166631656/fig1.2.png" alt="Example of the javascript snippet code inside the HTML file" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 1.2 – The javascript snippet code inside the HTML file</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Figure 1.3 is a screenshot of a Microsoft Edge browser opening the HTML file. As you can see, the ZIP archive has been automatically saved onto the victim’s device.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_1383633615.img.png/1658166687103/fig1.3.png" alt="Example of The HTML file opened in the Microsoft Edge browser" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 1.3 – The HTML file opened in the Microsoft Edge browser</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Downloading and executing QakBot</h2>
<p>Next, we’ll look at what’s inside the downloaded ZIP archive. It’s a Windows shortcut file – “ScannedDocs_1586212494.lnk”. As you may know, a Windows shortcut file can execute commands by putting them into the Target field. Figure 2.1 shows a screenshot of this shortcut file and its properties. </p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--6 aem-GridColumn--offset--default--3">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_813759514.img.png/1658166747309/fig2.1.png" alt="Screenshot of The Windows shortcut file and properties" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 2.1 – The Windows shortcut file and properties</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The shortcut is disguised with a Microsoft Write icon to trick the victim into thinking it’s a safe text file so they will open it. As for its properties, a group of commands in the target field will be executed by “cmd.exe”. When the victim double clicks the file, the commands get executed.</p>
<p>According to the commands found in Figure 2.1, it mainly runs “cURL” (Client URL) to download a file from URL 194[.]36[.]191[.]227/%random%.dat into local file “%ProgramData%\Flop\Tres.dod”. cURL is a popular Linux tool, but it has also been part of Windows as a default program since Windows 10.</p>
<p>The downloaded file (“Tres.dod”) is a DLL file. By my analysis, it is a sort of QakBot’s loader program. In this case, “regsvr32” is in charge of executing it using the command “regsvr32 %ProgramData%\Flop\Tres.dod”.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_2053822108.img.png/1658166808143/fig-2.2.png" alt="Example of the QakBot Loader Module’s Resource section" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 2.2 – A view of the QakBot Loader Module’s Resource section</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The QakBot Loader Module (Tres.dod) that runs in “regsvr32.exe” loads a binary block from its Resource section with the name “AAA”, as shown in Figure 2.2. It proceeds to decrypt the binary block to get a fileless PE file and a piece of dynamic code that is a kind of self-deployment function. It is then called by the Loader Module to deploy the fileless PE file, which is the core module of QakBot, inside the “regsvr32” process. After the core module of QakBot is deployed, the last task of the self-deployment function is to call its entry point. Figure 2.3 explains how the self-deployment function calls the entry point of the QakBot core module.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--7 aem-GridColumn--offset--default--3">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_1830509941.img.png/1658166860354/fig-2.3.png" alt="Self-deployment function about to call the entry point of QakBot" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 2.3 – Self-deployment function about to call the entry point of QakBot</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Process Hollowing</h2>
<p>Malware usually performs process hollowing to inject malicious code or modules into another process. It does this to evade being detected.</p>
<p>Depending on the affected machine’s platform (32-bit or 64-bit) and installed anti-virus software, QakBot will select a system process from a process list as the target process for performing process hollowing. This list includes OneDriveSetup.exe, explorer.exe, mobsync.exe, msra.exe, and iexplore.exe for this variant.</p>
<p>In my testing environment, it picked “OneDriveSetup.exe”. QakBot then calls the API CreateProcessW() to start a new process using the creation flag CREATE_SUSPENDED so it gets suspended at start. It can then modify its memory data, like carrying the QakBot core module onto the newly-created “OneDriveSetup.exe” process by calling API WriteProcessMemory(). Next, it modifies the code at the entry point of the new process to jump to the injected core module. It eventually calls the API ResumeThread() to resume the new process, and QakBot is then executed in the target process.</p>
<p>Figure 3.1 shows a process tree with all relevant processes from downloading QakBot Loader (“curl.exe”) to “OneDriveSetup.exe”.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_43835043.img.png/1658166913423/fig-3.1.png" alt="Overview of the process tree for relevant processes" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 3.1 – Overview of the process tree for relevant processes</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Anti-analysis technique</h2>
<p>Before analyzing QakBot’s core module, let’s go through some of the anti-analysis techniques that QakBot uses to prevent itself from being easily analyzed.</p>
<h4><span style="font-weight: normal;">Constant strings are encrypted</span></h4>
<p>Constant strings are useful information for researchers to analyze code. QakBot holds encrypted constant strings, which are only decrypted by a particular function before using. Figure 4.1 is an example of obtaining a constant string, &quot;Mozilla/5.0 (Windows NT 6.1; rv:77.0) Gecko/20100101 Firefox/77.0&quot;, through the function at 609DD8 by string index 0xA8.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_2042687518.img.png/1658166967211/fig-4.1.png" alt="Example of one decrypted constant string by a function" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 4.1 – Example of one decrypted constant string by a function</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h4><span style="font-weight: normal;">Dynamically obtaining key Windows APIs</span></h4>
<p>Most Windows APIs are obtained during QakBot run-time. It is hard to guess which API is called until executing the instruction. Below is an instance of calling the API CreateThread(), where dword_61F818 is a dynamically loaded function table, whose offset +74H is the function of CreateThread().</p>
<p style="margin-left: 40.0px;">xor ecx, ecx<br />
lea eax, [ebp+var_4]<br />
push eax<br />
mov eax, dword_61F818 ; Function table of Kernel32.dll<br />
push ecx<br />
push ecx<br />
push offset thread_fun<br />
push ecx<br />
push ecx<br />
mov [ebp+var_4], ecx<br />
<b> call dword ptr [eax+74h] ; =&gt;; CreateThread</b><br />
mov dword_61F83C, eax<br />
test eax, eax<br />
</p>
<h4><span style="font-weight: normal;">Detecting Analysis Tools</span></h4>
<p>QakBot has a thread function that checks once per second to see if any analysis tool is running on the affected machine. To do this, it predefines a process name list of some analysis tools, which of course, is a decrypted constant string. Once any of them matches one of the running processes, it will affect QakBot’s workflow (say, never connecting to a C2 server).</p>
<p>Here is the predefined process name list:</p>
<p style="margin-left: 40.0px;"><b>frida-winjector-helper-32.exe, frida-winjector-helper-64.exe, tcpdump.exe,windump.exe, ethereal.exe, wireshark.exe, ettercap.exe;rtsniff.exe, packetcapture.exe, capturenet.exe, qak_proxy;dumpcap.exe, CFF Explorer.exe, not_rundll32.exe, ProcessHacker.exe, tcpview.exe, filemon.exe, procmon.exe;idaq64.exe, PETools.exe, ImportREC.exe, LordPE.exe, SysInspector.exe, proc_analyzer.exe, sysAnalyzer.exe, sniff_hit.exe, joeboxcontrol.exe, joeboxserver.exe, ResourceHacker.exe, x64dbg.exe, Fiddler.exe, sniff_hit.exe, sysAnalyzer.exe</b></p>
<p>According to the above process list, I determined that the analysis tools include, but are not limited to:</p>
<p style="margin-left: 40.0px;"><b>Joe Sandbox, TcpDump, WinPcap, Wireshark, Ettercap, PacketCapture, CaptureNet, CFF Explorer, ProcessHacker, TcpView, FileMon, ProcMon, IDA pro, PETools, ImportREC, LordPE, SysInspector, SysAnalyzer, ResourceHacker, x64dbg, and Fiddler.</b></p>
<h2>QakBot’s Core Module Connects to C2 Server<br />
</h2>
<p>As long as the QakBot core module is resumed in the target process (such as “OneDriveSetup.exe”), it starts using another entry function other than the one in regsvr32.exe.</p>
<p>As per QakBot tradition, it uses many threads to perform its tasks. One is to collect information about the affected device and send it to its C2 server.</p>
<p>The core module has two binary data blocks in its Resource section, named “102” and “103”. The data of Resource “103” is an RC4 encrypted configuration. After decryption, it is the string “10=obama189\r\n3=1655107308\r\n”. “obama189” is a QakBot ID of this variant, and “1655107308” is a Unix Epoch time.</p>
<p>The “102” Resource data is an RC4 encrypted C2 server list. “\System32\WindowsPowerShel1\v1.0\powershel1.exe” is a constant string that generates an Rc4 key buffer to decrypt the C2 server data.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_2098653348.img.png/1658167111494/fig-5.1.png" alt="Screenshot of partially decrypted “102” Resource" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 5.1 – Screenshot of partially decrypted “102” Resource</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The top section of Figure 5.1 shows it was about to call the API FindResourceW with the Resource name “102”, while the bottom section is a partial list of the decrypted binary IP and Port of the C2 server. There are 123 IP and Port pairs inside this variant.</p>
<p>QakBot goes through all listed C2 servers, one by one, until a connection is established. It then sends the victim registry packet (the first packet) to that C2 server to register the victim. The plain text of the registry packet is:</p>
<p style="margin-left: 40.0px;"> <b>“{\”2\”:\”hrzpxm292261\”,\”8\”:9,\”1\”:18}”</b></p>
<p>The keys are string numbers, like “2”, “8”, and “1”. The value of “2” is “hrzpxm292261” (the victim’s ID) that was generated using hardware information, the value of key “8” specifies the packet type (it’s 9 for this packet), and “1”’s value is 18, which is the QakBot version.</p>
<p>The packet is RC4 encrypted and then encoded as a string using a base64 algorithm. All the packets between QakBot and the C2 server are sealed in a JSON structure.</p>
<p>It then sends the data to its C2 server using the HTTP Post method with URL “/t4” and the base64 encoded registry data as the body and being transported over SSL protocol. Figure 5.2 shows a screenshot of an analysis tool with the sent packet on the left and response data on the right.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_892568808.img.png/1658167398665/fig-5.2.png" alt="Example of the registry packet in an analysis tool" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 5.2 – The view of the registry packet in an analysis tool</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>It takes the reverse path to restore the response data to plain text, which is base64 decoding and RC4 decryption.</p>
<p>“{\”8\”:5,\”16\”:3257495567,\”39\”:\”vLLO\”,\”38\”:1}” is the plain text for this case, which will set or update the value of some local variables.</p>
<h2>Sending Sensitive Data to the C2 Server</h2>
<p>QakBot collects sensitive data from the victim’s device and sends it to its C2 server. Similarly, the hacker could transfer corresponding sub-modules to the QakBot client to be executed on the victim’s device.</p>
<p>QakBot leverages Windows APIs, Windows commands, and WMI Query Language (WQL) to obtain the information. Below are the details.</p>
<h4><span style="font-weight: normal;">Window APIs</span></h4>


</div>
<div class="cmp cmp-text aem-GridColumn--default--none aem-GridColumn--default--9 aem-GridColumn aem-GridColumn--offset--default--3">
  <table cellspacing="0" class="MsoTableGrid" style="border: none;margin-left: 25.0px;">
<tbody><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>API Function</b></span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>Description</b></span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">GetVersionEx()</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Windows edition information, including build number, such as “10.0.1.19043.0.0.0100” for my testing system running Windows 10.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">GetComputerNameW()</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Computer name, like “DESKTOP-P952NC4”.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">GetSystemMetrics() </span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Obtain screen size (width and height).</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">NetGetJoinInformation()</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Retrieve the AD Domain, like “WORKGROUP”.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">LookupAccountSidW()</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">The User name.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">GetSystemInfo()</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Processor Architecture.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">CreateToolhelp32Snapshot(),</span></span></p>
<p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Process32FirstW(), Process32NextW()</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Obtain running process information.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">GetModuleFileNameW()</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">The full path of QakBot and the full path of the target process. </span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 180.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">CreatProcessW() </span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 385.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Execute Windows commands.</span></span></p>
</td>
</tr></tbody></table>


</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h4><span style="font-weight: normal;">WMI Object Query</span></h4>


</div>
<div class="cmp cmp-text aem-GridColumn--default--none aem-GridColumn--default--9 aem-GridColumn aem-GridColumn--offset--default--3">
  <table cellspacing="0" class="MsoTableGrid" style="border: none;">
<tbody><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>Query String</b></span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>Description</b></span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_OperatingSystem</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">OS information.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM AntiVirusProduct</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Obtain the installed AntiVirus software, like Microsoft Defender or FortiClient. </span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_Processor</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">CPU processor information.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_ComputerSystem</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">System environment information, like Model, Domain, Manufacturer, etc.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_Bios</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Device’s BIOS information.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_DiskDrive</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Hard disk information, like Partitions, Size, and Model. </span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT * FROM Win32_PhysicalMemory</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Physical RAM sticks’ detailed information, such as capacity, clock speed, and channel.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT Caption,Description,Vendor,Version,</span></span></p>
<p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">InstallDate,InstallSource,PackageName FROM Win32_Product</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Installed software information.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 307.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">SELECT Caption,Description,DeviceID,</span></span></p>
<p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Manufacturer,Name,PNPDeviceID,Service,</span></span></p>
<p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Status</span></span></p>
<p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">FROM Win32_PnPEntity</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 283.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Properties of Plug and Play devices, like Keyboard, Mouse, CD-ROM, Network adapter, and more.</span></span></p>
</td>
</tr></tbody></table>


</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h4><span style="font-weight: normal;">Windows Commands</span></h4>


</div>
<div class="cmp cmp-text aem-GridColumn--default--none aem-GridColumn--default--9 aem-GridColumn aem-GridColumn--offset--default--3">
  <table cellspacing="0" class="MsoTableGrid" style="border: none;">
<tbody><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>Commands</b></span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: 1.0px solid black;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"><b>Description</b></span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;ipconfig /all&quot;</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">All TCP/IP network configuration values.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;nslookup -querytype=ALL -timeout=12 _ldap._tcp.dc._msdcs.%s&quot;</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Query SRV records for the domain from the main DNS server of the victim’s device.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;nltest /domain_trusts /all_trusts&quot;</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Enumerating domain trusts.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;net share&quot;</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Shared resources and names.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;route print&quot;</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Active routes’ tables.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;netstat -nao&quot;</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Active connections in the victim’s device.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;net localgroup&quot;</span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Local groups information.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;qwinsta&quot;</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Active sessions on the victim’s device.</span></span></p>
</td>
</tr><tr><td style="border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;arp -a&quot;    </span></span></p>
</td>
<td style="border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;"> Information about ARP entries.</span></span></p>
</td>
</tr><tr><td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: 1.0px solid black;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">&quot;net view /all&quot;</span></span></p>
</td>
<td style="background-color: yellow;border-bottom: 1.0px solid black;border-left: none;border-right: 1.0px solid black;border-top: none;vertical-align: top;width: 295.0px;"><p><span style="font-size: 11.0pt;"><span style="font-family: Calibri , sans-serif;">Display all the shares on a remote computer.</span></span></p>
</td>
</tr></tbody></table>


</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Once QakBot has collected all the information shown in the above tables, it seals the information inside a packet with packet type “8”:4. Figure 6.1 shows the JSON data of this packet, which was about to call the RC4 encryption function.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--7 aem-GridColumn--offset--default--3">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/threat-research/new-variant-of-qakbot-spread-by-phishing-emails/_jcr_content/root/responsivegrid/image_305982080.img.png/1658167740504/fig-6.1.png" alt="Plain text of packet “8”:4 with sensitive information" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 6.1 – Plain text of packet “8”:4 with sensitive information</span>


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Although this QakBot successfully established connections with its C2 server, I have not received any sub-modules. I’m still monitoring the communication and will update this analysis if I get something interesting.</p>
<h2>Conclusion</h2>
<p>According to this analysis, I proved that an attached HTML file is no safer than any other risky files (like MS Word, MS Excel, PDF, and so on). You have to be extra cautious when receiving emails with attachments.</p>
<p>I then explained how the HTML file drops a ZIP archive through a piece of auto-execution JavaScript code. Later, I focused on how a disguised Windows shortcut file downloads the loader module of QakBot.</p>
<p>You also learned what the loader module does to decrypt and deploy the core module of QakBot in a picked target process (“OneDriveSetup.exe” for this time).</p>
<p>And finally, we walked through QakBot starting threads to connect to its C2 server using an <a title="IP address" href="https://www.fortinet.com/resources/cyberglossary/what-is-ip-address?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=blog-what-is-ip-address">IP address</a> and port pair chosen from a C2 server list that had been decrypted from its Resource “102”, as well as what sensitive data it retrieved from the victim’s device and then submitted to its C2 server..</p>
<h2>Fortinet Protections</h2>
<p>Fortinet customers are already protected from this malware through FortiGuard’s Web Filtering, AntiVirus, FortiMail, FortiClient, and FortiEDR services, as follows:</p>
<p>The phishing email was detected as &quot;<b>SPAM</b>&quot; by the FortiMail service.</p>
<p>The URL to download QakBot and its C2 servers has been rated as &quot;<b>Malicious Websites</b>&quot; by the FortiGuard Web Filtering service.</p>
<p>The HTML file attached to the phishing email and the downloaded QakBot Loader module are detected as &quot;<b>JS/Agent.BLOB!tr</b>&quot; and &quot;<b>W32/Qbot.D!tr</b>&quot; and are blocked by the FortiGuard Antivirus service.<b></b></p>
<p>FortiEDR detects the involved file as malicious based on its behavior.</p>
<p>In addition to these protections, we suggest that organizations have their end users also go through the FREE <a href="https://training.fortinet.com/?utm_source=blog&amp;utm_campaign=nse-institute">NSE training</a>: <a href="https://training.fortinet.com/local/staticpage/view.php?page=nse_1&amp;utm_source=blog&amp;utm_campaign=nse-1">NSE 1 – Information Security Awareness</a>. It includes a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks.</p>
<h2>IOCs</h2>
<h4><span style="font-weight: normal;">URLs:</span></h4>
<p>194[.]36[.]191[.]227/%random%.dat</p>
<p style="margin-left: 40.0px;">Click <u><a href="https://www.fortinet.com/blog/threat-research/c2-server-list">here</a></u> for the complete C2 server list<b></b></p>
<h4><span style="font-weight: normal;">Sample SHA-256 Involved in the Campaign:</span></h4>
<p>[Attached HTML file]</p>
<p style="margin-left: 40.0px;">FE1043A63E6F0A6FAA762771FF0C82F253E979E6E3F4ADD1C26A7BD0C4B2E14C</p>
<p>[Loader module of QakBot]</p>
<p style="margin-left: 40.0px;">9C3D3CD9B0FCB39117692600A7296B68DDDF2995C6D302BC9D9C8B786780BA19</p>
<p>  [ScannedDocs_1586212494.lnk]</p>
<p>          F5B6619E92D7C4698733D9514DF62AFACA99883DFAC8B9EE32A07D087F2800BF</p>
<p><i>Learn more about Fortinet’s </i><a href="https://www.fortinet.com/fortiguard/labs?utm_source=blog&amp;utm_campaign=fortiguard-labs"><i>FortiGuard Labs</i></a><i> threat research and intelligence organization and the FortiGuard Security Subscriptions and Services </i><a href="https://www.fortinet.com/fortiguard/labs?tab=security-bundles&amp;utm_source=blog&amp;utm_campaign=security-bundles"><i>portfolio</i></a><i>.</i></p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><div id="om-b2dxtopzidsdt3fkzfsv-holder"></div></div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=email-phishing">email phishing</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=phishing">phishing</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=malware-analysis">malware analysis</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=html">html</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/adobe-patches-address-zero-day-vulnerabilities-discovered-by-fortiguard-labs" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/adobe-patches-new-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="New Adobe Illustrator Patches Address Multiple Zero Day Vulnerabilities Discovered by FortiGuard Labs" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">New Adobe Illustrator Patches Address Multiple Zero Day Vulnerabilities Discovered by FortiGuard Labs</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/analysis-of-follina-zero-day" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/follina-zero-day-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="CVE-2022-30190: Microsoft Support Diagnostic Tool (MSDT) RCE Vulnerability “Follina”" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">CVE-2022-30190: Microsoft Support Diagnostic Tool (MSDT) RCE Vulnerability “Follina”</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/nokoyawa-variant-catching-up" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/nokoyama-variant-peers-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="New Nokoyawa Variant Catching Up to Peers with Blatant Code Reuse" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">New Nokoyawa Variant Catching Up to Peers with Blatant Code Reuse</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  <!--data-sly-test="true - got replaced with false to disable the discussion event-->
  
</div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.twitter.com/fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2023 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script type="text/javascript" src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.js"></script>





    


    

    </body>
    </html>
