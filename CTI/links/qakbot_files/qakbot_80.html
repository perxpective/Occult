<!DOCTYPE HTML>
<html lang="en">
    <head>
    <meta charset="UTF-8"/>

    
    









    <!-- OneTrust Cookies Consent Notice Start -->






    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="6373c986-7725-4c54-9731-2a91bdd43107"></script>


<script type="text/javascript">
    function OptanonWrapper() { }
</script>

<!-- OneTrust Cookies Consent Notice End -->

















    
    <title>Kraken the Code on Prometheus</title>
    
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus"
        },
        "headline": "Kraken the Code on Prometheus",
        "image": [
            "/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-350x350-ibb.png",
            "/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-875x530-ibb.png"
        ],
        "datePublished": "2022-01-19T08:01:00.000-08:00",
        "author": {
                    "@type": "Person",
                    "name": "The BlackBerry Research & Intelligence Team"
                },

        "publisher": {
            "@type": "Organization",
            "name": "BlackBerry",
            "logo": {
                "@type": "ImageObject",
                "url": "https://blogs.blackberry.com/content/dam/blackberry-com/Images/logos/BlackBerry_Logo_Black_150.png"
            }
        }
    }
</script>

    <meta name="keywords" content="Cybersecurity"/>
    <meta name="description" content="The BlackBerry Research &amp; Intelligence Team has uncovered a cluster of nine distinct Russian threat actors who have attacked U.S. government agencies using Prometheus, a network of malicious Traffic Direction Systems."/>
    
    <link rel="icon" href="/etc.clientlibs/bbcom/clientlibs/clientlib-etc-legacy/resources/bbcom-aem-project/images/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    
    
    <link rel="canonical" href="https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus"/>
    <meta name="author" content="blogs.blackberry.com"/>
    <meta property="og:url" content="https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus"/>
    <meta property="og:title" content="Kraken the Code on Prometheus"/>
    <meta property="og:description" content="The BlackBerry Research &amp; Intelligence Team has uncovered a cluster of nine distinct Russian threat actors who have attacked U.S. government agencies using Prometheus, a network of malicious Traffic Direction Systems."/>
    <meta property="og:type" content="article"/>
    <meta property="og:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-875x530-ibb.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BlackBerry"/>
    <meta name="twitter:title" content="Kraken the Code on Prometheus"/>
    <meta name="twitter:description" content="The BlackBerry Research &amp; Intelligence Team has uncovered a cluster of nine distinct Russian threat actors who have attacked U.S. government agencies using Prometheus, a network of malicious Traffic Direction Systems."/>
    <meta name="twitter:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-875x530-ibb.png"/>

    

    
    
<link rel="stylesheet" href="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.212090aa91e144ce76b952f074e6c1ba.css" type="text/css">





    








<script>
    var digitalData = {
        page: {
            pageInfo: {
                pageTitle: "Kraken the Code on Prometheus",
                pageName: "en:2022:01:kraken-the-code-on-prometheus",
                domain:"blogs.blackberry.com",
                hierarchy:["en","2022","01","kraken-the-code-on-prometheus"],
                timeStamp:"2023-12-23 00:01:30",
                tags:"Cybersecurity",
                country:"CN"
            }
        }
    }
</script>



    <script src="//assets.adobedtm.com/cb3160b9e813/dd47d4a7a48e/launch-17c42c38011b.min.js" async></script>
    










<script>
    digitalData.blogPost = {
        authors: "The BlackBerry Research & Intelligence Team",
        categories: "Research & Intelligence"
    }
</script>








    
    
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TXGFP23');</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=AW-944900006"></script> 
<script> 
  window.dataLayer = window.dataLayer || []; 
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); gtag('config', 'AW-944900006'); 
</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXGFP23" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



    

    



<script src="https://kit.fontawesome.com/3c243f8233.js" crossorigin="anonymous"></script>

    
    
    

    
    
    
    

    
</head>
    <body class="page basicpage" data-enable-history="true">
        
        
            



            

  
<!--
<sly data-sly-use.templatedContainer="com.day.cq.wcm.foundation.TemplatedContainer"
   data-sly-repeat.child=""
   data-sly-resource=""/>
-->

<header>
    




    
    
    
<!-- BEGIN DO NOT INDEX -->

    

<!-- skip to content: START -->
<a href='#' class='skipNav' tabindex="0">Skip Navigation</a>
<!-- skip to content: END-->
<!-- BEGIN DO NOT INDEX -->

  <nav class="blogs-navigationv2 bb-blogs-navbar navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="https://blogs.blackberry.com">
        <svg width="175px" height="30px" viewBox="0 0 175 30" version="1.1">
          <title>BlackBerry Logo</title>
          <g id="Creative" stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
              <g id="21-product-page-Protect-02.15.22" transform="translate(-91.000000, -10.000000)" fill="#FFFFFF" fillRule="nonzero">
                  <g id="BB_White" transform="translate(91.000000, 10.000000)">
                      <path d="M9.18042011,2.14285967 C9.18042011,1.19318021 8.5959918,-1.17624431e-15 6.16086942,-1.17624431e-15 C5.16247216,-1.17624431e-15 2.4107723,-1.17624431e-15 2.4107723,-1.17624431e-15 L1.33931598,4.94318021 C1.33931598,4.94318021 3.36046941,4.94318021 5.25986363,4.94318021 C8.32813214,4.91883014 9.18042011,3.48214033 9.18042011,2.14285967 Z" id="Shape"></path>
                      <path d="M19.2861873,2.14285967 C19.2861873,1.19318021 18.701759,-1.17624431e-15 16.2666366,-1.17624431e-15 C15.2682393,-1.17624431e-15 12.5165395,-1.17624431e-15 12.5165395,-1.17624431e-15 L11.4450831,4.94318021 C11.4450831,4.94318021 13.4662366,4.94318021 15.3412807,4.94318021 C18.4338993,4.91883014 19.2861873,3.48214033 19.2861873,2.14285967 Z" id="Shape_1_"></path>
                      <path d="M7.84110413,9.54545936 C7.84110413,8.59578874 7.25667582,7.4025997 4.82155344,7.4025997 C3.82315617,7.4025997 1.07145632,7.4025997 1.07145632,7.4025997 L5.68518084e-15,12.3457799 C5.68518084e-15,12.3457799 2.02115343,12.3457799 3.89619757,12.3457799 C6.96445725,12.3457799 7.84110413,10.88474 7.84110413,9.54545936 Z" id="Shape_2_"></path>
                      <path d="M17.9468713,9.54545936 C17.9468713,8.59578874 17.362443,7.4025997 14.9273206,7.4025997 C13.9289233,7.4025997 11.1772235,7.4025997 11.1772235,7.4025997 L10.1057671,12.3457799 C10.1057671,12.3457799 12.1269206,12.3457799 14.0263148,12.3457799 C17.0702244,12.3457799 17.9468713,10.88474 17.9468713,9.54545936 Z" id="Shape_3_"></path>
                      <path d="M28.5153164,6.55032938 C28.5153164,5.60064992 27.930888,4.40746971 25.4957657,4.40746971 C24.4973684,4.40746971 21.7456774,4.40746971 21.7456774,4.40746971 L20.6742211,9.35064992 C20.6742211,9.35064992 22.6953745,9.35064992 24.5704186,9.35064992 C27.6386695,9.32629985 28.5153164,7.88961005 28.5153164,6.55032938 Z" id="Shape_4_"></path>
                      <path d="M27.0542412,14.2694801 C27.0542412,13.3198006 26.4698129,12.1266204 24.0346816,12.1266204 C23.0362844,12.1266204 20.2845934,12.1266204 20.2845934,12.1266204 L19.213137,17.0698006 C19.213137,17.0698006 21.2342905,17.0698006 23.1093346,17.0698006 C26.1775943,17.0698006 27.0542412,15.6087696 27.0542412,14.2694801 Z" id="Shape_5_"></path>
                      <path d="M16.4857961,17.2889601 C16.4857961,16.3392807 15.9013678,15.1461005 13.4662366,15.1461005 C12.4678393,15.1461005 9.71614827,15.1461005 9.71614827,15.1461005 L8.64469195,20.0892807 C8.64469195,20.0892807 10.6658454,20.0892807 12.5408895,20.0892807 C15.6091492,20.0649306 16.4857961,18.6282496 16.4857961,17.2889601 Z" id="Shape_6_"></path>
                      <path d="M83.7683052,18.75 C83.5978459,19.11526 82.7455491,20.7711005 80.6026453,20.7711005 C78.1188139,20.7711005 77.1447667,18.701291 77.1447667,17.191551 C77.1447667,14.6590813 78.8493515,12.3944712 81.3575329,12.3944712 C84.0605238,12.3944712 84.6936523,14.4155717 84.7667113,14.7808317 L88.7359591,14.7808317 C88.9794775,13.2954417 87.786262,8.74187154 81.5036422,8.74187154 C76.9012483,8.74187154 73.2242102,12.4188213 73.2242102,17.3133014 C73.2242102,21.331161 75.7323917,24.4236913 80.3834769,24.4236913 C86.1790775,24.4236913 87.7375619,19.8701212 87.9323713,18.7499912 L83.7683052,18.7499912 L83.7683052,18.75 Z" id="Shape_7_"></path>
                      <path d="M53.2805356,19.8457799 C53.2805356,19.6022703 53.3535858,19.1639601 53.5483953,18.2629897 C53.7432047,17.3376603 56.5435959,4.40746971 56.5435959,4.40746971 L52.8178577,4.40746971 L49.7252479,18.6769498 C49.6034887,19.2857193 49.5304385,19.87013 49.5304385,20.3814904 C49.5304385,23.4983708 51.9412108,24.4237002 53.889314,24.4237002 C54.5711514,24.4237002 55.22863,24.3019498 55.3747393,24.2775909 C55.4477895,23.961031 56.0322266,21.2824609 56.0565767,21.1607105 C55.9835265,21.1607105 55.5695487,21.2094107 55.0825295,21.2094107 C53.6945045,21.2094107 53.2805356,20.625 53.2805356,19.8457799 Z" id="Shape_8_"></path>
                      <polygon id="Shape_9_" points="106.220152 8.76623044 101.033339 8.76623044 94.3367415 14.7808405 96.6014133 4.38311963 92.8269661 4.38311963 88.5654909 24.1071403 92.3155881 24.1071403 93.3626943 19.3100606 95.6760575 17.4837696 98.8660763 24.1071403 103.054492 24.1071403 98.5251576 15.2435096"></polygon>
                      <path d="M32.7767827,18.0194801 C33.0933514,16.6071403 35.7232832,4.38311963 35.7232832,4.38311963 C35.7232832,4.38311963 40.2769681,4.38311963 42.8338497,4.38311963 C47.9963131,4.38311963 49.2625788,7.25649924 49.2625788,8.98538995 C49.2625788,12.8327903 45.6342409,13.8555199 45.1959219,13.9772703 C45.6098908,14.1233708 47.971963,15.0487002 47.971963,18.0681802 C47.971963,21.3555199 44.9524035,24.107459 40.2526181,24.107459 C40.2526181,24.107459 38.5723834,24.107459 38.1097143,24.107459 C34.1404576,24.1314904 32.0218951,21.4042201 32.7767827,18.0194801 Z M43.905306,17.7759705 C43.905306,16.8506411 43.2965277,15.681811 40.666587,15.681811 L37.2330585,15.681811 L36.2103112,20.4545406 L40.1065088,20.4545406 C42.5903401,20.4545406 43.905306,19.3100606 43.905306,17.7759705 Z M45.1715718,9.8133102 C45.1715718,8.86363075 44.4410342,8.0357105 42.6633904,8.0357105 L38.8645931,8.0357105 L38.0122963,12.0292201 L41.9815529,12.0292201 C44.0757654,12.0292201 45.1715718,10.9821403 45.1715718,9.8133102 Z" id="Shape_10_"></path>
                      <path d="M104.515568,18.0194801 C104.832136,16.6071403 107.462068,4.38311963 107.462068,4.38311963 C107.462068,4.38311963 112.015753,4.38311963 114.572626,4.38311963 C119.735089,4.38311963 121.001364,7.25649924 121.001364,8.98538995 C121.001364,12.8327903 117.373026,13.8555199 116.934707,13.9772703 C117.348667,14.1233708 119.710748,15.0487002 119.710748,18.0681802 C119.710748,21.3555199 116.666847,24.107459 111.991394,24.107459 C111.991394,24.107459 110.311159,24.107459 109.84849,24.107459 C105.879234,24.1314904 103.76068,21.4042201 104.515568,18.0194801 Z M115.644091,17.7759705 C115.644091,16.8506411 115.035304,15.681811 112.405372,15.681811 L108.947493,15.681811 L107.924737,20.4545406 L111.820935,20.4545406 C114.329125,20.4545406 115.644091,19.3100606 115.644091,17.7759705 Z M116.910348,9.8133102 C116.910348,8.86363075 116.17981,8.0357105 114.377825,8.0357105 L110.603378,8.0357105 L109.751081,12.0292201 L113.720347,12.0292201 C115.81455,12.0292201 116.910348,10.9821403 116.910348,9.8133102 Z" id="Shape_11_"></path>
                      <path d="M146.789339,8.76623044 C142.820083,8.76623044 140.092742,11.1282408 139.191745,15.5357105 C138.802126,17.4350606 137.365401,24.1071403 137.365401,24.1071403 L141.091139,24.1071403 C141.091139,24.1071403 142.454814,17.7516204 142.893133,15.75487 C143.45322,13.1493501 144.841236,12.2483796 146.69193,12.2483796 C147.300717,12.2483796 147.665986,12.3214298 147.860795,12.3457799 C147.958196,11.8100694 148.493915,9.44805023 148.615674,8.88798965 C148.226055,8.86363957 147.592918,8.76623044 146.789339,8.76623044 Z" id="Shape_12_"></path>
                      <path d="M159.451988,30 L171.968527,8.76623044 L167.950571,8.76623044 L162.20367,18.75 L160.864354,8.74188037 C160.864354,8.74188037 158.818851,8.74188037 156.554179,8.74188037 C151.610875,8.74188037 149.054002,11.0064904 148.153005,15.316551 C147.690327,17.4594107 146.253602,24.1071315 146.253602,24.1071315 L149.97934,24.1071315 C149.97934,24.1071315 151.343015,17.8003117 151.903085,15.2678508 C152.438822,12.8084314 154.265166,12.0535613 156.23761,12.4675303 L157.016848,8.83928067 C157.601285,12.2727209 159.378911,23.2792113 159.378911,23.2792113 L155.482714,30 L159.451988,30 L159.451988,30 Z" id="Shape_13_"></path>
                      <path d="M64.0437813,17.5811699 C64.871728,17.4594195 67.2581502,17.0941595 67.599069,17.0454594 C67.5260099,17.313319 67.4529597,17.7029291 67.3799095,18.0194889 C66.9415816,19.8701388 65.0665375,21.063319 62.972325,21.063319 C61.633009,21.063319 60.8537712,20.3571492 60.8537712,19.5048788 C60.8294212,18.7987002 61.4869085,17.9464298 64.0437813,17.5811699 Z M62.6314151,13.5876603 C62.7288242,13.4415598 63.6785213,11.9561699 66.0649435,11.9561699 C67.5503688,11.9561699 68.3052565,12.4918804 68.3052565,13.1493501 C68.3052565,14.0746706 66.8198312,14.3181802 64.2142406,14.6834402 C59.7579648,15.3165598 56.9332236,16.7045406 56.9332236,19.9188301 C56.9332236,22.2077903 58.8326178,24.4237002 62.193096,24.4237002 C64.9934872,24.4237002 66.4545624,22.7435096 66.5763216,22.5974003 C66.6006717,23.0113604 66.6493719,23.62013 66.6737308,24.1071403 C66.9902906,24.1071403 69.5715222,24.1071403 70.5212282,24.1071403 C70.399469,23.4496706 70.1072504,22.1590901 70.5699283,20.1136307 C70.8134379,19.0422009 71.4952754,15.9496706 71.8361941,14.24513 C72.4936815,11.0064904 70.7160376,8.74188037 66.1867116,8.74188037 C60.3424108,8.74188037 58.6621673,12.9301906 58.3943076,13.5876603 L62.6314151,13.5876603 Z" id="Shape_14_"></path>
                      <path d="M131.862019,19.5292201 C131.715918,19.8214298 130.814921,21.0876603 128.793759,21.0876603 C125.871617,21.0876603 125.214139,18.6038995 125.28718,17.9464298 C126.845665,17.9464298 135.831275,17.9464298 136.659213,17.9464298 C136.732272,17.6785702 136.975791,16.6558493 136.975791,15.6087696 C136.975791,12.00487 134.540668,8.71753912 129.621714,8.71753912 C125.11673,8.71753912 121.512742,12.4918892 121.512742,16.9967592 C121.512742,21.3311787 124.118324,24.423709 128.745059,24.423709 C134.443259,24.423709 135.977393,19.9675391 136.123494,19.5292289 C135.100738,19.5292201 131.862019,19.5292201 131.862019,19.5292201 Z M129.670406,12.1266204 C132.178587,12.1266204 133.128284,13.6607105 133.030884,14.8782408 C131.594159,14.8782408 127.308342,14.8782408 125.84725,14.8782408 C126.042068,14.0990295 127.235283,12.1266204 129.670406,12.1266204 Z" id="Shape_15_"></path>
                      <path d="M171.979978,19.5027334 C173.12535,19.5027334 174.087452,20.4108465 174.087452,21.6216668 C174.087452,22.8557689 173.10243,23.7406002 171.979978,23.7406002 C170.834615,23.7406002 169.849603,22.8324871 169.849603,21.6216668 C169.849603,20.4108465 170.834615,19.5027334 171.979978,19.5027334 Z M171.979978,19.8520043 C171.017877,19.8520043 170.26193,20.620409 170.26193,21.6216668 C170.26193,22.6462064 171.017877,23.4146111 171.979978,23.4146111 C172.942098,23.4146111 173.675125,22.6694882 173.675125,21.6216668 C173.675125,20.620409 172.919178,19.8520043 171.979978,19.8520043 Z M171.52183,22.8557689 L171.155316,22.8557689 L171.155316,20.4108465 L172.071613,20.4108465 C172.644299,20.4108465 172.919178,20.620409 172.919178,21.109397 C172.919178,21.5518126 172.644299,21.7380934 172.277768,21.7846569 L172.964991,22.8557689 L172.552655,22.8557689 L171.911246,21.7846569 L171.49891,21.7846569 L171.49891,22.8557689 L171.52183,22.8557689 Z M171.521821,21.4819585 L171.957076,21.4819585 C172.415225,21.4819585 172.552664,21.3422501 172.552664,21.0861152 C172.552664,20.8532621 172.438127,20.7135538 172.025792,20.7135538 L171.521821,20.7135538 L171.521821,21.4819585 L171.521821,21.4819585 Z" id="Shape_16_"></path>
                  </g>
              </g>
          </g>
      </svg>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/cybersecurity">Cybersecurity</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/automotive">Automotive & IOT</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/critical-event-management">Critical Communications</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/blackberry-news">Inside BlackBerry</a>
          </li>
        </ul>
  
  
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            
            <a class="nav-link open-search-btn" role="button">
              <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                </path>
              </svg>
            </a>
            <div id="searchOverlay" class="search-overlay">
              <span class="close-search-btn" title="Close Search">×</span>
              <div class="overlay-content">
                <form id="search-form">
                  <input id="search-form--input" description="Search" data-search-url="https://blogs.blackberry.com/en/search" type="text" placeholder="Search" name="search"/>
                  <button type="submit">
                    <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                      <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                      </path>
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>



<!-- END DO NOT INDEX -->



<!-- END DO NOT INDEX -->

    
    
    <div class="hero">

      <div class="jumbotron mastheadDefault">
        <div class="hero-container narrower" style="background-image: url( \2f content\2f dam\2f blackberry-com\2fImages\2fsupport\2f bgs\2f bnr-blue-gradient-crop.jpg)">
          
          <div class="mask  "></div>

          <div class="container headings  l-align">
            <div class="col-lg-12">
          		




    
    
    <div class="blog-name-title">

  <div class="cmp-title ">
  
  
   <!-- <span class="highlighted-text-title blogs">INSIDE</span>
   <span class="normal-text-title">BlackBerry Blog</span> -->
   <span class="normal-text-title">BlackBerry Blog</span>
  
  
  
</div>
</div>



          	</div>
          </div>
      </div>
    </div>
</div>



</header><main>
    




    
    
    <div class="section">
  <section class="section     ">
    
    <div class="container">
        




    
    
    
<ol class="breadcrumb">
    <li class="breadcrumb-item ">
        <a href="/en.html">BlackBerry Blog</a>
    </li>

    <li class="breadcrumb-item ">
        <a href="/en/2022/01">01</a>
    </li>

    <li class="breadcrumb-item active">
        Kraken the Code on Prometheus
    </li>
</ol>

    


      
    </div>
  </section>
    

</div>


    
    
    <div class="blogsection">
    <section class="section     ">
      
      <div class="container sectionPadding py-0">
           
      <div class="col-md-9 col-lg-9 col-sm-12">
          




    
    
    <div class="cmp cmp-title blog-title row">
  

<div class="col-md-12 col-lg-12 col-sm-12">
<h1>Kraken the Code on Prometheus</h1>
</div>



    
</div>


    
    
    <div class="categorydateauthor"><!--Pulling author bio from author page-->
<div class="categorydateauthor">
<span><a title="RESEARCH &amp; INTELLIGENCE" href="/en/category/research-and-intelligence">RESEARCH &amp; INTELLIGENCE</a> / </span><span class='publish-date'></span>01.19.22 / </span>

    <span class="author"><a href="/en/author/the-blackberry-research-and-intelligence-team">The BlackBerry Research &amp; Intelligence Team</a></span>

</div></div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus&text=Kraken%20the%20Code%20on%20Prometheus&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus&title=Kraken%20the%20Code%20on%20Prometheus&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Kraken%20the%20Code%20on%20Prometheus&body=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1963934593.coreimg{.width}.png/1674164571204/prometheus-875x530-ibb.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-875x530-ibb.png" data-asset-id="58a6b53c-b675-405c-bfe9-aae4f070eaa5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus-875x530-ibb.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <h3><b>Executive Summary</b></h3>
<ul>
<li><b>The subscription-based malware service Prometheus TDS was first discovered in August of 2021 by Group-IB, as part of an email campaign targeting U.S. government agencies, amongst others. The Crimeware-as-a-Service (CaaS) offering was posted by a cyber threat actor called “Ma1n” on various Russian hack forums, to a primarily Russian customer base.</b><br>
<br>
</li>
<li><b>This threat actor appears to lean heavily on Cobalt Strike for part of its infrastructure (for more information about Cobalt Strike please download our recent <a href="https://www.blackberry.com/us/en/forms/enterprise/ebook-beacons-in-the-dark" target="_blank">book</a> on the subject). With the data gathered from the BlackBerry Research &amp; Intelligence Team’s Cobalt Strike Team Server scanning solution, we were able to cluster a variety of different malware families they’ve used, based on Beacon configuration data.</b><br>
<br>
</li>
<li><b>Malware researcher for NVISO Labs </b><a href="https://blog.didierstevens.com/" target="_blank"><b>Didier Stevens</b></a><b> also recently found six SSL private keys bundled with cracked or leaked copies of Cobalt Strike, one of which has an extensive overlap with Prometheus-related activity. He has published </b><a href="https://blog.nviso.eu/2021/10/21/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-1/" target="_blank"><b>information and tooling</b></a><b> that makes it possible to decrypt this Beacon traffic.<br>
</b></li>
</ul>
<h3><b>Introduction</b></h3>
<p>Prometheus, a supreme trickster, stole fire for humankind by lighting a torch from the sun. What would this tale look like if it were updated, with the god of fire reimagined as a cybercriminal?</p>
<p>In our gritty reboot of this classic tale, instead of a rebel bringing the light of knowledge to humanity, the main character is the “puppetmaster” of a monstrous cephalopod that has its tentacles wending its way around a huge territory. The torch is now a Beacon (of the cracked/leaked Cobalt Strike variety). In our revamped plot line, there is hope at the bottom of Pandora’s box in the form of passionate researchers working diligently to identify and thwart these cyber-thieves.</p>
<h3><b>Prometheus: The God of Fire (and TDSes?!)</b></h3>
<p>In August of 2021, Group-IB published research on <a href="https://blog.group-ib.com/prometheus-tds" target="_blank">Prometheus TDS</a>. They shone light on two large email campaigns targeting U.S. entities in the public and private sector, as well as individuals in Belgium.</p>
<p>Prometheus at its core is a Traffic Direction System (TDS) used to facilitate Malware-as-a-Service (MaaS) operations and <a href="https://blogs.blackberry.com/en/2020/11/the-art-of-targeted-phishing-how-not-to-get-hooked" target="_blank">phishing</a> redirection on a large scale. As its name suggests, a TDS is a system designed to (re)direct users from one web location to another, based on the configuration set by its operator. The TDS helps to deliver malware binaries to targets via a complex web of phishing, maldocs and HTTP redirection. The BlackBerry Research &amp; Intelligence Team has also discovered an interesting correlation between Prometheus and the use of a leaked <a href="https://blogs.blackberry.com/en/2021/11/all-your-beacon-are-belong-to-us-new-blackberry-book-cracks-code-of-cobalt-strike-threat-actors" target="_blank">Cobalt Strike</a> SSL key pair, which we will elaborate in more detail later.</p>
<p>Prometheus can be considered a full-bodied service/platform that allows threat groups to purvey their malware or phishing operations with ease. Think of Prometheus like a freight transport infrastructure; except instead of carrying food or petrochemicals, it carries a range of cyber offensive capabilities and malware to its targets. The irony of this analogy is that services like Prometheus enable bad actors to target companies that provide actual infrastructure – such as freight transport and other critical services – in the physical world.</p>
<p>In order to accomplish its goals, the platform has many moving parts, from malicious PHP backdoors to JavaScript redirects, to malspam and Cobalt Strike infrastructure, as well as customer-facing administration web panels. Prometheus sells access to the TDS via underground forums on a subscription basis, with its prices ranging from $30 for two days to $250 for a month.</p>
<h3><b>Catching Fire: The Prometheus TDS – Traffic Direction System</b></h3>
<p>Historically, a TDS would be considered an integral part of an exploit kit’s execution chain; they would be used to redirect an unwitting user to a &quot;landing page&quot; where their computer would be fingerprinted and served with an exploit where possible. But the exploit kit (EK) landscape has been on the <a href="https://www.bleepingcomputer.com/news/security/rig-exploit-kit-usage-declines-as-browsers-are-getting-harder-to-hack/" target="_blank">decline</a> <a href="https://www.bleepingcomputer.com/news/security/rig-exploit-kit-usage-declines-as-browsers-are-getting-harder-to-hack/" target="_blank">in recent years</a> thanks to a concerted effort by law enforcement, browser hardening by developers, and declines in the use of Internet Explorer (IE) and Flash.</p>
<p>Consequently, TDSes have evolved into their own independent entities that are largely part of <a href="https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds" target="_blank">Crimeware-as-a-Service (CaaS)</a> offerings, which a threat actor offers for either rent or sale in specialized forums located on the dark web. Past examples of this are the <a href="https://malware.dontneedcoffee.com/hosted/anonymous/kotd.html" target="_blank">EITest TDS</a> that exclusively targeted IE users, <a href="https://www.proofpoint.com/us/threat-insight/post/drive-service-blacktds" target="_blank">BlackTDS</a>, which offered services for as little as $16/day, and <a href="https://www.checkpoint.com/defense/advisories/public/2017/cpai-2017-0525.html/" target="_blank">Seamless TDS</a>.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1551150000.coreimg{.width}.png/1674164571223/prometheus-fig01.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig01.png" data-asset-id="1a73a968-562a-4ae5-8e98-74cfaec3526a" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig01.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 1 - BlackTDS forum advertisement</i></p>
<p>TDS traffic is typically funneled from one of <a href="https://www.bleepingcomputer.com/news/security/tds-systems-are-the-next-big-money-makers-in-the-land-of-cybercrime/" target="_blank">two main sources</a>; malicious ads (malvertising) on legitimate websites, or on compromised legitimate websites that contain malicious code. Once a victim is caught in this web of redirects, they are at the mercy of the TDS and will be redirected to a location that serves malware, phishing scams, exploit kits or tech support scams.</p>
<p>The Prometheus TDS follows the typical TDS execution flow, but targets are funneled via a spam email that contains either an HTML file, a Google Docs page or a web shell redirector. These components each contain an embedded URL designed to redirect the user to a first stage payload, or to a website that has been compromised by the threat actor and hosts a PHP-based backdoor. The backdoor is used to glean various types of data from the victim, which gets sent back to the Prometheus TDS administrative panel. The admin panel could then choose to send instructions back to the compromised website/PHP backdoor, to serve the victim with malware, or redirect them to another page that might contain a phishing scam, etc.</p>
<h3><b>PHP Backdoor</b></h3>
<p>The Prometheus backdoor was previously an integral component in the execution chain of the Prometheus TDS and played the role of a middleman, acting as a gateway between the attacker and the unwitting victim. However, its use has been minimal since earlier this year. It is a miniscule (12-16KB) PHP script that operates as an HTTP redirector, and it is often found on compromised websites running vulnerable PHPMailer software.</p>
<p>A victim is typically redirected – after clicking a malicious link that is delivered to them through a <a href="https://blog.group-ib.com/prometheus-tds" target="_blank">spam email</a> – to a website infected with the backdoor. The backdoor’s primary purpose is to fingerprint victims, scrape various pieces of data from their machine, and then send the stolen data to the Prometheus TDS administration panel.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1283208593.coreimg{.width}.png/1674164571249/prometheus-fig02.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig02.png" data-asset-id="1e7a7299-730c-4d09-b54c-4177676fe45a" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig02.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 2 – Prometheus TDS admin panel</i></p>
<p>The admin panel can then choose to send an additional instruction to the backdoor, such as to redirect the victim to another specified URL and/or deliver a malicious first stage payload.</p>
<h3><b>Analysis</b></h3>
<p>An examination of the backdoor code reveals a configuration file containing a series of hardcoded settings for communication between the backdoor and the command-and-control (C2) server (also running the admin panel).</p>
<p>Communication between both parties is encrypted via XOR, a cipher key is contained within the configuration settings.</p>
<p>Also included is the C2 admin panel address – in this case “<b><i>hxxp://109[.]248[.]203[.]114</i></b>” – and the installation path along with a test path location.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_2015641628.coreimg{.width}.png/1674164571275/prometheus-fig03.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig03.png" data-asset-id="c9d1bb6d-9ac3-4486-9f82-1487e80902a5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig03.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 3 - Configuration settings</i></p>
<p>Additional settings include the presence of <b>(</b>“<b>allow_url_fopen”, “1</b>”<b>)</b>. This is a PHP feature that, when enabled, allows data/files to be retrieved from remote locations over&nbsp;HTTP&nbsp;or&nbsp;FTP.&nbsp;</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_2102736360.coreimg{.width}.png/1674164571301/prometheus-fig04.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig04.png" data-asset-id="1e2ca865-c587-403f-964e-7db7d007ecf3" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig04.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 4 - Setting enablement</i></p>
<p>Once a victim lands on an infected site, various pieces of information are retrieved from their browser, including their IP, geolocation, time-zone, user-agent, language, protocol used, and the location they were referred from.&nbsp;</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_463323532.coreimg{.width}.png/1674164571317/prometheus-fig05.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig05.png" data-asset-id="7234e772-630a-49b0-841f-035cd1505d8e" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig05.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 5 - User data scraping code</i></p>
<p>A request is then generated to send the newly acquired data to the attacker’s admin panel/C2 server.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_601672305.coreimg{.width}.png/1674164571340/prometheus-fig06.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig06.png" data-asset-id="70dbaace-6b91-4816-a15d-e19fb261986d" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig06.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 6 - C2 exfil</i></p>
<p>The server might then send a response containing additional instructions depending on the “<b>$modeType</b>” chosen.&nbsp;Instructions include specifying a URL to redirect the victim to, or whether to send further files/malware to them.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1717072296.coreimg{.width}.png/1674164571364/prometheus-fig07.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig07.png" data-asset-id="a74eb755-e8b0-4bf2-b0e5-fed16ac247fe" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig07.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 7 - Modetype options</i></p>
<h3><b>The Threat Actor “Ma1n” and Sales on the Dark Web</b></h3>
<p>In this gritty reimagining of the Prometheus tale, there is a threat actor directing this malicious traffic. “Main” (aka <b>Ma1n</b>) is considered to be the author behind the Prometheus TDS, amongst other illicit cyber-offerings. His focus has evolved over the years, selling various kits like PowerMTA and offering services in form of &quot;high quality redirects&quot;. This work and knowledge led him creating Prometheus TDS.</p>
<p>He has used various Russian hack forums to advertise his wares throughout 2019 and 2020, often featuring package deals to encourage customers to make larger purchases or to make setup more convenient. Ma1n even includes a way for potential buyers to contact him via the messaging platforms Jabber, Reserve or Telegram.</p>
<p>Ma1n’s favored forum avatar – a red fox – is the same fox that was featured in The Prodigy song titled “<i><a href="https://youtu.be/xB_nKpEkILs" target="_blank">Nasty</a></i>.”</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1253380535.coreimg{.width}.png/1674164571393/prometheus-fig08.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig08.png" data-asset-id="b74846ec-173b-4e4b-b71f-66170e2a10d3" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig08.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 8 – Ma1n's favored avatar: the red fox</i></p>
<p>Ma1n first registered on a hacking forum on October 15, 2018. The last activity on this site was on July 3, 2019. Ma1n posted twice and had zero reactions to any other posts, indicating that this account meant strictly business.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1587840177.coreimg{.width}.png/1674164571410/prometheus-fig09.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig09.png" data-asset-id="56350af9-a888-4944-a7c4-77d33d7f8d23" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig09.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 9 - Ma1n's activity on the forum</i></p>
<p><b>May 2019</b></p>
<p>On May 3, 2019, Ma1n wrote his first post on this forum. He was looking to purchase a “Recaptcha 2” solution via Zennoposter, sending via Callback.&nbsp;</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_2029357740.coreimg{.width}.png/1674164571425/prometheus-fig10.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig10.png" data-asset-id="a54d901d-1478-4488-9bb9-c2172ab2b8b2" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig10.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 10 - Ma1n's activity and post</i></p>
<p><b>June 2019</b></p>
<p>On June 22, 2019, Ma1n posted again. This time he advertised high-speed SMTP based on PowerMTA (Message Transfer Agent), redirects, and various sets of purchase packages such as “<i>A set of VPS + 10 additional IP addresses + 10 domains - 100+ high-speed SMTP = $180.”</i></p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1093613125.coreimg{.width}.png/1674164571441/prometheus-fig11.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig11.png" data-asset-id="92ef894a-ce69-4ff6-9359-55cd431e306f" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig11.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 11 - Ma1n's post adverting https redirects, etc.</i></p>
<p>The post is written in both Russian and English. The full English post states:</p>

    
    
</div>


    
    
    <div class="text">    
    
    <table width="100%" cellspacing="1" cellpadding="5" border="1">
<tbody><tr><td><p><b>HELLO WORLD!</b></p>
<p><b>***************************************************************************</b></p>
<p><b>Speedy and Smart Checker-Crack System Email and Email:Pass</b></p>
<p><b>***************************************************************************</b></p>
<p><b>🇺🇸</b></p>
<p><b>Business Smtp</b></p>
<p><b>✔ Inbox Business Smtp,Imap (There is access to reading letters and sending, optionally testing on inbox) - 5$ pcs.</b></p>
<p><b>✔ Inbox Smtp (Smtp tested to inbox gmail simple text letter without links) - 3$ pcs.</b></p>
<p><b>✔ Mix (All smtp checked on delivery) - 2$ pcs.</b></p>
<p><b>✔ Not checked for delivery (Smtp checked for authorization only) - 0.7$ pcs.</b></p>
<p><b>***************************************************************************</b></p>
<p><b>High-speed Smtp based on PowerMTA</b></p>
<p><b>🎓 Ideal for spamming to corporate emails(leads).</b></p>
<p><b>🎓 This method can do any spamming, with the exception of immoral content.</b></p>
<p><b>🎓 Competent configuration PowerMTA give a good deliverability.</b></p>
<p><b>🎓 High speed mailing and large volumes.</b></p>
<p><b>🎓 SPF, DMARC, DKIM, PTR</b></p>
<p><b>Sets:</b></p>
<p><b>A set of VPS + 10 additional IP addresses + 10 domains - 100+ high-speed SMTP = $180</b></p>
<p><b>- The optimal number of sent letters is 200.000 - 400.000 (it is possible and more, but the deliverability drops)</b></p>
<p><b>A set of VPS + 20 additional IP addresses + 20 domains - 200+ high-speed SMTP = $260</b></p>
<p><b>- The optimal number of sent letters is 400.000 - 600.000 (it is possible and more, but the deliverability drops)</b></p>
<p><b>A set of VPS + 30 additional IP addresses + 30 domains - 300+ high-speed SMTP = $310</b></p>
<p><b>- The optimal number of sent letters is 600.000 - 800.000 (it is possible and more, but the deliverability drops)</b></p>
<p><b> </b></p>
<p><b>It is possible to order more IP and domains, specify the prices!</b></p>
<p><b>***************************************************************************</b></p>
<p><b>Redirects</b></p>
<p><b>✔ Redirects on domains (.club .live .world) and abuse-resistant vps, 10 domains - $140</b></p>
<p><b>✔ Redirects on HTTP, HTTPS trust domains (Geo, click statistics, combination with Blacktds, KeitaroTDS) - $5 - $10 per trusted domain.</b></p>
<p><b>***************************************************************************</b></p>
<p><b>Spam 100k - $200</b></p>
<p><b>✔ Spamming with maximum inbox via PowerMTA</b></p>
<p><b>(Used for mailing to corporate mailboxes)</b></p>
<p><b>***************************************************************************</b></p>
<p><b>Creating letters 50 - 150 $</b></p>
<p><b>✔ Creation, Translation, Randomization, text, html</b></p>
<p><b>✔ There are ready-made options for various topics.</b></p>
<p><b>***************************************************************************</b></p>
<p><b>Contacts:</b></p>
<p><b>Jabber: ma1n[at]thesecure[.]biz</b></p>
<p><b>Reserve: ma1n[at]exploit[.]im</b></p>
<p><b>Telegram: [at]Ma1n_exp</b></p>
<p><b> </b></p>
<p><b>* In case of force majeure, there may be delays in the issuance and manufacture of servers for the duration of the situation, but no later than one working week.</b></p>
<p><b>* On the PowerMTA tariffs, when receiving complaints from the main blacklists, the server will be blocked.</b></p>
<p><b>* Due to the limited number of hosting companies providing additional IP addresses, sometimes it takes more time to remove IP addresses from different blacklists, so the presence of blacklists in small quantities is allowed.</b></p>
<p><b>* When purchasing a product or ordering services, the price is fixed by the currency in which you are calculating.</b></p>
<p><i>Note: Post ends</i><br />
</p>
</td>
</tr></tbody></table>

    
    
</div>


    
    
    <div class="text">    
    
    <p><b><br>
 August 2019</b></p>
<p>On Aug. 16, 2019, Ma1n posted on another Russian forum specifying that he offers “<i>high quality redirects</i>” with many settings available for delivering spam and traffic. Ma1n also mentions other wares, such as PowerMTA. For any prospective buyers interested in buying in bulk, discounts would be offered.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_104702649.coreimg{.width}.png/1674164571479/prometheus-fig12.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig12.png" data-asset-id="d14b72c4-eea1-44ab-9aa8-47fc781519ff" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig12.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 12 – Ma1n's post on another Russian forum</i></p>
<p><b>April 2020</b></p>
<p>On April 12, 2020, Ma1n posted in the Certi Vendors Telegram thread. Here, he advertised that PowerMTA kits for mailing to corporate mailboxes, corporate SMTP, SMTP mailer, and ready-made templates were now available.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1620981328.coreimg{.width}.png/1674164571495/prometheus-fig13.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig13.png" data-asset-id="b3120fc8-6840-479c-8b20-29365decd760" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig13.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 13 - Ma1n’s post on Certi Vendors</i></p>
<p><b>September 2020</b></p>
<p>On September 22, 2020, Ma1n registered an account and advertised Prometheus on one of the most popular Russian hacking forums. However, his last activity on the forum was on October 30, 2020.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1874288406.coreimg{.width}.png/1674164571510/prometheus-fig14.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig14.png" data-asset-id="dc8ea814-9d92-4cc7-89cc-c7a0a14a2348" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig14.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 14 - Ma1n's activity on Russian hacking forum</i></p>
<p>Ma1n only published one post on this forum, which can be seen in the image below.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1882829942.coreimg{.width}.png/1674164571525/prometheus-fig15.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig15.png" data-asset-id="f4aa1fd4-c29e-47b4-8515-e3cb93478bf5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig15.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 15 - Prometheus post by Ma1n in Russian</i></p>
<p>In this post, Ma1n stated that he has “<i>great news to anyone who is working with traffic using links and redirects</i>” in the form of an antibot redirect system called Prometheus. The post lists Prometheus’s capabilities, such as web shell validation, creation and functionality check of redirects, traffic distribution system, and more. The price of Prometheus starts at $30 per two-day usage period and then goes up to $250 for a month’s usage.</p>
<p>The full translated version of this post can be seen below.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1853455971.coreimg{.width}.png/1674164571544/prometheus-fig16.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig16.png" data-asset-id="3c81031b-777f-4daa-a6c2-e0fce2a4f73c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig16.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 16 - English translation of Prometheus advertisement</i></p>
<p>At the end of the post, Ma1n included his contact information for Jabber, Reserve and Telegram accounts:</p>
<ul>
<li>Jabber: ma1n[at]exploit[.]im</li>
<li>Reserve: ma1n[at]thesecure[.]biz</li>
<li>Telegram: [at]Ma1n_exp</li>
</ul>
<h3><b>Stealing Fire</b></h3>
<p>While Prometheus employs several bespoke offensive solutions to bring their wares to the masses, they also appear to lean heavily on the adversary simulation and threat emulation software known as Cobalt Strike Beacon. With the data gathered from our Cobalt Strike Team Server scanning solution (as detailed extensively in our book “<i><a href="http://blackberry.com/beacon" target="_blank">Finding Beacons in the Dark: A Guide to Cyber Threat Intelligence</a>”</i>), we began to cluster based on specific Beacon configuration data. We then visualized this into what we call “constellations.” &nbsp;</p>
<p>When we looked at the visualized representation of the SSL public keys, we saw one specific constellation that dwarfed every other, comprising over 16% of our dataset at one point in time.</p>
<p>The MD5 hash of this public key is e9ae865f5ce035176457188409f6020a.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_1617719083.coreimg{.width}.png/1674164571568/prometheus-fig17.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig17.png" data-asset-id="20065f2d-afa0-452c-9f7c-545bca88bcc9" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig17.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 17 – Over 4000 IPs clustered with the SSL public key</i></p>
<p>Such a large cluster couldn’t help but draw the eye; we wondered what could be responsible for such a large representation in our dataset. Was it one singular threat actor with a huge array of infrastructure? Doubtful. Was each Beacon being distributed by a botnet? Maybe. Was it a cracked copy being distributed on the dark web? Now we’re on to something.</p>
<p><a href="https://www.sans.org/profiles/didier-stevens/" target="_blank">Didier Stevens</a> (of the InfoSec hall-of-fame), recently published that he found six SSL private keys in the wild that were used as part of malicious Cobalt Strike installations. One private key in particular was the respective counterpart to our e9ae865f5ce035176457188409f6020a<b> </b>public key: it was bundled within a cracked version of Cobalt Strike 4.2. When investigating known intrusions between Team Servers and Beacons relating to this SSL key, we noticed extensive overlap with Prometheus-related activity.</p>
<p>This cracked version (and the SSL key) appears to be so heavily relied upon by Prometheus affiliates that we speculate that this same illegitimate copy of Cobalt Strike could perhaps be proliferated by the Prometheus operators themselves. We also found that by using clustering mechanisms such as the PROC_INJ_STUB value (which tracks the Cobalt Strike Team Server JAR) we can infer that the SSL key was migrated between version 4.2 to 4.4. This suggests that an entity had a desire to maintain access to Beacons across multiple versions.</p>
<p>While we cannot say for certain, it’s possible that someone connected with the Prometheus TDS is maintaining this cracked copy and providing it upon purchase. It is also possible that this cracked installation may be provided as part of a standard playbook or a virtual machine (VM) installation.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_482928243.coreimg{.width}.png/1674164571593/prometheus-fig18.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig18.png" data-asset-id="4c0d2de8-20b9-44d4-b479-466311cd34d8" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig18.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 18 – Breakdown of Cobalt Strike versions using the leaked SSL public key</i></p>
<p>In subsequent blog posts regarding the SSL private keys, Stevens showed how you can <a href="https://blog.didierstevens.com/2021/10/21/public-private-cobalt-strike-keys/" target="_blank">decrypt the network traffic</a> between the Beacon and its respective Team Server if one of these keys is in use. Any Cobalt Strike beacon found to be using any of the corresponding public keys – in this case the Prometheus TDS – can have its network traffic decrypted. This can help quite significantly in understanding the extent of a related breach, and to enable further investigation into those responsible.</p>
<p>While we can’t directly tie this cracked version of Cobalt Strike to the Prometheus TDS, we can however show the number of threat actors who have been observed using this specific copy over the last two years. The number of groups that have used this installation who are believed to be of Russian origin is particularly noteworthy.</p>
<p>The diagram in Figure 20 below displays a timeline of the various families and types of malwares that have been seen in conjunction with Cobalt Strike using this SSL key pair, from early 2020 to present.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_2145574255.coreimg{.width}.png/1674164571618/prometheus-fig19.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig19.png" data-asset-id="4e6d2378-1756-44c6-a63c-7e2ff1b6fea2" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig19.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 19 - Malware observed using the cracked Cobalt Strike SSL key pair</i></p>
<p>In one of our previous publications, we saw the same SSL key being used by Zebra2104, an initial access broker whose services were used by groups such as Strong Pity, MountLocker and Phobos. For more on this, see our <a href="https://blogs.blackberry.com/en/2021/11/zebra2104" target="_blank">recent blog on the group.</a></p>
<h3><b>Pandora’s Box</b></h3>
<p>While the previous figure shows the different malware associated with the leaked SSL public key, it does not imply that all of these threats have any direct association with Prometheus.</p>
<p>However, after careful research into overlaps between the leaked key and malware deployed via Prometheus TDS, we have concluded that the following campaigns are likely to have recently utilized Cobalt Strike <b>AND</b> Prometheus.</p>
<h3><b>DarkCrystal RAT</b></h3>
<p>DarkCrystal RAT (or DCRAT for short) is a lightweight commercial Russian Remote Access Trojan (RAT) that was first seen in in the wild in 2018. It is one of the cheaper commercial malwares of its kind available on the Russian market, with recent prices ranging from <a href="https://www.xe.com/currencyconverter/convert/?Amount=500&amp;From=RUB&amp;To=EUR" target="_blank">500 Rub</a> ($6/€6) for two months to <a href="https://www.xe.com/currencyconverter/convert/?Amount=4200&amp;From=RUB&amp;To=EUR" target="_blank">4200 Rub</a> ($57/€50) for a lifetime license.</p>
<p>This RAT employs a client-server architecture, with the client written in C# and the server written in JPHP. DCRAT is regularly updated with new features and plugins. Someone using the handle [at]DarkCrystalRAT maintains a news page on Telegram that provides regular updates as to the continuous development of the RAT.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_2016157031.coreimg{.width}.png/1674164571642/prometheus-fig20.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig20.png" data-asset-id="b61745d1-0f96-44cc-bded-a6a568d5c6ce" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig20.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 20 - DarkCrystal RAT news channel</i></p>
<p>Once installed on a victim machine, DCRAT provides an attacker with a wide array of functionality, including keylogging, webcam and microphone manipulation, plus file and folder manipulation. It also provides a large list of plugins that add further feature enhancements, such as browser password scraping, anti-VM capabilities, crypto-stealing, notifications sent to the threat actor via Telegram, and privilege escalation.</p>
<h3><b>FickerStealer</b></h3>
<p><a href="https://blogs.blackberry.com/en/2021/08/threat-thursday-ficker-infostealer-malware" target="_blank">FickerStealer</a> is an advanced <a href="https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages" target="_blank">Rust</a>-based information-stealing malware. It was first advertised for sale and <a href="https://www.cyberark.com/resources/threat-research-blog/fickerstealer-a-new-rust-player-in-the-market" target="_blank">marketed</a> as a MaaS on underground forums in August of 2020, by its namesake author.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_622752915.coreimg{.width}.png/1674164571666/prometheus-fig21.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig21.png" data-asset-id="e1830f8c-5120-4e83-afce-8f888090437c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig21.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 21 - FickerStealer author alias<br>
&nbsp;</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_425205217.coreimg{.width}.png/1674164571692/prometheus-fig22.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig22.png" data-asset-id="c7a9ee9d-10df-4877-8c4d-79df87c83cb6" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig22.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 22 - FickerStealer Russian forum advertisement</i></p>
<p>Prices for FickerStealer service ranges from $90 to $900 USD, depending on the subscription length.</p>
<p>Upon subscribing to the service, the would-be attacker is provided with the necessary components to set up and configure the malware for their specific malicious goals.</p>
<p>FickerStealer has an added degree of <a href="https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages" target="_blank">difficulty</a> when being analyzed, due to its being written in the obscure programming language <a href="https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages" target="_blank">Rust</a>. That obstacle is further compounded by being heavily <a href="https://www.cyberark.com/resources/threat-research-blog/fickerstealer-a-new-rust-player-in-the-market" target="_blank">obfuscated</a>.</p>
<p>FickerStealer is designed to pilfer a variety of sensitive data from a victim’s machine, which is then encrypted and <a href="https://www.cyberark.com/resources/threat-research-blog/fickerstealer-a-new-rust-player-in-the-market" target="_blank">exfiltrated</a> to the attacker’s C2. This includes information such as credit card data, and user login credentials, as well as browser and cryptocurrency wallet information. It gathers this information by targeting a host of commonly used applications such as Chrome, FireFox, WinSCP, FileZilla and Discord. FickerStealer can also manipulate files and folders on the compromised machine, and it can download additional files or malware if instructed to do so by an attacker.</p>
<h3><b>Cerber</b></h3>
<p><a href="https://blogs.blackberry.com/en/2016/09/cylanceprotect-vs-cerber-ransomware" target="_blank">Cerber</a> ransomware first appeared on the threat landscape in 2016, being offered for sale in Russian forums using a Ransomware-as-a-Service (RaaS) model. It was initially distributed via exploit kit or spam emails and weaponized document attachments.</p>
<p>An attacker can fully customize the threat via an embedded configuration file.</p>
<p>Upon execution, Cerber first geolocates the infected machine in order to compare the location with a list of exempted countries. This list is mostly comprised of eastern European and ex-Soviet states.</p>
<p>This threat then creates a copy of itself in <i>%Appdata%.</i> After this, it creates persistence via the Registry, deletes shadow copies, and begins the encryption process employing RSA encryption. Upon completion of encryption, a ransom note is dropped to all affected folders, and the machine’s wallpaper is set to relay the same information contained in the ransom note. Initial variants of Cerber appended a &quot;<b>.cerber</b>&quot; file extension to encrypted files.</p>
<p>At its peak in the year after it had launched, Cerber was <a href="https://www.microsoft.com/security/blog/2017/01/30/averting-ransomware-epidemics-in-corporate-networks-with-windows-defender-atp/" target="_blank">responsible for 26%</a> of all ransomware infections during the holiday season of 2016. It was still active in Fall 2021, accounting for 5% of ransomware infections, gaining it sixth place in a Top 10 list of most prevalent ransomware families according to <a href="https://businessinsights.bitdefender.com/bitdefender-threat-debrief-november-2021" target="_blank">Bitdefender</a>.</p>
<h3><b>Sodin/REvil</b></h3>
<p><a href="https://blogs.blackberry.com/en/2021/05/threat-thursday-dr-revil-ransomware-strikes-again-employs-double-extortion-tactics" target="_blank">REvil</a> (also known as <a href="https://blogs.blackberry.com/en/2019/07/threat-spotlight-sodinokibi-ransomware" target="_blank">Sodinokibi</a> or Sodin) is a prolific RaaS group that first emerged on the threat landscape in the aftermath of <a href="https://blogs.blackberry.com/en/2018/03/cylance-vs-gandcrab-ransomware" target="_blank">Gandcrab</a> ransomware group ceasing operations. It is considered to be a successor of Gandcrab, or at least developed by the same authors, due to similarities in their code.</p>
<p>REvil uses the exploitation of vulnerabilities and spam emails as an infection vector. Once executed on a machine, it will attempt to escalate privileges via the exploitation of <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-8453" target="_blank">CVE-2018-8453</a>. It will also kill a list of blacklisted processes, wipe the contents of a list of blacklisted folders (if it’s configured to do so), and delete shadow copies. It begins file encryption with exceptions only granted to those files and folders specified on its configurations whitelist, with a set list of countries – mostly made up of eastern European and ex-Soviet states – being exempted. Encryption is performed using the Salsa20 stream cipher. Post encryption, a ransom note is dropped to all affected directories on the host.</p>
<p>REvil has also been known to employ double extortion tactics, where the attacker threatens to publish the victim’s data on a leak site located in the dark web, should they not pay the ransom before a set deadline.</p>
<h3><b>Ryuk/Wizard Spider</b></h3>
<p>Wizard Spider is a Russian based cyber threat group that has been in operation since at least 2014. They are best known for being the operators behind the <a href="https://blogs.blackberry.com/en/2019/09/blackberry-cylance-vs-trickbot-infostealer-malware" target="_blank">Trickbot</a> malware family.</p>
<p>In the latter half of 2018, they began deploying Ryuk ransomware. In a lot of instances, they used Trickbot to <a href="https://www.trendmicro.com/en_ie/what-is/ransomware/ryuk-ransomware.html" target="_blank">install Ryuk</a> on compromised systems.</p>
<p>Ryuk is itself a variant and evolution of the <a href="https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/" target="_blank">Hermes</a> ransomware, and it was primarily used to target larger, enterprise-sized corporations to extort larger ransoms. This practice is colloquially known as &quot;big game hunting.&quot;</p>
<p>Upon detonation, Ryuk first tries to kill a comprehensive list of processes and 150-plus services to make the next stage of its infection run as smoothly as possible. File encryption is performed using the RSA-4096 cipher, and a ransom note is dropped to each affected directory.</p>
<p>Ryuk contains the ability to encrypt files remotely, and it can also perform Wake-on-LAN (WoL) functionality. This feature enables attackers to wake up networked devices that are offline, so that they can be targeted for encryption.</p>
<h3><b>BlackMatter</b></h3>
<p><a href="https://blogs.blackberry.com/en/2021/09/threat-thursday-blackmatter-ransomware-as-a-service" target="_blank">BlackMatter ransomware</a> was first spotted in the wild in July 2021. It is being offered as a RaaS on dark web forums. There has been some speculation that BlackMatter was a successor to <a href="https://blogs.blackberry.com/en/2021/05/threat-thursday-delving-into-the-darkside" target="_blank">DarkSide</a> ransomware. However, in an <a href="https://therecord.media/an-interview-with-blackmatter-a-new-ransomware-group-thats-learning-from-the-mistakes-of-darkside-and-revil/" target="_blank">interview with one of the representatives</a> from the ransomware group, the representative said that while they have previously worked together with some of the members from DarkSide, they are no longer doing so.</p>
<p>In May 2021, BlackMatter was looking for initial access brokers (IABs) to provide initial access. BlackMatter was very specific about what kind of targets the threat group was looking for: the target had to be a large, English-speaking company with annual revenue of $100-plus million.</p>
<p>BlackMatter also had an <a href="https://blogs.blackberry.com/en/2021/09/threat-thursday-blackmatter-ransomware-as-a-service" target="_blank">exemption list</a> defining which types of industries and organization it had excluded from attack. These included hospitals, critical infrastructure facilities (such as nuclear power plants, power plants, and water treatment plants), companies in the oil and gas industries, and those in the defense, non-profit and government sectors.</p>
<p>However, on Nov. 1, 2021, <a href="https://twitter.com/vxunderground/status/1455750066560544769" target="_blank">BlackMatter posted</a> on their page (which is currently offline) that they have decided to close their operations due to pressure from the authorities. They stated that each affected organization would receive a decryption tool.</p>
<p>During their time of operation, BlackMatter targeted both Linux® and Windows® operating systems.</p>
<p>File encryption was achieved using Salsa20 and RSA-1024 encryption algorithms. Only the first megabyte of the file was encrypted, to speed up the encryption process on the victim's machine.</p>
<h3><b><a title="Qakbot" href="https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/qakbot">Qakbot</a></b></h3>
<p>Qakbot is a mature malware family that dates back as far as 2007. Constant development and support for the malware has seen it stand the test of time, and it is still one of the most prominent botnets today. Qakbot has several affiliates who disseminate the malware via a combination of malspam and malicious Microsoft® Office documents, not to mention via the Prometheus TDS.</p>
<p>During its lengthy tenure, Qakbot has become quite a formidable foe. It includes a large amount of anti-VM and anti-sandbox functionality on both the client and server-side. This is done to hinder analysis efforts by researchers. Thus, Qakbot has been able to stay competitive with security solutions by combining its anti-analysis functionality with a high degree of modularity in the form of credential harvesting modules, worm modules, and webhooks, among others.</p>
<p>If that wasn’t bad enough, Qakbot has been known to drop other malware binaries on victim machines. These include several ransomware families used primarily for financial gain, as well as binaries from other infamous botnets to help to increase their victim-base.</p>
<h3><b>And More!</b></h3>
<p>As highlighted in the aforementioned Group-IB report, other threat groups including <a href="https://blogs.blackberry.com/en/2017/03/threat-spotlight-dissecting-the-man1-groups-macro" target="_blank">MAN1</a>, <a href="https://blogs.blackberry.com/en/2021/04/blackberry-eliminates-carbanak-and-fin7-in-mitre-engenuity-attack-evaluations" target="_blank">FIN7</a> and <a href="https://blogs.blackberry.com/en/2020/02/blackberry-cylance-vs-icedid-banking-trojan" target="_blank">IcedID</a> have also been distributed by Prometheus. We further explore the correlations between these groups in our recent book, “<a href="https://www.blackberry.com/us/en/forms/enterprise/ebook-beacons-in-the-dark" target="_blank"><i>Finding Beacons in the Dark: A Guide to Cyber Threat Intelligence</i></a><i>.”</i></p>
<h3><b>Insights</b></h3>
<p>Searching across our customers' data for signs of Prometheus/Cobalt Strike-related activity reveals some interesting trends. The list of inbound TCP ports shows evidence of port scanning, with threat actors performing reconnaissance of Internet-facing infrastructure. In all likelihood, they are doing so in search of one of the greatest Achilles’ heels for organizations - remotely exploitable services.</p>
<p>The top inbound port, 3389, highlights threat actors’ propensity to leverage remote desktop protocol (RDP) with credentials after establishing a foothold. Several Prometheus-related Team Servers were found to be operating as RDP jump stations.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_505279040.coreimg{.width}.png/1674164571718/prometheus-fig23.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig23.png" data-asset-id="1d78620e-5da9-4487-9043-cba534c09dee" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig23.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 23 – Top inbound TCP ports</i></p>
<p>Outbound TCP connections are largely as expected: Beacon traffic on standard web ports. One slight anomaly is outbound traffic on ports 80 and 443 from various Apache Tomcat servers to a couple of related IPs:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_252109213.coreimg{.width}.png/1674164571742/prometheus-fig24.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig24.png" data-asset-id="dc1cdd21-0794-4ebb-950f-f9269865c49c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig24.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 24 – Outbound traffic</i></p>
<p>Unfortunately, we were unable to recover process dumps from these systems, so we can only speculate as to whether this activity is indicative of a Tomcat vulnerability being leveraged to load Beacon payloads, or the operation of a web shell.</p>
<p>Finally, across all campaigns using the leaked build of Team Server, there seems to be a tendency to target organizations within the public sector:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image_146781495.coreimg{.width}.png/1674164571767/prometheus-fig25.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig25.png" data-asset-id="2c4ed9b8-c809-49cf-a146-f5bed6a3dac3" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2022/01/prometheus_fig25.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 25 – Targeted verticals</i></p>
<h3><b>Stuck in the Middle With You</b></h3>
<p>In an interesting twist of fate, as we were preparing this blog, Didier Stevens of NVISO Labs released a multi-part blog series where he talks about decrypting Cobalt Strike traffic using known private keys. For us, there was a big revelation when we realized that Stevens had found the corresponding private key to the public key we had been using to cluster “Prometheus”-related threat groups and malspam campaigns.</p>
<p>For analysts and investigators, this means that for all the threat groups listed in this blog (as well as many more, as this is the most prominent public/private key pair, after all), it is now possible to decrypt the Beacon C2 traffic by using Stevens' processes and tooling. We encourage any incident responders dealing with recent <a href="https://blogs.blackberry.com/en/2021/05/threat-thursday-conti-ransoms-over-400-organizations-worldwide" target="_blank">Conti</a>/Ryuk/BlackMatter/<a href="https://blogs.blackberry.com/en/2016/09/cylanceprotect-vs-cerber-ransomware" target="_blank">Cerber</a> incidents who are in possession of Cobalt Strike PCAPs to give it a try.</p>
<p>What is more, Stevens also released <a href="https://github.com/DidierStevens/AdHoc/blob/master/cs-mitm.py" target="_blank">a subsequent tool</a> enabling the user to man-in-the-middle (MITM) live Beacon communications that use one of the known private keys, including injecting your own commands.</p>
<p>There’s hope at the bottom of the box!</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2022/01/kraken-the-code-on-prometheus/_jcr_content/main/par/sectionblog/par/image.coreimg{.width}.jpeg/1674164571790/cobalt-strike-beacon-1200px-banner.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/10/cobalt-strike-beacon-1200px-banner.jpg" data-asset-id="2dbf649e-e931-4f8a-9ae8-c265a164265b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/10/cobalt-strike-beacon-1200px-banner.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="authorblog"><!--Pulling author bio from author page-->

    
    
        
  



<div class="author-info" data-author-name="The BlackBerry Research &amp; Intelligence Team" data-author-path="https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus">
  <div class="author-avatar">
    
    <img src="/content/dam/blogs-blackberry-com/images/authors/blackberry-logo-square.jpg" class="author-avatar" alt="The BlackBerry Research &amp; Intelligence Team"/>				
    
  </div><!-- .author-avatar -->
  <div class="author-description">
      
    
    <h2>About The BlackBerry Research &amp; Intelligence Team</h2>
    <p>The BlackBerry Research &amp; Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of defenders and the organizations they serve.</p>

  </div><!-- .author-description	-->
</div>
<hr class="author-hr"/>
    
</div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus&text=Kraken%20the%20Code%20on%20Prometheus&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus&title=Kraken%20the%20Code%20on%20Prometheus&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Kraken%20the%20Code%20on%20Prometheus&body=https://blogs.blackberry.com/en/2022/01/kraken-the-code-on-prometheus" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="backbutton">
<a href="javascript:history.back()" class="cta cta-primary btn-back-button">Back</a></div>



      </div>
      
          
      </div>
    </section>
      
  
  
</div>



</main>

<!-- BEGIN DO NOT INDEX -->
<footer>
    <div class="container pt-2">
    <nav id='footerNav'>
        <div>
            <div class="row my-4">
                <div class='socialLinks col-lg-4 col-md-4 col-sm-12 pb-3'>
                    <a href='https://www.facebook.com/BlackBerry/' class='socialLink px-3 pl-0' target="_blank" rel="noopener" style="padding-left:0 !important;">
                      <span class='sr-only' aria-label="BlackBerry Facebook Account">Facebook</span>
                      <span class='svgIcon-social fb' aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"/>
                        </svg>
                      </span>
                    </a>
                    <a href='https://twitter.com/blackberry' target="_blank" class='socialLink px-3 ' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Twitter Account">Twitter</span>
                      <span class='svgIcon-social tw'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                      </span>
                    </a>
                    <a href='https://www.youtube.com/user/BlackBerry' target="_blank" class='socialLink px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry YouTube Account">YouTube</span>
                      <span class='svgIcon-social yt'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
                      </span>                      
                    </a>
                    <a href='https://www.instagram.com/blackberry/' target="_blank" class='socialLink youTube px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Instagram Account">Instagram</span>
                      <span class='svgIcon-social ig'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
                      </span>                        
                    </a>
                                 
                  </div>
                
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                </div>-->
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/support" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/support/overview" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                </div>-->
            </div>
            <hr/>
            <div class='row mt-5'>
               <!--/% <div class='col-xs-12 col-md-3'>
                   
                    <sly data-sly-list.col1="">
                        
                          <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse1" aria-expanded="false" aria-controls="collapse1">
                          	<h3>
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span> 
                            </h3>
                          </a>
                          
                        <sly data-sly-list.children="">
                        	<div class="collapse in" id="collapse1">
                            <ul data-sly-list.leveltwo="">
                                <li>
                                    <sly data-sly-use.navLink="Footer">
                                        <sly data-sly-test="">
                                            <a href="" data-sly-attribute.target=""></a>
                                        </sly>
                                        <sly data-sly-test="true">
                                            <a href="" data-sly-attribute.target="" rel="noopener"></a>
                                        </sly>
                                    </sly>
                                </li>
                            </ul>
                            </div>
                        </sly>
                    </sly>
                </div>
%/-->
                <div class='col-xs-12 col-md-4'>
                    <!--Col-2-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse21" aria-expanded="false" aria-controls="collapse21">
                        	<h3>Corporate
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse21">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company" rel="noopener" target="_blank">Company</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/newsroom" target="_blank">Newsroom</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/investors" target="_blank">Investors</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/careers" rel="noopener" target="_blank">Careers</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/leadership" target="_blank">Leadership</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/corporate-responsibility-at-blackberry" target="_blank">Corporate Responsibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/certifications" rel="noopener" target="_blank">Certifications</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/success-stories" rel="noopener" target="_blank">Customer Success</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-3-->
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse31" aria-expanded="false" aria-controls="collapse31">
                        	<h3>Developers
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse31">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://developers.blackberry.com/" rel="noopener" target="_blank">Enterprise Platform &amp; Apps</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.qnx.com/account/login.html?returnaddress=%2Fdownload%2Fgroup.html%3Fprogramid%3D29178" rel="noopener" target="_blank">BlackBerry QNX Developer Network</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse32" aria-expanded="false" aria-controls="collapse32">
                        	<h3>Blogs
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse32">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://blogs.blackberry.com/" rel="noopener">BlackBerry ThreatVector Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://devblog.blackberry.com/" rel="noopener" target="_blank">Developers Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://helpblog.blackberry.com/" rel="noopener" target="_blank">Help Blog</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-4-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse41" aria-expanded="false" aria-controls="collapse41">
                        	<h3>Legal
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse41">
                            <ul>
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal" target="_blank">Overview</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/accessibility" target="_blank">Accessibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/blackberry-virtual-patent-marking" target="_blank">Patents</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/trademarks" target="_blank">Trademarks</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/privacy-policy" target="_blank">Privacy Policy</a>
                                        
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
            </div>
            </div>
        </div>
        <div class='container'>
            <div class='row tm10' style="padding-top: 50px">
                <div class='col-xs-12 col-md-6 copyright' copyright>
                    <p>
                        © 2023 BlackBerry Limited. All rights reserved.
                    </p>
                </div>
              
                
            </div>
        </div>

    </nav>
    </div>
</footer>
<!-- END DO NOT INDEX -->
            
    
    
    
    
<script src="/etc.clientlibs/shared/clientlibs/jquery.min.c4de22c2db1dbe5fe0380215f514281f.js"></script>
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-dependencies.min.d41d8cd98f00b204e9800998ecf8427e.js"></script>





    
    
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.8f8340887c35307d1a6f8cc1e121c30b.js"></script>




    

    

    
    
    

            

            
            <script type="text/plain" class="optanon-category-C0002">

  (function () {

    var getParameterByName = function (name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    var getParentAnchor = function (element) {

      while (element !== null && !(element instanceof HTMLDocument)) {
        if (element.tagName.toUpperCase() === "A") {
          return element;
        }
        element = element.parentNode;
      }
      return null;
    };

    if (document.title === '404') {
        _satellite.track("error",
        { "errorType": "404", "pageURL": document.location.href }
      );
    }

    document.addEventListener('click', function (event) {
      var downloadFiles = [".pdf", ".exe", ".zip",".gzip",".gz",".tar",".jar",".bin",".dmg",".tgz",".mp4"];
      var videoSourceFound = "";
      var elem = getParentAnchor(event.target);
      var audioPlayerButton;
      var audioPlayerButtonChild;
      if (elem !== null) {
        var urlSplit = elem.href.split("/");
        if (elem.matches("a.twitter-share") || elem.matches("a.facebook-share") || elem.matches("a.linkedin-share") || elem.matches("a.email-share")) {
            _satellite.track("social_share",
              { "socialName": elem.className.split('-')[0] }
            );
        }
        else if (elem.hasAttribute("data-lity")) {
          var videoSources = { scene7: "s7d2.scene7.com", youtube: ["youtu.be", "youtube.com"], vimeo: "vimeo.com" };
          for (var key in videoSources) {
            if (videoSources.hasOwnProperty(key)) {
              if (Array.isArray(videoSources[key])) {
                videoSources[key].forEach(function (domain, i) {
                  if (elem.href.indexOf(domain) > -1) {
                    videoSourceFound = key;
                  }
                });

              } else {
                if (elem.href.indexOf(videoSources[key]) > -1) {
                  videoSourceFound = key;
                }
              }
            }
          }
          if (videoSourceFound !== "") {
            var linkHref = videoSourceFound === "scene7" ? getParameterByName("asset",elem.href): elem.href;
              _satellite.track("video", {
                "linkHref": linkHref,
                "videoPlatform": videoSourceFound,
                "linkText": elem.text.trim()
              });
          }

        }
        else if (elem.text.toLowerCase().indexOf("subscribe") > -1 || elem.text.toLowerCase().indexOf("register for updates") > -1) {
            _satellite.track("subscribe",
              { "linkText": elem.text.trim() }
            );
        }
        else if (elem.text.toLowerCase().indexOf("contact us") > -1 || elem.text.toLowerCase().indexOf("contact sales") > -1) {
            _satellite.track("contact_us",
              { "linkText": elem.text.trim() }
            );
        }
        else if (!(elem.host.indexOf(window.location.host) > -1) && elem.href !== "" && videoSourceFound == "") {
            _satellite.track("site_exit", {
              "site": elem.hostname
            });
        }

        for (var i = 0; i < downloadFiles.length; i++) {
          if (elem.href.toLowerCase().indexOf(downloadFiles[i]) > -1) {
            var fileName = urlSplit[urlSplit.length - 1];
            console.log('Download clicked');
              _satellite.track("download",
                { "fileName": fileName }
              );
          }
        }
      }
      else {
        //AA Tracking for Audio Player Component - CM 2/9/2022
        if (event.target.matches('.bb-dms7-audio-container-right__top-playpause') || event.target.matches('#playpauseIcon')) { 
          
          var eventType;
          var audioComponent = $('.audio')[0];
          var audioSource = $($(audioComponent).find('#player source')[0]).attr('src');
          var audioTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__podcast-name')[0]).text();
          var trackTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__episode-title')[0]).text();

          if (event.target.matches('.bb-dms7-audio-container-right__top-playpause')) {
            if (event.target.childNodes[0].nextElementSibling.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.childNodes[0].nextElementSibling.matches('.fa-pause')) {
              eventType = 'play';
            }
          }
          else if (event.target.matches('#playpauseIcon')) {
            if (event.target.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.matches('.fa-pause')) {
              eventType = 'play';
            }
          }

          if (typeof _satellite !== 'undefined') {
              _satellite.track("audio", {
                "eventType": eventType,
                "audioTitle": audioTitle,
                "trackTitle": trackTitle,
                "audioSource": audioSource
              });
          }
        }
      }
    }, false);


  })();


</script>



<script>
    function getGclidQueryParameter(p) {
      var match = RegExp('[?&]' + p + '=([^&]*)').exec(window.location.search);
      return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

    function getExpiryRecord(value) {
      var expiryPeriod = 90 * 24 * 60 * 60 * 1000; // 90 day expiry in milliseconds

      var expiryDate = new Date().getTime() + expiryPeriod;
      return {
        value: value,
        expiryDate: expiryDate
      };
    }

    function addGclid() {
      var gclidParam = getGclidQueryParameter('gclid');
      var gclidFormFields = ['gclid_field']; // all possible gclid form field ids here
      var gclidRecord = null;
      var currGclidFormField;

      var gclsrcParam = getGclidQueryParameter('gclsrc');
      var isGclsrcValid = !gclsrcParam || gclsrcParam.indexOf('aw') !== -1;

      gclidFormFields.forEach(function (field) {
        if (document.getElementById(field)) {
          currGclidFormField = document.getElementById(field);
        }
      });

      if (gclidParam && isGclsrcValid) {
        gclidRecord = getExpiryRecord(gclidParam);
        localStorage.setItem('gclid', JSON.stringify(gclidRecord));
      }

      var gclid = gclidRecord || JSON.parse(localStorage.getItem('gclid'));
      var isGclidValid = gclid && new Date().getTime() < gclid.expiryDate;

      if (currGclidFormField && isGclidValid) {
        currGclidFormField.value = gclid.value;
      }
    }

    window.addEventListener('load', addGclid);
  </script>
        
    </body>
</html>
