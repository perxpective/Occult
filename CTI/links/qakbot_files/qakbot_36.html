<!doctype html>
<html lang="en">

<head>
    <title>Following the LNK metadata trail</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/bootstrap.min.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/navigation.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/pagination.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/banners.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/style.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism.css?v=a225f65a71">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-vsc-dark-plus.css?v=a225f65a71">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-talos.css?v=a225f65a71">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/landing-page.css?v=a225f65a71">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/css/style.min.css" rel="stylesheet">


    <meta name="description" content="While tracking some prevalent commodity malware threat actors, Talos observed the popularization of malicious LNK files as their initial access method to download and execute payloads. A closer look at the LNK files illustrates how their metadata could be used to identify and track new campaigns.">
    <link rel="icon" href="https://blog.talosintelligence.com/content/images/size/w256h256/2022/07/talos_o_square.png" type="image/png">
    <link rel="canonical" href="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Cisco Talos Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Following the LNK metadata trail">
    <meta property="og:description" content="While tracking some prevalent commodity malware threat actors, Talos observed the popularization of malicious LNK files as their initial access method to download and execute payloads. A closer look at the LNK files illustrates how their metadata could be used to identify and track new campaigns.">
    <meta property="og:url" content="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/">
    <meta property="og:image" content="https://blog.talosintelligence.com/content/images/2023/01/threat-spotlight.png">
    <meta property="article:published_time" content="2023-01-19T13:00:19.000Z">
    <meta property="article:modified_time" content="2023-01-19T13:53:34.000Z">
    <meta property="article:tag" content="Threat Spotlight">
    <meta property="article:tag" content="Threats">
    <meta property="article:tag" content="Qakbot">
    <meta property="article:tag" content="SecureX">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Following the LNK metadata trail">
    <meta name="twitter:description" content="While tracking some prevalent commodity malware threat actors, Talos observed the popularization of malicious LNK files as their initial access method to download and execute payloads. A closer look at the LNK files illustrates how their metadata could be used to identify and track new campaigns.">
    <meta name="twitter:url" content="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/">
    <meta name="twitter:image" content="https://blog.talosintelligence.com/content/images/2023/01/threat-spotlight.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Guilherme Venere">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Threat Spotlight, Threats, Qakbot, SecureX">
    <meta name="twitter:site" content="@TalosSecurity">
    <meta property="og:image:width" content="1001">
    <meta property="og:image:height" content="501">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Cisco Talos Blog",
        "url": "https://blog.talosintelligence.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.talosintelligence.com/content/images/2022/11/TalosBrand_ukraine.svg"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Guilherme Venere",
        "url": "https://blog.talosintelligence.com/author/guilherme-venere/",
        "sameAs": []
    },
    "headline": "Following the LNK metadata trail",
    "url": "https://blog.talosintelligence.com/following-the-lnk-metadata-trail/",
    "datePublished": "2023-01-19T13:00:19.000Z",
    "dateModified": "2023-01-19T13:53:34.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.talosintelligence.com/content/images/2023/01/threat-spotlight.png",
        "width": 1001,
        "height": 501
    },
    "keywords": "Threat Spotlight, Threats, Qakbot, SecureX",
    "description": "While tracking some prevalent commodity malware threat actors, Talos observed the popularization of malicious LNK files as their initial access method to download and execute payloads. A closer look at the LNK files illustrates how their metadata could be used to identify and track new campaigns.",
    "mainEntityOfPage": "https://blog.talosintelligence.com/following-the-lnk-metadata-trail/"
}
    </script>

    <meta name="generator" content="Ghost 5.75">
    <link rel="alternate" type="application/rss+xml" title="Cisco Talos Blog" href="https://blog.talosintelligence.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="4ffb0139d74ada998f4b141e4d" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://cisco-talos-blog.ghost.io/" crossorigin="anonymous"></script>
    
    <link href="https://blog.talosintelligence.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=a225f65a71"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=a225f65a71">
    <style type='text/css'>
    img[src*="icon_check_white.svg"] { width: 20px; margin-left: 0px; margin-right: auto; }
    
    #ghost-portal-root { display: none; }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F45RVJG3BK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F45RVJG3BK');
</script>
<style>:root {--ghost-accent-color: #006db6;}</style>
</head>

<body class="post-template tag-threat-spotlight tag-threats tag-qakbot tag-securex-3">

    <div id="mobile-page-header" class="desktop-hide">
    <h1>Cisco Talos Blog</h1>
</div>
<input id="nav-trigger" class="nav-trigger" type="checkbox"/>
<label for="nav-trigger">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
        <g id="menu-icon">
            <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
            <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
            <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
        </g>
    </svg>
</label>
<nav id="nav">
    <div id="top-nav-bar">
    </div>

    <div id="navigation">
        <div class="navigation-logos-wrapper">
            <div id="talos-logo-wrapper">
                <a class="navbar-brand" href="https://talosintelligence.com">
                </a>
            </div>
        </div>
        <div class="navigation-links-wrapper">
            <ul class="main-nav-list">
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/software">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                            <style type="text/css">
                                .white{fill:#FFFFFF;}
                            </style>
                            <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                        </svg>
                        <span>Software</span>
                    </a>
                </li>
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/vulnerability_info">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                                <g id="vuln-icon" class="nav-icon">
                                    <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                                </g>
                            </svg>
                            <span>Vulnerability Information</span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="vuln-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="vuln-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                    </label>
                    <ul class="sub-nav">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/vulnerability_info">
                                <h4>Vulnerability Information</h4>
                            </a>
                        </li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="vuln-sub-trigger">BACK</label>
                        </li>
                        <li><a href="https://talosintelligence.com/vulnerability_reports">Vulnerability Reports</a></li>
                        <li><a href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                            <g id="vuln-icon" class="nav-icon">
                                <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                            </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/reputation">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                <style type="text/css">
                                    .white{fill:#FFFFFF;}
                                </style>
                                <g>
                                <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                    <circle class="white" cx="10" cy="10" r="3.2"></circle>
                                </g>
                            </svg>
                            <span>
                                Reputation Center
                            </span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="reputation-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="reputation-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                    </label>
                    <ul class="sub-nav">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/reputation">
                                <h4>Reputation Center</h4>
                            </a>
                        </li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="reputation-sub-trigger">BACK</label>
                        </li>
                        <li><a data-method="get" href="https://talosintelligence.com/reputation_center">IP &amp; Domain Reputation</a></li>
                        <li><a href="https://talosintelligence.com/talos_file_reputation">Talos File Reputation</a></li>
                        <li><a href="https://talosintelligence.com/amp-naming">Secure Endpoint Naming Conventions</a></li>
                        <li><a href="https://talosintelligence.com/categories">Intelligence Categories</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                            <style type="text/css">
                                .white{fill:#FFFFFF;}
                            </style>
                            <g>
                            <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                <circle class="white" cx="10" cy="10" r="3.2"></circle>
                            </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://support.talosintelligence.com/">
                        <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="20px" viewBox="0 0 123.17 159.292">
                            <path d="M61.59,0,0,17.069v85.32c0,23.472,61.59,56.9,61.59,56.9s61.58-36.288,61.58-56.9V17.069Zm-.433,149.746C38.314,136.662,8.128,114.3,8.128,102.389V23.239l53.029-14.7Z" fill="#fff"></path>
                        </svg>
                        <span>Support</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/incident_response">
                        <svg xmlns="http://www.w3.org/2000/svg" width="111.588" height="148.311" viewBox="0 0 111.588 148.311">
                            <path d="M1.181,128.446v15.7a4.167,4.167,0,0,0,4.167,4.167h100.9a4.167,4.167,0,0,0,4.167-4.167v-15.7a4.167,4.167,0,0,0-4.167-4.167H5.348a4.167,4.167,0,0,0-4.167,4.166M55.8,63.109a3.277,3.277,0,1,1,0,6.553c-10.344,0-20.755,8.578-20.755,18.57a3.277,3.277,0,1,1-6.554,0C28.489,73.947,41.93,63.109,55.8,63.109Zm0-12.016c-21.787,0-39.325,17.81-39.325,39.937v26.7H95.122V91.03c0-22.128-17.537-39.937-39.324-39.937m52.365-38.3a3.291,3.291,0,0,0-2.254,1.024L88.432,31.294a3.283,3.283,0,0,0,4.642,4.644l17.478-17.479a3.278,3.278,0,0,0-2.389-5.666m-105.138,0a3.276,3.276,0,0,0-1.98,5.666L18.522,35.938a3.283,3.283,0,0,0,4.643-4.644L5.687,13.817A3.255,3.255,0,0,0,3.025,12.793ZM55.389.026a3.276,3.276,0,0,0-2.867,3.345V19.642a3.277,3.277,0,1,0,6.554,0V3.371A3.283,3.283,0,0,0,55.389.026Z" fill="#fff"></path>
                        </svg>
                        <span>Incident Response</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/careers">
                        <svg xmlns="http://www.w3.org/2000/svg" width="153.816" height="90" viewBox="0 0 153.816 90">
                            <g>
                                <path d="M56.336,47.451a31.328,31.328,0,0,0-17.1-10.872A19.564,19.564,0,0,0,50.91,19.1C50.91,8.868,42.008,0,31.735,0S12.559,8.868,12.559,19.1A19.564,19.564,0,0,0,24.22,36.574,31.239,31.239,0,0,0,0,66.717c0,2.343,12.671,10.9,31.883,10.9a63.142,63.142,0,0,0,6.536-.341,37,37,0,0,1,8.222-21.367,38.039,38.039,0,0,1,9.7-8.456" fill="#fff" fill-rule="evenodd"></path>
                                <path d="M106.731,70.729a32.386,32.386,0,0,0-1.889-4.815c-.014-.029-.028-.058-.043-.087a32.308,32.308,0,0,0-2.568-4.335c-.033-.047-.066-.095-.1-.142-.312-.436-.631-.866-.964-1.287l-.015-.02a32.215,32.215,0,0,0-2.185-2.483l-.166-.168c-.369-.372-.745-.737-1.131-1.09l-.025-.024c-.415-.379-.838-.744-1.272-1.1l-.081-.064q-.582-.474-1.189-.92l-.217-.159c-.43-.312-.866-.616-1.313-.9h0a31.084,31.084,0,0,0-9.679-4.164A19.564,19.564,0,0,0,95.566,31.488c0-10.234-8.9-19.1-19.175-19.1s-19.176,8.868-19.176,19.1A19.564,19.564,0,0,0,68.876,48.96a31.828,31.828,0,0,0-9.109,3.733h0a31.8,31.8,0,0,0-6.941,5.668l-.045.05a31.3,31.3,0,0,0-2.243,2.738l-.024.034q-.5.693-.969,1.415c-.014.023-.03.047-.046.07a31.053,31.053,0,0,0-1.7,3.019c-.028.059-.057.117-.085.175a30.16,30.16,0,0,0-1.33,3.185c-.02.056-.038.112-.058.169q-.255.741-.474,1.5c-.019.065-.039.13-.057.2a30.092,30.092,0,0,0-.741,3.374c-.015.094-.03.188-.044.282-.084.56-.158,1.123-.211,1.693v.007c-.087.935-.135,1.88-.135,2.834,0,2.343,12.671,10.9,31.883,10.9s31.583-8.555,31.583-10.9a32.8,32.8,0,0,0-1.384-8.35l-.007-.023" fill="#fff" fill-rule="evenodd"></path>
                                <path d="M129.588,36.579A19.564,19.564,0,0,0,141.261,19.1c0-10.234-8.9-19.1-19.175-19.1S102.91,8.868,102.91,19.1a19.562,19.562,0,0,0,11.66,17.472A31.817,31.817,0,0,0,96.916,47.859a38.586,38.586,0,0,1,17.373,29.253,63.062,63.062,0,0,0,7.945.5c19.212,0,31.582-8.554,31.582-10.9a31.947,31.947,0,0,0-24.228-30.138" fill="#fff" fill-rule="evenodd"></path>
                            </g>
                        </svg>
                        <span>Careers</span>
                    </a>
                </li>

                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a id="link_blog" class="primary_nav_link" href="https://blog.talosintelligence.com">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="260px" height="296.5px" viewBox="0 0 260 296.5" enable-background="new 0 0 260 296.5" xml:space="preserve">
                                <path fill="#FFFFFF" d="M243.586,42.404h-14.448c-0.943-4.513-3.143-8.813-6.616-12.33L201.793,9.098  c-4.7-4.757-10.972-7.377-17.66-7.377c-6.578,0-12.777,2.547-17.457,7.173l-33.875,33.511H17.586c-6.6,0-12,5.399-12,12V226.28  c0,6.6,5.4,12,12,12H153.83l84.21,56.278l-27.448-56.278h32.994c6.6,0,12-5.4,12-12V54.404  C255.586,47.804,250.186,42.404,243.586,42.404z M214.662,48.045c-0.01,0.2-0.021,0.399-0.044,0.599  c-0.008,0.069-0.021,0.139-0.031,0.207c-0.046,0.345-0.113,0.688-0.196,1.026c-0.034,0.137-0.063,0.273-0.103,0.408  c-0.039,0.135-0.087,0.267-0.133,0.399c-0.051,0.151-0.102,0.302-0.16,0.45c-0.049,0.126-0.105,0.249-0.16,0.373  c-0.068,0.153-0.139,0.307-0.216,0.457c-0.059,0.116-0.12,0.23-0.184,0.345c-0.088,0.157-0.181,0.312-0.278,0.465  c-0.065,0.104-0.13,0.206-0.2,0.308c-0.115,0.168-0.239,0.33-0.366,0.492c-0.064,0.081-0.124,0.165-0.19,0.244  c-0.199,0.238-0.409,0.472-0.635,0.694L82.458,182.308l-47.932,12.871l13.427-47.74L177.223,19.561  c1.917-1.895,4.414-2.84,6.911-2.84c2.534,0,5.068,0.975,6.99,2.92l20.726,20.974c0.545,0.552,1.002,1.156,1.39,1.79  c0.574,0.938,0.975,1.951,1.206,2.993c0.004,0.021,0.01,0.04,0.014,0.06c0.049,0.226,0.086,0.453,0.119,0.682  c0.008,0.06,0.017,0.118,0.024,0.178c0.026,0.211,0.045,0.424,0.058,0.636c0.004,0.077,0.007,0.153,0.009,0.23  c0.007,0.203,0.011,0.407,0.005,0.61C214.673,47.877,214.666,47.961,214.662,48.045z"></path>
                            </svg>
                            <span>Blog</span>
                        </a>
                    </div>
                    <input id="blog-sub-trigger" class="sub-nav-trigger" type="checkbox"/>
                    <label class="sub-nav-trigger-label" for="blog-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                    </label>
                    <ul class="sub-nav">
                        <li class="desktop-hide">
                            <a href="https://blog.talosintelligence.com">
                                <h4>Blog</h4>
                            </a>
                        </li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="blog-sub-trigger">BACK</label>
                        </li>
                        <li>
                            <a href="https://blog.talosintelligence.com">Talos Blog</a>
                        </li>
                        <li>
                            <a href="https://blog.talosintelligence.com/category/threat-source-newsletter/">Talos Threat Source Newsletter</a>
                        </li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 260 296.5" enable-background="new 0 0 260 296.5" xml:space="preserve">
                            <path fill="#FFFFFF" d="M243.586,42.404h-14.448c-0.943-4.513-3.143-8.813-6.616-12.33L201.793,9.098  c-4.7-4.757-10.972-7.377-17.66-7.377c-6.578,0-12.777,2.547-17.457,7.173l-33.875,33.511H17.586c-6.6,0-12,5.399-12,12V226.28  c0,6.6,5.4,12,12,12H153.83l84.21,56.278l-27.448-56.278h32.994c6.6,0,12-5.4,12-12V54.404  C255.586,47.804,250.186,42.404,243.586,42.404z M214.662,48.045c-0.01,0.2-0.021,0.399-0.044,0.599  c-0.008,0.069-0.021,0.139-0.031,0.207c-0.046,0.345-0.113,0.688-0.196,1.026c-0.034,0.137-0.063,0.273-0.103,0.408  c-0.039,0.135-0.087,0.267-0.133,0.399c-0.051,0.151-0.102,0.302-0.16,0.45c-0.049,0.126-0.105,0.249-0.16,0.373  c-0.068,0.153-0.139,0.307-0.216,0.457c-0.059,0.116-0.12,0.23-0.184,0.345c-0.088,0.157-0.181,0.312-0.278,0.465  c-0.065,0.104-0.13,0.206-0.2,0.308c-0.115,0.168-0.239,0.33-0.366,0.492c-0.064,0.081-0.124,0.165-0.19,0.244  c-0.199,0.238-0.409,0.472-0.635,0.694L82.458,182.308l-47.932,12.871l13.427-47.74L177.223,19.561  c1.917-1.895,4.414-2.84,6.911-2.84c2.534,0,5.068,0.975,6.99,2.92l20.726,20.974c0.545,0.552,1.002,1.156,1.39,1.79  c0.574,0.938,0.975,1.951,1.206,2.993c0.004,0.021,0.01,0.04,0.014,0.06c0.049,0.226,0.086,0.453,0.119,0.682  c0.008,0.06,0.017,0.118,0.024,0.178c0.026,0.211,0.045,0.424,0.058,0.636c0.004,0.077,0.007,0.153,0.009,0.23  c0.007,0.203,0.011,0.407,0.005,0.61C214.673,47.877,214.666,47.961,214.662,48.045z"></path>
                        </svg>

                    </div>
                </li>

                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/podcasts">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="podcast-icon-nav" x="0px" y="0px" viewBox="0 0 71.8 75" width="26px" height="20px" style="enable-background:new 0 0 71.8 75;" xml:space="preserve">
                                <style type="text/css">
                                    .podcast-fill{fill:#fff;}
                                </style>
                                <path class="podcast-fill" d="M21.8,15.1c0-7.8,6.3-14.1,14.1-14.1c7.8,0,14.1,6.3,14.1,14.1v25.4c0,7.8-6.3,14.1-14.1,14.1  c-7.8,0-14.1-6.3-14.1-14.1V15.1z M59.9,40.1c0,12.4-9.4,22.6-21.5,23.9v3.6h12.8c1.4,0,2.6,1.2,2.6,2.6c0,1.4-1.2,2.6-2.6,2.6H20.4  c-1.4,0-2.6-1.2-2.6-2.6c0-1.4,1.2-2.6,2.6-2.6h12.8V64c-12-1.3-21.5-11.5-21.5-23.9v-6.8c0-1.4,1.2-2.6,2.6-2.6  c1.4,0,2.6,1.2,2.6,2.6v6.8c0,10.4,8.5,18.8,18.8,18.8c10.4,0,18.8-8.5,18.8-18.9v-6.8c0-1.4,1.2-2.6,2.6-2.6c1.4,0,2.6,1.2,2.6,2.6  V40.1z"></path>
                            </svg>

                            <span>
                                Podcasts
                            </span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="podcast-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="podcast-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                    </label>
                    <ul class="sub-nav">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/podcasts">
                                <h4>Podcasts</h4>
                            </a>
                        </li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="podcast-sub-trigger">BACK</label>
                        </li>
                        <li><a href="https://talosintelligence.com/podcasts/shows/beers_with_talos">Beers with Talos</a></li>
                        <li><a href="https://talosintelligence.com/podcasts/shows/talos_takes">Talos Takes</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="podcast-icon-nav" x="0px" y="0px" viewBox="0 0 71.8 75" width="26px" height="20px" style="enable-background:new 0 0 71.8 75;" xml:space="preserve">
                            <style type="text/css">
                                .podcast-fill{fill:#fff;}
                            </style>
                            <path class="podcast-fill" d="M21.8,15.1c0-7.8,6.3-14.1,14.1-14.1c7.8,0,14.1,6.3,14.1,14.1v25.4c0,7.8-6.3,14.1-14.1,14.1  c-7.8,0-14.1-6.3-14.1-14.1V15.1z M59.9,40.1c0,12.4-9.4,22.6-21.5,23.9v3.6h12.8c1.4,0,2.6,1.2,2.6,2.6c0,1.4-1.2,2.6-2.6,2.6H20.4  c-1.4,0-2.6-1.2-2.6-2.6c0-1.4,1.2-2.6,2.6-2.6h12.8V64c-12-1.3-21.5-11.5-21.5-23.9v-6.8c0-1.4,1.2-2.6,2.6-2.6  c1.4,0,2.6,1.2,2.6,2.6v6.8c0,10.4,8.5,18.8,18.8,18.8c10.4,0,18.8-8.5,18.8-18.9v-6.8c0-1.4,1.2-2.6,2.6-2.6c1.4,0,2.6,1.2,2.6,2.6  V40.1z"></path>
                        </svg>
                    </div>
                </li>

                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/about">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="55px" height="55px" viewBox="0 0 55 55">
                            <g>
                                <g class="mobile-nav-home">
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                                </g>
                            </g>
                        </svg>
                        <span>About</span>
                    </a>
                </li>
                <li class="nav-item desktop-hide">
                    <button class="search-button" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <span>Search Blog</span></button>
                </li>
            </ul>
        </div>
        <div class="nav-search-wrapper">
            <button class="search-button" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
        </div>
    </div>
</nav>
    

    <main id="site-main">

            <div class="banner-content-wrapper">
                <div class="container">
                    <div class="row">
                            <div class="col threat-spotlight-graphic banner-post-graphic">
                            </div>
                    </div>
                </div>
            </div>
                <div class="container-fluid">
                    <div class="row banner-bg-container banner-bg-2">
                        <div class="col left-bg-2"></div>
                        <div class="col right-bg-2"></div>
                    </div>
                </div>
            
        <div class="container-fluid">
            <div class="row main-content-row">
                <div class="col post-full-content">
                    
<article class="post tag-threat-spotlight tag-threats tag-qakbot tag-securex-3  blog-series-article">

    <h1 class="text-center">Following the LNK metadata trail</h1>

    <div class="text-center m-1">
        <div class="post-author">
            <span>By </span>
                <a href="https://blog.talosintelligence.com/author/guilherme-venere/">Guilherme Venere</a>
        </div>

        <br/>
        <time class="post-datetime" datetime="January 19, 2023 08:00">
            Thursday, January 19, 2023 08:00
        </time>

        <div class="m-3">
                        <a href="https://blog.talosintelligence.com/category/threat-spotlight/" class="category primary-category">
                            Threat Spotlight
                        </a>
                                            <a href="https://blog.talosintelligence.com/category/threats/" class="category primary-category">
                            Threats
                        </a>
                                            <a href="https://blog.talosintelligence.com/category/qakbot/" class="category primary-category">
                            Qakbot
                        </a>
                                            <a href="https://blog.talosintelligence.com/category/securex-3/" class="category primary-category">
                            SecureX
                        </a>
                            </div>
    </div>

    <section class="post-content-wrapper mt-5">
        <div class="post-content">
            <ul><li>Adversaries’ shift toward Shell Link (LNK) files, likely sparked by Microsoft’s decision to block macros, provides the opportunity to capitalize on information that can be provided by LNK metadata.</li><li>Cisco Talos analyzed metadata in LNK files and correlated it with threat actors tactics techniques and procedures, to identify and track threat actor activity. This report outlines our research on Qakbot and Gamaredon as examples.</li><li>Talos also used LNK file metadata to identify relationships among different threat actors. In this report we demonstrate this by using metadata to connect  Bumblebee with IcedID and Qakbot respectively.</li></ul><h1 id="executive-summary">Executive Summary</h1><p>Microsoft announced at the beginning of 2022 that they would soon start to <a href="https://docs.microsoft.com/en-gb/DeployOffice/security/internet-macros-blocked">disable macros</a> by default in Office documents downloaded from the Internet. They implemented the changes around June, only to remove<a href="https://techcrunch.com/2022/07/11/microsoft-office-macros-block/"> the feature</a> later that month. The feature was finally re-enabled by the end of July. Cisco Talos observed threat actors reacting to these changes by moving away from malicious macros as an initial access method in favor of other types of executable attachments.</p><p>While tracking some prevalent commodity malware threat actors, Talos observed the popularization of malicious LNK files as their initial access method to download and execute payloads. A closer look at the LNK files illustrates how their metadata could be used to identify and track new campaigns.</p><h1 id="an-overview-of-lnk-file-format">An overview of LNK file format</h1><p>Microsoft <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">describes</a> the Shell Link binary file format - the format used by Windows files with the extension "LNK" - as a file which contains information that can be used by the Operating System or an application to access another data object on the system. Although the format itself has applications supporting Object Linking and Embedding (OLE) object access, it is more commonly used as “shortcuts” to applications and file locations on the file system.</p><p>The LNK structure stores information about the target object as well as other related information about the application behavior and metadata from the machine where the LNK file was created. These metadata sections can contain optional data about various attributes of the target file. Among these attributes, a few provide valuable information to identify the exact system where the file was created. Other researchers have published <a href="https://www.intezer.com/blog/malware-analysis/how-threat-actors-abuse-lnk-files/">some good information</a> on the basic features present in LNK files so we won’t delve too deep in the details, but the most important fields for our research are the following:</p><ul><li><strong>Modification/Access/Creation (MAC) timestamps</strong>: A FILETIME structure that specifies the MAC time of the LNK target in UTC.</li><li><strong>VolumeID</strong>: An optional VolumeID structure that specifies information about the volume where the link target was on when the link was created. Of special interest to analysts is the field <strong>DriveSerialNumber </strong>which is unique and can be associated with a specific <strong>Disk Device.</strong></li><li><strong>MachineID (16 bytes)</strong>: A NULL–terminated character string, as defined by the system default code page, which specifies the NetBIOS name of the machine where the link target was last known to reside.</li><li><strong>DROID (CDomainRelativeObjId) GUID</strong>: Two values in GUID packet representation which are used to indicate the location of the link target. There are different values for the Volume identifier as well as the File identifier. The last section of the File identifier is generated based on the <strong>MAC Address</strong> of the machine where the file resides, which is another important correlation data.</li><li><strong>DROID Birth GUID</strong>: The same as the field above, but stores the location where the LNK file originally pointed to. Together with DROID GUID these two fields could indicate if a LNK file was moved to a different system after creation.</li><li><strong>Metadata Store structure</strong>: Extra structures of attributes used to describe additional details about the link target. Sometimes, when the target information is not present on the LNK file, we might need to look at the Metadata Store structure for additional data. The fields “<strong>ItemFolderPathDisplayNarrow</strong>”, “<strong>ParsingPath</strong>” and security identifier (“<strong>SID</strong>”) in this structure might provide valuable data to identify the LNK target as well as embedded payloads.</li></ul><p>In order to extract these attributes, several tools are available in the public domain to parse and analyze the LNK structure. Google provides a free command line tool called “<a href="https://code.google.com/archive/p/lnk-parser/">LNK Parser</a>”, which we are going to use in this blog to demonstrate the examples, but there are other options like <a href="https://github.com/EricZimmerman/LECmd">LeCMD</a> or the Python library “<a href="https://pypi.org/project/LnkParse3/">LnkParse3</a>”. Some of these tools are able to parse even malformed LNK files, which is a characteristic of some files created by threat actors.</p><h1 id="lnk-builder-tools">LNK Builder Tools</h1><p>With the increasing usage of LNK files in attack chains, it’s logical that threat actors have started developing and using tools to create such files. Several tools <a href="https://windowsir.blogspot.com/2022/09/lnk-builders.html?m=1">have been documented</a> before and many are available publicly or through a paid subscription:</p><ul><li><a href="https://research.checkpoint.com/2020/breaking-through-windows-defenses-analysing-mlnk-builder/">MLNK Builder</a></li><li>Quantum Builder</li><li>Macropack</li><li>LNKUp</li><li>Lnk2pwn</li><li>SharPersist</li><li>RustLnkBuilder</li></ul><p>These different tools may sometimes leave traces in the LNK metadata, which can be useful for detecting or tracking malicious actors. By examining the output payload of some of these builders, we can see that most of them wipe out most metadata from the file. This could be used as a good indicator of suspicious behavior, as these fields normally are present by default when the shortcut is properly created.</p><h2 id="sharpersist-payload">SharPersist Payload</h2><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/MI7nyJUPdvu9nVEFKgpxh-0S7Ztus_NH_bUpU2mKh8rNrJDDTvJCUADVjjrJZxEHk2_YrOtCJCfk-vfACAxriRlw5n3GPK3cBKDNzxlwJSdlJ5FIz5cxxmG6rPXiXftVFxtYWc_QVQj6Jz2qWgrj8kLRUgSs9BJkkwYmHyFVWCC87c_tEBrt5-zo0Qpacw" class="kg-image" alt loading="lazy" width="624" height="487"><figcaption><em>Figure 1: SharPersist payload</em></figcaption></figure><p>In Figure 1 we can see the MAC timestamps are empty, but the LNK file still contains information about the relative path where the file was created, as well as the SID of the user who created the file.</p><h2 id="quantum-builder-payload">Quantum Builder Payload</h2><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/blR9DeBjldWlu5tUbxr7G006WVdm-8D8K8agxUFI_I06jpwEF_wlb6Txifa1QU7LD9eEDmbK9seMs2-TrjFVEd--CSaz8u490mw3hgcrxWQ6TOD4Ze5KOCC1acPSvFy4ifjW5U6bGg_Ws3wJmZiVHxG5eOC_qAj78uaua8kuMMcyz7PLmCHwR32I7WrqvQ" class="kg-image" alt loading="lazy" width="624" height="796"><figcaption><em>Figure 2: Quantum builder payload</em></figcaption></figure><p>In Figure 2, we can see the Quantum Builder does not attempt to wipe out any metadata and the generated LNK file contains a trove of metadata about the system where it was created. In this example, we also see the Disk Serial Number, user SID and DROID information including the MAC address of the machine used to create the file. A <a href="https://maclookup.app/search/result?mac=00%3A0c%3A29%3A99%3Add%3A62">quick search</a> for that MAC address indicates it is from a VMWare virtual network card.</p><h2 id="meterpreter-payload">Meterpreter Payload</h2><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/I0zcTwJATd8EkLFviYZ-t_GMeA2niUTvT60Ifu0jWQj5DjIwVsB7KLjw6twodgP8h2pDCSFqARniPxrBtzky3S6Wvkq4bsK6TQ9V8qhowsW12RmnPfFsEDDRqDfHA1HSQXAfUL8BxOevxYAQa6ATAZOH2ZzaR-wej6Q_-hfVAFo7jtpsegjx5e0GsG9c0w" class="kg-image" alt loading="lazy" width="624" height="320"><figcaption><em>Figure 3: Meterpreter payload generated for MS15-020 (CVE-2015-0096)</em></figcaption></figure><p>In the LNK files created by Meterpreter, as well as other exploit frameworks like Cobalt Strike, the metadata are completely wiped, with the malicious code present in fields not normally parsed by LnkParser. In Figure 3, the LNK target is pointing to a DLL file on a remote share but since this is a malformed file created to exploit a bug, the parsing tools cannot see the payload.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/q6R7oNz6jaKHHARRsLB-Jd8C654tUkRziv6dpX3F48mj7mffFIu-Az-kwsofPunnXNMf3YbEFyFt1Nag0tJXUidT5M0oSzU3clkZQFRTh5F40tVYdf6LAdw-qFJ66LkFu_xv-ahhYr6MBcTV2u18RL8PeefUEq3XlwzSDTeT_4yy1A8k_fDIrODFJ2XI" class="kg-image" alt loading="lazy" width="615" height="672"><figcaption><em>Figure 4: Meterpreter payload viewed in an Hex editor showing the payload</em></figcaption></figure><p>Comparing the data present in these examples we can start to see patterns that may be useful to detect these malicious files. Most of the tools tend to have wiped out data simply because the APIs used to create such files don’t require all fields to be present, so they implement the bare minimum to have the malicious code running. A simple YARA rule could be used to detect such samples:</p><!--kg-card-begin: html--><pre>
rule lnk_wiped {
    meta:
      author="gvenere"
      description="LNK with wiped metadata"
 
    strings:
        $lnk_magic = { 4c 00 00 00 }
        $ext1 = ".js"  // additional strings to search
        $ext2 = ".bat" // in the LNK target area
        $ext3 = ".cmd" // These are for Qakbot
 
 
    condition:
        $lnk_magic at 0x0 and
        uint16(0x1c) == 0x0 and // CreationTime == 0x0
        uint16(0x24) == 0x0 and // AccessTime == 0x0
        uint16(0x2c) == 0x0 and // WriteTime == 0x0
        // To target specific families we can add additional checks here
        ( any of ($ext*) in (0xa0..0x100) )
}
</pre><!--kg-card-end: html--><p>Other tools use the proper methods to create these files, but that opens an opportunity to identify information specific to the machine where the sample was created. Looking at the Quantum Builder example in Figure 2, it’s possible to see attributes which identify the Disk and Machine where the LNK was created.  </p><p>The information present in the LNK files can prove extremely valuable when it comes to tracking specific threat actors in the wild.</p><h1 id="lnk-files-as-initial-access-tool">LNK files as Initial Access Tool</h1><p>When Microsoft announced the changes to macro behavior in Office at the end of 2021, very few of the most prevalent malware families used LNK files as part of their initial infection chain. In general, LNK files are used by worm type malware like <a href="https://blogs.cisco.com/security/raspberry-robin-highly-evasive-worm-spreads-over-external-disks">Raspberry Robin</a> in order to spread to removable disks or network shares.</p><p>However, Talos observed a steady increase in LNK file usage by main malware families starting at the beginning of the year, with a big spike by the time Microsoft implemented the changes in Office 365. Looking for VirusTotal (VT) data for the past year, and searching exclusively for files related to prevalent malware families, we can see the following trend (Figure 5):</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/KB0gsMADGWAYiK-u27SQ3HsAO4nMMVab0nToekQRhu5SpDplqjp3SBleBBQW7_GS6E6TKhkAIC5eigFF8WFgfDalxQ0OIOWgYg7ObrnbKtiTkKaiHduJh5NduRmScH8NvKuRwiVUlpZlE1Z8iAgvBRjTV1rqAdYK9AWpMtfu02lczMpSJ33Tr-KuIi62" class="kg-image" alt loading="lazy" width="624" height="364"><figcaption><em>Figure 5: LNK files used as initial access mechanism for prevalent malware families. Source: VirusTotal&nbsp;</em></figcaption></figure><p>When we look at specific families using these files, we can observe Qakbot as the main source of files in their last two campaigns, one starting in May and ending in July, and the other starting around the beginning of August and ending in November.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh5.googleusercontent.com/98pVKRrbNJj-WVcaiQRapRWHwFED8jdpnHSh6H74QS5FPzittmBlKCQQQMAbJNhxRutxt03y9Q8rNbETKW-9WjIhJnbwrap6ineDBiZ1mq_KkqDrcvStxE5tisyb36HMkOzxlOr1JKtDIJMvwofZX_Y6U20Bq3Dh6psti5H4dVbFLXzS2eJftMmHQExB" class="kg-image" alt loading="lazy" width="624" height="364"><figcaption><em>Figure 6: LNK file telemetry mapped to malware families. Source: VirusTotal&nbsp;</em></figcaption></figure><p>Interestingly, many malicious LNK files submitted to VT during this period had all the metadata removed from the file. Looking at Qakbot data, we see the group started to use LNK files with wiped metadata during the August campaign. Wiped metadata could also be explained by the increasing usage of toolkits to generate such files, as explained before.</p><p>The data in Figure 6 also depicts a decrease in activity around July and August, followed by another spike around October and November. This could be explained by the <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41091">announcement </a>of <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-41049">vulnerabilities</a> which allowed malware to bypass the Mark-of-the-Web flag used by Microsoft Defender and other Antivirus products to decide whether to scan or not a file. As <a href="https://www.securityweek.com/microsoft-patches-motw-zero-day-exploited-malware-delivery">reported </a>by other <a href="https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-windows-zero-day-bug-exploited-to-push-malware/">sources</a>, this bug was exploited by many malware families and could explain the second spike in LNK files usage as delivery mechanism.</p><h1 id="threat-actor-tracking">Threat Actor Tracking</h1><h2 id="qakbot">Qakbot</h2><p><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot">Qakbot</a> (also known as Qbot or Pinkslipbot) is one of the oldest malware operations still in activity. First observed in the wild around 2007, it is still one of the most active malware families today, as we recently reported in <a href="https://blog.talosintelligence.com/2022/07/quarterly-report-incident-response.html">Talos’s Q2 Quarterly Report</a>.</p><p>Qakbot is known to evolve and adapt their operation according to the current popular delivery methods and defense techniques. As recently as May 2022, their preferred method of distribution was to <a href="https://blog.talosintelligence.com/2022/07/what-talos-incident-response-learned.html">hijack email threads</a> gathered from compromised machines, and insert attachments containing Office XLSB documents embedded with malicious macros.</p><p>However, after Microsoft announced changes to how macros were executed by default on internet downloaded content, Talos found Qakbot increasingly moving away from the XLSB files in favor of ISO files containing a LNK file, which would download and execute the payload.</p><p>While examining the content of these LNK files used in the last 6 months of campaigns, we observed some interesting characteristics. Looking at the information present in the metadata about where these samples are created, we see that there is no overlapping metadata between the different campaigns. Additionally, looking at the Top 200 samples in VT known to be part of a Qakbot campaign, we see what machines were the most active in generating these LNK files (Figure 7):</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh3.googleusercontent.com/As1VyWHjVQxlJwPiIbf6aOKM_NW8ArrEM_uaJJqGffreE1grVL_JwQV9wzRovOq1UIIhWu-Pn3E0O5lyQxTGVdn4TfG3prS4hj31NDnzLu97qcHbXNX1cnGAH9mSga2NAJCsfYYkb6AoOVihARYJtfkzBJaJLhSOv9x6CUWx_qOeb4At20AXMBdKDedH" class="kg-image" alt loading="lazy" width="624" height="453"><figcaption><em>Figure 7: Distribution of LNK files related to main Qakbot campaigns</em></figcaption></figure><p>Metadata information can also help detect correlations between these actors and other malware. For example, we analyzed the samples below, which are all part of the “AA” Qakbot campaign from June and July 2022:</p><ul><li>8fda14f91e27afec5c1b1f71d708775c9b6e2af31e8331bbf26751bc0583dc7e</li><li>2f9da7145056a4217552a5a536ceb8365e853fbd04d28ae2d494afb20e9c021f</li><li>52458b4aaddbcb04048be963ea7d669c2ff7a69642d027f88812a5c6c1ade955</li><li>6a980d7659efb8bfb997dec3259d6eb090d4e6a4609e4c0666e04ad612151d71</li><li>67bbffb2ff5f724a201445f26018cb09fbf0588689f98f90fd82082aae7c6eec</li><li>da2a0d9a6b5dd2123c4c2cbd55d81fd22ab72bf7ceb1489a5a770e10bcf67137</li><li>54681cbb4c61dd4fe03341cfd8d2b796366a0372b53dd3e1d52c9e6ff98692d1</li><li>a7f31c98147d98ac08f4b8afe7faa2f2b4aab821655717f4bde519fcd87300ac</li><li>c5c0daaa26815bb6528332dd4f56f7eb72db4456d5a84b8bc69239c45079a1c4</li><li>efdb91497fe213e8f696065c2fe81f64cbaa219da16e2b3f8e1e146d098652b5</li><li>c9dfafd3536977289b4bfda1369fbd113a778cf06ac0c01cdc8e00e1c300e774</li><li>e818b0115a9a877a9517c99b16e5a2df9cf7c5eb1fb249d9153b68e8fa94e60b</li><li>7ba3eaee591cc73ab85aeb09d8c02b1e569b9dcaffcbc7c4473f504f939697d2</li></ul><p>The metadata in these samples indicate they were created on a machine with Drive Serial # “0x2848e8a8”. Looking at VT for this serial we found samples that were both related to the AA campaign, and linked to other malware. </p><p>For example the sample beacb63904c2624ae02601f283671b3ef61650109aea3259b63a0aeefe4133fa, which was submitted on August 15th, 2022, contains Powershell code to download and execute a binary from hxxp://88.198.148[.]231/u.exe.</p><p>According to VT information, this sample with hash 6161c01fd590c98c6dee4e510ba9be4f574c9cc5c89283dbff6bb79cd9383d70 is detected as a Redline variant (Figure 8):</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh5.googleusercontent.com/pil_Q9Bv75BQO3Hs8SQ9RCT6JzMoB-EaGZ5fyVEIZe14Jierx9_eFcoyBQMboANjmzf_R5-oJMQkiHMCI_z9leTltcOivqs9DTssES9HE1dtiXf3SMP_ydL8yDHHOtg-5yYo8GRQvWXDqBlHmdAJarFMMeMx9ZbGBFnLnzmDvkNXpBLQ5To6cGD2SEJdhg" class="kg-image" alt loading="lazy" width="400" height="312"><figcaption><em>Figure 8: VirusTotal details for Redline sample</em></figcaption></figure><p>Starting in August 2022, Qakbot resumed activity, including their two main campaigns, “Obama” and “AA”. Interestingly, at this point the “Obama” Qakbot campaign  began <a href="https://bazaar.abuse.ch/sample/b47bf41986964ec1f181f023eacc2c10eed2ad556f64d402bec61b39e60aae69/">wiping out the metadata</a> on their LNK files, but the Target field always pointed to the JS, BAT or CMD file used to start the malicious DLL part of the initial infection chain (Figure 9):</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh3.googleusercontent.com/42owac4MXZjStiVa1B-RsYwbHzVzIFxFz9Vc8o6_GNnSEkUhCOwmbqNE50vDpMcDIQ-q2FieR2noujQvIl-odHawMBtSHsng1QAOcwxXcBjSO3PHxHTnPaC21t1osbtWanYDLA5GYlQq7df24opPsq-ZF8tqb9YunvZY1yVPypxXZX80DhEB_XnqQsmV4Q" class="kg-image" alt loading="lazy" width="624" height="577"><figcaption><em>Figure 9: Metadata for LNK files part of “Obama” campaign</em></figcaption></figure><p>The same behavior started to happen on “BB” campaign’s LNK files starting on September 13th. We can see in Figure 10 that samples <a href="https://bazaar.abuse.ch/browse.php?search=sha256%3A77fe3b85503872e252ee98f49c1491d7dfc7cb3579ff3771bd7ad59f68c0dc60">mapped to the “BB”</a> campaign in September still had Drive Serial Number information:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh4.googleusercontent.com/hhJqL45M60u9Svl5Pt-1hjzkPa9OttO56DSu6VAXc_13O2--BZ1k9MHOKjoXhgeN5jt8Y_g4cBGd3QPbErRHhhGnSLH1RDlcGCoRq0uZHr7spMXN2EiAZm3V_cGTHjICSzA6wiOOHJUV0NZdIpXS-Rn3tJI531kLHqLcicEvsd3tdVLqaZxXJ9p_5ea8wA" class="kg-image" alt loading="lazy" width="624" height="767"><figcaption><em>Figure 10: Metadata for LNK files part of “BB” campaign</em></figcaption></figure><p>We also observe that the Drive Serial Number matches the one used by the “AA” campaign from the May/July timeframe, which could indicate “AA” and “BB” are probably managed by the same group. More recently,  <a href="https://bazaar.abuse.ch/sample/3c1d714d910f4d14eaf4698b7cec9a15a7ed92c657fb9945125bbdf3f8c767d5">samples</a> from “BB” started to have their metadata wiped too.</p><h2 id="gamaredon"><a href="https://malpedia.caad.fkie.fraunhofer.de/actor/gamaredon_group">Gamaredon</a></h2><p>In June 2022, Inquest published a <a href="https://inquest.net/blog/2022/06/27/glowsand">report </a>about a new threat actor called Glowsand that was targeting Ukranian entities using phishing emails with malicious documents and LNK files to download and execute second stage payloads. </p><p>By analyzing the metadata content of the<a href="https://www.virustotal.com/gui/file/d965892ede4f74fa62248b381160ed6f0cd9158bf4788de40b57815f9108bc15"> LNK file</a> in the report, Talos associated the machine IDs where the files were generated, to files associated with the <a href="https://www.virustotal.com/gui/search/metadata%253A3C76-6C45/files">Gamaredon APT</a>. Furthermore, based on this metadata, Talos identified a new campaign targeting Ukrainian organizations that started around August 8th, 2022, which we wrote about in a <a href="https://blog.talosintelligence.com/gamaredon-apt-targets-ukrainian-agencies/">separate blog post</a>. In fact, Gamaredon files reported as far back as <a href="https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/">Feb 2017</a> contained the same LNK metadata as the files found in our research.</p><p>On September 6th a new set of samples was identified during our hunts, which we also connected to previous Gamaredon campaigns via metadata. But the samples this time had an interesting feature: an embedded digital signature (digisig) pertaining to a Microsoft development unit in Puerto Rico.</p><ul><li>7f66f4411983001d29236c5d3fb4ff26f01b5742badca1db8d49264c01ba506c</li><li>1b2ed05f488f8439688a02cc6ef84f939d16169117b489219b688a3ea482e5ed</li><li>6ce64dedbe81c36aef38fd2d567f6ab9737df708591dc2f0cafa56db26a1d043</li><li>1e0b92485e09ac970ae38214fb5c7407f73027ada47ea697017e49cacb576908</li></ul><p>The samples had very few or no detections at all in VT, even though some of them are related to a Gamaredon campaign from 2016/2017, which may indicate the embedded digisig might have been added in an attempt to bypass AV detections. </p><p>Following the lead on the digisig name “<a href="https://www.virustotal.com/gui/search/content%253A%257B4d6963726f736f6674204f7065726174696f6e732050756572746f205269636f31%257D">Microsoft Operations Puerto Rico1</a>” we can find a multitude of LNK files using the same technique. The interesting point here is that there is no provision in the LNK file format for a digisig, which means the digisig is probably present only as garbage data to confuse AV scanners and is a common technique used by many malware families.</p><h2 id="bumblebee-relationship-with-icedid-and-qakbot">Bumblebee relationship with IcedID and Qakbot</h2><p>In addition to tracking malware groups’ activity over time, LNK file metadata can help identify relationships among different threat actors. Researchers <a href="https://blog.bushidotoken.net/2022/11/the-continuity-of-conti.html">have identified</a> relationships between Bumblebee and other malware families before, which we independently confirmed by looking at the LNK metadata.</p><p>In August 2022, a user submitted a <a href="https://www.virustotal.com/gui/file/f10f7b6b90f1fabd7d55822fa50d11cda7e8651df246daa8f1cf2360cebca61e">test link</a> file to VT, with a file path containing the individual’s username: “Lamar”. This LNK file was created on the same machine responsible for the LNK files used in a previous IcedID campaign. A few hours later the same user submitted another file with hash e89cd1999517b47805106111e14de4a03669cac30adb3b3304655febce25955f, this time with user information sanitized, and packaged in a Zip file containing a BAT and DLL file. <a href="https://www.virustotal.com/gui/file/74ec1aefc915a939cda2b028d778566e341c2ef81186a5861b677e3bc6707623">The DLL</a> file was an IcedID bot.</p><p>We also found a correlation between LNK files leading to IcedID infection, with LNK files used in a Bumblebee campaign, which both use the same Drive Serial Number:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/SWAdFxNt2Tzy1srk-QFCaEuzcPQJJFxgZqM1ASHwPuTAN4RcmeXe0z57t-c0q5-eYXuK73a1UgTZSwgL38bGfBSBUD9EPeeSAvBBkZmBFAbMYCQiPJXJuPOH46PbZhJSO_tRKXQcXM9RE3PoUCYTosubOqT76mM7YsymSIci97B6M9FUeQGoaqCyOmX1Sw" class="kg-image" alt loading="lazy" width="624" height="167"><figcaption><em>Figure 11: Bumblebee and IcedID samples sharing the same metadata</em></figcaption></figure><p>By examining the relationships between these hashes in VT, we can see that the LNK file 9c7e01c2c39dadc020a0cf8dc74b62e6453b56413f09705b4ad4d391981f5a3f seen in Figure 11 leads to a <a href="https://www.virustotal.com/gui/file/2e349b3224cc0d958e6945623098c2d28cc8977e0d45480c0188febbf7b8aa78">Bumblebee DLL </a>while other hashes like 3cca8d1b4cfe0ebcf105621700454d0285ef1b44dfed3e3abf70060bb62aa5b4 lead to an <a href="https://www.virustotal.com/gui/file/2630bdfe1b7ee3c9a6e46fd004c238b2d4b22de0696ea502074d7e33900b6c8f">IcedID DLL</a>. In both cases the same username is present in the ParsingPath field.</p><p>A similar approach was used to find a relationship between Bumblebee and Qakbot. During our research on Qakbot we found samples associated with the “Obama” campaign which still had the LNK information and used the Drive Serial Number “300D-05E9”. This same serial number was found later in LNK samples leading to Bumblebee infections:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh6.googleusercontent.com/dW0j-NapzjJAk0TLo_1V3yYhu8SFZwVpVAJkncPwjwFyE9AViR7XTR6KnbBPnU60gyHI4u08ba17WDBGTuCGk7euZcx8uZN6SA-0sikuKhJmr_t2voFauUGBrKtPwjYRQJ7bLORVpWmKNFg3QiUaI7sdKODkcZItPy3PSJrvsVpG7sW4SqIHTl75Ywi1Rw" class="kg-image" alt loading="lazy" width="624" height="159"><figcaption><em>Figure 12: Bumblebee and Qakbot samples sharing the same metadata</em></figcaption></figure><p>Just as an example, the sample 2738ee3f181994cca5d9ea19359b8142981583d17563934ab3212eefe13af3ff in Figure 12 leads to a <a href="https://www.virustotal.com/gui/file/b29b0f2a27ccbb9f12363a3dde1f2d2373fdc782232f4804f0abffbb8daf9d25">Bumblebee DLL</a>.</p><h1 id="conclusion">Conclusion</h1><p>In the cyber threat landscape, any new information on the adversary could be critical toward improving defenses.  In this blog Talos demonstrated metadata’s value using LNK files, but the same concept is applicable to other file formats that include metadata, or attack tools that leave signature traces about their use in their payloads.</p><p>By analyzing and tracking information leaked through metadata, and correlating this information with other actor’s tactics, techniques and procedures, defenders can develop better detections and even predict future behavior, to prepare for an attack.</p><h1 id="coverage">Coverage</h1><figure class="kg-card kg-image-card"><img src="https://blog.talosintelligence.com/content/images/2023/01/endpoint-email-firewall-analytics-web.jpg" class="kg-image" alt loading="lazy" width="2000" height="404" srcset="https://blog.talosintelligence.com/content/images/size/w600/2023/01/endpoint-email-firewall-analytics-web.jpg 600w, https://blog.talosintelligence.com/content/images/size/w1000/2023/01/endpoint-email-firewall-analytics-web.jpg 1000w, https://blog.talosintelligence.com/content/images/size/w1600/2023/01/endpoint-email-firewall-analytics-web.jpg 1600w, https://blog.talosintelligence.com/content/images/size/w2400/2023/01/endpoint-email-firewall-analytics-web.jpg 2400w" sizes="(min-width: 720px) 720px"></figure><p><a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html">Cisco Secure Endpoint</a> (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free <a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=amp-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=amp-free-trial">here.</a></p><p><a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> web scanning prevents access to malicious websites and detects malware used in these attacks.</p><p><a href="https://www.cisco.com/c/en/us/products/security/email-security/index.html">Cisco Secure Email</a> (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free <a href="https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium=web-referral&amp;utm_source=cisco&amp;utm_campaign=cmd-free-trial-request&amp;utm_term=pgm-talos-trial">here</a>.</p><p><a href="https://www.cisco.com/c/en/us/products/security/firewalls/index.html">Cisco Secure Firewall</a> (formerly Next-Generation Firewall and Firepower NGFW) appliances such as <a href="https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html">Threat Defense Virtual</a>, <a href="https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html">Adaptive Security Appliance</a> and <a href="https://meraki.cisco.com/products/appliances">Meraki MX</a> can detect malicious activity associated with this threat.</p><p><a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html">Cisco Secure Malware Analytics</a> (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.</p><p><a href="https://umbrella.cisco.com/">Umbrella</a>, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella <a href="https://signup.umbrella.com/?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=umbrella-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=automated-free-trial">here</a>.</p><p><a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.</p><p>Additional protections with context to your specific environment and threat data are available from the <a href="https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html">Firewall Management Center</a>.</p><p><a href="https://signup.duo.com/?utm_source=talos&amp;utm_medium=referral&amp;utm_campaign=duo-free-trial">Cisco Duo</a> provides multi-factor authentication for users to ensure only those authorized are accessing your network.</p><p>Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on <a href="https://www.snort.org/products">Snort.org</a>. Snort SIDs for this threat are: 61099-61102, 300367-300368</p><p>The following ClamAV detections are also available for this threat:</p><ul><li>Lnk.Dropper.Agent</li><li>Lnk.Trojan.Qakbot</li><li>Lnk.Trojan.BazarLoader</li><li>Lnk.Downloader.Agent</li><li>Win.Dropper.Agent</li></ul><h1 id="indicators-of-compromise">Indicators of Compromise</h1><p>Indicators of Compromise associated with this threat can be found <a href="https://github.com/Cisco-Talos/IOCs/blob/main/2023/01/following-the-lnk-metadata-trail.txt">here</a>.</p>
        </div>
    </section>
    <div class="social-media-wrapper">
    <h5>Share this post</h5>
    <ul class="social-media-share-list">
        <li>
            <a class="share-facebook" title="Share this on Facebook" data-text="Following the LNK metadata trail" data-href="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/" rel="nofollow" target="_blank" href="https://www.facebook.com/sharer.php?u=https://blog.talosintelligence.com/following-the-lnk-metadata-trail/"></a>
        </li>
        <li>
            <a class="share-twitter" title="Tweet This" data-text="Following the LNK metadata trail" data-href="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/" rel="nofollow" target="_blank" href="https://twitter.com/share?url=https://blog.talosintelligence.com/following-the-lnk-metadata-trail/"></a>
        </li>
        <li>
            <a class="share-linkedin" title="Share this on LinkedIn" data-text="Following the LNK metadata trail" data-href="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/" rel="nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.talosintelligence.com/following-the-lnk-metadata-trail/"></a>
        </li>
        <li>
            <a class="share-reddit" title="Reddit This" data-text="Following the LNK metadata trail" data-href="https://blog.talosintelligence.com/following-the-lnk-metadata-trail/" rel="nofollow" target="_blank" href="https://www.reddit/submit?url=https://blog.talosintelligence.com/following-the-lnk-metadata-trail/"></a>
        </li>
        <li>
            <a class="share-email" title="Email This" href="mailto:?body=Following the LNK metadata trailhttps://blog.talosintelligence.com/following-the-lnk-metadata-trail/"></a>
        </li>
    </ul>
</div></article>
                </div>
                <div class="col-lg alt-layout-row-dk sidebar" id="side-bar">


                            <h4>Related Content</h4>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/intellexa-and-cytrox-intel-agency-grade-spyware/">
                                        <h3>Intellexa and Cytrox: From fixer-upper to Intel Agency-grade spyware</h3>
                                        <span  class="preview-attributes">December 21, 2023 11:00</span>
                                        <p>Talos revealed that rebooting an iOS or Android device may not remove the Predator spyware produced by Intellexa. Intellexa knows if their customers intend to perform surveillance operations on foreign soil.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/deep-dive-into-phobos-ransomware/">
                                        <h3>A deep dive into Phobos ransomware, recently deployed by 8Base group</h3>
                                        <span  class="preview-attributes">November 17, 2023 08:01</span>
                                        <p>Cisco Talos has recently observed an increase in activity conducted by 8Base, a ransomware group that uses a variant of the Phobos ransomware and other publicly available tools to facilitate their operations.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/understanding-the-phobos-affiliate-structure/">
                                        <h3>Understanding the Phobos affiliate structure and activity</h3>
                                        <span  class="preview-attributes">November 17, 2023 08:01</span>
                                        <p>Cisco Talos identified the most prolific Phobos variants, TTPs and affiliate structure, based on their activity and analysis of over 1,000 samples from VirusTotal dating back to 2019. We assess with moderate confidence Eking, Eight, Elbie, Devos and Faust are the most common variants</p>
                                    </a>
                                </div>
                </div>
            </div>
        </div>
    </main>



    <footer id="footer">
    <div class="container-fluid">
        <div class="row footer_nav_wrapper">
            <div class="col-lg-10 col-md-9 col-sm-12">
                <div class="multi-col-list-wrapper">
                    <ul>
                        <li>
                            <a href="https://talosintelligence.com/software">Software</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/reputation_center">Reputation Center</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/vulnerability_info">Vulnerability Information</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/ms_advisories">Microsoft Advisory Snort Rules</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/incident_response">Incident Response</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/amp-naming">Secure Endpoint Naming Conventions</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/talos_file_reputation">Talos File Reputation</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/community">Support Communities</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/about">About</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/careers">Careers</a>
                        </li>
                        <li>
                            <a href="https://blog.talosintelligence.com">Talos Blog</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/newsletters">Threat Source Newsletter</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/podcasts/shows/beers_with_talos">Beers with Talos Podcast</a>
                        </li>
                        <li>
                            <a href="https://talosintelligence.com/podcasts/shows/talos_takes">Talos Takes Podcast</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-2 col-md-3 col-sm-12 connect_social">
                <h5>Connect with us</h5>
                <ul>
                    <li>
                        <a target="_blank" href="https://twitter.com/talossecurity" rel="nofollow">
                            <img alt="Follow us on Twitter" src="https://blog.talosintelligence.com/assets/images/footer_icon_tw.svg?v=a225f65a71"/>
                        </a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured" rel="nofollow">
                            <img alt="Watch our informational videos on YouTube" src="https://blog.talosintelligence.com/assets/images/footer_icon_yt.svg?v=a225f65a71"/>
                        </a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/company/cisco-talos-intelligence-group/" rel="nofollow">
                            <img alt="Connect with us on LinkedIn" src="https://blog.talosintelligence.com/assets/images/footer_icon_li.svg?v=a225f65a71">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 footer_corporate">
                <a href="http://tools.cisco.com/security/center/home.x" target="_blank">
                    <img src="https://blog.talosintelligence.com/assets/images/logo_cisco_white.svg?v=a225f65a71" alt="Cisco Security"/>
                </a>

                <p class="copyright">
                    &copy; <span id="current-year"></span> Cisco Systems, Inc. and/or its affiliates. All rights reserved. View our <a href="https://www.cisco.com/web/siteassets/legal/privacy_full.html" class="underline" target="_blank">Privacy Policy</a>
                </p>
            </div>
        </div>
    </div>
</footer>
    


<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://blog.talosintelligence.com/assets/js/jquery-3.6.0.min.js?v=a225f65a71"></script>
<script src="https://blog.talosintelligence.com/assets/js/popper.min.js?v=a225f65a71"></script>
<script src="https://blog.talosintelligence.com/assets/js/bootstrap.bundle.min.js?v=a225f65a71"></script>
<script src="https://blog.talosintelligence.com/assets/js/date.js?v=a225f65a71"></script>
<script src="https://blog.talosintelligence.com/assets/js/prism.js?v=a225f65a71"></script>
<script src="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/js/ghost-theme-utils.min.js" async defer></script>


<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"83ea9e106eb11924","b":1,"version":"2023.10.0","token":"35f8ae698f9d471b83b846a751388737"}' crossorigin="anonymous"></script>
</body>

</html>