<!DOCTYPE HTML>
<html lang="en">
    <head>
    <meta charset="UTF-8"/>

    
    









    <!-- OneTrust Cookies Consent Notice Start -->






    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="6373c986-7725-4c54-9731-2a91bdd43107"></script>


<script type="text/javascript">
    function OptanonWrapper() { }
</script>

<!-- OneTrust Cookies Consent Notice End -->

















    
    <title>Threat Thursday: Agent Tesla Infostealer</title>
    
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware"
        },
        "headline": "Threat Thursday: Agent Tesla Infostealer",
        "image": [
            "/content/dam/blogs-blackberry-com/images/blogs/2021/06/threat-thurs-tesla-1-350x350-ibb.png",
            "/content/dam/blogs-blackberry-com/images/blogs/2021/06/threat-thurs-tesla-1-875x530-ibb.png"
        ],
        "datePublished": "2021-06-24T04:01:00.000-04:00",
        "author": {
                    "@type": "Person",
                    "name": "The BlackBerry Research & Intelligence Team"
                },

        "publisher": {
            "@type": "Organization",
            "name": "BlackBerry",
            "logo": {
                "@type": "ImageObject",
                "url": "https://blogs.blackberry.com/content/dam/blackberry-com/Images/logos/BlackBerry_Logo_Black_150.png"
            }
        }
    }
</script>

    <meta name="keywords" content="Cybersecurity"/>
    <meta name="description" content="Agent Tesla is an extremely popular information-stealing Trojan that is being sold and distributed across a number of underground hacking forums and platforms. It is highly customizable, which allows threat actors to tailor it to their particular needs. "/>
    
    <link rel="icon" href="/etc.clientlibs/bbcom/clientlibs/clientlib-etc-legacy/resources/bbcom-aem-project/images/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    
    
    <link rel="canonical" href="https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware"/>
    <meta name="author" content="blogs.blackberry.com"/>
    <meta property="og:url" content="https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware"/>
    <meta property="og:title" content="Threat Thursday: Agent Tesla Infostealer"/>
    <meta property="og:description" content="Agent Tesla is an extremely popular information-stealing Trojan that is being sold and distributed across a number of underground hacking forums and platforms. It is highly customizable, which allows threat actors to tailor it to their particular needs. "/>
    <meta property="og:type" content="article"/>
    <meta property="og:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2021/06/threat-thurs-tesla-1-875x530-ibb.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BlackBerry"/>
    <meta name="twitter:title" content="Threat Thursday: Agent Tesla Infostealer"/>
    <meta name="twitter:description" content="Agent Tesla is an extremely popular information-stealing Trojan that is being sold and distributed across a number of underground hacking forums and platforms. It is highly customizable, which allows threat actors to tailor it to their particular needs. "/>
    <meta name="twitter:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2021/06/threat-thurs-tesla-1-875x530-ibb.png"/>

    

    
    
<link rel="stylesheet" href="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.212090aa91e144ce76b952f074e6c1ba.css" type="text/css">





    








<script>
    var digitalData = {
        page: {
            pageInfo: {
                pageTitle: "Threat Thursday: Agent Tesla Infostealer",
                pageName: "en:2021:06:threat-thursday-agent-tesla-infostealer-malware",
                domain:"blogs.blackberry.com",
                hierarchy:["en","2021","06","threat-thursday-agent-tesla-infostealer-malware"],
                timeStamp:"2023-12-23 07:23:34",
                tags:"Cybersecurity",
                country:"GB"
            }
        }
    }
</script>



    <script src="//assets.adobedtm.com/cb3160b9e813/dd47d4a7a48e/launch-17c42c38011b.min.js" async></script>
    










<script>
    digitalData.blogPost = {
        authors: "The BlackBerry Research & Intelligence Team",
        categories: "Research & Intelligence"
    }
</script>








    
    
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TXGFP23');</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=AW-944900006"></script> 
<script> 
  window.dataLayer = window.dataLayer || []; 
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); gtag('config', 'AW-944900006'); 
</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXGFP23" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



    

    



<script src="https://kit.fontawesome.com/3c243f8233.js" crossorigin="anonymous"></script>

    
    
    

    
    
    
    

    
</head>
    <body class="page basicpage" data-enable-history="true">
        
        
            



            

  
<!--
<sly data-sly-use.templatedContainer="com.day.cq.wcm.foundation.TemplatedContainer"
   data-sly-repeat.child=""
   data-sly-resource=""/>
-->

<header>
    




    
    
    
<!-- BEGIN DO NOT INDEX -->

    

<!-- skip to content: START -->
<a href='#' class='skipNav' tabindex="0">Skip Navigation</a>
<!-- skip to content: END-->
<!-- BEGIN DO NOT INDEX -->

  <nav class="blogs-navigationv2 bb-blogs-navbar navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="https://blogs.blackberry.com">
        <svg width="175px" height="30px" viewBox="0 0 175 30" version="1.1">
          <title>BlackBerry Logo</title>
          <g id="Creative" stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
              <g id="21-product-page-Protect-02.15.22" transform="translate(-91.000000, -10.000000)" fill="#FFFFFF" fillRule="nonzero">
                  <g id="BB_White" transform="translate(91.000000, 10.000000)">
                      <path d="M9.18042011,2.14285967 C9.18042011,1.19318021 8.5959918,-1.17624431e-15 6.16086942,-1.17624431e-15 C5.16247216,-1.17624431e-15 2.4107723,-1.17624431e-15 2.4107723,-1.17624431e-15 L1.33931598,4.94318021 C1.33931598,4.94318021 3.36046941,4.94318021 5.25986363,4.94318021 C8.32813214,4.91883014 9.18042011,3.48214033 9.18042011,2.14285967 Z" id="Shape"></path>
                      <path d="M19.2861873,2.14285967 C19.2861873,1.19318021 18.701759,-1.17624431e-15 16.2666366,-1.17624431e-15 C15.2682393,-1.17624431e-15 12.5165395,-1.17624431e-15 12.5165395,-1.17624431e-15 L11.4450831,4.94318021 C11.4450831,4.94318021 13.4662366,4.94318021 15.3412807,4.94318021 C18.4338993,4.91883014 19.2861873,3.48214033 19.2861873,2.14285967 Z" id="Shape_1_"></path>
                      <path d="M7.84110413,9.54545936 C7.84110413,8.59578874 7.25667582,7.4025997 4.82155344,7.4025997 C3.82315617,7.4025997 1.07145632,7.4025997 1.07145632,7.4025997 L5.68518084e-15,12.3457799 C5.68518084e-15,12.3457799 2.02115343,12.3457799 3.89619757,12.3457799 C6.96445725,12.3457799 7.84110413,10.88474 7.84110413,9.54545936 Z" id="Shape_2_"></path>
                      <path d="M17.9468713,9.54545936 C17.9468713,8.59578874 17.362443,7.4025997 14.9273206,7.4025997 C13.9289233,7.4025997 11.1772235,7.4025997 11.1772235,7.4025997 L10.1057671,12.3457799 C10.1057671,12.3457799 12.1269206,12.3457799 14.0263148,12.3457799 C17.0702244,12.3457799 17.9468713,10.88474 17.9468713,9.54545936 Z" id="Shape_3_"></path>
                      <path d="M28.5153164,6.55032938 C28.5153164,5.60064992 27.930888,4.40746971 25.4957657,4.40746971 C24.4973684,4.40746971 21.7456774,4.40746971 21.7456774,4.40746971 L20.6742211,9.35064992 C20.6742211,9.35064992 22.6953745,9.35064992 24.5704186,9.35064992 C27.6386695,9.32629985 28.5153164,7.88961005 28.5153164,6.55032938 Z" id="Shape_4_"></path>
                      <path d="M27.0542412,14.2694801 C27.0542412,13.3198006 26.4698129,12.1266204 24.0346816,12.1266204 C23.0362844,12.1266204 20.2845934,12.1266204 20.2845934,12.1266204 L19.213137,17.0698006 C19.213137,17.0698006 21.2342905,17.0698006 23.1093346,17.0698006 C26.1775943,17.0698006 27.0542412,15.6087696 27.0542412,14.2694801 Z" id="Shape_5_"></path>
                      <path d="M16.4857961,17.2889601 C16.4857961,16.3392807 15.9013678,15.1461005 13.4662366,15.1461005 C12.4678393,15.1461005 9.71614827,15.1461005 9.71614827,15.1461005 L8.64469195,20.0892807 C8.64469195,20.0892807 10.6658454,20.0892807 12.5408895,20.0892807 C15.6091492,20.0649306 16.4857961,18.6282496 16.4857961,17.2889601 Z" id="Shape_6_"></path>
                      <path d="M83.7683052,18.75 C83.5978459,19.11526 82.7455491,20.7711005 80.6026453,20.7711005 C78.1188139,20.7711005 77.1447667,18.701291 77.1447667,17.191551 C77.1447667,14.6590813 78.8493515,12.3944712 81.3575329,12.3944712 C84.0605238,12.3944712 84.6936523,14.4155717 84.7667113,14.7808317 L88.7359591,14.7808317 C88.9794775,13.2954417 87.786262,8.74187154 81.5036422,8.74187154 C76.9012483,8.74187154 73.2242102,12.4188213 73.2242102,17.3133014 C73.2242102,21.331161 75.7323917,24.4236913 80.3834769,24.4236913 C86.1790775,24.4236913 87.7375619,19.8701212 87.9323713,18.7499912 L83.7683052,18.7499912 L83.7683052,18.75 Z" id="Shape_7_"></path>
                      <path d="M53.2805356,19.8457799 C53.2805356,19.6022703 53.3535858,19.1639601 53.5483953,18.2629897 C53.7432047,17.3376603 56.5435959,4.40746971 56.5435959,4.40746971 L52.8178577,4.40746971 L49.7252479,18.6769498 C49.6034887,19.2857193 49.5304385,19.87013 49.5304385,20.3814904 C49.5304385,23.4983708 51.9412108,24.4237002 53.889314,24.4237002 C54.5711514,24.4237002 55.22863,24.3019498 55.3747393,24.2775909 C55.4477895,23.961031 56.0322266,21.2824609 56.0565767,21.1607105 C55.9835265,21.1607105 55.5695487,21.2094107 55.0825295,21.2094107 C53.6945045,21.2094107 53.2805356,20.625 53.2805356,19.8457799 Z" id="Shape_8_"></path>
                      <polygon id="Shape_9_" points="106.220152 8.76623044 101.033339 8.76623044 94.3367415 14.7808405 96.6014133 4.38311963 92.8269661 4.38311963 88.5654909 24.1071403 92.3155881 24.1071403 93.3626943 19.3100606 95.6760575 17.4837696 98.8660763 24.1071403 103.054492 24.1071403 98.5251576 15.2435096"></polygon>
                      <path d="M32.7767827,18.0194801 C33.0933514,16.6071403 35.7232832,4.38311963 35.7232832,4.38311963 C35.7232832,4.38311963 40.2769681,4.38311963 42.8338497,4.38311963 C47.9963131,4.38311963 49.2625788,7.25649924 49.2625788,8.98538995 C49.2625788,12.8327903 45.6342409,13.8555199 45.1959219,13.9772703 C45.6098908,14.1233708 47.971963,15.0487002 47.971963,18.0681802 C47.971963,21.3555199 44.9524035,24.107459 40.2526181,24.107459 C40.2526181,24.107459 38.5723834,24.107459 38.1097143,24.107459 C34.1404576,24.1314904 32.0218951,21.4042201 32.7767827,18.0194801 Z M43.905306,17.7759705 C43.905306,16.8506411 43.2965277,15.681811 40.666587,15.681811 L37.2330585,15.681811 L36.2103112,20.4545406 L40.1065088,20.4545406 C42.5903401,20.4545406 43.905306,19.3100606 43.905306,17.7759705 Z M45.1715718,9.8133102 C45.1715718,8.86363075 44.4410342,8.0357105 42.6633904,8.0357105 L38.8645931,8.0357105 L38.0122963,12.0292201 L41.9815529,12.0292201 C44.0757654,12.0292201 45.1715718,10.9821403 45.1715718,9.8133102 Z" id="Shape_10_"></path>
                      <path d="M104.515568,18.0194801 C104.832136,16.6071403 107.462068,4.38311963 107.462068,4.38311963 C107.462068,4.38311963 112.015753,4.38311963 114.572626,4.38311963 C119.735089,4.38311963 121.001364,7.25649924 121.001364,8.98538995 C121.001364,12.8327903 117.373026,13.8555199 116.934707,13.9772703 C117.348667,14.1233708 119.710748,15.0487002 119.710748,18.0681802 C119.710748,21.3555199 116.666847,24.107459 111.991394,24.107459 C111.991394,24.107459 110.311159,24.107459 109.84849,24.107459 C105.879234,24.1314904 103.76068,21.4042201 104.515568,18.0194801 Z M115.644091,17.7759705 C115.644091,16.8506411 115.035304,15.681811 112.405372,15.681811 L108.947493,15.681811 L107.924737,20.4545406 L111.820935,20.4545406 C114.329125,20.4545406 115.644091,19.3100606 115.644091,17.7759705 Z M116.910348,9.8133102 C116.910348,8.86363075 116.17981,8.0357105 114.377825,8.0357105 L110.603378,8.0357105 L109.751081,12.0292201 L113.720347,12.0292201 C115.81455,12.0292201 116.910348,10.9821403 116.910348,9.8133102 Z" id="Shape_11_"></path>
                      <path d="M146.789339,8.76623044 C142.820083,8.76623044 140.092742,11.1282408 139.191745,15.5357105 C138.802126,17.4350606 137.365401,24.1071403 137.365401,24.1071403 L141.091139,24.1071403 C141.091139,24.1071403 142.454814,17.7516204 142.893133,15.75487 C143.45322,13.1493501 144.841236,12.2483796 146.69193,12.2483796 C147.300717,12.2483796 147.665986,12.3214298 147.860795,12.3457799 C147.958196,11.8100694 148.493915,9.44805023 148.615674,8.88798965 C148.226055,8.86363957 147.592918,8.76623044 146.789339,8.76623044 Z" id="Shape_12_"></path>
                      <path d="M159.451988,30 L171.968527,8.76623044 L167.950571,8.76623044 L162.20367,18.75 L160.864354,8.74188037 C160.864354,8.74188037 158.818851,8.74188037 156.554179,8.74188037 C151.610875,8.74188037 149.054002,11.0064904 148.153005,15.316551 C147.690327,17.4594107 146.253602,24.1071315 146.253602,24.1071315 L149.97934,24.1071315 C149.97934,24.1071315 151.343015,17.8003117 151.903085,15.2678508 C152.438822,12.8084314 154.265166,12.0535613 156.23761,12.4675303 L157.016848,8.83928067 C157.601285,12.2727209 159.378911,23.2792113 159.378911,23.2792113 L155.482714,30 L159.451988,30 L159.451988,30 Z" id="Shape_13_"></path>
                      <path d="M64.0437813,17.5811699 C64.871728,17.4594195 67.2581502,17.0941595 67.599069,17.0454594 C67.5260099,17.313319 67.4529597,17.7029291 67.3799095,18.0194889 C66.9415816,19.8701388 65.0665375,21.063319 62.972325,21.063319 C61.633009,21.063319 60.8537712,20.3571492 60.8537712,19.5048788 C60.8294212,18.7987002 61.4869085,17.9464298 64.0437813,17.5811699 Z M62.6314151,13.5876603 C62.7288242,13.4415598 63.6785213,11.9561699 66.0649435,11.9561699 C67.5503688,11.9561699 68.3052565,12.4918804 68.3052565,13.1493501 C68.3052565,14.0746706 66.8198312,14.3181802 64.2142406,14.6834402 C59.7579648,15.3165598 56.9332236,16.7045406 56.9332236,19.9188301 C56.9332236,22.2077903 58.8326178,24.4237002 62.193096,24.4237002 C64.9934872,24.4237002 66.4545624,22.7435096 66.5763216,22.5974003 C66.6006717,23.0113604 66.6493719,23.62013 66.6737308,24.1071403 C66.9902906,24.1071403 69.5715222,24.1071403 70.5212282,24.1071403 C70.399469,23.4496706 70.1072504,22.1590901 70.5699283,20.1136307 C70.8134379,19.0422009 71.4952754,15.9496706 71.8361941,14.24513 C72.4936815,11.0064904 70.7160376,8.74188037 66.1867116,8.74188037 C60.3424108,8.74188037 58.6621673,12.9301906 58.3943076,13.5876603 L62.6314151,13.5876603 Z" id="Shape_14_"></path>
                      <path d="M131.862019,19.5292201 C131.715918,19.8214298 130.814921,21.0876603 128.793759,21.0876603 C125.871617,21.0876603 125.214139,18.6038995 125.28718,17.9464298 C126.845665,17.9464298 135.831275,17.9464298 136.659213,17.9464298 C136.732272,17.6785702 136.975791,16.6558493 136.975791,15.6087696 C136.975791,12.00487 134.540668,8.71753912 129.621714,8.71753912 C125.11673,8.71753912 121.512742,12.4918892 121.512742,16.9967592 C121.512742,21.3311787 124.118324,24.423709 128.745059,24.423709 C134.443259,24.423709 135.977393,19.9675391 136.123494,19.5292289 C135.100738,19.5292201 131.862019,19.5292201 131.862019,19.5292201 Z M129.670406,12.1266204 C132.178587,12.1266204 133.128284,13.6607105 133.030884,14.8782408 C131.594159,14.8782408 127.308342,14.8782408 125.84725,14.8782408 C126.042068,14.0990295 127.235283,12.1266204 129.670406,12.1266204 Z" id="Shape_15_"></path>
                      <path d="M171.979978,19.5027334 C173.12535,19.5027334 174.087452,20.4108465 174.087452,21.6216668 C174.087452,22.8557689 173.10243,23.7406002 171.979978,23.7406002 C170.834615,23.7406002 169.849603,22.8324871 169.849603,21.6216668 C169.849603,20.4108465 170.834615,19.5027334 171.979978,19.5027334 Z M171.979978,19.8520043 C171.017877,19.8520043 170.26193,20.620409 170.26193,21.6216668 C170.26193,22.6462064 171.017877,23.4146111 171.979978,23.4146111 C172.942098,23.4146111 173.675125,22.6694882 173.675125,21.6216668 C173.675125,20.620409 172.919178,19.8520043 171.979978,19.8520043 Z M171.52183,22.8557689 L171.155316,22.8557689 L171.155316,20.4108465 L172.071613,20.4108465 C172.644299,20.4108465 172.919178,20.620409 172.919178,21.109397 C172.919178,21.5518126 172.644299,21.7380934 172.277768,21.7846569 L172.964991,22.8557689 L172.552655,22.8557689 L171.911246,21.7846569 L171.49891,21.7846569 L171.49891,22.8557689 L171.52183,22.8557689 Z M171.521821,21.4819585 L171.957076,21.4819585 C172.415225,21.4819585 172.552664,21.3422501 172.552664,21.0861152 C172.552664,20.8532621 172.438127,20.7135538 172.025792,20.7135538 L171.521821,20.7135538 L171.521821,21.4819585 L171.521821,21.4819585 Z" id="Shape_16_"></path>
                  </g>
              </g>
          </g>
      </svg>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/cybersecurity">Cybersecurity</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/automotive">Automotive & IOT</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/critical-event-management">Critical Communications</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/blackberry-news">Inside BlackBerry</a>
          </li>
        </ul>
  
  
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            
            <a class="nav-link open-search-btn" role="button">
              <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                </path>
              </svg>
            </a>
            <div id="searchOverlay" class="search-overlay">
              <span class="close-search-btn" title="Close Search">×</span>
              <div class="overlay-content">
                <form id="search-form">
                  <input id="search-form--input" description="Search" data-search-url="https://blogs.blackberry.com/en/search" type="text" placeholder="Search" name="search"/>
                  <button type="submit">
                    <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                      <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                      </path>
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>



<!-- END DO NOT INDEX -->



<!-- END DO NOT INDEX -->

    
    
    <div class="hero">

      <div class="jumbotron mastheadDefault">
        <div class="hero-container narrower" style="background-image: url( \2f content\2f dam\2f blackberry-com\2fImages\2fsupport\2f bgs\2f bnr-blue-gradient-crop.jpg)">
          
          <div class="mask  "></div>

          <div class="container headings  l-align">
            <div class="col-lg-12">
          		




    
    
    <div class="blog-name-title">

  <div class="cmp-title ">
  
  
   <!-- <span class="highlighted-text-title blogs">INSIDE</span>
   <span class="normal-text-title">BlackBerry Blog</span> -->
   <span class="normal-text-title">BlackBerry Blog</span>
  
  
  
</div>
</div>



          	</div>
          </div>
      </div>
    </div>
</div>



</header><main>
    




    
    
    <div class="section">
  <section class="section     ">
    
    <div class="container">
        




    
    
    
<ol class="breadcrumb">
    <li class="breadcrumb-item ">
        <a href="/en.html">BlackBerry Blog</a>
    </li>

    <li class="breadcrumb-item active">
        Threat Thursday: Agent Tesla Infostealer
    </li>
</ol>

    


      
    </div>
  </section>
    

</div>


    
    
    <div class="blogsection">
    <section class="section     ">
      
      <div class="container sectionPadding py-0">
           
      <div class="col-md-9 col-lg-9 col-sm-12">
          




    
    
    <div class="cmp cmp-title blog-title row">
  

<div class="col-md-12 col-lg-12 col-sm-12">
<h1>How Agent Tesla Works</h1>
</div>



    
</div>


    
    
    <div class="categorydateauthor"><!--Pulling author bio from author page-->
<div class="categorydateauthor">
<span><a title="RESEARCH &amp; INTELLIGENCE" href="/en/category/research-and-intelligence">RESEARCH &amp; INTELLIGENCE</a> / </span><span class='publish-date'></span>06.24.21 / </span>

    <span class="author"><a href="/en/author/the-blackberry-research-and-intelligence-team">The BlackBerry Research &amp; Intelligence Team</a></span>

</div></div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware&text=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware&title=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&body=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image.coreimg{.width}.jpeg/1690331011867/041221-agent-tesla-875x530-ibb.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/04/041221-agent-tesla-875x530-ibb.jpg" data-asset-id="182f6473-d0b4-417c-972e-bbe38f5537f5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/04/041221-agent-tesla-875x530-ibb.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <h3><b>Summary</b></h3>
<p><a title="Agent Tesla" href="https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/agent-tesla">Agent Tesla</a> is an extremely popular information-stealing Trojan that is being sold and distributed across a number of underground hacking forums and platforms. It is highly customizable, which allows threat actors to tailor it to their particular needs.</p>
<p>First seen in-the-wild in 2014, Agent Tesla has gone through many iterations, developing new capabilities for causing mayhem and escaping detection along the way. It has used these features to maintain itself as one of the most prevalent <a title="Remote Access Trojan" href="https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/remote-access-trojan">Remote Access Trojans (RAT)</a> across the cyber threat-landscape.</p>
<p><i>Read our original writeup on “Secret” Agent Tesla </i><a href="https://blogs.blackberry.com/en/2020/04/threat-spotlight-secret-agent-tesla" target="_blank"><i>here.</i></a></p>
<h3><b>Operating System</b></h3>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_614319247.coreimg{.width}.png/1690331011872/new-agent-tesla-table01-edit.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-table01-edit.png" data-asset-id="46d0ae76-d2a3-4ba1-976f-8375c66b13a0" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-table01-edit.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <h3><b>Risk &amp; Impact</b></h3>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1747695258.coreimg{.width}.png/1690331011878/new-agent-tesla-table02-edit.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-table02-edit.png" data-asset-id="c3ce7f91-0689-423e-8862-23639c5b5c2c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-table02-edit.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p>Due to its prevalence, ready availability, and highly sophisticated nature, Agent Tesla has a high impact rating.</p>
<h3><b>Malware-as-a-Service</b></h3>
<p>Agent Tesla was first available for purchase from an official website agenttesla[.]com. This website offered cybercriminals and threat actors flexible pricing options and fixed term licenses to use the malware. Paying users would get a sophisticated graphical user interface and a dashboard for management of victim devices, providing ease-of-use for even the most novice of threat actors.</p>
<p>Currently, there are two prominent variants of Agent Tesla still found in-the-wild:</p>
<ul>
<li><b>Version 2 </b>– First released version of the malware, with a focus on obfuscation and anti-analysis.</li>
<li><b>Version 3</b> – Additional customization options, advances in obfuscation and further functionality.</li>
</ul>
<p>Both variants have varying levels of obfuscation. In version 2, a single function decrypts all the strings and allows them to be executed. In version 3, each encrypted string has its own function, which makes reverse engineering these static strings more difficult.</p>
<p>Both versions of the malware can communicate over HTTP, SMTP, and FTP. Recent variants of Agent Tesla version 3 have been seen abusing the chat platform Telegram. This latter version also provides the option to use a Tor client to encrypt communications.</p>
<h3>Infection Vector</h3>
<p>Agent Tesla can be dropped onto a victim’s machine in a wide array of ways. Email attachment&nbsp;is its most common deployment vector. These lure attachments can&nbsp;differ greatly with the aim of generating a click by a potential victim and&nbsp;initiating its malicious payload.&nbsp;</p>
<p>This malware has been observed dropping from&nbsp;weaponized documents that contain&nbsp;a&nbsp;malicious&nbsp;payload&nbsp;that downloads Agent Tesla,&nbsp;or&nbsp;it may deploy&nbsp;itself&nbsp;via an executable&nbsp;email&nbsp;attachment.</p>
<p>This large degree of flexibility is another reason why the malware is still such a prevalent threat, even years after its initial release.</p>
<p>Once deployed on a victim’s device, the malware will initially fingerprint the device to confirm infection, sending this information back to its Command and Control (C2) before carrying out its large magnitude of malicious information stealing capabilities. </p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_953011463.coreimg{.width}.png/1690331011885/new-agent-tesla-fig01.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig01.png" data-asset-id="b830268e-98bc-490c-afde-df6bae9db52e" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig01.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 1: Example of Infection vector process flow.</i></p>
<p>Below is a screenshot of a typical spam email used by Agent Tesla. This email includes a RAR archive attachment (.rar), which is the initial step in this sample’s multi-stage infection process. The attachment masquerades as something of interest to the user, and has a suffix of ‘_pdf’ before the file extension. This naming convention is an attempt to fool the victim into believing they are opening a PDF document and not a malicious archive.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1568564112.coreimg{.width}.png/1690331011890/new-agent-tesla-fig02.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig02.png" data-asset-id="39936d29-89fe-4027-94bb-64b494972cdb" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig02.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 2: Recent Mal spam email.</i></p>
<p>Within this RAR archive is another disguised EXE file. The executable file also uses the suffix ‘_pdf’ before the file extension.</p>
<p>This behavior can be seen in Figure 3. The bundled EXE file is a Nullsoft Scriptable Installer. When it is run, it launches several processes that use ‘Living off the Land’ (LotL) techniques to harvest information.</p>
<p>Living off the Land techniques maliciously abuse native system programs and tools found on a victim’s machine. Samples of Agent Tesla use these techniques in a wide range of ways to both insert the malware onto a victim machine, and to use native system commands to obtain device information.</p>
<p>This information can then be utilized by the malware and exfiltrated:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_905109730.coreimg{.width}.png/1690331011896/new-agent-tesla-fig03.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig03.png" data-asset-id="2853fa31-e62d-45bd-80eb-890e50ae509f" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig03.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 3: Content of malicious RAR archive.</i></p>
<p>The lures used by attackers can differ greatly depending on the requirements of the potential victim. The malware can also arrive as a weaponized document that contains a malicious macro payload, which downloads Agent Tesla.</p>
<h3><b>Deployment</b></h3>
<p>If the malicious attachment is executed by the user, the executable downloads additional components. These components are often hosted on legitimate websites, which also helps them evade detection by security products and services.</p>
<p>In one Agent Tesla loader sample observed by the BlackBerry Research Team, the file masqueraded as a Databasic. This is a C#/VB.NET database utility developed by Czech freelance developer and trainer known as <a href="https://github.com/Databasic-NET/Databasic" target="_blank">Tom Fidlr</a>:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_659117616.coreimg{.width}.png/1690331011902/new-agent-tesla-fig04.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig04.png" data-asset-id="fbd6f3e0-abea-46ea-8eec-0417c1d7e01f" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig04.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 4: Embedded file version information.</i></p>
<p>Agent Tesla employs many techniques to help evade detection and impede analysis. Examining the binary in a .NET decompiler shows that the file’s function names and strings are heavily obfuscated. Based on the namespace labels and assembly comments, it appears the sample has been obfuscated with SmartAssembly 7.3.0.3296:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_311434946.coreimg{.width}.png/1690331011908/new-agent-tesla-fig05.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig05.png" data-asset-id="09073eb5-67e3-4fc2-9357-fe7339cdbb19" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig05.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 5: File Obfuscation visible in DNSpy.</i></p>
<p>Included with the file’s resources is a PNG image. Agent Tesla uses steganography techniques, where an image contains an embedded Program Executable (PE) image that is dynamically decoded:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1490066450.coreimg{.width}.png/1690331011914/new-agent-tesla-fig06.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig06.png" data-asset-id="cb4c2792-c722-42db-873b-7c783488e634" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig06.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 6: Malicious PNG resource.</i></p>
<p>The obfuscated PE image contains a .NET DLL file, which is the next step in the installation process. Once the PE image has been de-obfuscated during runtime, it calls the SelectorX method in SimpleUI.MDI:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2023865137.coreimg{.width}.png/1690331011920/new-agent-tesla-fig07.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig07.png" data-asset-id="02d1e1ce-919a-4cc2-b963-82f13c93737c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig07.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 7: Second stage Agent Tesla loader.<br>
<br>
</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1904880496.coreimg{.width}.png/1690331011926/new-agent-tesla-fig08.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig08.png" data-asset-id="71f00340-d7b3-449d-91bf-5096343cc1ec" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig08.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 8: .NET DLL calling SelectorX.</i></p>
<p>As part of Agent Tesla’s layered approach, this decoded DLL calls another loader. This loader launches a legitimate Microsoft .NET services installation tool (RegSvcs.exe) in a suspended state:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2132749337.coreimg{.width}.png/1690331011932/new-agent-tesla-fig09.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig09.png" data-asset-id="4a9360b0-9b0c-4350-b61c-aa138f18b179" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig09.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 9: Code Injection into Regsvcs.exe.</i></p>
<p>Using the technique called process hollowing, Agent Tesla unmaps the memory of RegSvcs.exe and overwrites this memory space with its malicious code before resuming the suspended thread. In allows the malware to mask its activities as a legitimate process.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_515191361.coreimg{.width}.png/1690331011938/new-agent-tesla-fig10.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig10.png" data-asset-id="cc0ce770-4191-4b95-9677-b2836819d7ef" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig10.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 10: Write Process Memory for PE header.<br>
<br>
</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_541637293.coreimg{.width}.png/1690331011944/new-agent-tesla-fig11.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig11.png" data-asset-id="bd4f99ad-db54-46b1-bbcf-0b128ed8d284" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig11.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 11: Resume Thread call.</i></p>
<p>The new ‘RegSvcs.exe’ then begins searching the host for information such as the active computer name and TCP settings:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1251361697.coreimg{.width}.png/1690331011950/new-agent-tesla-fig12.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig12.png" data-asset-id="6548a00c-13cc-4ee4-95bc-7bf813aa9e9b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig12.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 12: Regsvc.exe searching the host machine.</i></p>
<p>The malware then creates a new folder ‘AvrzbM’ and a file called ‘AvrzbM.exe’ in <b>‘C:\Users\%username%\AppData\Roaming\’</b>. This behaviour differs per sample, depending on how the malware variant is predefined during its creation:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1452781449.coreimg{.width}.png/1690331011956/new-agent-tesla-fig13.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig13.png" data-asset-id="b14ca5ca-41e9-4115-a04e-26ec0413794b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig13.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 13: Copy of 'RegSvc.exe' is created in %AppData% directory under the defined named 'AvzbM.exe'.</i></p>
<p>The malware creates the following registry key to achieve persistence:</p>
<p><b>“HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\”</b> location.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1731245387.coreimg{.width}.png/1690331011962/new-agent-tesla-fig14.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig14.png" data-asset-id="c92e9be4-53df-48a7-ba6e-3a2cd24baf5b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig14.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 14: Additional Persistence Mechanisms.</i></p>
<p>The threat will search through the victim’s machine for a pre-defined list of specific software and utilities. These lists tend to vary per sample, but they can be quite long. The goal of this functionality is to locate software to steal information from, by extracting saved credentials. This stolen information is stored for later exfiltration.</p>
<h3><b>Browser Stealing Activities</b></h3>
<p>The first set of utilities the malware searches for are web browsers. Most Agent Tesla samples contain a large, predefined list of Internet browsers that the malware attempts to find on the victim’s machine. If those browsers are located, the threat targets the place where their credentials are stored, and sends them back to the threat actor.</p>
<p>Agent Tesla looks for the presence of both popular web-browsers like Chromium and Firefox as well as more uncommon web-browsers.</p>
<p>Please see <b>Appendix A</b> for the observed list.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_917580264.coreimg{.width}.png/1690331011968/new-agent-tesla-fig15.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig15.png" data-asset-id="6cf5be0b-ad48-459d-b95d-0990c1139ffb" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig15.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 15: Searching the victim’s machine for stored credentials.</i></p>
<h3><b>Email Stealing Activities</b></h3>
<p>Agent Tesla will search through the device for the presence of a list of different email clients. If it finds them, it will attempt to deploy several measures depending on the specific client, to steal its login credentials before storing them for extraction.</p>
<p>Please see <b>Appendix B </b>for the observed list.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1855749547.coreimg{.width}.png/1690331011974/new-agent-tesla-fig16.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig16.png" data-asset-id="99899f70-719f-439a-a3dc-81fd8912d64b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig16.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 16: Searching for email utilities.</i></p>
<h3><b>FTP Utility Stealing Activities</b></h3>
<p>FTP utilities are also targeted for the purpose of stealing login credentials. If an FTP utility is present on the victim’s device, Agent Tesla will attempt to obtain that information while also targeting other information unique to specific applications, which we discuss in more detail in the FileZilla section.</p>
<p>Please see <b>Appendix C </b>for the observed list.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_11368569.coreimg{.width}.png/1690331011980/new-agent-tesla-fig17.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig17.png" data-asset-id="778e295a-5582-4890-890a-64d8433077b8" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig17.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 17: Searching for FTP utilities.</i></p>
<h3><b>VPN Client and Miscellaneous Stealing Activities</b></h3>
<p>Because Agent Tesla is highly customizable, some samples also include the ability to search for other software and utilities on a victim’s machine. For example, some Agent Tesla Version 3 samples steal credentials of VPN clients, along with those of downloading tools and remote server desktop applications.</p>
<p>Please see <b>Appendix D &amp; E </b>for the observed list of additional tools and applications.</p>
<h3><b>Exfiltration</b></h3>
<p>Once the malware has retrieved all available credentials and other assorted data from a victim’s machine, it sends this information over email/SMTP protocol using a hardcoded port 587:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_346142090.coreimg{.width}.png/1690331011986/new-agent-tesla-fig18.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig18.png" data-asset-id="b6041ec6-29e6-47c6-acd3-a0a017ec9441" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig18.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 18: Sample utilizes SMTP via port 587.<br>
<br>
</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_113622560.coreimg{.width}.png/1690331011992/new-agent-tesla-fig19.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig19.png" data-asset-id="56c0c2dc-4bc1-4b81-ad05-5eeaa5372655" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig19.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 19: Network capture of initial SMTP communication.</i></p>
<h3><b>Communication</b></h3>
<p>Both Version 2 and Version 3 of Agent Tesla can be configured to communicate over HTTP, SMTP, and FTP. The threat actor selects this configuration when building a new malicious sample.</p>
<p>In Version 3 of the malware, Agent Tesla added an additional form of communication. It abuses the popular Instant Messenger (IM) Telegram to communicate with its Command and Control (C2) infrastructure.</p>
<p>Most Agent Tesla samples abuse SMTP as their desired communication method.</p>
<p>Though the information-stealing capabilities operate in a similar manner across all forms of communication, the way data is exfiltrated can vary depending on both version of the malware and configuration of a specific sample:</p>
<table cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Communication</b></p>
</td>
<td width="482" valign="top"><p><b>Description</b></p>
<p><b>&nbsp;</b></p>
</td>
</tr><tr><td width="141" valign="top"><p><b>SMTP</b></p>
</td>
<td width="482" valign="top"><p>Compromised email accounts are utilized to exfiltrate information to a mail server operated by malicious actors.</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="141" valign="top"><p><b>HTTP</b></p>
</td>
<td width="482" valign="top"><p>Sends compromised data to web panel operated by malicious actors.</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="141" valign="top"><p><b>FTP</b></p>
</td>
<td width="482" valign="top"><p>Upload data to a malicious controlled FTP server.</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="141" valign="top"><p><b>Telegram</b></p>
</td>
<td width="482" valign="top"><p>Exfiltrate data via maliciously setup Telegram chat rooms. (Version 3 only)</p>
<p>&nbsp;</p>
</td>
</tr></tbody></table>
<p><br>
Agent Tesla is heavily obfuscated to avoid initial static analysis steps. This can hide the malicious code and its true intentions when it is run in a malware sandbox. After we decoded it, we were able to observe it statically to understand its inner workings and capabilities, such as the SMTP form of exfiltration as seen in the image below (Figure 20).</p>
<p>This observed sample uses SMTP as its form of exfiltration. This protocol is often used because there is limited overhead required by the attacker, as the threat actor only needs a single compromised email account to accomplish their malicious activities:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2132742858.coreimg{.width}.png/1690331011998/new-agent-tesla-fig20.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig20.png" data-asset-id="9d76855b-b65f-4278-b185-8c8af405a30a" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig20.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 20: Example of SMTP exfiltration process.</i></p>
<h3><b>Fingerprinting</b></h3>
<p>Agent Tesla gathers information from the infected machine for tagging a new infection and ‘fingerprinting’ the victim’s machine, to indicate that it has been compromised.</p>
<p>This data includes:</p>
<ul>
<li>Computer Name</li>
<li>User’s Name</li>
<li>IP information</li>
<li>Internet Connectivity</li>
<li>Processor name and information</li>
<li>Memory</li>
<li>Operating System</li>
</ul>
<p>In samples observed by the BlackBerry Research Team, Agent Tesla makes a HTTP Request to ‘api[.]ipify[.]org’. This is a public web API that returns the external IP address of the victim’s device. The IP address is stored by the threat actor, and it is used in the malware’s user-interface when they are interacting with the information they have exfiltrated with the malware:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_65282424.coreimg{.width}.png/1690331012004/new-agent-tesla-fig21.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig21.png" data-asset-id="07756878-7658-411a-b622-9745dcb8677c" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig21.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 21: Agent Tesla reaches out to 'api[.]ipify[.]org.</i></p>
<h3><b>Core Commands</b></h3>
<p>Both Agent Tesla Version 2 and Version 3 contain a set of core commands for information stealing and gathering. The malware’s primary goals are keylogging and gathering screenshots, as well as stealing cookies and credentials.</p>
<p>The specifics of these commands, and which applications the threat focuses on, can vary from sample to sample:<b></b></p>
<table cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="83" valign="top"><p><b>String Command</b></p>
</td>
<td width="134" valign="top"><p><b>Command Action</b></p>
</td>
<td width="406" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td width="83" valign="top"><p><b>KL</b></p>
</td>
<td width="134" valign="top"><p>Keyboard Logging</p>
</td>
<td width="406" valign="top"><p>Record keystrokes, periodically logging and dating them before sending stolen info to its C2.</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="83" valign="top"><p><b>SC</b></p>
</td>
<td width="134" valign="top"><p>Screenshot Gather</p>
</td>
<td width="406" valign="top"><p>Screenshot images of victim’s screen, saving and dating them before periodically sending them to C2</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="83" valign="top"><p><b>PW</b></p>
</td>
<td width="134" valign="top"><p>Credential Stealing</p>
</td>
<td width="406" valign="top"><p>Heavily varies per-sample; attempts to steal user and password logins from a wide-range of applications and utilities.</p>
<p>&nbsp;</p>
</td>
</tr><tr><td width="83" valign="top"><p><b>CO</b></p>
</td>
<td width="134" valign="top"><p>Cooking Stealing</p>
</td>
<td width="406" valign="top"><p>Customizable, attempts to steal cookie information from a wide range of Internet browsers.</p>
<p>&nbsp;</p>
</td>
</tr></tbody></table>
<p><b>&nbsp;</b></p>
<h3><b>Uninstall</b></h3>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1489150491.coreimg{.width}.png/1690331012010/new-agent-tesla-fig22.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig22.png" data-asset-id="d381d441-d788-40c7-b4bb-62f5915e93e5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig22.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 22: Uninstaller functionality.</i></p>
<p>Some samples of Agent Tesla have further commands and capabilities, such as the malware having the ability to uninstall itself.</p>
<p>This functionality could be used by Agent Tesla to briefly infect a victim’s machine, exfiltrate data, and then remove its presence from a device, with these interactions going unnoticed by the victim.</p>
<h3><b>Cookies</b></h3>
<p>Agent Tesla attempts to gather browser cookies from a list of predefined browsers. These cookies are sent back to the C2 server so that attackers can look for any login credentials or other sensitive information that might be present:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2140767777.coreimg{.width}.png/1690331012016/new-agent-tesla-fig23.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig23.png" data-asset-id="8b8d443b-1f8c-40f1-be63-e517484a1b04" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig23.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 23: Gathering cookies from predefined Internet browsers.</i></p>
<p>Agent Tesla will also gather any cookies from the SQLite cookies database for the list of predefined browsers seen below:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_34429930.coreimg{.width}.png/1690331012022/new-agent-tesla-fig24.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig24.png" data-asset-id="55af1e43-f16e-495c-87d0-6e3a66ef988e" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig24.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 24: Gathering cookies from SQLite directories of predefined Internet browsers.</i></p>
<p>This threat also gathers additional information from the “\User Data” directory of the predefined browsers listed below:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_861778941.coreimg{.width}.png/1690331012028/new-agent-tesla-fig25.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig25.png" data-asset-id="230c8e37-1f52-459e-b835-e285868ac6f1" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig25.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 25: Gathering information from \Users Data directory of predefined Internet browsers.</i></p>
<p>The malware searches the “\CoreFTP\site” directory to grab usernames and passwords for FTP applications:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1899557464.coreimg{.width}.png/1690331012034/new-agent-tesla-fig26-edit.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig26-EDIT.png" data-asset-id="01e3f100-e0b5-4e63-adac-36a8cca673cf" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig26-EDIT.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 26: FTP application credential-grabbing.</i></p>
<p>The malware searches for any browser credentials:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_626422525.coreimg{.width}.png/1690331012040/new-agent-tesla-fig27.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig27.png" data-asset-id="7603f9ac-9a07-4e22-9b1a-5280bb597f58" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig27.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 27: Internet browser credential-grabbing.</i></p>
<h3><b>Keystrokes</b></h3>
<p>Keystrokes are also recorded and sent to the C2 server in the hopes that further sensitive information can be obtained from the victim's machine:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1744957994.coreimg{.width}.png/1690331012046/new-agent-tesla-fig28.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig28.png" data-asset-id="a4796593-1431-4d2f-9f93-667b6b38738b" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig28.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 28: Keylogging functionality.</i></p>
<h3><b>Clipboard</b></h3>
<p>Agent Tesla can also harvest data from the system clipboard. It does this by calling the APIs ‘SetClipboardViewer’ to register itself, so that it is alerted whenever data is updated on the clipboard:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1565061674.coreimg{.width}.png/1690331012052/new-agent-tesla-fig29.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig29.png" data-asset-id="47cd844d-20ae-494d-82a5-a2d1efbf71b2" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig29.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 29: Clipboard harvesting functionality.</i></p>
<p>To display the functionality of the clipboard stealer found in Agent Tesla, a sentence was typed out and copied to the clipboard on a test victim machine:</p>
<p>“<b>This is an example of the clipboard stealer</b>”</p>
<p>This information was exfiltrated and observed before being decoded to reveal the stolen clipboard information. It is further noted that Agent Tesla will label the stolen clipboard contents with the tag [Clipboard] for ease of use by the threat actor.</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2085381036.coreimg{.width}.png/1690331012058/new-agent-tesla-fig30.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig30.png" data-asset-id="f86edd8d-8817-46ea-95d4-a8c000e90d26" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig30.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 30: URL Decoded information.</i></p>
<h3><b>Screenshots</b></h3>
<p>The screenshot exfiltration function allows the malware to capture an image of the infected machine. It sends the image back to the C2 server as a JPEG image:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_935553773.coreimg{.width}.png/1690331012064/new-agent-tesla-fig31-edit.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig31-edit.png" data-asset-id="fb95c5c4-8709-4ac4-a740-8df46721ad1f" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig31-edit.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 31: Malware screenshot functionality.</i></p>
<p>Exfiltrated information is sent back to Agent Tesla’s C2 server as Triple DES-EDE3 encrypted data. This data can be captured, parsed, and decrypted, revealing a further layer of obfuscation as these stolen images are transported as Base64 encoded data.</p>
<p>This data can be decoded and rendered to reveal the screen capture the malware took on the victim’s device, as seen in Figure 32:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1010810144.coreimg{.width}.png/1690331012070/new-agent-tesla-fig32.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig32.png" data-asset-id="c24bbef5-7bc6-4e9e-bcfa-e7e2dbc7b34f" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig32.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 32: Decoded image data sent back to the C2 server.</i></p>
<h3><b>FTP</b></h3>
<p>FTP usernames and passwords are harvested and sent via a STOR Request. A STOR request is issued after a data connection has been established and a victim client wishes to upload a local copy of a file to a server. </p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1752427379.coreimg{.width}.png/1690331012076/new-agent-tesla-fig33.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig33.png" data-asset-id="749b49fc-e985-48d3-965d-a4cc658192f4" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig33.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 33: FTP credential stealing functionality.</i></p>
<h3><b>Open-VPN</b></h3>
<p>The malware then searches the Open-VPN directory “Software\OpenVPN-GUI\configs” for further potential credentials:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_2084241526.coreimg{.width}.png/1690331012082/new-agent-tesla-fig34.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig34.png" data-asset-id="198d09eb-8ef0-4fbe-86d2-e98ee2a891a7" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig34.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 34: Open-VPN credential grabbing.</i></p>
<h3><b>NordVPN</b></h3>
<p>Just like above, the malware searches the NordVPN configuration folder for usernames and passwords:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1280484222.coreimg{.width}.png/1690331012088/new-agent-tesla-fig35.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig35.png" data-asset-id="548bf3ea-cf68-44f5-8ea3-1e7398d354f8" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig35.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 35: NordVPN credential grabbing.</i></p>
<h3><b>FileZilla</b></h3>
<p>Agent Tesla searches the FileZilla ‘recent servers’ folder within the “\AppData” directory for information related to recently established connections with FTP servers. It gathers the hostname, port number, and username:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1372417541.coreimg{.width}.png/1690331012094/new-agent-tesla-fig36.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig36.png" data-asset-id="6d111600-c685-4140-86a4-09fa002831c5" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig36.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 36: FileZilla recent-server grabbing.</i></p>
<h3><b>Outlook</b></h3>
<p>Agent Tesla variants can now attempt to steal email addresses and login credentials. This can be used as a pivoting point to illicitly login to a victim’s email clients, to gather and steal the contents.</p>
<p>Here, we see Agent Tesla looking for Registry Keys that signify that Microsoft Outlook is installed and used on the device by the victim, before attempting to harvest password information:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1414896333.coreimg{.width}.png/1690331012100/new-agent-tesla-fig37.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig37.png" data-asset-id="7b37b33a-2a5b-4f70-baa6-ad6774f922df" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig37.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <i>Figure 37: Outlook credential grabbing (1 of 2).<br>
<br>
</i>
    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1215959111.coreimg{.width}.png/1690331012106/new-agent-tesla-fig38.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig38.png" data-asset-id="36e85aa5-6fe5-4323-b85d-76284dcce648" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig38.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 38: Outlook credential grabbing (2 of 2).</i></p>
<h3><b>Tor Proxy</b></h3>
<p>Version 3 of Agent Tesla uses the Tor client in order to conceal communications. The malware already encrypts all C2 traffic, but using Tor further anonymizes its actions.</p>
<p>Tor is an open-source networking client that is designed to enable anonymous connection and communication. Tor itself promotes the use of concealing location and usage from traffic analysis and networking monitoring.</p>
<p>Agent Tesla V3 reaches out to the official Tor website to download the client. It also checks to see if the Tor client is either present on the device or currently running. If so, the malware attempts to kill this process and download a new one. It attempts to alter the default configuration file of Tor, which is known as ‘torrc’: <i><br>
 </i></p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1714624649.coreimg{.width}.png/1690331012112/new-agent-tesla-fig39.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig39.png" data-asset-id="f060a470-e914-42ee-85ea-07dacadbb2a3" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig39.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 39: Downloading of Tor Client.</i></p>
<p>These alterations will create a localized Tor proxy on port 9050, once its de-obfuscated. This port number was hardcoded in the observed sample:</p>

    
    
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2021/06/threat-thursday-agent-tesla-infostealer-malware/_jcr_content/main/par/sectionblog/par/image_1437959858.coreimg{.width}.png/1690331012118/new-agent-tesla-fig40.png" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig40.png" data-asset-id="91e6319e-0097-4e81-977e-579d6f731ef2" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2021/06/new-agent-tesla-fig40.png" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <p><i>Figure 40: Utilization of the Tor proxy.</i></p>
<h3><b>Conclusion</b></h3>
<p>There has been a recent resurgence in Agent Tesla samples in the wild, despite it previously having been reported to be on the decline and no longer for sale.</p>
<p>The same distribution methods have prevailed, and recently discovered samples have been distributed using spam emails and malicious attachments.</p>
<p>The samples we observed used several techniques to avoid detection. They abuse genuine email servers to steal as much information as possible. The latest versions of this threat add the ability to customize how information is exfiltrated, and include new forms of communication.</p>
<h3><b>Yara Rule</b></h3>
<p>The following Yara rule was authored by the BlackBerry Threat Research Team to catch the threat described in this document:</p>
<table cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="623" valign="top"><p>import &quot;pe&quot;</p>
<p>rule Mal_InfoStealer_Win32_AgentTesla_2021<br>
{<br>
&nbsp;&nbsp;&nbsp; meta:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = &quot;Detects AgentTesla V3&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; author = &quot;BlackBerry Threat Research Team &quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date = &quot;2021-06&quot;<br>
<br>
&nbsp;&nbsp;&nbsp; strings:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $x1 = &quot;get_Provider&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $x2 = &quot;PADPADP&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $x3 = &quot;/VB.NET database utility&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $x4 = &quot;v4.0.30319&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $x5 = &quot;.cctor&quot;</p>
<p>&nbsp;&nbsp;&nbsp; condition:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //PE File<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16(0) == 0x5a4d and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // DotNet<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pe.imports(&quot;mscoree.dll&quot;, &quot;_CorExeMain&quot;) and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // File imphash<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pe.imphash() == &quot;f34d5f2d4577ed6d9ceec516c1f5a744&quot; and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // PE Sections<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pe.number_of_sections == 3 and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Checksum is not set and does not match<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pe.checksum != pe.calculate_checksum() and</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //All Strings<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all of ($x*)<br>
}</p>
</td>
</tr></tbody></table>
<p><b>&nbsp;</b></p>
<h3><b>Indicators of Compromise (IoCs)</b><br>
</h3>
<p>At BlackBerry, we take a <a href="https://blogs.blackberry.com/en/2021/01/from-aspiration-to-realization-the-evolution-of-the-prevention-first-approach-to-security" target="_blank">prevention-first</a> and AI-driven approach to cybersecurity. Putting prevention first neutralizes malware before the exploitation stage of the kill-chain.</p>
<p>By stopping malware at this stage, BlackBerry solutions help organizations increase their resilience. It also helps reduce infrastructure complexity and streamline security management to ensure business, people, and endpoints are secure.</p>
<table cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="623" valign="top"><p>Due to Agent Tesla being so customizable, this information tends to vary between samples:</p>
<p><b>File System Actions:</b><br>
Created</p>
<ul>
<li>C:\Users\%username%\AppData\Roaming\%AvrzbM%\%AvrzbM.exe%</li>
</ul>
<p><b>Registries:</b><br>
Created<br>
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\%AvrzbM%<br>
Value: C:\Users\%username%\AppData\Roaming\%AvrzbM%\%AvrzbM.exe%</p>
<p><b>Mutex:</b><br>
%FciEzCUbpfPiIrzZAOtOj%</p>
<p><b>Network:</b><br>
</p>
<ul>
<li>Protocol: smtp</li>
<li>Host: mail[.]rakub[.]org[.]bd</li>
<li>Port: 587</li>
</ul>
</td>
</tr></tbody></table>
<h3>&nbsp;</h3>
<h3><b>Appendix A<br>
 <br>
</b></h3>
<table width="614" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Software Name</b></p>
</td>
<td width="472" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td colspan="2" width="614" valign="top"><p><b>Browsers</b></p>
</td>
</tr><tr><td width="141" valign="top"><p>CocCoc</p>
</td>
<td width="472" valign="top"><p>Freeware browser focused on the Vietnamese region/market</p>
</td>
</tr><tr><td width="141" valign="top"><p>Pale Moon</p>
</td>
<td width="472" valign="top"><p>Open Source, Mozilla-derived web browser available for Microsoft® Windows and Linux</p>
</td>
</tr><tr><td width="141" valign="top"><p>Firefox</p>
</td>
<td width="472" valign="top"><p>Web-browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Flock</p>
</td>
<td width="472" valign="top"><p>A discontinued web browser that specialized in providing social networking and Web 2.0 facilities built into its user interface</p>
</td>
</tr><tr><td width="141" valign="top"><p>Lieabao</p>
</td>
<td width="472" valign="top"><p>Chinese web browser by KingSoft</p>
</td>
</tr><tr><td width="141" valign="top"><p>Iridium</p>
</td>
<td width="472" valign="top"><p>Web browser based on the Chromium code base</p>
</td>
</tr><tr><td width="141" valign="top"><p>ChromePlus</p>
</td>
<td width="472" valign="top"><p>ChromePlus by MapleStudio is a web browser that tries to offer an improved Chromium version</p>
</td>
</tr><tr><td width="141" valign="top"><p>Chromium</p>
</td>
<td width="472" valign="top"><p>Open-source codebase for web-browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Orbitum</p>
</td>
<td width="472" valign="top"><p>Web browser developed based on Chromium with unique applications for social networks</p>
</td>
</tr><tr><td width="141" valign="top"><p>Coowon</p>
</td>
<td width="472" valign="top"><p>Google Chrome based browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>360Chrome</p>
</td>
<td width="472" valign="top"><p>Web browser made by Chinese company Qihoo 360</p>
</td>
</tr><tr><td width="141" valign="top"><p>Sputnik</p>
</td>
<td width="472" valign="top"><p>Web browser extension which I designed to search IPs, Domains, File Hashes, and URLs using free Open-Source Intelligence (OSINT) resources quickly and easily</p>
</td>
</tr><tr><td width="141" valign="top"><p>Amigo</p>
</td>
<td width="472" valign="top"><p>Web browser based on Chromium and it was created with the intent to surf through social medias with a specially made panel</p>
</td>
</tr><tr><td width="141" valign="top"><p>Opera</p>
</td>
<td width="472" valign="top"><p>Freeware web browser for Microsoft Windows, Android, iOS, macOS, and Linux operating systems, developed by Opera Software</p>
</td>
</tr><tr><td width="141" valign="top"><p>7Star</p>
</td>
<td width="472" valign="top"><p>Chromium-based web browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Torch</p>
</td>
<td width="472" valign="top"><p>Web browser for Windows developed by Torch media, based on Chromium.</p>
</td>
</tr><tr><td width="141" valign="top"><p>Yandex</p>
</td>
<td width="472" valign="top"><p>Russian web browser developed by Yandex</p>
</td>
</tr><tr><td width="141" valign="top"><p>Sleipnir5</p>
</td>
<td width="472" valign="top"><p>A tabbed web browser developed by Fenrir Inc. The browser's main features are customization and tab functions</p>
</td>
</tr><tr><td width="141" valign="top"><p>Vivaldi</p>
</td>
<td width="472" valign="top"><p>Freeware, cross-platform web browser developed by Vivaldi Technologies</p>
</td>
</tr><tr><td width="141" valign="top"><p>Uran</p>
</td>
<td width="472" valign="top"><p>Russian web-browser based on Chromium</p>
</td>
</tr><tr><td width="141" valign="top"><p>Centbrowser</p>
</td>
<td width="472" valign="top"><p>Web browser based on Chromium</p>
</td>
</tr><tr><td width="141" valign="top"><p>Chedot</p>
</td>
<td width="472" valign="top"><p>Web browser based on Chromium</p>
</td>
</tr><tr><td width="141" valign="top"><p>Brave-browser</p>
</td>
<td width="472" valign="top"><p>Free and open-source web browser developed by Brave Software, Inc. based on the Chromium web browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Elements</p>
</td>
<td width="472" valign="top"><p>Web browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>BlackHawk</p>
</td>
<td width="472" valign="top"><p>Web browser created by NETGATE</p>
</td>
</tr><tr><td width="141" valign="top"><p>SeaMonkey</p>
</td>
<td width="472" valign="top"><p>Free and open-source Internet suite. It is the continuation of the former Mozilla Application Suite</p>
</td>
</tr><tr><td width="141" valign="top"><p>CyberFox</p>
</td>
<td width="472" valign="top"><p>Mozilla-based Internet browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>QQBrowser</p>
</td>
<td width="472" valign="top"><p>Web browser with dual engines (WebKit and Trident)</p>
</td>
</tr><tr><td width="141" valign="top"><p>IceCat</p>
</td>
<td width="472" valign="top"><p>The GNU version of the Firefox browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Waterfox</p>
</td>
<td width="472" valign="top"><p>Web-bowser</p>
</td>
</tr><tr><td width="141" valign="top"><p>K-Meleon</p>
</td>
<td width="472" valign="top"><p>Lightweight web-browser for Windows</p>
</td>
</tr><tr><td width="141" valign="top"><p>Chrome</p>
</td>
<td width="472" valign="top"><p>Cross-platform web browser developed by Google</p>
</td>
</tr><tr><td width="141" valign="top"><p>IceDragon</p>
</td>
<td width="472" valign="top"><p>Internet browser based on Mozilla Firefox</p>
</td>
</tr><tr><td width="141" valign="top"><p>Falkon</p>
</td>
<td width="472" valign="top"><p>Open-source web browser built by Qt WebEngine</p>
</td>
</tr><tr><td width="141" valign="top"><p>UCBrowser</p>
</td>
<td width="472" valign="top"><p>Web browser built for low-end computers and slow connections</p>
</td>
</tr><tr><td width="141" valign="top"><p>Edge</p>
</td>
<td width="472" valign="top"><p>Microsoft edge web browser</p>
</td>
</tr><tr><td width="141" valign="top"><p>Citrio</p>
</td>
<td width="472" valign="top"><p>Web browser developed by Catalina Group.</p>
</td>
</tr><tr><td width="141" valign="top"><p>Epic privacy browser</p>
</td>
<td width="472" valign="top"><p>Web browser developed by Hidden Reflex which is based on Chromium</p>
</td>
</tr><tr><td width="141" valign="top"><p>Kometa</p>
</td>
<td width="472" valign="top"><p>Chromium based browser for Russian speaking users</p>
</td>
</tr><tr><td width="141" valign="top"><p>Safari</p>
</td>
<td width="472" valign="top"><p>Windows version of Safari</p>
</td>
</tr><tr><td width="141" valign="top"><p>QIP Surf</p>
</td>
<td width="472" valign="top"><p>Chromium based browser for Russian speaking users</p>
</td>
</tr></tbody></table>
<p><b>&nbsp;</b></p>
<h3><b>Appendix B</b></h3>
<table width="614" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Software Name</b></p>
</td>
<td width="472" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td colspan="2" width="614" valign="top"><p><b>Email &amp; messaging</b></p>
</td>
</tr><tr><td width="141" valign="top"><p>Outlook</p>
</td>
<td width="472" valign="top"><p>Email client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Thunderbird</p>
</td>
<td width="472" valign="top"><p>Free and open-source cross-platform email client, news client, RSS, and chat client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Claws Mail</p>
</td>
<td width="472" valign="top"><p>Claws Mail is an email client (and news reader), based on GTK+</p>
</td>
</tr><tr><td width="141" valign="top"><p>Postbox</p>
</td>
<td width="472" valign="top"><p>A desktop email client, news client and feed reader for Windows and macOS</p>
</td>
</tr><tr><td width="141" valign="top"><p>RimArts B2</p>
</td>
<td width="472" valign="top"><p>Japanese email client - Becky 2</p>
</td>
</tr><tr><td width="141" valign="top"><p>The Bat!</p>
</td>
<td width="472" valign="top"><p>Email client for Windows</p>
</td>
</tr><tr><td width="141" valign="top"><p>Trillian</p>
</td>
<td width="472" valign="top"><p>Instant messaging platform</p>
</td>
</tr><tr><td width="141" valign="top"><p>Foxmail</p>
</td>
<td width="472" valign="top"><p>Email client developed by Tencent</p>
</td>
</tr><tr><td width="141" valign="top"><p>Eudora</p>
</td>
<td width="472" valign="top"><p>Qualcomm e-mail client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Opera Mail</p>
</td>
<td width="472" valign="top"><p>Email client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Mailbird</p>
</td>
<td width="472" valign="top"><p>Desktop email client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Incredimail</p>
</td>
<td width="472" valign="top"><p>Has been discontinued since 20/03/2020</p>
</td>
</tr><tr><td width="141" valign="top"><p>Pocomail</p>
</td>
<td width="472" valign="top"><p>Email client</p>
</td>
</tr><tr><td width="141" valign="top"><p>eM Client</p>
</td>
<td width="472" valign="top"><p>Email client</p>
</td>
</tr></tbody></table>
<p><b>&nbsp;</b></p>
<h3><b>Appendix C</b></h3>
<table width="614" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Software Name</b></p>
</td>
<td width="472" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td colspan="2" width="614" valign="top"><p><b>FTP</b></p>
</td>
</tr><tr><td width="141" valign="top"><p>FlashFXP</p>
</td>
<td width="472" valign="top"><p>FTP client</p>
</td>
</tr><tr><td width="141" valign="top"><p>FTPGetter</p>
</td>
<td width="472" valign="top"><p>Powerful ftp manager for automation of work with ftp servers</p>
</td>
</tr><tr><td width="141" valign="top"><p>CoreFTP</p>
</td>
<td width="472" valign="top"><p>FTP client software with SFTP (SSH), SSL, and TLS support</p>
</td>
</tr><tr><td width="141" valign="top"><p>FTP Navigator</p>
</td>
<td width="472" valign="top"><p>Windows-based Internet application that facilitates FTP transfer by displaying information about the files and directory structure of a remote system in a browsing screen</p>
</td>
</tr><tr><td width="141" valign="top"><p>SmartFTP</p>
</td>
<td width="472" valign="top"><p>FTP client for Windows</p>
</td>
</tr><tr><td width="141" valign="top"><p>FileZilla</p>
</td>
<td width="472" valign="top"><p>FTP solution for both client and server - Recent Server</p>
</td>
</tr><tr><td width="141" valign="top"><p>WinSCP</p>
</td>
<td width="472" valign="top"><p>Free SFTP, SCP, Amazon S3, WebDAV, and FTP client for Windows</p>
</td>
</tr><tr><td width="141" valign="top"><p>PSI /PSI+</p>
</td>
<td width="472" valign="top"><p>Cross-platform powerful XMPP client designed for experienced users. Psi+ is a development branch of Psi XMPP client</p>
</td>
</tr><tr><td width="141" valign="top"><p>IP Switch</p>
</td>
<td width="472" valign="top"><p>FTP Client Server</p>
</td>
</tr><tr><td width="141" valign="top"><p>ws_ftp</p>
</td>
<td width="472" valign="top"><p>File sharing software developed by Ipswich</p>
</td>
</tr></tbody></table>
<h3>&nbsp;</h3>
<h3><b>Appendix D</b></h3>
<table width="614" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Software Name</b></p>
</td>
<td width="472" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td colspan="2" width="614" valign="top"><p><b>VPN</b></p>
</td>
</tr><tr><td width="141" valign="top"><p>OpenVPN</p>
</td>
<td width="472" valign="top"><p>VPN Client</p>
</td>
</tr><tr><td width="141" valign="top"><p>NordVPN</p>
</td>
<td width="472" valign="top"><p>VPN Client</p>
</td>
</tr><tr><td width="141" valign="top"><p>Private Internet Access</p>
</td>
<td width="472" valign="top"><p>VPN Client</p>
</td>
</tr><tr><td width="141" valign="top"><p>VPN-GUI</p>
</td>
<td width="472" valign="top"><p>VPN client</p>
</td>
</tr></tbody></table>
<p><b>&nbsp;</b></p>
<h3><b>Appendix E</b></h3>
<table width="614" cellspacing="0" cellpadding="0" border="1">
<tbody><tr><td width="141" valign="top"><p><b>Software Name</b></p>
</td>
<td width="472" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td colspan="2" width="614" valign="top"><p><b>Miscellaneous</b></p>
</td>
</tr><tr><td width="141" valign="top"><p>jDownloader</p>
</td>
<td width="472" valign="top"><p>Download manager</p>
</td>
</tr><tr><td width="141" valign="top"><p>Internet Download Manager</p>
</td>
<td width="472" valign="top"><p>Downloader tool</p>
</td>
</tr><tr><td width="141" valign="top"><p>My SQL Workbench</p>
</td>
<td width="472" valign="top"><p>SQL Workbench</p>
</td>
</tr><tr><td width="141" valign="top"><p>UltraVNC</p>
</td>
<td width="472" valign="top"><p>Remote Desktop Server</p>
</td>
</tr><tr><td width="141" valign="top"><p>TightVNC</p>
</td>
<td width="472" valign="top"><p>Remote Desktop Server</p>
</td>
</tr></tbody></table>
<p>&nbsp;</p>
<h3><b>BlackBerry Assistance</b></h3>
<p>If you’re battling Agent Tesla or a similar threat, you’ve come to the right place, regardless of your existing BlackBerry relationship.</p>
<p><a href="https://www.blackberry.com/us/en/services/incident-response" target="_blank">The BlackBerry Incident Response team</a> is made up of world-class consultants dedicated to handling response and containment services for a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases.</p>
<p>We have a global consulting team standing by to assist you providing around-the-clock support, where required, as well as local assistance. Please contact us here: <a href="https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment" target="_blank">https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment<br>
 <br>
 </a></p>

    
    
</div>


    
    
    <div class="authorblog"><!--Pulling author bio from author page-->

    
    
        
  



<div class="author-info" data-author-name="The BlackBerry Research &amp; Intelligence Team" data-author-path="https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware">
  <div class="author-avatar">
    
    <img src="/content/dam/blogs-blackberry-com/images/authors/blackberry-logo-square.jpg" class="author-avatar" alt="The BlackBerry Research &amp; Intelligence Team"/>				
    
  </div><!-- .author-avatar -->
  <div class="author-description">
      
    
    <h2>About The BlackBerry Research &amp; Intelligence Team</h2>
    <p>The BlackBerry Research &amp; Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of defenders and the organizations they serve.</p>

  </div><!-- .author-description	-->
</div>
<hr class="author-hr"/>
    
</div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware&text=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware&title=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Threat%20Thursday:%20Agent%20Tesla%20Infostealer&body=https://blogs.blackberry.com/en/2021/06/threat-thursday-agent-tesla-infostealer-malware" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="backbutton">
<a href="javascript:history.back()" class="cta cta-primary btn-back-button">Back</a></div>



      </div>
      
          
      </div>
    </section>
      
  
  
</div>


    
    
    <div class="text">    
    
    
    
    
</div>



</main>

<!-- BEGIN DO NOT INDEX -->
<footer>
    <div class="container pt-2">
    <nav id='footerNav'>
        <div>
            <div class="row my-4">
                <div class='socialLinks col-lg-4 col-md-4 col-sm-12 pb-3'>
                    <a href='https://www.facebook.com/BlackBerry/' class='socialLink px-3 pl-0' target="_blank" rel="noopener" style="padding-left:0 !important;">
                      <span class='sr-only' aria-label="BlackBerry Facebook Account">Facebook</span>
                      <span class='svgIcon-social fb' aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"/>
                        </svg>
                      </span>
                    </a>
                    <a href='https://twitter.com/blackberry' target="_blank" class='socialLink px-3 ' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Twitter Account">Twitter</span>
                      <span class='svgIcon-social tw'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                      </span>
                    </a>
                    <a href='https://www.youtube.com/user/BlackBerry' target="_blank" class='socialLink px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry YouTube Account">YouTube</span>
                      <span class='svgIcon-social yt'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
                      </span>                      
                    </a>
                    <a href='https://www.instagram.com/blackberry/' target="_blank" class='socialLink youTube px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Instagram Account">Instagram</span>
                      <span class='svgIcon-social ig'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
                      </span>                        
                    </a>
                                 
                  </div>
                
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                </div>-->
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/support" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/support/overview" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                </div>-->
            </div>
            <hr/>
            <div class='row mt-5'>
               <!--/% <div class='col-xs-12 col-md-3'>
                   
                    <sly data-sly-list.col1="">
                        
                          <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse1" aria-expanded="false" aria-controls="collapse1">
                          	<h3>
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span> 
                            </h3>
                          </a>
                          
                        <sly data-sly-list.children="">
                        	<div class="collapse in" id="collapse1">
                            <ul data-sly-list.leveltwo="">
                                <li>
                                    <sly data-sly-use.navLink="Footer">
                                        <sly data-sly-test="">
                                            <a href="" data-sly-attribute.target=""></a>
                                        </sly>
                                        <sly data-sly-test="true">
                                            <a href="" data-sly-attribute.target="" rel="noopener"></a>
                                        </sly>
                                    </sly>
                                </li>
                            </ul>
                            </div>
                        </sly>
                    </sly>
                </div>
%/-->
                <div class='col-xs-12 col-md-4'>
                    <!--Col-2-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse21" aria-expanded="false" aria-controls="collapse21">
                        	<h3>Corporate
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse21">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company" rel="noopener" target="_blank">Company</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/newsroom" target="_blank">Newsroom</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/investors" target="_blank">Investors</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/careers" rel="noopener" target="_blank">Careers</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/leadership" target="_blank">Leadership</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/corporate-responsibility-at-blackberry" target="_blank">Corporate Responsibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/certifications" rel="noopener" target="_blank">Certifications</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/success-stories" rel="noopener" target="_blank">Customer Success</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-3-->
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse31" aria-expanded="false" aria-controls="collapse31">
                        	<h3>Developers
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse31">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://developers.blackberry.com/" rel="noopener" target="_blank">Enterprise Platform &amp; Apps</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.qnx.com/account/login.html?returnaddress=%2Fdownload%2Fgroup.html%3Fprogramid%3D29178" rel="noopener" target="_blank">BlackBerry QNX Developer Network</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse32" aria-expanded="false" aria-controls="collapse32">
                        	<h3>Blogs
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse32">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://blogs.blackberry.com/" rel="noopener">BlackBerry ThreatVector Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://devblog.blackberry.com/" rel="noopener" target="_blank">Developers Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://helpblog.blackberry.com/" rel="noopener" target="_blank">Help Blog</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-4-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse41" aria-expanded="false" aria-controls="collapse41">
                        	<h3>Legal
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse41">
                            <ul>
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal" target="_blank">Overview</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/accessibility" target="_blank">Accessibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/blackberry-virtual-patent-marking" target="_blank">Patents</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/trademarks" target="_blank">Trademarks</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/privacy-policy" target="_blank">Privacy Policy</a>
                                        
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
            </div>
            </div>
        </div>
        <div class='container'>
            <div class='row tm10' style="padding-top: 50px">
                <div class='col-xs-12 col-md-6 copyright' copyright>
                    <p>
                        © 2023 BlackBerry Limited. All rights reserved.
                    </p>
                </div>
              
                
            </div>
        </div>

    </nav>
    </div>
</footer>
<!-- END DO NOT INDEX -->
            
    
    
    
    
<script src="/etc.clientlibs/shared/clientlibs/jquery.min.c4de22c2db1dbe5fe0380215f514281f.js"></script>
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-dependencies.min.d41d8cd98f00b204e9800998ecf8427e.js"></script>





    
    
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.8f8340887c35307d1a6f8cc1e121c30b.js"></script>




    

    

    
    
    

            

            
            <script type="text/plain" class="optanon-category-C0002">

  (function () {

    var getParameterByName = function (name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    var getParentAnchor = function (element) {

      while (element !== null && !(element instanceof HTMLDocument)) {
        if (element.tagName.toUpperCase() === "A") {
          return element;
        }
        element = element.parentNode;
      }
      return null;
    };

    if (document.title === '404') {
        _satellite.track("error",
        { "errorType": "404", "pageURL": document.location.href }
      );
    }

    document.addEventListener('click', function (event) {
      var downloadFiles = [".pdf", ".exe", ".zip",".gzip",".gz",".tar",".jar",".bin",".dmg",".tgz",".mp4"];
      var videoSourceFound = "";
      var elem = getParentAnchor(event.target);
      var audioPlayerButton;
      var audioPlayerButtonChild;
      if (elem !== null) {
        var urlSplit = elem.href.split("/");
        if (elem.matches("a.twitter-share") || elem.matches("a.facebook-share") || elem.matches("a.linkedin-share") || elem.matches("a.email-share")) {
            _satellite.track("social_share",
              { "socialName": elem.className.split('-')[0] }
            );
        }
        else if (elem.hasAttribute("data-lity")) {
          var videoSources = { scene7: "s7d2.scene7.com", youtube: ["youtu.be", "youtube.com"], vimeo: "vimeo.com" };
          for (var key in videoSources) {
            if (videoSources.hasOwnProperty(key)) {
              if (Array.isArray(videoSources[key])) {
                videoSources[key].forEach(function (domain, i) {
                  if (elem.href.indexOf(domain) > -1) {
                    videoSourceFound = key;
                  }
                });

              } else {
                if (elem.href.indexOf(videoSources[key]) > -1) {
                  videoSourceFound = key;
                }
              }
            }
          }
          if (videoSourceFound !== "") {
            var linkHref = videoSourceFound === "scene7" ? getParameterByName("asset",elem.href): elem.href;
              _satellite.track("video", {
                "linkHref": linkHref,
                "videoPlatform": videoSourceFound,
                "linkText": elem.text.trim()
              });
          }

        }
        else if (elem.text.toLowerCase().indexOf("subscribe") > -1 || elem.text.toLowerCase().indexOf("register for updates") > -1) {
            _satellite.track("subscribe",
              { "linkText": elem.text.trim() }
            );
        }
        else if (elem.text.toLowerCase().indexOf("contact us") > -1 || elem.text.toLowerCase().indexOf("contact sales") > -1) {
            _satellite.track("contact_us",
              { "linkText": elem.text.trim() }
            );
        }
        else if (!(elem.host.indexOf(window.location.host) > -1) && elem.href !== "" && videoSourceFound == "") {
            _satellite.track("site_exit", {
              "site": elem.hostname
            });
        }

        for (var i = 0; i < downloadFiles.length; i++) {
          if (elem.href.toLowerCase().indexOf(downloadFiles[i]) > -1) {
            var fileName = urlSplit[urlSplit.length - 1];
            console.log('Download clicked');
              _satellite.track("download",
                { "fileName": fileName }
              );
          }
        }
      }
      else {
        //AA Tracking for Audio Player Component - CM 2/9/2022
        if (event.target.matches('.bb-dms7-audio-container-right__top-playpause') || event.target.matches('#playpauseIcon')) { 
          
          var eventType;
          var audioComponent = $('.audio')[0];
          var audioSource = $($(audioComponent).find('#player source')[0]).attr('src');
          var audioTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__podcast-name')[0]).text();
          var trackTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__episode-title')[0]).text();

          if (event.target.matches('.bb-dms7-audio-container-right__top-playpause')) {
            if (event.target.childNodes[0].nextElementSibling.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.childNodes[0].nextElementSibling.matches('.fa-pause')) {
              eventType = 'play';
            }
          }
          else if (event.target.matches('#playpauseIcon')) {
            if (event.target.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.matches('.fa-pause')) {
              eventType = 'play';
            }
          }

          if (typeof _satellite !== 'undefined') {
              _satellite.track("audio", {
                "eventType": eventType,
                "audioTitle": audioTitle,
                "trackTitle": trackTitle,
                "audioSource": audioSource
              });
          }
        }
      }
    }, false);


  })();


</script>



<script>
    function getGclidQueryParameter(p) {
      var match = RegExp('[?&]' + p + '=([^&]*)').exec(window.location.search);
      return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

    function getExpiryRecord(value) {
      var expiryPeriod = 90 * 24 * 60 * 60 * 1000; // 90 day expiry in milliseconds

      var expiryDate = new Date().getTime() + expiryPeriod;
      return {
        value: value,
        expiryDate: expiryDate
      };
    }

    function addGclid() {
      var gclidParam = getGclidQueryParameter('gclid');
      var gclidFormFields = ['gclid_field']; // all possible gclid form field ids here
      var gclidRecord = null;
      var currGclidFormField;

      var gclsrcParam = getGclidQueryParameter('gclsrc');
      var isGclsrcValid = !gclsrcParam || gclsrcParam.indexOf('aw') !== -1;

      gclidFormFields.forEach(function (field) {
        if (document.getElementById(field)) {
          currGclidFormField = document.getElementById(field);
        }
      });

      if (gclidParam && isGclsrcValid) {
        gclidRecord = getExpiryRecord(gclidParam);
        localStorage.setItem('gclid', JSON.stringify(gclidRecord));
      }

      var gclid = gclidRecord || JSON.parse(localStorage.getItem('gclid'));
      var isGclidValid = gclid && new Date().getTime() < gclid.expiryDate;

      if (currGclidFormField && isGclidValid) {
        currGclidFormField.value = gclid.value;
      }
    }

    window.addEventListener('load', addGclid);
  </script>
        
    </body>
</html>
